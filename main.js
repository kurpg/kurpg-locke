(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["main"],{

/***/ "./$$_lazy_route_resource lazy recursive":
/*!******************************************************!*\
  !*** ./$$_lazy_route_resource lazy namespace object ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncaught exception popping up in devtools
	return Promise.resolve().then(function() {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	});
}
webpackEmptyAsyncContext.keys = function() { return []; };
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
module.exports = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "./$$_lazy_route_resource lazy recursive";

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/app.component.html":
/*!**************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/app.component.html ***!
  \**************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div id=\"app-table-layer\" style=\"position: absolute; width: 100%; height: 100%; overflow: hidden;\">\n  <game-table></game-table>\n</div>\n<ui-panel [top]=\"0\" [left]=\"0\" [width]=\"100\" [height]=\"470\" [title]=\"'メニュー'\">\n  <nav>\n    <ul>\n      <li (click)=\"open('PeerMenuComponent')\">\n        <a routerLink=\"/\" routerLinkActive=\"active\">\n          <div><i class=\"material-icons icon-size\">people</i></div>\n          <div>接続</div>\n        </a>\n      </li>\n      <li (click)=\"open('ChatWindowComponent')\">\n        <a routerLink=\"/\" routerLinkActive=\"active\">\n          <div><i class=\"material-icons icon-size\">speaker_notes</i></div>\n          <div>チャット画面</div>\n        </a>\n      </li>\n      <li (click)=\"open('GameTableSettingComponent')\">\n        <a routerLink=\"/\" routerLinkActive=\"active\">\n          <div><i class=\"material-icons icon-size\">layers</i></div>\n          <div>テーブル設定</div>\n        </a>\n      </li>\n      <li (click)=\"open('FileStorageComponent')\">\n        <a routerLink=\"/\" routerLinkActive=\"active\">\n          <div><i class=\"material-icons icon-size\">photo_library</i></div>\n          <div>画像</div>\n        </a>\n      </li>\n      <li (click)=\"open('JukeboxComponent')\">\n        <a routerLink=\"/\" routerLinkActive=\"active\">\n          <div><i class=\"material-icons\">queue_music</i></div>\n          <div>音楽</div>\n        </a>\n      </li>\n      <li (click)=\"open('GameObjectInventoryComponent')\">\n        <a routerLink=\"/\" routerLinkActive=\"active\">\n          <div><i class=\"material-icons icon-size\">folder_shared</i></div>\n          <div>インベントリ</div>\n        </a>\n      </li>\n      <li>\n        <a routerLink=\"/\" routerLinkActive=\"active\">\n          <label>\n            <div><i class=\"material-icons\">open_in_browser</i></div>\n            <div>ZIP読込</div>\n            <input type=\"file\" style=\"display: none;\" (change)=\"handleFileSelect($event)\" multiple\n              accept=\"application/xml,text/xml,application/zip\" />\n          </label>\n        </a>\n      </li>\n      <li (click)=\"save()\">\n        <a routerLink=\"/\" routerLinkActive=\"active\">\n          <div><i class=\"material-icons\">sd_storage</i></div>\n          <div>保存</div>\n        </a>\n      </li>\n    </ul>\n  </nav>\n</ui-panel>\n<div #modalLayer></div>\n<network-indicator class=\"networkIndicator\"></network-indicator>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/badge/badge.component.html":
/*!********************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/badge/badge.component.html ***!
  \********************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"badge\" [@bounce]=\"animeState\">{{count}}</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/card-stack-list/card-stack-list.component.html":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/card-stack-list/card-stack-list.component.html ***!
  \****************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div>\n  <button (click)=\"close(true)\">シャッフルしてウィンドウを閉じる</button>\n  <hr/>\n  <div *ngFor=\"let card of cardStack.cards; trackBy: trackByCard\" class=\"box\">\n    <div class=\"image-box\" [appTooltip]=\"card\">\n      <div class=\"image contain\" [style.background-image]=\"'url(' + card?.frontImage?.url + ')' | safe: 'style' \"></div>\n      <div class=\"image contain\" [style.background-image]=\"'url(' + card?.backImage?.url + ')' | safe: 'style' \"></div>\n    </div>\n    <div style=\"display: inline-block;\">\n      <button type=\"submit\" (click)=\"drawCard(card)\">山札から出す</button>\n      <button (click)=\"showDetail(card)\"><i class=\"material-icons\" style=\"font-size: 1.1em; vertical-align: text-bottom;\">settings</i>編集</button>\n      <br>\n      <button (click)=\"up(card)\">↑</button>\n      <button (click)=\"down(card)\">↓</button>\n      <br>\n    </div>\n  </div>\n</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/card-stack/card-stack.component.html":
/*!******************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/card-stack/card-stack.component.html ***!
  \******************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component is-3d is-pointer-events-none\" [ngClass]=\"{'is-empty': isEmpty}\"\n  [style.width.px]=\"size * gridSize\"\n  appMovable [movable.option]=\"movableOption\" (movable.ondragstart)=\"onMove()\" (movable.ondragend)=\"onMoved()\">\n  <div class=\"component-content is-pointer-events-auto is-grab\"\n    appRotable [rotable.option]=\"rotableOption\" (rotable.ondragstart)=\"onMove()\" (rotable.ondragend)=\"onMoved()\">\n    <div *ngIf=\"imageFile\" (@shuffle.start)=\"animationShuffleStarted($event)\" (@shuffle.done)=\"animationShuffleDone($event)\"\n      [@shuffle]=\"animeState\">\n      <img class=\"card-image\" [ngStyle]=\"{'transform': 'rotateZ(' + topCard.rotate +'deg)'}\" [src]=\"imageFile.url | safe: 'resourceUrl'\">\n    </div>\n    <ng-container *ngIf=\"!isIconHidden\">\n      <div class=\"rotate-grab of-left-top\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-left-bottom\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-right-bottom\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-right-top\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n    </ng-container>\n    <div *ngIf=\"isShowTotal\" class=\"name-tag is-nowrap is-black-background\" [ngStyle]=\"{'transform': 'translateY(-50%) translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}\">\n      <span>{{cards.length}}枚</span>\n    </div>\n    <div *ngIf=\"hasOwner\" class=\"name-tag has-length-limit is-nowrap is-black-background\" [ngStyle]=\"{'transform': 'translateY(50%) translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}\">\n      <span>{{ownerName}} が確認中</span>\n    </div>\n  </div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/card/card.component.html":
/*!******************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/card/card.component.html ***!
  \******************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component is-3d is-pointer-events-none is-grab\" [style.width.px]=\"size * gridSize\"\n  appMovable [movable.option]=\"movableOption\" (movable.ondragstart)=\"onMove()\" (movable.ondragend)=\"onMoved()\">\n  <div class=\"component-content is-pointer-events-auto\"\n    appRotable [rotable.option]=\"rotableOption\" (rotable.ondragstart)=\"onMove()\" (rotable.ondragend)=\"onMoved()\">\n    <img *ngIf=\"imageFile\" class=\"card-image\" [src]=\"(isFront ? frontImage.url : backImage.url) | safe: 'resourceUrl'\">\n    <div *ngIf=\"!isFront && hasOwner\" class=\"name-tag is-nowrap has-length-limit is-black-background\" [ngStyle]=\"{'transform': 'translateY(-75%) translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}\">\n      <span>{{ownerName}}</span>\n    </div>\n    <img *ngIf=\"isHand && frontImage\" class=\"card-image thumbnail-transform is-translucent\" [src]=\"frontImage.url | safe: 'resourceUrl'\">\n    <ng-container *ngIf=\"!isIconHidden\">\n      <div class=\"rotate-grab of-left-top\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-left-bottom\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-right-bottom\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-right-top\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"border-bg is-pointer-events-none\"></div>\n    </ng-container>\n  </div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-message/chat-message.component.html":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-message/chat-message.component.html ***!
  \**********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"container\">\n  <div class=\"message\" [ngClass]=\"{'direct-message': (chatMessage.isDirect || chatMessage.isSecret), 'system-message':chatMessage.isSystem, 'dicebot-message': chatMessage.isDicebot}\"\n    [@flyInOut]=\"'in'\">\n    <div class=\"image\">\n      <img *ngIf=\"0 < imageFile?.url?.length\" [src]=\"imageFile?.url | safe: 'resourceUrl'\" />\n    </div>\n    <div class=\"body\">\n      <div class=\"title\">\n        <span class=\"msg-name\">{{chatMessage.name}}</span>\n        <span class='tip msg-from'>{{chatMessage.from}}</span>\n        <span class='tip msg-timestamp'>{{chatMessage.timestamp | date:'y/M/d H:mm'}}</span>\n      </div>\n      <div class=\"text msg-text\">\n        <ng-container *ngIf=\"!chatMessage.isSecret || chatMessage.isSendFromSelf; then visible; else secret\"></ng-container>\n      </div>\n    </div>\n  </div>\n</div>\n<ng-template #visible>\n  <span>{{chatMessage.text}}</span>\n  <button *ngIf=\"chatMessage.isSecret\" (click)=\"discloseMessage()\">結果を公開</button>\n</ng-template>\n<ng-template #secret>\n  <span>（シークレットダイス）</span>\n</ng-template>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-palette/chat-palette.component.html":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-palette/chat-palette.component.html ***!
  \**********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"flex-container\">\n  <div style=\"flex-grow: 0;\">\n    <form>\n      <div class=\"chat-tab\">\n        <label *ngFor=\"let chatTab of chatMessageService.chatTabs\">\n          <input name=\"chat-tab\" type=\"radio\" value=\"{{chatTab.identifier}}\" ng-control=\"options\" [(ngModel)]=\"chatTabidentifier\">\n          <div>{{chatTab.name}}<badge *ngIf=\"chatTab.hasUnread\" class=\"badge\" [count]=\"chatTab.unreadLength\"></badge></div>\n        </label>\n      </div>\n    </form>\n    <div class=\"table\" [ngClass]=\"{ 'direct-message': isDirect }\">\n      <div class=\"table-cell imagebox\">\n        <img class=\"image\" *ngIf=\"character && character.imageFile != null && 0 < character.imageFile.url.length\" [src]=\"character.imageFile.url | safe: 'resourceUrl'\"\n        />\n      </div>\n      <div class=\"table-cell\">\n        <div>\n          <select style=\"width: 12em;\" (change)=\"onSelectedCharacter($event.target.value)\"  [ngModel]=\"character.identifier\">\n            <option *ngFor=\"let gameCharacter of gameCharacters\" value=\"{{gameCharacter.identifier}}\">{{gameCharacter.name}}</option>\n          </select> ＞\n          <select style=\"width: 10em;\" [(ngModel)]=\"sendTo\">\n            <option value=\"\">全員</option>\n            <option *ngFor=\"let peer of otherPeers\" value=\"{{peer.identifier}}\">{{peer.name}}<ng-container *ngIf=\"peer === myPeer\">（あなた）</ng-container></option>\n          </select>\n          <select style=\"width: 12em;\" (change)=\"onChangeGameType($event.target.value)\" [(ngModel)]=\"gameType\" [ngModelOptions]=\"{standalone: true}\">\n            <option value=\"\">ダイスボット指定なし</option>\n            <option *ngFor=\"let diceBotInfo of diceBotInfos\" value=\"{{diceBotInfo.script}}\">{{diceBotInfo.game}}</option>\n          </select>\n          <button (click)=\"showDicebotHelp()\">?</button>\n        </div>\n        <div>\n          <form>\n            <!--<input [(ngModel)]=\"text\" placeholder=\"message\" [ngModelOptions]=\"{standalone: true}\" style=\"width: 25em;\">-->\n            <textarea #textArea [(ngModel)]=\"text\" placeholder=\"Enterで送信  Shift+Enterで改行\" [ngModelOptions]=\"{standalone: true}\" class=\"chat-input\" (input)=\"onInput()\" (keydown.enter)=\"sendChat($event)\"></textarea>\n            <button type=\"submit\" (click)=\"sendChat(null)\">SEND</button>\n          </form>\n        </div>\n      </div>\n    </div>\n    <div *ngIf=\"isEdit\" class=\"edit-info\"><i class=\"material-icons\" style=\"vertical-align: bottom; size:0.8rem;\">info_outline</i> チャットパレット編集中です</div>\n  </div>\n  <div *ngIf=\"!isEdit\" style=\"flex-grow: 1; height: 0; min-height: 100px;\">\n    <select class=\"palette\" style=\"overflow-y: auto;\" size=\"5\" (input)=\"selectPalette($event.target.value)\" (click)=\"clickPalette($event.target.value)\" #chatPlette>\n      <ng-container *ngIf=\"palette\">\n        <option *ngFor=\"let palette of palette.getPalette()\" value=\"{{palette}}\">{{palette}}</option>\n      </ng-container>\n    </select>\n  </div>\n  <div *ngIf=\"isEdit\" style=\"flex-grow: 1; height: 0; min-height: 100px;\">\n    <textarea class=\"palette\" style=\"resize: none;\" [(ngModel)]=\"editPalette\" placeholder=\"チャットパレット\"></textarea>\n  </div>\n  <div style=\"flex-grow: 0;\">\n    <button type=\"submit\" (click)=\"toggleEditMode()\">\n      <span *ngIf=\"!isEdit\">チャットパレットの編集</span>\n      <span *ngIf=\"isEdit\">チャットパレットを確定</span>\n    </button>\n  </div>\n</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-tab-setting/chat-tab-setting.component.html":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-tab-setting/chat-tab-setting.component.html ***!
  \******************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"flex-container\">\n  <div class=\"flex-item no-grow\">\n    <div>\n      <button (click)=\"create()\">チャットタブを作る</button>\n    </div>\n    <select style=\"width: 10em;\" size=\"10\" (change)=\"onChangeSelectTab($event.target.value)\" [ngModel]=\"selectedTab?.identifier\">\n      <option *ngFor=\"let chatTab of chatTabs\" value=\"{{chatTab.identifier}}\">{{chatTab.name}}</option>\n    </select>\n  </div>\n  <div class=\"flex-item\">\n    <ng-container *ngIf=\"!isEmpty && selectedTab\">\n      <div>タブ名 :\n        <input [(ngModel)]=\"tabName\" placeholder=\"Name\" [attr.disabled]=\"!isEditable ? '' : null\" />\n      </div>\n      <hr/>\n      <div>\n        <ng-container *ngIf=\"!isDeleted\">\n          <button (click)=\"save()\">保存</button>\n          <button class=\"danger\" (click)=\"delete()\" [attr.disabled]=\"chatTabs.length <= 1 ? '' : null\">削除</button>\n        </ng-container>\n        <ng-container *ngIf=\"isDeleted\">\n          <button (click)=\"restore()\">元に戻す</button>\n        </ng-container>\n      </div>\n    </ng-container>\n  </div>\n</div>\n<ng-container *ngIf=\"isEmpty\">\n  <div style=\"font-size: 12px;\">※チャットタブが１つも作成されていません。「チャットタブを作る」からチャットタブを作成することができます。</div>\n</ng-container>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-tab/chat-tab.component.html":
/*!**************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-tab/chat-tab.component.html ***!
  \**************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"log\" *ngIf=\"0 < chatMessages.length\">\n  <button *ngIf=\"hasMany\" (click)=\"moreMessages()\">さらに古いログを見る</button>\n  <ng-container *ngFor=\"let chatMessage of chatMessages; trackBy: trackByChatMessage\">\n    <chat-message *ngIf=\"chatMessage.isDisplayable\" [chatMessage]=\"chatMessage\" (onInit)=\"onMessageInit()\"></chat-message>\n  </ng-container>\n</div>\n<div class=\"log\" *ngIf=\"chatMessages.length < 1\">\n  <chat-message *ngFor=\"let chatMessage of sampleMessages\" [chatMessage]=\"chatMessage\" (onInit)=\"onMessageInit()\"></chat-message>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-window/chat-window.component.html":
/*!********************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-window/chat-window.component.html ***!
  \********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<!--<h2>チャットシステム</h2>-->\n<div class=\"component\">\n<div class=\"log\">\n  <chat-tab *ngIf=\"chatTab\" [chatTab]=\"chatTab\" (onAddMessage)=\"scrollToBottom()\"></chat-tab>\n  <div *ngIf=\"!chatTab\">※チャットタブの内容が更新されました。チャットタブを選択しなおすか、このチャットウィンドウを開きなおしてください。</div>\n</div>\n<div class=\"sticky-bottom\">\n  <form>\n    <div class=\"chat-tab\">\n      <label *ngFor=\"let chatTab of chatMessageService.chatTabs; trackBy: trackByChatTab\">\n        <input name=\"chat-tab\" type=\"radio\" value=\"{{chatTab.identifier}}\" ng-control=\"options\" [(ngModel)]=\"chatTabidentifier\">\n        <div>{{chatTab.name}}<badge *ngIf=\"chatTab.hasUnread\" class=\"badge\" [count]=\"chatTab.unreadLength\"></badge></div>\n      </label>\n      <button class=\"tab-setting small-font\" (click)=\"showTabSetting()\"><i class=\"material-icons small-font\">settings</i>タブ設定</button>\n    </div>\n  </form>\n<div class=\"table\" [ngClass]=\"{'direct-message': isDirect}\">\n  <div class=\"table-cell imagebox\">\n    <img class=\"image\" *ngIf=\"gameCharacter && gameCharacter.imageFile != null && 0 < gameCharacter.imageFile?.url?.length\" [src]=\"gameCharacter.imageFile?.url | safe: 'resourceUrl'\"\n    />\n    <img class=\"image\" *ngIf=\"!gameCharacter && myPeer && myPeer?.image != null\" [src]=\"myPeer?.image?.url | safe: 'resourceUrl'\"\n    />\n  </div>\n  <div class=\"table-cell\">\n    <div>\n      <select style=\"width: 12em;\" (change)=\"onSelectedCharacter($event.target.value)\">\n        <option value=\"{{myPeer?.identifier}}\">{{myPeer?.name}}（あなた）</option>\n        <option *ngFor=\"let gameCharacter of gameCharacters\" value=\"{{gameCharacter.identifier}}\">{{gameCharacter.name}}</option>\n      </select> ＞\n      <select style=\"width: 10em;\" [(ngModel)]=\"sendTo\">\n        <option value=\"\">全員</option>\n        <option *ngFor=\"let peer of otherPeers\" value=\"{{peer.identifier}}\">{{peer.name}}<ng-container *ngIf=\"peer === myPeer\">（あなた）</ng-container></option>\n      </select>\n      <select style=\"width: 12em;\" (change)=\"onChangeGameType($event.target.value)\" [(ngModel)]=\"gameType\" [ngModelOptions]=\"{standalone: true}\">\n        <option value=\"\">ダイスボット指定なし</option>\n        <option *ngFor=\"let diceBotInfo of diceBotInfos\" value=\"{{diceBotInfo.script}}\">{{diceBotInfo.game}}</option>\n      </select>\n      <button (click)=\"showDicebotHelp()\">?</button>\n    </div>\n    <div>\n      <form #chatWindowForm=\"ngForm\">\n        <textarea #textArea [(ngModel)]=\"text\" placeholder=\"Enterで送信  Shift+Enterで改行\" [ngModelOptions]=\"{standalone: true}\" class=\"chat-input\" (input)=\"onInput()\" (keydown.enter)=\"sendChat($event)\"></textarea>\n        <button type=\"submit\" (click)=\"sendChat(null)\">SEND</button>\n      </form>\n    </div>\n    <div class=\"writing-info\">\n      <ng-container *ngIf=\"0 < writingPeerNames.length\" >\n        <span *ngFor=\"let peerName of writingPeerNames; index as i\" style=\"font-weight: bold;\">{{peerName}}<span *ngIf=\"writingPeerNames.length !== (i + 1)\">, </span></span>\n        <span> が入力中...</span>\n      </ng-container>\n    </div>\n  </div>\n</div>\n</div>\n<!--<div style=\"white-space:pre-wrap; font-size: 8px;\"><span>{{gameHelp}}</span></div>-->");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/context-menu/context-menu.component.html":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/context-menu/context-menu.component.html ***!
  \**********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component\" [ngClass]=\"{'submenu-panel': isSubmenu, 'is-max-limit': !isSubmenu, 'pointer-events-none': isPointerDragging}\" (mouseleave)=\"hideSubMenu()\" #root>\n  <div *ngIf=\"0 < title.length\" class=\"title\">{{title}}</div>\n  <ul>\n    <ng-container *ngFor=\"let action of actions\">\n      <ng-container *ngTemplateOutlet=\"action?.type === 'separator' ? separator : actionMenu; context: { action: action }\"></ng-container>\n    </ng-container>\n  </ul>\n</div>\n<ng-template #actionMenu let-action=\"action\">\n  <li class=\"hasHighlight\" (click)=\"doAction(action)\" (mouseenter)=\"showSubMenu(action)\">\n    <div class=\"menu-title\">{{action.name}}</div>\n    <div *ngIf=\"action.subActions\" class=\"sub-menu-arrow\">\n      <i class=\"material-icons\" style=\"font-size: 1em; vertical-align: bottom;\">arrow_forward_ios</i>\n    </div>\n    <context-menu *ngIf=\"subMenu && parentMenu === action\" [title]=\"action.name\" [actions]=\"subMenu\" [isSubmenu]=\"true\"></context-menu>\n  </li>\n</ng-template>\n<ng-template #separator let-action=\"action\">\n  <li>\n    <hr class=\"separator\" />\n  </li>\n</ng-template>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/dice-symbol/dice-symbol.component.html":
/*!********************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/dice-symbol/dice-symbol.component.html ***!
  \********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component is-3d is-grab is-pointer-events-none\" [style.width.px]=\"size * gridSize\" [style.height.px]=\"size * gridSize\"\n  appMovable [movable.option]=\"movableOption\" (movable.ondragstart)=\"onMove()\" (movable.ondragend)=\"onMoved()\">\n  <div class=\"component-content is-3d\" [@bounceInOut]=\"'in'\">\n    <div appRotable [rotable.option]=\"rotableOption\" (rotable.ondragstart)=\"onMove()\" (rotable.ondragend)=\"onMoved()\"\n      class=\"component-content is-3d is-pointer-events-auto\">\n      <div class=\"pedestal-inner\" [ngClass]=\"{'is-gray-border': hasOwner}\"></div>\n      <div class=\"pedestal-outer\"></div>\n      <ng-container *ngIf=\"!isIconHidden\">\n      <div class=\"pedestal-grab rotate-grab\">\n        <div class=\"pedestal-grab-border\">\n          <div class=\"material-icons of-front\">autorenew</div>\n          <div class=\"material-icons of-back\">autorenew</div>\n        </div>\n      </div>\n      </ng-container>\n      <div class=\"component-content is-3d\" [@diceRoll]=\"animeState\" (@diceRoll.done)=\"animationShuffleDone($event)\">\n        <div class=\"upright-transform is-fit-width is-3d\">\n          <div class=\"rotate-frame is-3d\" [style.width.px]=\"size * gridSize\" [style.height.px]=\"size * gridSize\">\n            <div class=\"rotate-inner is-3d\">\n              <div *ngIf=\"0 < name.length\" class=\"name-tag is-nowrap is-black-background is-3d\" [ngStyle]=\"{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}\">\n                <div class=\"fornt-tag is-3d\">{{name}}:<span *ngIf=\"isVisible\">{{face}}</span><span *ngIf=\"!isVisible\">???</span></div>\n                <div class=\"back-tag is-3d\">{{name}}:<span *ngIf=\"isVisible\">{{face}}</span><span *ngIf=\"!isVisible\">???</span></div>\n              </div>\n              <div *ngIf=\"hasOwner\" class=\"owner-tag is-nowrap is-black-background is-3d\" [ngStyle]=\"{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}\">\n                <div class=\"fornt-tag has-length-limit is-3d\">{{ownerName}}</div>\n                <div class=\"back-tag has-length-limit is-3d\">{{ownerName}}</div>\n              </div>\n              <img class=\"image\" *ngIf=\"0 < imageFile.url.length\" [src]=\"imageFile.url | safe: 'resourceUrl'\" [ngClass]=\"{'is-black-mask': !isVisible, 'is-harf-black-mask': isMine}\">\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/file-selecter/file-selecter.component.html":
/*!************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/file-selecter/file-selecter.component.html ***!
  \************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div id=\"file-list\">\n  <span class=\"empty\" *ngIf=\"isAllowedEmpty\">\n    <button (click)=\"onSelectedFile(empty)\">画像なし</button>\n  </span>\n  <span *ngFor=\"let file of images\" class=\"image\">\n    <img *ngIf=\"0 < file.url.length\" [src]=\"file.url | safe: 'resourceUrl'\" [alt]=\"file.name\" height=\"120\" (click)=\"onSelectedFile(file)\">\n    <img *ngIf=\"file.url.length <= 0\" src=\"./assets/images/loading.gif\" alt=\"{{file.name}}\">\n  </span>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/file-storage/file-storage.component.html":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/file-storage/file-storage.component.html ***!
  \**********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<label>\n  <div class=\"drop-zone\">\n    <div>\n      <i class=\"material-icons large-font\">add_photo_alternate</i>\n    </div>\n    <div>ここに画像をドロップ</div>\n    <div class=\"small-font\">またはここをクリックして選択</div>\n    <input type=\"file\" style=\"display: none;\" (change)=\"handleFileSelect($event)\" multiple accept=\"image/*\"/>\n    <div class=\"small-font\">\n      <br>１ファイルにつき2MBまで</div>\n  </div>\n</label>\n<div id=\"file-list\">\n  <span *ngFor=\"let file of fileStorageService.images\" class=\"image\">\n    <img *ngIf=\"0 < file.url.length\" [src]=\"file.url | safe: 'resourceUrl'\" [alt]=\"file.name\" height=\"120\" (click)=\"onSelectedFile(file)\">\n    <img *ngIf=\"file.url.length <= 0\" src=\"assets/images/loading.gif\" alt=\"{{file.name}}\">\n  </span>\n</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character-generator/game-character-generator.component.html":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character-generator/game-character-generator.component.html ***!
  \**********************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<button (click)=\"openModal()\">画像を選ぶ</button>\n<div>\n  <img height=\"120\" [src]=\"tableBackgroundImage.url | safe: 'resourceUrl'\">\n</div>\n<input [(ngModel)]=\"name\" placeholder=\"Name\" name=\"name\" />\n<div>\n  <div>\n    <input [(ngModel)]=\"size\" type=\"range\" min=\"{{minSize}}\" max=\"{{maxSize}}\" name=\"size\" /> Size : <input [(ngModel)]=\"size\"\n      type=\"number\" min=\"{{minSize}}\" max=\"{{maxSize}}\">\n  </div>\n  <button (click)=\"createGameCharacter()\">キャラクターを作る</button>\n  <button (click)=\"createGameTableMask()\">マップマスクを作る</button>\n  <!--\n  <div>\n    <button (click)=\"createGameCharacterForXML(xml)\">↓のXMLからキャラクターを作る</button>\n    <textarea style=\"width:100%; height:5em; resize: none;\" [(ngModel)]=\"xml\" placeholder=\"XML\"></textarea>\n  </div>\n  -->\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character-sheet/game-character-sheet.component.html":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character-sheet/game-character-sheet.component.html ***!
  \**************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<button (click)=\"toggleEditMode()\">編集切り替え</button>\n<ng-container [ngSwitch]=\"tabletopObject.aliasName\">\n  <ng-container *ngSwitchCase=\"'numberResource'\">\n  </ng-container>\n  <ng-container *ngSwitchCase=\"'card'\">\n    <button (click)=\"openModal('front')\">表面の画像を変更</button>\n    <button (click)=\"openModal('back')\">裏面の画像を変更</button>\n  </ng-container>\n  <ng-container *ngSwitchCase=\"'card-stack'\">\n  </ng-container>\n  <ng-container *ngSwitchCase=\"'terrain'\">\n    <button (click)=\"openModal('floor')\">床の画像を変更</button>\n    <button (click)=\"openModal('wall')\">壁の画像を変更</button>\n  </ng-container>\n  <ng-container *ngSwitchCase=\"'dice-symbol'\">\n    <button (click)=\"openModal(tabletopObject['face'])\" [disabled]=\"!tabletopObject['isVisible']\">ダイス目の画像を変更</button>\n  </ng-container>\n  <ng-container *ngSwitchDefault>\n    <button (click)=\"openModal('imageIdentifier', true)\">画像変更</button>\n  </ng-container>\n</ng-container>\n<button (click)=\"clone()\">コピーを作る</button>\n<button (click)=\"saveToXML()\">保存</button>\n<ng-container *ngIf=\"tabletopObject.aliasName === 'character'\">\n  <select *ngIf=\"tabletopObject\" (change)=\"setLocation($event.target.value)\" [ngModel]=\"tabletopObject.location.name\">\n    <option value=\"table\">テーブル</option>\n    <option value=\"common\">共有インベントリ</option>\n    <option value=\"{{networkService.peerId}}\">個人インベントリ</option>\n    <option value=\"graveyard\">墓地</option>\n  </select>\n</ng-container>\n<div *ngIf=\"tabletopObject\" class=\"flex-container\">\n  <div *ngIf=\"0 < tabletopObject.imageFile?.url.length\" class=\"box main-image-box\">\n    <img class=\"main-image\" [src]=\"tabletopObject.imageFile.url | safe: 'resourceUrl'\" [alt]=\"tabletopObject.imageFile.name\"\n    />\n  </div>\n  <ng-container *ngIf=\"tabletopObject.commonDataElement\">\n    <div class=\"flex-item\">\n      <div class=\"table\">\n        <div class=\"table-row\" game-data-element [gameDataElement]=\"tabletopObject.commonDataElement\" [isTagLocked]=\"true\"></div>\n      </div>\n    </div>\n  </ng-container>\n\n  <ng-container *ngIf=\"tabletopObject.detailDataElement\">\n    <div class=\"flex-item\" *ngFor=\"let childElement of tabletopObject.detailDataElement.children\">\n      <div class=\"table\">\n        <div class=\"table-row\" game-data-element [gameDataElement]=\"childElement\" [isEdit]=\"isEdit\"></div>\n      </div>\n    </div>\n  </ng-container>\n\n  <ng-container *ngIf=\"isEdit\">\n    <div class=\"flex-item\">\n      <button style=\"width:100%; color: #555;\" (click)=\"addDataElement()\">新しい項目を追加</button>\n    </div>\n  </ng-container>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character/game-character.component.html":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character/game-character.component.html ***!
  \**************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component is-3d is-grab is-pointer-events-none\" [style.width.px]=\"size * gridSize\"\n  [style.height.px]=\"size * gridSize\" appMovable [movable.option]=\"movableOption\" (movable.ondragstart)=\"onMove()\"\n  (movable.ondragend)=\"onMoved()\">\n  <div class=\"component-content is-3d\" [@bounceInOut]=\"'in'\">\n    <div class=\"component-content is-3d is-pointer-events-auto\" appRotable [rotable.option]=\"rotableOption\"\n      (rotable.ondragstart)=\"onMove()\" (rotable.ondragend)=\"onMoved()\">\n      <div class=\"pedestal-inner\"></div>\n      <div class=\"pedestal-outer\"></div>\n      <div class=\"pedestal-grab rotate-grab\">\n        <div class=\"pedestal-grab-border\">\n          <div class=\"material-icons of-front\">autorenew</div>\n          <div class=\"material-icons of-back\">autorenew</div>\n        </div>\n      </div>\n      <div class=\"upright-transform is-fit-width is-3d\">\n        <div class=\"rotate-frame is-3d\" [style.width.px]=\"size * gridSize\" [style.height.px]=\"size * gridSize\"\n          appRotable [(rotable.value)]=\"roll\" (rotable.ondragstart)=\"onMove()\" (rotable.ondragend)=\"onMoved()\">\n          <div class=\"rotate-inner is-3d\">\n            <div *ngIf=\"0 < name.length\" class=\"name-tag is-nowrap is-black-background is-3d\"\n              [ngStyle]=\"{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}\">\n              <div class=\"fornt-tag has-length-limit is-3d\">{{name}}</div>\n              <div class=\"back-tag has-length-limit is-3d\">{{name}}</div>\n            </div>\n            <img class=\"image\" *ngIf=\"0 < imageFile.url.length\" [src]=\"imageFile.url | safe: 'resourceUrl'\">\n            <div class=\"grab-group\">\n              <div class=\"rotate-grab rotate-grab-icon of-top\"\n                [ngStyle]=\"{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}\">\n                <i class=\"material-icons\">autorenew</i>\n              </div>\n              <div class=\"rotate-grab rotate-grab-icon of-bottom\"\n                [ngStyle]=\"{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px'}\">\n                <i class=\"material-icons\">autorenew</i>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-data-element/game-data-element.component.html":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-data-element/game-data-element.component.html ***!
  \********************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<ng-container *ngIf=\"gameDataElement\">\n  <ng-container *ngIf=\"gameDataElement.children.length < 1\">\n    <div *ngIf=\"isEdit\" class=\"table-cell table-cell_solid\">\n      <ng-container *ngTemplateOutlet=\"editButtons\"></ng-container>\n      <select (change)=\"setElementType($event.target.value)\" [ngModel]=\"gameDataElement.type\">\n        <option value=\"\">通常</option>\n        <option value=\"numberResource\">リソース</option>\n        <option value=\"note\">ノート</option>\n      </select>\n    </div>\n    <div class=\"table-cell table-cell_solid\">\n      <ng-container *ngIf=\"isTagLocked\">\n        <div style=\"font-family: Cambria, Georgia; font-size: 0.9rem;\">{{name}}</div>\n      </ng-container>\n      <ng-container *ngIf=\"!isTagLocked\">\n        <div class=\"hidden-spacer\" style=\"font-family: Cambria, Georgia; font-size: 0.9rem;\">{{name}}</div>\n        <input style=\"width:100%; min-width:10px; font-family: Cambria, Georgia; font-size: 0.9rem;\" size=\"1\"\n          [(ngModel)]=\"name\" placeholder=\"Value\" />\n      </ng-container>\n    </div>\n    <div class=\"table-cell\">\n      <ng-container [ngSwitch]=\"gameDataElement.type\">\n        <ng-container *ngSwitchCase=\"'numberResource'\">\n          <input [style]=\"'font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: ' + value + '; --val:' + currentValue +';' | safe: 'style'\"\n            [(ngModel)]=\"currentValue\" type=\"range\" min=\"0\" max=\"{{value}}\" />\n          <br>\n          <input style=\"width: 5em; text-align: right;\" size=\"1\" type=\"number\" [(ngModel)]=\"currentValue\" placeholder=\"Value\" />\n          /\n          <input style=\"width: 5em;\" size=\"1\" type=\"number\" [(ngModel)]=\"value\" placeholder=\"Value\" />\n        </ng-container>\n        <ng-container *ngSwitchCase=\"'note'\">\n          <textarea style=\"width:100%; height:5em; min-width:50px; resize: none; font-size: 0.8em;\" [(ngModel)]=\"value\" placeholder=\"Note\"></textarea>\n        </ng-container>\n        <ng-container *ngSwitchDefault>\n          <!-- size属性がないと小さくならない -->\n          <div class=\"hidden-spacer\" style=\"font-size: 1.0em; font-family: Cambria, Georgia;\">{{value}}</div>\n          <input style=\"width:100%; min-width:10px;\" size=\"1\" [(ngModel)]=\"value\" placeholder=\"Value\" />\n        </ng-container>\n      </ng-container>\n    </div>\n  </ng-container>\n  <ng-container *ngIf=\"0 < gameDataElement.children.length\">\n    <div *ngIf=\"isEdit\" class=\"table-cell table-cell_solid\" style=\"vertical-align: top;\">\n      <ng-container *ngTemplateOutlet=\"editButtons\"></ng-container>\n    </div>\n    <div class=\"table-cell table-cell_inner-table\" style=\"padding:0; width:0;\"></div>\n    <div class=\"table-cell_inner-table\">\n      <div class=\"table-cell_inner-table-title\">\n        <ng-container *ngIf=\"isTagLocked\">\n          <div style=\"padding: 2px; font-family: Cambria, Georgia; font-size: 1.0rem; font-weight: bold;\">{{name}}</div>\n        </ng-container>\n        <ng-container *ngIf=\"!isTagLocked\">\n          <input style=\"width:100%; min-width:10px; font-family: Cambria, Georgia; font-size: 1.0rem; font-weight: bold;\"\n            size=\"1\" [(ngModel)]=\"name\" placeholder=\"Value\" />\n        </ng-container>\n      </div>\n      <div class=\"table\" *ngIf=\"0 < gameDataElement.children.length\">\n        <div game-data-element class=\"table-row\" *ngFor=\"let childElement of gameDataElement.children\"\n          [gameDataElement]=\"childElement\" [isEdit]=\"isEdit\" [isTagLocked]=\"isTagLocked\"></div>\n      </div>\n    </div>\n  </ng-container>\n</ng-container>\n<ng-template #editButtons>\n  <button (click)=\"addElement()\"><i class=\"material-icons\">add_circle</i></button>\n  <button (click)=\"upElement()\"><i class=\"material-icons\">arrow_upward</i></button>\n  <br>\n  <button (click)=\"deleteElement()\"><i class=\"material-icons\">remove_circle_outline</i></button>\n  <button (click)=\"downElement()\"><i class=\"material-icons\">arrow_downward</i></button>\n</ng-template>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-object-inventory/game-object-inventory.component.html":
/*!****************************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-object-inventory/game-object-inventory.component.html ***!
  \****************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component\">\n  <ng-container *ngTemplateOutlet=\"inventoryTab\"></ng-container>\n  <ng-container *ngTemplateOutlet=\"inventoryViewSetting\"></ng-container>\n  <div *ngIf=\"getGameObjects(selectTab).length < 1\">{{getTabTitle(selectTab)}}インベントリは空です</div>\n  <div (contextmenu)=\"onContextMenu($event, gameObject)\" *ngFor=\"let gameObject of getGameObjects(selectTab); trackBy: trackByGameObject\"\n    (click)=\"selectGameObject(gameObject)\" [ngClass]=\"{'box': true, 'selected': (selectedIdentifier === gameObject.identifier)}\">\n    <ng-container *ngTemplateOutlet=\"gameObjectTags; context:{ gameObject: gameObject}\"></ng-container>\n  </div>\n  <div *ngIf=\"selectTab === 'graveyard'\" style=\"padding-top: 6px;\">\n    <button class=\"danger\" (click)=\"cleanInventory()\" [attr.disabled]=\"getGameObjects(selectTab).length < 1 ? '' : null\">墓場を空にする</button>\n  </div>\n</div>\n<ng-template #inventoryTab>\n  <form class=\"is-sticky-top\">\n    <div class=\"tab\">\n      <label *ngFor=\"let inventoryType of inventoryTypes\">\n        <input name=\"tab\" type=\"radio\" value=\"{{inventoryType}}\" ng-control=\"options\" [(ngModel)]=\"selectTab\">\n        <div>{{getTabTitle(inventoryType)}} ({{getInventory(inventoryType).length}})</div>\n      </label>\n    </div>\n  </form>\n</ng-template>\n<ng-template #inventoryViewSetting>\n  <ng-container *ngIf=\"isEdit\">\n    <div>\n      <div style=\"font-size: 12px;\">並び順</div>\n      <input [(ngModel)]=\"sortTag\" placeholder=\"タグ名\" />\n      <select [(ngModel)]=\"sortOrder\">\n        <option value=\"ASC\">昇順</option>\n        <option value=\"DESC\">降順</option>\n      </select>\n    </div>\n    <div style=\"font-size: 12px; padding-top: 6px;\">表示項目</div>\n    <input style=\"width: 100%; box-sizing: border-box;\" [(ngModel)]=\"dataTag\" placeholder=\"スペース区切りでタグ名 スラッシュで改行 ex.「HP MP / メモ」\" />\n    <div style=\"padding-top: 6px;\">\n      <button class=\"tab-setting small-font\" (click)=\"toggleEdit()\"><i class=\"material-icons small-font\">settings</i>完了</button>\n    </div>\n  </ng-container>\n  <ng-container *ngIf=\"!isEdit\">\n    <table style=\"font-size: 0.8em;\">\n      <tr>\n        <th style=\" vertical-align:middle;\">並び順:</th>\n        <td style=\" vertical-align:middle;\">\n          <ng-container *ngIf=\"0 < sortTag.length\">{{sortTag}} ({{sortOrderName}})</ng-container>\n          <ng-container *ngIf=\"sortTag.length < 1\">-</ng-container>\n        </td>\n        <td><button class=\"tab-setting small-font\" (click)=\"toggleEdit()\"><i class=\"material-icons small-font\">settings</i>設定</button></td>\n      </tr>\n    </table>\n  </ng-container>\n</ng-template>\n<ng-template #gameObjectTags let-gameObject=\"gameObject\">\n  <div class=\"inventory-object\">\n    <div class=\"object-name\">{{gameObject.name}}\n      <button style=\"font-size: 0.8em; padding: 2px 5px;\" *ngIf=\"selectedIdentifier === gameObject.identifier\" (click)=\"onContextMenu($event, gameObject)\">\n        <i class=\"material-icons\" style=\"font-size: 1em;\">settings</i>\n      </button>\n    </div>\n    <div class=\"object-tags-box\">\n      <div class=\"table-cell image-box\">\n        <img *ngIf=\"gameObject.imageFile.url\" [src]=\"gameObject.imageFile.url | safe: 'resourceUrl'\" />\n      </div>\n      <div class=\"table-cell\">\n        <div *ngIf=\"gameObject.rootDataElement\">\n          <ng-container *ngFor=\"let dataElm of getInventoryTags(gameObject); trackBy: trackByGameObject\">\n            <ng-container *ngTemplateOutlet=\"dataElmTag; context:{ dataElm: dataElm}\"></ng-container>\n          </ng-container>\n        </div>\n      </div>\n    </div>\n  </div>\n</ng-template>\n<ng-template #dataElmTag let-dataElm=\"dataElm\">\n  <ng-container *ngIf=\"dataElm?.name === newLineString\"><br></ng-container>\n  <div *ngIf=\"dataElm && dataElm.name !== newLineString\" class=\"object-tag\">\n    <ng-container [ngSwitch]=\"dataElm.attributes['type']\">\n      <ng-container *ngSwitchCase=\"'numberResource'\">\n        <div class=\"resource-tag\">\n          <div style=\"font-size: 0.8em; display: inline-block; margin-right: 0.5em;\">{{dataElm.name}}</div>\n          <input class=\"input resource-value\" type=\"number\" size=\"1\" [(ngModel)]=\"dataElm.currentValue\" placeholder=\"Value\" />\n        </div>\n        <div class=\"resource-tag\">\n          <input type=\"range\" [style]=\"'font-size: 0.8em; min-width: 1em; width:' + (dataElm.name.length + 4.5) + 'em; --min: 0; --max: ' + dataElm.value + '; --val:' + dataElm.currentValue +';' | safe: 'style'\"\n            min=\"0\" max=\"{{dataElm.value}}\" [ngStyle]=\"{'background-color':'green'}\" [(ngModel)]=\"dataElm.currentValue\" />\n        </div>\n      </ng-container>\n      <ng-container *ngSwitchDefault>\n        <div class=\"tag-name\">{{dataElm.name}}</div>\n        <div style=\"text-align: center;\">\n          <div style=\"display: inline-block;\">\n            <div class=\"tag-value-box\">\n              <div class=\"hidden-spacer\" style=\"font-weight: bold;\">{{dataElm.value}}</div>\n              <input class=\"input tag-value\" size=\"1\" [(ngModel)]=\"dataElm.value\" placeholder=\"\" />\n            </div>\n          </div>\n        </div>\n      </ng-container>\n    </ng-container>\n  </div>\n</ng-template>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table-mask/game-table-mask.component.html":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table-mask/game-table-mask.component.html ***!
  \****************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component\" [ngClass]=\"{'is-grab': !isLock}\"\n  [style.width.px]=\"width * gridSize\" [style.height.px]=\"height * gridSize\"\n  appMovable [movable.option]=\"movableOption\" [movable.disable]=\"isLock\" (movable.ondragstart)=\"onMove()\" (movable.ondragend)=\"onMoved()\">\n  <div *ngIf=\"imageFile.url.length < 1; then blackMask; else imageMask\"></div>\n  <ng-template #blackMask>\n    <div class=\"border is-fit-full\" [style.background-color]=\"'rgba(10, 10, 10,' + opacity +')'\"></div>\n  </ng-template>\n  <ng-template #imageMask>\n    <div class=\"border is-fit-full\">\n      <img class=\"image is-fit-full\" [style.opacity]=\"opacity\" [src]=\"imageFile.url | safe: 'resourceUrl'\">\n    </div>\n  </ng-template>\n  <div *ngIf=\"isLock\" class=\"lock-icon is-center\">\n    <i class=\"material-icons\">lock</i>\n  </div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table-setting/game-table-setting.component.html":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table-setting/game-table-setting.component.html ***!
  \**********************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"flex-container\">\n  <div class=\"flex-item no-grow\">\n    <div>\n      <button (click)=\"createGameTable()\">新しいテーブルを作る</button>\n    </div>\n    <select style=\"width: 10em;\" size=\"10\" (change)=\"selectGameTable($event.target.value)\" [ngModel]=\"selectedTable?.identifier\">\n      <option *ngFor=\"let gameTable of getGameTables()\" value=\"{{gameTable.identifier}}\">{{gameTable.name}}</option>\n    </select>\n  </div>\n  <div class=\"flex-item\">\n    <ng-container *ngIf=\"!isEmpty || selectedTable\">\n      <div class=\"images-select\">\n        <div>\n          画像\n          <div (click)=\"openBgImageModal()\">\n            <img height=\"120\" [src]=\"tableBackgroundImage.url | safe: 'resourceUrl'\">\n          </div>\n        </div>\n        <div>\n          背景\n          <div *ngIf=\"!tableDistanceviewImage.url\">\n            <button (click)=\"openDistanceViewImageModal()\" style=\"height: 120px;\">背景画像を追加</button>\n          </div>\n          <div *ngIf=\"tableDistanceviewImage.url\" (click)=\"openDistanceViewImageModal()\">\n            <img height=\"120\" [src]=\"tableDistanceviewImage.url | safe: 'resourceUrl'\">\n          </div>\n        </div>\n      </div>\n      <div>Name :\n        <input [(ngModel)]=\"tableName\" placeholder=\"Name\" [attr.disabled]=\"!isEditable ? '' : null\" />\n      </div>\n      <div>\n        <input [(ngModel)]=\"tableWidth\" type=\"range\" min=\"{{minSize}}\" max=\"{{maxSize}}\" name=\"tableWidth\" [attr.disabled]=\"!isEditable ? '' : null\"\n        /> Width :\n        <input [(ngModel)]=\"tableWidth\" type=\"number\" min=\"{{minSize}}\" max=\"{{maxSize}}\" style=\"width: 5em;\" [attr.disabled]=\"!isEditable ? '' : null\">\n      </div>\n      <div>\n        <input [(ngModel)]=\"tableHeight\" type=\"range\" min=\"{{minSize}}\" max=\"{{maxSize}}\" name=\"tableHeight\" [attr.disabled]=\"!isEditable ? '' : null\"\n        /> Height :\n        <input [(ngModel)]=\"tableHeight\" type=\"number\" min=\"{{minSize}}\" max=\"{{maxSize}}\" style=\"width: 5em;\" [attr.disabled]=\"!isEditable ? '' : null\">\n      </div>\n      <div>\n        グリッド:\n        <select [(ngModel)]=\"tableGridType\" name=\"tableGridType\" [attr.disabled]=\"!isEditable ? '' : null\">\n          <option value=\"0\">スクエア</option>\n          <option value=\"1\">ヘクス（縦揃え）</option>\n          <option value=\"2\">ヘクス（横揃え）</option>\n        </select>\n        色:\n        <select [(ngModel)]=\"tableGridColor\" name=\"tableGridColor\" [attr.disabled]=\"!isEditable ? '' : null\">\n          <option value=\"#000000e6\">黒</option>\n          <option value=\"#dddddde6\">白</option>\n        </select>\n      </div>\n      <div>\n        背景フィルタ\n        <select [(ngModel)]=\"tableDistanceviewFilter\" name=\"tableDistanceviewFilter\" [attr.disabled]=\"!isEditable ? '' : null\">\n          <option value=\"\">なし</option>\n          <option value=\"white\">ホワイト</option>\n          <option value=\"black\">ブラック</option>\n        </select>\n      </div>\n      <hr/>\n      <div>\n        <label>グリッドを常に表示:\n          <input type=\"checkbox\" [(ngModel)]=\"tableGridShow\" name=\"tableGridShow\" />\n        </label>\n        <label>スナップ:\n          <input type=\"checkbox\" [(ngModel)]=\"tableGridSnap\" name=\"tableGridSnap\" />\n        </label>\n        <ng-container *ngIf=\"!isDeleted\">\n          <button (click)=\"save()\">保存</button>\n          <button class=\"danger\" (click)=\"delete()\" [attr.disabled]=\"getGameTables().length <= 1 ? '' : null\">削除</button>\n        </ng-container>\n        <ng-container *ngIf=\"isDeleted\">\n          <button (click)=\"restore()\">元に戻す</button>\n        </ng-container>\n      </div>\n    </ng-container>\n  </div>\n</div>\n<ng-container *ngIf=\"isEmpty\">\n  <div style=\"font-size: 12px;\">※テーブルが１つも作成されていません。「新しいテーブルを作る」から新しいテーブルを作成することができます。</div>\n</ng-container>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table/game-table.component.html":
/*!******************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table/game-table.component.html ***!
  \******************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"background-image is-pointer-events-none\" [ngClass]=\"[(backgroundFilterType ? 'is-filter' : ''), backgroundFilterType]\" \n[style.background-image]=\"'url(' + backgroundImage.url + ')' | safe: 'style'\"></div>\n<div class=\"component is-fill is-perspective\" [ngClass]=\"{'is-grabbing': isPointerDragging}\" #root>\n  <div class=\"component-content is-fill is-3d\" #gameTable>\n    <div id=\"app-game-table\" class=\"game-table table-image is-3d\" [style.background-image]=\"'url(' + tableImage.url + ')' | safe: 'style'\" #gameObjects>\n      <canvas class=\"grid-canvas is-fill is-pointer-events-none\" #gridCanvas></canvas>\n      <terrain class=\"is-3d\" *ngFor=\"let terrain of terrains; trackBy: trackByGameObject\" [terrain]=\"terrain\"></terrain>\n      <game-table-mask class=\"is-3d\" *ngFor=\"let mask of tableMasks; trackBy: trackByGameObject\" [gameTableMask]=\"mask\"></game-table-mask>\n      <text-note class=\"is-3d\" *ngFor=\"let textNote of textNotes; trackBy: trackByGameObject\" [textNote]=\"textNote\" [appTooltip]=\"textNote\" [ngStyle]=\"{'z-index' : textNote.zindex}\"></text-note>\n      <card-stack class=\"is-3d\" *ngFor=\"let cardStack of cardStacks; trackBy: trackByGameObject\" [cardStack]=\"cardStack\" [appTooltip]=\"cardStack\" [ngStyle]=\"{'z-index' : cardStack.zindex, 'transform': 'translateZ(' + (cardStack.zindex * 0.001) +'px)'}\"></card-stack>\n      <card class=\"is-3d\" *ngFor=\"let card of cards; trackBy: trackByGameObject\" [card]=\"card\" [appTooltip]=\"card\" [ngStyle]=\"{'z-index' : card.zindex, 'transform': 'translateZ(' + (card.zindex * 0.001) +'px)'}\"></card>\n      <dice-symbol class=\"is-3d\" *ngFor=\"let diceSymbol of diceSymbols; trackBy: trackByGameObject\" [diceSymbol]=\"diceSymbol\" [appTooltip]=\"diceSymbol\"></dice-symbol>\n      <game-character class=\"is-3d\" *ngFor=\"let character of characters; trackBy: trackByGameObject\" [gameCharacter]=\"character\" [appTooltip]=\"character\"></game-character>\n      <peer-cursor class=\"is-3d\" *ngFor=\"let cursor of peerCursors; trackBy: trackByGameObject\" [cursor]=\"cursor\"></peer-cursor>\n    </div>\n  </div>\n</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/jukebox/jukebox.component.html":
/*!************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/jukebox/jukebox.component.html ***!
  \************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div>試聴音量：<input [(ngModel)]=\"auditionVolume\" type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" /></div>\n<div>BGM音量：<input [(ngModel)]=\"volume\" type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" /></div>\n<hr/>\n<div>\n  <div *ngFor=\"let audio of audios\" class=\"box\">\n    <button *ngIf=\"audio !== auditionPlayer?.audio || auditionPlayer?.paused\" (click)=\"play(audio)\" [disabled]=\"!audio.isReady\" >試聴/再生</button>\n    <button *ngIf=\"audio === auditionPlayer?.audio && !auditionPlayer?.paused\" (click)=\"stop()\" [disabled]=\"!audio.isReady\" >試聴/停止</button>\n    <button *ngIf=\"audio !== jukebox?.audio\" (click)=\"playBGM(audio)\" [disabled]=\"!audio.isReady\" >BGM/再生</button>\n    <button *ngIf=\"audio === jukebox?.audio\" (click)=\"stopBGM(audio)\" [disabled]=\"!audio.isReady\" >BGM/停止</button>\n    <span *ngIf=\"audio === auditionPlayer?.audio && !auditionPlayer?.paused\">【試聴中】</span>\n    <span *ngIf=\"audio === jukebox?.audio\">【BGM】</span>\n    <span>{{audio.name}}</span>\n  </div>\n  <div *ngIf=\"audios.length < 1\" >アップロードされた音楽ファイルはここに表示されます。</div>\n</div>\n\n<label>\n  <div class=\"drop-zone\">\n    <div>\n      <i class=\"material-icons large-font\">playlist_add</i>\n    </div>\n    <div>ここに音楽をドロップ</div>\n    <div class=\"small-font\">またはここをクリックして選択</div>\n    <input type=\"file\" style=\"display: none;\" (change)=\"handleFileSelect($event)\" multiple accept=\"audio/*\"/>\n    <div class=\"small-font\">\n      <br>１ファイルにつき10MBまで</div>\n  </div>\n</label>\n<div style=\"font-size: 12px;\">※「試聴」は自分のスピーカーだけで音楽を1回再生します。</div>\n<div style=\"font-size: 12px;\">※「BGM」はルーム内の全員で1つの音楽をループ再生します。</div>\n<div style=\"font-size: 12px;\">※現行バージョンのセーブデータ（zip）には音楽ファイルは含まれません。（毎回アップロードが必要です）</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/lobby/lobby.component.html":
/*!********************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/lobby/lobby.component.html ***!
  \********************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div *ngIf=\"!isConnected;else other_content\">\n  <button (click)=\"reload()\" [disabled]=\"isReloading\">一覧を更新</button>\n  <button (click)=\"showRoomSetting()\">新しいルームを作成する</button>\n  <hr/>\n  <ng-container *ngIf=\"rooms.length\">\n    <table style=\"font-size:12px; border: 0; border-spacing: 0; width: 100%;\">\n      <tr>\n        <th style=\"padding: 0 1em;\">ルームID</th>\n        <th style=\"padding: 0 1em; min-width: 50%;\">ルーム名</th>\n        <th style=\"padding: 0 1em;\">パスワード</th>\n        <th style=\"padding: 0 1em;\">参加者</th>\n        <th style=\"padding: 0 1em;\"></th>\n      </tr>\n      <ng-container *ngFor=\"let room of rooms\">\n        <!--\n    <div *ngIf=\"!room.isPrivate\" class=\"box\">\n      <div style=\"display: inline-block;\">\n        <i *ngIf=\"0 < room.peers[0].password.length\" class=\"material-icons\" style=\"vertical-align: middle; size:0.6rem;\">lock</i>\n        <span>{{room.roomName}}</span>/<span>{{room.room}}</span>/<span>({{room.peers.length}})</span>\n        <button [disabled]=\"room.room === currentRoom\" *ngIf=\"0 < room.room.length\" type=\"submit\" (click)=\"connect(room.peers[0].fullstring)\">接続する</button>\n      </div>\n    </div>\n    -->\n        <tr>\n          <td style=\"font-size:0.5rem; text-align: center; padding: 0 1em;\">{{room.peers[0]?.room}}</td>\n          <td style=\"text-align: center; padding: 0 1em;\">{{room.roomName}}</td>\n          <td *ngIf=\"0 < room.peers[0].password.length\" style=\"text-align: center; padding: 0 1em;\"><i class=\"material-icons\" style=\"vertical-align: middle; font-size:0.9rem;\">lock</i></td>\n          <td *ngIf=\"room.peers[0].password.length < 1\" style=\"text-align: center; padding: 0 1em;\">-</td>\n          <td style=\"text-align: center; padding: 0 1em;\">{{room.peers.length}}人</td>\n          <td><button [disabled]=\"room.peers[0]?.room === currentRoom\" *ngIf=\"0 < room.alias.length\" type=\"submit\" (click)=\"connect(room.peers)\">接続</button></td>\n        </tr>\n      </ng-container>\n    </table>\n  </ng-container>\n  <span *ngIf=\"rooms.length < 1\" style=\"font-size: 12px;\">{{help}}</span>\n</div>\n<ng-template #other_content><span style=\"font-size: 12px;\">別のルームに接続したい場合は、他の参加者との接続を切ってください。<br>（※ページリロードで切断できます。）</span></ng-template>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/modal/modal.component.html":
/*!********************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/modal/modal.component.html ***!
  \********************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component\">\n  <div [@bgInOut]=\"'in'\" class=\"modal-background\" (click)=\"clickBackground($event)\"></div>\n  <div [@flyInOut]=\"'in'\" class=\"modal-panel\">\n    <div class=\"title\">\n      <div class=\"title-button\">\n        <button (click)=\"resolve()\"><i class=\"material-icons\" style=\"font-size: 14px;\">close</i></button>\n      </div>\n      {{modalService.title}}\n    </div>\n    <div class=\"scrollable-panel\">\n      <ng-content></ng-content>\n      <div #content></div>\n    </div>\n    <!--<div class=\"footer\"><button (click)=\"resolve()\">OK</button><button (click)=\"resolve()\">CANCEL</button></div>-->\n  </div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/network-indicator/network-indicator.component.html":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/network-indicator/network-indicator.component.html ***!
  \********************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"sk-cube-grid\">\n  <div class=\"sk-cube sk-cube1\"></div>\n  <div class=\"sk-cube sk-cube2\"></div>\n  <div class=\"sk-cube sk-cube3\"></div>\n  <div class=\"sk-cube sk-cube4\"></div>\n  <div class=\"sk-cube sk-cube5\"></div>\n  <div class=\"sk-cube sk-cube6\"></div>\n  <div class=\"sk-cube sk-cube7\"></div>\n  <div class=\"sk-cube sk-cube8\"></div>\n  <div class=\"sk-cube sk-cube9\"></div>\n  <div class=\"sk-title\">sync</div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/overview-panel/overview-panel.component.html":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/overview-panel/overview-panel.component.html ***!
  \**************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component is-pointer-events-none\" [@fadeInOut]=\"'in'\" appDraggable #draggablePanel>\n  <ng-container [ngSwitch]=\"tabletopObject.aliasName\">\n    <ng-container *ngSwitchCase=\"'numberResource'\">\n    </ng-container>\n    <ng-container *ngSwitchCase=\"'card'\">\n      <ng-container *ngTemplateOutlet=\"overviewCard; context: { card: tabletopObject }\"></ng-container>\n    </ng-container>\n    <ng-container *ngSwitchCase=\"'card-stack'\">\n      <ng-container *ngTemplateOutlet=\"overviewCard; context: { card: tabletopObject }\"></ng-container>\n    </ng-container>\n    <ng-container *ngSwitchCase=\"'text-note'\">\n      <ng-container *ngTemplateOutlet=\"overviewNote; context: { note: tabletopObject }\"></ng-container>\n    </ng-container>\n    <ng-container *ngSwitchCase=\"'character'\">\n      <ng-container *ngTemplateOutlet=\"overviewCharacter; context: { character: tabletopObject }\"></ng-container>\n    </ng-container>\n    <ng-container *ngSwitchCase=\"'dice-symbol'\">\n      <ng-container *ngTemplateOutlet=\"overviewDiceSymbol; context: { dice: tabletopObject }\"></ng-container>\n    </ng-container>\n    <ng-container *ngSwitchDefault>\n      <ng-container *ngTemplateOutlet=\"overviewCharacter; context: { character: tabletopObject }\"></ng-container>\n    </ng-container>\n  </ng-container>\n</div>\n\n<ng-container *ngIf=\"isOpenImageView\">\n  <ng-container *ngTemplateOutlet=\"imageView\"></ng-container>\n</ng-container>\n\n<ng-template #overviewCard let-card=\"card\">\n  <div class=\"component-content is-small-size\"\n    [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\">\n    <div *ngIf=\"hasImage\" style=\"position: relative;\">\n      <img class=\"card-image\" [src]=\"imageUrl | safe: 'resourceUrl'\" />\n      <button class=\"zoom-button\" (click)=\"chanageImageView(true)\">\n        <i class=\"material-icons\">zoom_in</i>\n      </button>\n      <div *ngIf=\"card.hasOwner\" class=\"component-owner position-right-bottom\"\n        [ngClass]=\"{'with-button-marign': hasImage}\">\n        <div class=\"owner-tag\">{{card.ownerName}}</div>\n      </div>\n    </div>\n    <div *ngIf=\"0 < card?.name?.length\" class=\"component-title title-background\"\n      [ngClass]=\"{'with-button-marign': hasImage}\">\n      <ng-container *ngIf=\"card.isVisible == null || card.isVisible\">{{card.name}}</ng-container>\n      <ng-container *ngIf=\"card.isVisible != null && !card.isVisible\">カード</ng-container>\n    </div>\n    <div class=\"component-background\">\n      <div class=\"grid-container-root\" *ngIf=\"hasDataElms && card.isVisible\">\n        <div class=\"grid-container\">\n          <ng-container *ngFor=\"let dataElm of dataElms\">\n            <ng-container *ngTemplateOutlet=\"dataElement; context: { dataElm: dataElm }\"></ng-container>\n          </ng-container>\n        </div>\n      </div>\n    </div>\n  </div>\n</ng-template>\n\n<ng-template #overviewNote let-note=\"note\">\n  <div class=\"component-content is-large-size\"\n    [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\">\n    <div class=\"component-title title-background\">{{note.title}}</div>\n    <div class=\"component-background text-note-container\">\n      <div style=\"position: relative;\">\n        <div class=\"is-fill\">\n          <textarea class=\"textarea\" [(ngModel)]=\"note.text\" spellcheck=\"false\"></textarea>\n        </div>\n        <div class=\"textarea-spacer\">{{note.text}}</div>\n      </div>\n    </div>\n  </div>\n</ng-template>\n\n<ng-template #overviewCharacter let-character=\"character\">\n  <div class=\"component-content character-grid-container is-middle-size\">\n    <div class=\"title-bg-area title-background\"\n      [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\">\n    </div>\n    <div class=\"image-area character-image-box\"\n      [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\"\n      *ngIf=\"hasImage\">\n      <img class=\"character-image\" [src]=\"imageUrl | safe: 'resourceUrl'\" />\n    </div>\n    <div class=\"title-area component-title\" [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging,\n    'pointer-events-none': this.isPointerDragging }\">{{character.name}}</div>\n    <div class=\"void-area is-pointer-events-none\"></div>\n    <div class=\"dataElm-area component-background\"\n      [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\">\n      <div class=\"grid-container-root\" *ngIf=\"hasDataElms\">\n        <!--<ng-container *ngFor=\"let dataElm of dataElms\">-->\n        <ng-container *ngFor=\"let dataElm of inventoryDataElms\">\n          <ng-container *ngIf=\"dataElm && dataElm.name !== newLineString\">\n            <div class=\"grid-container\">\n              <ng-container *ngTemplateOutlet=\"dataElement; context: { dataElm: dataElm }\"></ng-container>\n            </div>\n          </ng-container>\n        </ng-container>\n      </div>\n    </div>\n  </div>\n</ng-template>\n\n<ng-template #overviewDiceSymbol let-dice=\"dice\">\n  <div class=\"component-content character-grid-container is-middle-size\">\n    <div class=\"title-bg-area title-background\"\n      [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\">\n    </div>\n    <div class=\"title-area component-title\"\n      [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\">\n      {{dice.name}}:\n      <ng-container *ngIf=\"dice.isVisible\">{{dice.face}}</ng-container>\n      <ng-container *ngIf=\"!dice.isVisible\">???</ng-container>\n    </div>\n    <div *ngIf=\"dice.hasOwner\" class=\"owner-name-area component-owner\"\n      [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\">\n      <div class=\"owner-tag\">{{dice.ownerName}}\n      </div>\n    </div>\n    <div class=\"image-area character-image-box\"\n      [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\"\n      *ngIf=\"hasImage\">\n      <img class=\"character-image\" [ngClass]=\"{'is-black-mask': !dice.isVisible, 'is-harf-black-mask': dice.isMine}\"\n        [src]=\"imageUrl | safe: 'resourceUrl'\" />\n    </div>\n    <div class=\"void-area is-pointer-events-none\"></div>\n    <div class=\"dataElm-area component-background\"\n      [ngClass]=\"{ 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }\">\n      <div class=\"grid-container-root\" *ngIf=\"hasDataElms && dice.isVisible\">\n        <div class=\"grid-container\">\n          <ng-container *ngFor=\"let dataElm of dataElms\">\n            <ng-container *ngIf=\"dataElm && dataElm.name !== newLineString\">\n              <ng-container *ngTemplateOutlet=\"dataElement; context: { dataElm: dataElm }\"></ng-container>\n            </ng-container>\n          </ng-container>\n        </div>\n      </div>\n    </div>\n  </div>\n</ng-template>\n\n<ng-template #dataElement let-dataElm=\"dataElm\">\n  <ng-container *ngIf=\"0 < dataElm.children.length; then thenBlock; else elseBlock\"></ng-container>\n  <ng-template #thenBlock>\n    <div class=\"section\" style=\"padding-top: 0.5em;\">\n      <div class=\"section-text\" *ngIf=\"0 < dataElm.name.trim().length\">{{dataElm.name}}</div>\n      <div class=\"grid-container indetnt\">\n        <ng-container *ngFor=\"let childElm of dataElm.children\">\n          <ng-container *ngTemplateOutlet=\"dataElement; context: { dataElm: childElm }\"></ng-container>\n        </ng-container>\n      </div>\n    </div>\n  </ng-template>\n  <ng-template #elseBlock>\n    <ng-container [ngSwitch]=\"dataElm.type\">\n      <ng-container *ngSwitchCase=\"'note'\">\n        <div class=\"section\">\n          <div>{{dataElm.name}}</div>\n          <div class=\"note\" style=\"position: relative;\">\n            <div class=\"is-fill\">\n              <textarea class=\"textarea\" [(ngModel)]=\"dataElm.value\" spellcheck=\"false\"></textarea>\n            </div>\n            <div class=\"textarea-spacer\">{{dataElm.value}}</div>\n          </div>\n        </div>\n      </ng-container>\n      <ng-container *ngSwitchCase=\"'numberResource'\">\n        <div class=\"tag\">{{dataElm.name}}</div>\n        <div class=\"value\">\n          <div style=\"display: inline-block; width: min-content;\">\n            <div class=\"hidden-spacer\" style=\"margin-right: 2em;\">{{dataElm.currentValue}}</div>\n            <input class=\"input\" type=\"number\" size=\"1\" [(ngModel)]=\"dataElm.currentValue\" />\n          </div>\n          <div style=\"display: inline;\"> / {{dataElm.value}}</div>\n        </div>\n        <div class=\"section\" style=\"line-height: 1em;\">\n          <input type=\"range\"\n            [style]=\"'font-size: 0.8em; width: 100%; --min: 0; --max:' + dataElm.value + '; --val:' + dataElm.currentValue +';' | safe: 'style'\"\n            min=\"0\" max=\"{{dataElm.value}}\" [(ngModel)]=\"dataElm.currentValue\" />\n        </div>\n      </ng-container>\n      <ng-container *ngSwitchDefault>\n        <div class=\"tag\">{{dataElm.name}}</div>\n        <div class=\"value\">\n          <div class=\"hidden-spacer\">{{dataElm.value}}</div>\n          <input class=\"input\" size=\"1\" [(ngModel)]=\"dataElm.value\" />\n        </div>\n      </ng-container>\n    </ng-container>\n    <div class=\"section border\"></div>\n  </ng-template>\n</ng-template>\n\n<ng-template #imageView>\n  <div class=\"image-view-background is-fill\" (click)=\"chanageImageView(false)\" [@fadeInOut]=\"'in'\">\n    <div class=\"close-button is-pointer-events-none\"><i class=\"material-icons\">close</i></div>\n    <img class=\"contain-image\" [src]=\"imageUrl | safe: 'resourceUrl'\" />\n  </div>\n</ng-template>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/password-check/password-check.component.html":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/password-check/password-check.component.html ***!
  \**************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<form #passwordForm=\"ngForm\">\n  <div>パスワード: <input [(ngModel)]=\"password\" (input)=\"onInputChange($event.target.value)\" [ngModelOptions]=\"{standalone: true}\" placeholder=\"パスワード\" /></div>\n  <button type=\"submit\" (click)=\"submit()\">入室</button>\n</form>\n<div>\n  <span style=\"font-size: 12px;\">{{help}}</span>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/peer-cursor/peer-cursor.component.html":
/*!********************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/peer-cursor/peer-cursor.component.html ***!
  \********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div *ngIf=\"!isMine\" #cursor class=\"component is-3d is-transition is-pointer-events-none\">\n  <div #opacity class=\"peer-cursor is-3d is-transition\">\n    <div class=\"icon\" [style.background-image]=\"'url(' + iconUrl + ')' | safe: 'style'\">\n      <div class=\"name is-center\">\n        <span style=\"white-space: nowrap;\">{{name}}</span>\n      </div>\n    </div>\n  </div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/peer-menu/peer-menu.component.html":
/*!****************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/peer-menu/peer-menu.component.html ***!
  \****************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div *ngIf=\"myPeer\">\n  <button (click)=\"changeIcon()\">アイコンを変更する</button>\n  <div *ngIf=\"myPeer.image\" class=\"image cover\" [style.background-image]=\"'url(' + myPeer.image.url + ')' | safe: 'style' \"\n    (click)=\"changeIcon()\">\n    <!--<img *ngIf=\"myPeer.image\" [src]=\"myPeer.image.url | safe: 'resourceUrl'\" />-->\n  </div>\n  <span>あなたのニックネーム：  <input [(ngModel)]=\"myPeer.name\"  placeholder=\"ニックネーム\" /></span>\n</div>\n<div>\n  <span>あなたのID：<span *ngIf=\"networkService.isOpen\" style=\"font-weight: bold;\">{{networkService.peerContext.id}}</span>\n  <span *ngIf=\"!networkService.isOpen\" style=\"font-weight: bold;\">???</span>\n  </span>\n</div>\n<!--<div>host ID:{{networkService.hostPeerID}}</div>-->\n<ng-container *ngIf=\"18 < networkService.peerId.length\">\n  <hr/>\n  <div>\n    <span>ルーム名：<span *ngIf=\"networkService.isOpen\" style=\"font-weight: bold;\">{{networkService.peerContext.roomName}}/{{networkService.peerContext.room}}</span></span>\n  </div>\n  <div>\n    <span>パスワード：<span *ngIf=\"networkService.isOpen\" style=\"font-weight: bold;\">{{networkService.peerContext.password}}</span></span>\n  </div>\n</ng-container>\n<hr/>\n<div *ngFor=\"let conn of networkService.peerContexts\">\n  <div>\n    <span *ngIf=\"!conn.isOpen\">[接続中]</span>\n    <span>他の参加者：{{conn.id}} [{{findPeerName(conn.fullstring)}}]</span>\n  </div>\n</div>\n<div>\n  <ng-container *ngIf=\"networkService.peerId.length <= 18\">\n    <input [(ngModel)]=\"targetPeerId\" placeholder=\"接続したい相手のID\" name=\"targetPeerId\" />\n    <button (click)=\"connectPeer()\" [disabled]=\"!networkService.isOpen\">プライベート接続</button><br>\n  </ng-container>\n  <button *ngIf=\"networkService.peerIds.length <= 1\" (click)=\"showLobby()\" [disabled]=\"!networkService.isOpen\">ロビー（ルーム一覧）を表示</button>\n</div>\n<div><span style=\"font-size: 12px;\">{{help}}</span></div>\n<ng-container *ngIf=\"networkService.peerId.length <= 18\">\n  <div style=\"font-size: 12px;\" *ngIf=\"networkService.peerContexts.length < 1\">※プライベート接続を使用する場合は、お互いのIDをユドナリウム外で共有してください。</div>\n  <div style=\"font-size: 12px;\" *ngIf=\"networkService.peerContexts.length < 1\">※一人で動作確認を行いたい場合はブラウザを2つ開くと良いと思います。</div>\n</ng-container>\n<ng-container *ngIf=\"18 < networkService.peerId.length\">\n  <div style=\"font-size: 12px;\">※ルーム機能を利用している時はプライベート接続を利用できません。</div>\n</ng-container>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/room-setting/room-setting.component.html":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/room-setting/room-setting.component.html ***!
  \**********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div *ngIf=\"!isConnected;else other_content\">\n  <div>ルーム名 : <input class=\"input\" (input)=\"calcPeerId($event.target.value, password)\" [(ngModel)]=\"roomName\" required minlength=\"1\" maxlength=\"128\" #roomNameValidation=\"ngModel\"\n      placeholder=\"ルームの名前は必須\" /></div>\n  <div>パスワード: <input class=\"input\" (input)=\"calcPeerId(roomName, $event.target.value)\" [(ngModel)]=\"password\" maxlength=\"12\" #passwordValidation=\"ngModel\" placeholder=\"空ならパスワードなし\"\n    /></div>\n  <hr/>\n  <div *ngIf=\"roomNameValidation.errors && (roomNameValidation.dirty || roomNameValidation.touched)\">\n    <div [hidden]=\"!roomNameValidation.errors.required\">\n      ルームの名前は必須です。\n    </div>\n    <div [hidden]=\"!roomNameValidation.errors.minlength\">\n      ルームの名前は必須です。\n    </div>\n    <div [hidden]=\"!roomNameValidation.errors.maxlength\">\n      ルーム名前の長さは128以内にしてください。\n    </div>\n  </div>\n  <div *ngIf=\"passwordValidation.errors && (passwordValidation.dirty || passwordValidation.touched)\">\n    <div [hidden]=\"!passwordValidation.errors.maxlength\">\n      パスワードの長さは12以内にしてください。\n    </div>\n  </div>\n  <div *ngIf=\"!validateLength\">\n    ルームの名前とパスワードの合計が長すぎるようです。どちらかを少し短くしてみてください。\n  </div>\n  <div>\n    <button [disabled]=\"!roomNameValidation.valid || !passwordValidation.valid || !validateLength\" (click)=\"createRoom()\">新しいルームを作成</button>\n  </div>\n</div>\n<div><span style=\"font-size: 12px;\">※作成したルームは参加者が0人になった時点で解散します。ルームの状態を次回に持ち越したい場合は必ず「保存」してください。</span></div>\n<ng-template #other_content>\n  <span style=\"font-size: 12px;\">他の参加者と接続したままではルーム作成を行えません。<br>別のルームに接続したい場合は、他の参加者との接続を切ってください。<br>（※ページリロードで切断できます。）</span>\n</ng-template>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/terrain/terrain.component.html":
/*!************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/terrain/terrain.component.html ***!
  \************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component is-3d is-pointer-events-none\"\n  [style.width.px]=\"width * gridSize\" [style.height.px]=\"depth * gridSize\"\n  appMovable [movable.option]=\"movableOption\" [movable.disable]=\"isLocked\" (movable.ondragstart)=\"onMove()\" (movable.ondragend)=\"onMoved()\">\n  <div class=\"component-content is-3d is-pointer-events-auto\" [ngClass]=\"{'is-grab': !isLocked}\"\n    appRotable [rotable.option]=\"rotableOption\" (rotable.ondragstart)=\"onMove()\" (rotable.ondragend)=\"onMoved()\" [rotable.disable]=\"isLocked\">\n    <ng-container *ngIf=\"hasFloor && 0 < floorImage?.url.length\">\n      <div class=\"texture\" [ngClass]=\"{'blinking-animation': !isLocked}\" [ngStyle]=\"{'transform': 'translateZ(' + height * gridSize +'px)'}\"\n        [style.background-image]=\"'url(' + floorImage.url + ')' | safe: 'style'\"></div>\n    </ng-container>\n    <ng-container *ngIf=\"hasWall && 0 < wallImage?.url.length\">\n      <div [ngClass]=\"{'blinking-animation': !isLocked}\" class=\"texture of-wall-top\" [style.background-image]=\"'url(' + wallImage.url + ')' | safe: 'style'\"\n        [style.width.px]=\"width * gridSize\" [style.height.px]=\"height * gridSize\"></div>\n      <div [ngClass]=\"{'blinking-animation': !isLocked}\" class=\"texture of-wall-bottom\" [style.background-image]=\"'url(' + wallImage.url + ')' | safe: 'style'\"\n        [style.width.px]=\"width * gridSize\" [style.height.px]=\"height * gridSize\"></div>\n      <div [ngClass]=\"{'blinking-animation': !isLocked}\" class=\"texture of-wall-left\" [style.background-image]=\"'url(' + wallImage.url + ')' | safe: 'style'\"\n        [style.width.px]=\"depth * gridSize\" [style.height.px]=\"height * gridSize\"></div>\n      <div [ngClass]=\"{'blinking-animation': !isLocked}\" class=\"texture of-wall-right\" [style.background-image]=\"'url(' + wallImage.url + ')' | safe: 'style'\"\n        [style.width.px]=\"depth * gridSize\" [style.height.px]=\"height * gridSize\"></div>\n    </ng-container>\n    <ng-container *ngIf=\"!isLocked\">\n      <div class=\"pedestal-grab rotate-grab\"></div>\n      <div class=\"rotate-grab of-left-top rotate-grab-icon\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-left-bottom rotate-grab-icon\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-right-bottom rotate-grab-icon\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n      <div class=\"rotate-grab of-right-top rotate-grab-icon\">\n        <i class=\"material-icons\">autorenew</i>\n      </div>\n    </ng-container>\n  </div>\n</div>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/text-note/text-note.component.html":
/*!****************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/text-note/text-note.component.html ***!
  \****************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"component is-3d is-pointer-events-none\"\n  appMovable [movable.option]=\"movableOption\" [movable.disable]=\"isSelected\" (movable.ondragstart)=\"onMove()\" (movable.ondragend)=\"onMoved()\">\n  <div class=\"is-3d\" appRotable [rotable.option]=\"rotableOption\" (rotable.ondragstart)=\"onMove()\" (rotable.ondragend)=\"onMoved()\">\n  <div class=\"component-content is-3d is-pointer-events-auto\"\n    [style.width.px]=\"width * gridSize\">\n    <div class=\"upright-transform is-3d is-bg-color is-bg-texture\"\n      [style.background-image]=\"'url(' + imageFile?.url + ')' | safe: 'style'\" [style.width.px]=\"width * gridSize\" [style.min-height.px]=\"height * gridSize\">\n      <div *ngIf=\"title.length\" class=\"title is-black-background is-pointer-events-none\">{{title}}</div>\n      <textarea (input)=\"calcFitHeight();\" #textArea [ngClass]=\"{'is-pointer-events-none': !isSelected, 'is-pointer-events-auto': isSelected, 'is-outline-text': !isSelected}\"\n        [style.font-size.px]=\"fontSize + 9\" [(ngModel)]=\"text\" spellcheck=\"false\"></textarea>\n    </div>\n    <div class=\"rotate-grab of-left-top\">\n      <i class=\"material-icons\">autorenew</i>\n    </div>\n    <div class=\"rotate-grab of-right-top\">\n      <i class=\"material-icons\">autorenew</i>\n    </div>\n  </div>\n</div>\n</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/text-view/text-view.component.html":
/*!****************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/text-view/text-view.component.html ***!
  \****************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<span><pre class=\"text\">{{text}}</pre></span>");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/ui-panel/ui-panel.component.html":
/*!**************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/component/ui-panel/ui-panel.component.html ***!
  \**************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div [@flyInOut]=\"'in'\" [ngClass]=\"{'pointer-events-none': isPointerDragging}\" class=\"draggable-panel\"\n  [style.left.px]=\"left\" [style.top.px]=\"top\" [style.width.px]=\"width\" [style.height.px]=\"height\"\n  [draggable.stack]=\"'.draggable-panel'\" appDraggable appResizable #draggablePanel>\n  <div class=\"title\">\n    <div class=\"title-button\">\n      <button (click)=\"toggleFullScreen()\"><i class=\"material-icons\" style=\"font-size: 14px;\">fullscreen</i></button>\n      <button (click)=\"close()\"><i class=\"material-icons\" style=\"font-size: 14px;\">close</i></button>\n    </div>\n    {{panelService.title}}\n  </div>\n  <div class=\"scrollable-panel\" #scrollablePanel>\n    <ng-content></ng-content>\n    <div #content></div>\n  </div>\n</div>\n");

/***/ }),

/***/ "./node_modules/tslib/tslib.es6.js":
/*!*****************************************!*\
  !*** ./node_modules/tslib/tslib.es6.js ***!
  \*****************************************/
/*! exports provided: __extends, __assign, __rest, __decorate, __param, __metadata, __awaiter, __generator, __exportStar, __values, __read, __spread, __spreadArrays, __await, __asyncGenerator, __asyncDelegator, __asyncValues, __makeTemplateObject, __importStar, __importDefault */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spreadArrays", function() { return __spreadArrays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),

/***/ "./src/app/app.component.css":
/*!***********************************!*\
  !*** ./src/app/app.component.css ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("nav ul {\n    list-style:none;\n    padding: 0px;\n    margin: 0px;\n  /*\n  border: 1px solid #bbb;\n  border-radius: 5px;\n  padding: 5px;\n  background-color: rgba(30, 30, 30, 0.8);\n  */\n}\n\nnav ul > li {\n  text-align: center;\n  padding: 5px;\n  color: #CCC;\n  color: #444;\n\n  cursor: -moz-pointer;\n  cursor: -webkit-pointer;\n  cursor: pointer;\n}\n\nnav ul > li:hover {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n\nnav ul > li > a {\n  height: 128px;\n  width: 128px;\n  font-size: 8px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\nnav ul > li > a > label {\n  cursor: -moz-pointer;\n  cursor: -webkit-pointer;\n  cursor: pointer;\n}\n\nnav ul i {\n  font-size: 24px;\n}\n\nnav ul a, nav ul a:hover, nav ul a:active, nav ul a:visited {\n  text-decoration: none;\n}\n\n.icon-size {\n  font-size: 40px;\n}\n\n.side-menu {\n  top: 0px;\n  left: 0px;\n  box-sizing: border-box;\n  overflow: auto;\n  position: absolute;\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n  border:solid 1px #999;\n  padding: 0px;\n  height: 100%;\n  width: 300px;\n}\n\n.networkIndicator {\n  display: none;\n  z-index: 9999;\n  pointer-events: none;\n  position: absolute;\n  top: 3px;\n  right: 3px;\n  height: 30px;\n  width: 30px;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvYXBwLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxlQUFlO0lBQ2YsWUFBWTtJQUNaLFdBQVc7RUFDYjs7Ozs7R0FLQztBQUNIOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFlBQVk7RUFDWixXQUFXO0VBQ1gsV0FBVzs7RUFFWCxvQkFBb0I7RUFDcEIsdUJBQXVCO0VBQ3ZCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsdUNBQXVDO0FBQ3pDOztBQUNBO0VBQ0UsYUFBYTtFQUNiLFlBQVk7RUFDWixjQUFjO0VBQ2QseUJBQWlCO0tBQWpCLHNCQUFpQjtNQUFqQixxQkFBaUI7VUFBakIsaUJBQWlCO0FBQ25COztBQUNBO0VBQ0Usb0JBQW9CO0VBQ3BCLHVCQUF1QjtFQUN2QixlQUFlO0FBQ2pCOztBQUNBO0VBQ0UsZUFBZTtBQUNqQjs7QUFDQTtFQUNFLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxRQUFRO0VBQ1IsU0FBUztFQUNULHNCQUFzQjtFQUN0QixjQUFjO0VBQ2Qsa0JBQWtCO0VBQ2xCLFdBQVc7RUFDWCx1Q0FBdUM7RUFDdkMscUJBQXFCO0VBQ3JCLFlBQVk7RUFDWixZQUFZO0VBQ1osWUFBWTtBQUNkOztBQUVBO0VBQ0UsYUFBYTtFQUNiLGFBQWE7RUFDYixvQkFBb0I7RUFDcEIsa0JBQWtCO0VBQ2xCLFFBQVE7RUFDUixVQUFVO0VBQ1YsWUFBWTtFQUNaLFdBQVc7QUFDYiIsImZpbGUiOiJzcmMvYXBwL2FwcC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsibmF2IHVsIHtcbiAgICBsaXN0LXN0eWxlOm5vbmU7XG4gICAgcGFkZGluZzogMHB4O1xuICAgIG1hcmdpbjogMHB4O1xuICAvKlxuICBib3JkZXI6IDFweCBzb2xpZCAjYmJiO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIHBhZGRpbmc6IDVweDtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDMwLCAwLjgpO1xuICAqL1xufVxuXG5uYXYgdWwgPiBsaSB7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgcGFkZGluZzogNXB4O1xuICBjb2xvcjogI0NDQztcbiAgY29sb3I6ICM0NDQ7XG5cbiAgY3Vyc29yOiAtbW96LXBvaW50ZXI7XG4gIGN1cnNvcjogLXdlYmtpdC1wb2ludGVyO1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbm5hdiB1bCA+IGxpOmhvdmVyIHtcbiAgY29sb3I6ICNDQ0M7XG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMzAsIDMwLCAzMCwgMC44KTtcbn1cbm5hdiB1bCA+IGxpID4gYSB7XG4gIGhlaWdodDogMTI4cHg7XG4gIHdpZHRoOiAxMjhweDtcbiAgZm9udC1zaXplOiA4cHg7XG4gIHVzZXItc2VsZWN0OiBub25lO1xufVxubmF2IHVsID4gbGkgPiBhID4gbGFiZWwge1xuICBjdXJzb3I6IC1tb3otcG9pbnRlcjtcbiAgY3Vyc29yOiAtd2Via2l0LXBvaW50ZXI7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cbm5hdiB1bCBpIHtcbiAgZm9udC1zaXplOiAyNHB4O1xufVxubmF2IHVsIGEsIG5hdiB1bCBhOmhvdmVyLCBuYXYgdWwgYTphY3RpdmUsIG5hdiB1bCBhOnZpc2l0ZWQge1xuICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG59XG5cbi5pY29uLXNpemUge1xuICBmb250LXNpemU6IDQwcHg7XG59XG5cbi5zaWRlLW1lbnUge1xuICB0b3A6IDBweDtcbiAgbGVmdDogMHB4O1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBvdmVyZmxvdzogYXV0bztcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBjb2xvcjogI0NDQztcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDMwLCAwLjgpO1xuICBib3JkZXI6c29saWQgMXB4ICM5OTk7XG4gIHBhZGRpbmc6IDBweDtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMzAwcHg7XG59XG5cbi5uZXR3b3JrSW5kaWNhdG9yIHtcbiAgZGlzcGxheTogbm9uZTtcbiAgei1pbmRleDogOTk5OTtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAzcHg7XG4gIHJpZ2h0OiAzcHg7XG4gIGhlaWdodDogMzBweDtcbiAgd2lkdGg6IDMwcHg7XG59XG4iXX0= */");

/***/ }),

/***/ "./src/app/app.component.ts":
/*!**********************************!*\
  !*** ./src/app/app.component.ts ***!
  \**********************************/
/*! exports provided: AppComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppComponent", function() { return AppComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_chat_tab__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/chat-tab */ "./src/app/class/chat-tab.ts");
/* harmony import */ var _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/audio-player */ "./src/app/class/core/file-storage/audio-player.ts");
/* harmony import */ var _udonarium_core_file_storage_audio_sharing_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/file-storage/audio-sharing-system */ "./src/app/class/core/file-storage/audio-sharing-system.ts");
/* harmony import */ var _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/file-storage/audio-storage */ "./src/app/class/core/file-storage/audio-storage.ts");
/* harmony import */ var _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/file-storage/file-archiver */ "./src/app/class/core/file-storage/file-archiver.ts");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _udonarium_core_file_storage_image_sharing_system__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @udonarium/core/file-storage/image-sharing-system */ "./src/app/class/core/file-storage/image-sharing-system.ts");
/* harmony import */ var _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @udonarium/core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_factory__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-factory */ "./src/app/class/core/synchronize-object/object-factory.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_synchronizer__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-synchronizer */ "./src/app/class/core/synchronize-object/object-synchronizer.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @udonarium/data-summary-setting */ "./src/app/class/data-summary-setting.ts");
/* harmony import */ var _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @udonarium/dice-bot */ "./src/app/class/dice-bot.ts");
/* harmony import */ var _udonarium_Jukebox__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @udonarium/Jukebox */ "./src/app/class/Jukebox.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_chat_window_chat_window_component__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! component/chat-window/chat-window.component */ "./src/app/component/chat-window/chat-window.component.ts");
/* harmony import */ var component_file_storage_file_storage_component__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! component/file-storage/file-storage.component */ "./src/app/component/file-storage/file-storage.component.ts");
/* harmony import */ var component_game_character_generator_game_character_generator_component__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! component/game-character-generator/game-character-generator.component */ "./src/app/component/game-character-generator/game-character-generator.component.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var component_game_object_inventory_game_object_inventory_component__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! component/game-object-inventory/game-object-inventory.component */ "./src/app/component/game-object-inventory/game-object-inventory.component.ts");
/* harmony import */ var component_game_table_setting_game_table_setting_component__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! component/game-table-setting/game-table-setting.component */ "./src/app/component/game-table-setting/game-table-setting.component.ts");
/* harmony import */ var component_jukebox_jukebox_component__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! component/jukebox/jukebox.component */ "./src/app/component/jukebox/jukebox.component.ts");
/* harmony import */ var component_peer_menu_peer_menu_component__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! component/peer-menu/peer-menu.component */ "./src/app/component/peer-menu/peer-menu.component.ts");
/* harmony import */ var component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! component/text-view/text-view.component */ "./src/app/component/text-view/text-view.component.ts");
/* harmony import */ var service_app_config_service__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! service/app-config.service */ "./src/app/service/app-config.service.ts");
/* harmony import */ var service_chat_message_service__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! service/chat-message.service */ "./src/app/service/chat-message.service.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_save_data_service__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! service/save-data.service */ "./src/app/service/save-data.service.ts");




































var AppComponent = /** @class */ (function () {
    function AppComponent(modalService, panelService, pointerDeviceService, chatMessageService, appConfigService, saveDataService, ngZone) {
        var _this = this;
        this.modalService = modalService;
        this.panelService = panelService;
        this.pointerDeviceService = pointerDeviceService;
        this.chatMessageService = chatMessageService;
        this.appConfigService = appConfigService;
        this.saveDataService = saveDataService;
        this.ngZone = ngZone;
        this.immediateUpdateTimer = null;
        this.lazyUpdateTimer = null;
        this.openPanelCount = 0;
        this.ngZone.runOutsideAngular(function () {
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["EventSystem"];
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["Network"];
            _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_6__["FileArchiver"].instance.initialize();
            _udonarium_core_file_storage_image_sharing_system__WEBPACK_IMPORTED_MODULE_8__["FileSharingSystem"].instance.initialize();
            _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_9__["ImageStorage"].instance;
            _udonarium_core_file_storage_audio_sharing_system__WEBPACK_IMPORTED_MODULE_4__["AudioSharingSystem"].instance.initialize();
            _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance;
            _udonarium_core_synchronize_object_object_factory__WEBPACK_IMPORTED_MODULE_10__["ObjectFactory"].instance;
            _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_11__["ObjectSerializer"].instance;
            _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_12__["ObjectStore"].instance;
            _udonarium_core_synchronize_object_object_synchronizer__WEBPACK_IMPORTED_MODULE_13__["ObjectSynchronizer"].instance.initialize();
        });
        this.appConfigService.initialize();
        this.pointerDeviceService.initialize();
        _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_15__["DataSummarySetting"].instance.initialize();
        var diceBot = new _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_16__["DiceBot"]('DiceBot');
        diceBot.initialize();
        var jukebox = new _udonarium_Jukebox__WEBPACK_IMPORTED_MODULE_17__["Jukebox"]('Jukebox');
        jukebox.initialize();
        var soundEffect = new _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["SoundEffect"]('SoundEffect');
        soundEffect.initialize();
        var chatTab = new _udonarium_chat_tab__WEBPACK_IMPORTED_MODULE_2__["ChatTab"]('MainTab');
        chatTab.name = 'メインタブ';
        chatTab.initialize();
        chatTab = new _udonarium_chat_tab__WEBPACK_IMPORTED_MODULE_2__["ChatTab"]('SubTab');
        chatTab.name = 'サブタブ';
        chatTab.initialize();
        var fileContext = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_7__["ImageFile"].createEmpty('none_icon').toContext();
        fileContext.url = './assets/images/ic_account_circle_black_24dp_2x.png';
        var noneIconImage = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_9__["ImageStorage"].instance.add(fileContext);
        _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_3__["AudioPlayer"].resumeAudioContext();
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].dicePick = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/soundeffect-lab/shoulder-touch1.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].dicePut = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/soundeffect-lab/book-stack1.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].diceRoll1 = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].diceRoll2 = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].cardDraw = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/soundeffect-lab/card-turn-over1.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].cardPick = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/soundeffect-lab/shoulder-touch1.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].cardPut = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/soundeffect-lab/book-stack1.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].cardShuffle = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/soundeffect-lab/card-open1.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].piecePick = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/soundeffect-lab/shoulder-touch1.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].piecePut = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/soundeffect-lab/book-stack1.mp3').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].blockPick = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/tm2/tm2_pon002.wav').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].blockPut = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/tm2/tm2_pon002.wav').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].lock = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/tm2/tm2_switch001.wav').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].unlock = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/tm2/tm2_switch001.wav').identifier;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].sweep = _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.add('./assets/sounds/tm2/tm2_swing003.wav').identifier;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].dicePick).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].dicePut).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].diceRoll1).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].diceRoll2).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].cardDraw).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].cardPick).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].cardPut).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].cardShuffle).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].piecePick).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].piecePut).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].blockPick).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].blockPut).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].lock).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].unlock).isHidden = true;
        _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.get(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_19__["PresetSound"].sweep).isHidden = true;
        _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_18__["PeerCursor"].createMyCursor();
        _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_18__["PeerCursor"].myCursor.name = 'プレイヤー';
        _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_18__["PeerCursor"].myCursor.imageIdentifier = noneIconImage.identifier;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', function (event) { _this.lazyNgZoneUpdate(event.isSendFromSelf); })
            .on('DELETE_GAME_OBJECT', function (event) { _this.lazyNgZoneUpdate(event.isSendFromSelf); })
            .on('SYNCHRONIZE_AUDIO_LIST', function (event) { if (event.isSendFromSelf)
            _this.lazyNgZoneUpdate(false); })
            .on('SYNCHRONIZE_FILE_LIST', function (event) { if (event.isSendFromSelf)
            _this.lazyNgZoneUpdate(false); })
            .on('LOAD_CONFIG', function (event) {
            console.log('LOAD_CONFIG !!!', event.data);
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["Network"].setApiKey(event.data.webrtc.key);
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["Network"].open();
        })
            .on('FILE_LOADED', function (event) {
            _this.lazyNgZoneUpdate(false);
        })
            .on('OPEN_NETWORK', function (event) {
            console.log('OPEN_NETWORK', event.data.peer);
            _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_18__["PeerCursor"].myCursor.peerId = event.data.peer;
        })
            .on('CLOSE_NETWORK', function (event) {
            console.log('CLOSE_NETWORK', event.data.peer);
            _this.ngZone.run(function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!(1 < _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["Network"].peerIds.length)) return [3 /*break*/, 2];
                            return [4 /*yield*/, this.modalService.open(component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_28__["TextViewComponent"], { title: 'ネットワークエラー', text: 'ネットワーク接続に何らかの異常が発生しました。\nこの表示以後、接続が不安定であれば、ページリロードと再接続を試みてください。' })];
                        case 1:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 2: return [4 /*yield*/, this.modalService.open(component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_28__["TextViewComponent"], { title: 'ネットワークエラー', text: '接続情報が破棄されました。\nこのウィンドウを閉じると再接続を試みます。' })];
                        case 3:
                            _a.sent();
                            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["Network"].open();
                            _a.label = 4;
                        case 4: return [2 /*return*/];
                    }
                });
            }); });
        })
            .on('CONNECT_PEER', function (event) {
            if (event.isSendFromSelf)
                _this.chatMessageService.calibrateTimeOffset();
        })
            .on('DISCONNECT_PEER', function (event) {
            //
        });
    }
    AppComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        service_panel_service__WEBPACK_IMPORTED_MODULE_33__["PanelService"].defaultParentViewContainerRef = service_modal_service__WEBPACK_IMPORTED_MODULE_32__["ModalService"].defaultParentViewContainerRef = service_context_menu_service__WEBPACK_IMPORTED_MODULE_31__["ContextMenuService"].defaultParentViewContainerRef = this.modalLayerViewContainerRef;
        setTimeout(function () {
            _this.panelService.open(component_peer_menu_peer_menu_component__WEBPACK_IMPORTED_MODULE_27__["PeerMenuComponent"], { width: 500, height: 450, left: 100 });
            _this.panelService.open(component_chat_window_chat_window_component__WEBPACK_IMPORTED_MODULE_20__["ChatWindowComponent"], { width: 700, height: 400, left: 100, top: 450 });
        }, 0);
    };
    AppComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["EventSystem"].unregister(this);
    };
    AppComponent.prototype.open = function (componentName) {
        var component = null;
        var option = { width: 450, height: 600, left: 100 };
        switch (componentName) {
            case 'PeerMenuComponent':
                component = component_peer_menu_peer_menu_component__WEBPACK_IMPORTED_MODULE_27__["PeerMenuComponent"];
                break;
            case 'ChatWindowComponent':
                component = component_chat_window_chat_window_component__WEBPACK_IMPORTED_MODULE_20__["ChatWindowComponent"];
                option.width = 700;
                break;
            case 'GameTableSettingComponent':
                component = component_game_table_setting_game_table_setting_component__WEBPACK_IMPORTED_MODULE_25__["GameTableSettingComponent"];
                option = { width: 630, height: 400, left: 100 };
                break;
            case 'FileStorageComponent':
                component = component_file_storage_file_storage_component__WEBPACK_IMPORTED_MODULE_21__["FileStorageComponent"];
                break;
            case 'GameCharacterSheetComponent':
                component = component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_23__["GameCharacterSheetComponent"];
                break;
            case 'JukeboxComponent':
                component = component_jukebox_jukebox_component__WEBPACK_IMPORTED_MODULE_26__["JukeboxComponent"];
                break;
            case 'GameCharacterGeneratorComponent':
                component = component_game_character_generator_game_character_generator_component__WEBPACK_IMPORTED_MODULE_22__["GameCharacterGeneratorComponent"];
                option = { width: 500, height: 300, left: 100 };
                break;
            case 'GameObjectInventoryComponent':
                component = component_game_object_inventory_game_object_inventory_component__WEBPACK_IMPORTED_MODULE_24__["GameObjectInventoryComponent"];
                break;
        }
        if (component) {
            option.top = (this.openPanelCount % 10 + 1) * 20;
            option.left = 100 + (this.openPanelCount % 20 + 1) * 5;
            this.openPanelCount = this.openPanelCount + 1;
            this.panelService.open(component, option);
        }
    };
    AppComponent.prototype.save = function () {
        var roomName = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["Network"].peerContext && 0 < _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["Network"].peerContext.roomName.length
            ? _udonarium_core_system__WEBPACK_IMPORTED_MODULE_14__["Network"].peerContext.roomName
            : 'ルームデータ';
        this.saveDataService.saveRoom(roomName);
    };
    AppComponent.prototype.handleFileSelect = function (event) {
        var files = event.target.files;
        if (files.length)
            _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_6__["FileArchiver"].instance.load(files);
    };
    AppComponent.prototype.lazyNgZoneUpdate = function (isImmediate) {
        var _this = this;
        if (isImmediate) {
            if (this.immediateUpdateTimer !== null)
                return;
            this.immediateUpdateTimer = setTimeout(function () {
                _this.immediateUpdateTimer = null;
                if (_this.lazyUpdateTimer != null) {
                    clearTimeout(_this.lazyUpdateTimer);
                    _this.lazyUpdateTimer = null;
                }
                _this.ngZone.run(function () { });
            }, 0);
        }
        else {
            if (this.lazyUpdateTimer !== null)
                return;
            this.lazyUpdateTimer = setTimeout(function () {
                _this.lazyUpdateTimer = null;
                if (_this.immediateUpdateTimer != null) {
                    clearTimeout(_this.immediateUpdateTimer);
                    _this.immediateUpdateTimer = null;
                }
                _this.ngZone.run(function () { });
            }, 100);
        }
    };
    AppComponent.ctorParameters = function () { return [
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_32__["ModalService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_33__["PanelService"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_34__["PointerDeviceService"] },
        { type: service_chat_message_service__WEBPACK_IMPORTED_MODULE_30__["ChatMessageService"] },
        { type: service_app_config_service__WEBPACK_IMPORTED_MODULE_29__["AppConfigService"] },
        { type: service_save_data_service__WEBPACK_IMPORTED_MODULE_35__["SaveDataService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('modalLayer', { read: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewContainerRef"], static: true })
    ], AppComponent.prototype, "modalLayerViewContainerRef", void 0);
    AppComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-root',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./app.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/app.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./app.component.css */ "./src/app/app.component.css")).default]
        })
    ], AppComponent);
    return AppComponent;
}());



/***/ }),

/***/ "./src/app/app.module.ts":
/*!*******************************!*\
  !*** ./src/app/app.module.ts ***!
  \*******************************/
/*! exports provided: AppModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppModule", function() { return AppModule; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/common */ "./node_modules/@angular/common/fesm5/common.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/forms */ "./node_modules/@angular/forms/fesm5/forms.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/platform-browser/animations */ "./node_modules/@angular/platform-browser/fesm5/animations.js");
/* harmony import */ var component_badge_badge_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! component/badge/badge.component */ "./src/app/component/badge/badge.component.ts");
/* harmony import */ var component_card_stack_list_card_stack_list_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! component/card-stack-list/card-stack-list.component */ "./src/app/component/card-stack-list/card-stack-list.component.ts");
/* harmony import */ var component_card_stack_card_stack_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! component/card-stack/card-stack.component */ "./src/app/component/card-stack/card-stack.component.ts");
/* harmony import */ var component_card_card_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! component/card/card.component */ "./src/app/component/card/card.component.ts");
/* harmony import */ var component_chat_message_chat_message_component__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! component/chat-message/chat-message.component */ "./src/app/component/chat-message/chat-message.component.ts");
/* harmony import */ var component_chat_palette_chat_palette_component__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! component/chat-palette/chat-palette.component */ "./src/app/component/chat-palette/chat-palette.component.ts");
/* harmony import */ var component_chat_tab_setting_chat_tab_setting_component__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! component/chat-tab-setting/chat-tab-setting.component */ "./src/app/component/chat-tab-setting/chat-tab-setting.component.ts");
/* harmony import */ var component_chat_tab_chat_tab_component__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! component/chat-tab/chat-tab.component */ "./src/app/component/chat-tab/chat-tab.component.ts");
/* harmony import */ var component_chat_window_chat_window_component__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! component/chat-window/chat-window.component */ "./src/app/component/chat-window/chat-window.component.ts");
/* harmony import */ var component_context_menu_context_menu_component__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! component/context-menu/context-menu.component */ "./src/app/component/context-menu/context-menu.component.ts");
/* harmony import */ var component_dice_symbol_dice_symbol_component__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! component/dice-symbol/dice-symbol.component */ "./src/app/component/dice-symbol/dice-symbol.component.ts");
/* harmony import */ var component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! component/file-selecter/file-selecter.component */ "./src/app/component/file-selecter/file-selecter.component.ts");
/* harmony import */ var component_file_storage_file_storage_component__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! component/file-storage/file-storage.component */ "./src/app/component/file-storage/file-storage.component.ts");
/* harmony import */ var component_game_character_generator_game_character_generator_component__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! component/game-character-generator/game-character-generator.component */ "./src/app/component/game-character-generator/game-character-generator.component.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var component_game_character_game_character_component__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! component/game-character/game-character.component */ "./src/app/component/game-character/game-character.component.ts");
/* harmony import */ var component_game_data_element_game_data_element_component__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! component/game-data-element/game-data-element.component */ "./src/app/component/game-data-element/game-data-element.component.ts");
/* harmony import */ var component_game_object_inventory_game_object_inventory_component__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! component/game-object-inventory/game-object-inventory.component */ "./src/app/component/game-object-inventory/game-object-inventory.component.ts");
/* harmony import */ var component_game_table_mask_game_table_mask_component__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! component/game-table-mask/game-table-mask.component */ "./src/app/component/game-table-mask/game-table-mask.component.ts");
/* harmony import */ var component_game_table_setting_game_table_setting_component__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! component/game-table-setting/game-table-setting.component */ "./src/app/component/game-table-setting/game-table-setting.component.ts");
/* harmony import */ var component_game_table_game_table_component__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! component/game-table/game-table.component */ "./src/app/component/game-table/game-table.component.ts");
/* harmony import */ var component_jukebox_jukebox_component__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! component/jukebox/jukebox.component */ "./src/app/component/jukebox/jukebox.component.ts");
/* harmony import */ var component_lobby_lobby_component__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! component/lobby/lobby.component */ "./src/app/component/lobby/lobby.component.ts");
/* harmony import */ var component_modal_modal_component__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! component/modal/modal.component */ "./src/app/component/modal/modal.component.ts");
/* harmony import */ var component_network_indicator_network_indicator_component__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! component/network-indicator/network-indicator.component */ "./src/app/component/network-indicator/network-indicator.component.ts");
/* harmony import */ var component_overview_panel_overview_panel_component__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! component/overview-panel/overview-panel.component */ "./src/app/component/overview-panel/overview-panel.component.ts");
/* harmony import */ var component_password_check_password_check_component__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! component/password-check/password-check.component */ "./src/app/component/password-check/password-check.component.ts");
/* harmony import */ var component_peer_cursor_peer_cursor_component__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! component/peer-cursor/peer-cursor.component */ "./src/app/component/peer-cursor/peer-cursor.component.ts");
/* harmony import */ var component_peer_menu_peer_menu_component__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! component/peer-menu/peer-menu.component */ "./src/app/component/peer-menu/peer-menu.component.ts");
/* harmony import */ var component_room_setting_room_setting_component__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! component/room-setting/room-setting.component */ "./src/app/component/room-setting/room-setting.component.ts");
/* harmony import */ var component_terrain_terrain_component__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! component/terrain/terrain.component */ "./src/app/component/terrain/terrain.component.ts");
/* harmony import */ var component_text_note_text_note_component__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! component/text-note/text-note.component */ "./src/app/component/text-note/text-note.component.ts");
/* harmony import */ var component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! component/text-view/text-view.component */ "./src/app/component/text-view/text-view.component.ts");
/* harmony import */ var component_ui_panel_ui_panel_component__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! component/ui-panel/ui-panel.component */ "./src/app/component/ui-panel/ui-panel.component.ts");
/* harmony import */ var directive_draggable_directive__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! directive/draggable.directive */ "./src/app/directive/draggable.directive.ts");
/* harmony import */ var directive_movable_directive__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! directive/movable.directive */ "./src/app/directive/movable.directive.ts");
/* harmony import */ var directive_resizable_directive__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! directive/resizable.directive */ "./src/app/directive/resizable.directive.ts");
/* harmony import */ var directive_rotable_directive__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! directive/rotable.directive */ "./src/app/directive/rotable.directive.ts");
/* harmony import */ var directive_tooltip_directive__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! directive/tooltip.directive */ "./src/app/directive/tooltip.directive.ts");
/* harmony import */ var pipe_safe_pipe__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! pipe/safe.pipe */ "./src/app/pipe/safe.pipe.ts");
/* harmony import */ var service_app_config_service__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! service/app-config.service */ "./src/app/service/app-config.service.ts");
/* harmony import */ var service_chat_message_service__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! service/chat-message.service */ "./src/app/service/chat-message.service.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_game_object_inventory_service__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! service/game-object-inventory.service */ "./src/app/service/game-object-inventory.service.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_tabletop_service__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! service/tabletop.service */ "./src/app/service/tabletop.service.ts");
/* harmony import */ var _app_component__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ./app.component */ "./src/app/app.component.ts");























































var AppModule = /** @class */ (function () {
    function AppModule() {
    }
    AppModule = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["NgModule"])({
            declarations: [
                _app_component__WEBPACK_IMPORTED_MODULE_54__["AppComponent"],
                component_badge_badge_component__WEBPACK_IMPORTED_MODULE_6__["BadgeComponent"],
                component_card_card_component__WEBPACK_IMPORTED_MODULE_9__["CardComponent"],
                component_card_stack_card_stack_component__WEBPACK_IMPORTED_MODULE_8__["CardStackComponent"],
                component_card_stack_list_card_stack_list_component__WEBPACK_IMPORTED_MODULE_7__["CardStackListComponent"],
                component_chat_message_chat_message_component__WEBPACK_IMPORTED_MODULE_10__["ChatMessageComponent"],
                component_chat_palette_chat_palette_component__WEBPACK_IMPORTED_MODULE_11__["ChatPaletteComponent"],
                component_chat_tab_chat_tab_component__WEBPACK_IMPORTED_MODULE_13__["ChatTabComponent"],
                component_chat_tab_setting_chat_tab_setting_component__WEBPACK_IMPORTED_MODULE_12__["ChatTabSettingComponent"],
                component_chat_window_chat_window_component__WEBPACK_IMPORTED_MODULE_14__["ChatWindowComponent"],
                component_context_menu_context_menu_component__WEBPACK_IMPORTED_MODULE_15__["ContextMenuComponent"],
                component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_17__["FileSelecterComponent"],
                component_file_storage_file_storage_component__WEBPACK_IMPORTED_MODULE_18__["FileStorageComponent"],
                component_game_character_generator_game_character_generator_component__WEBPACK_IMPORTED_MODULE_19__["GameCharacterGeneratorComponent"],
                component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_20__["GameCharacterSheetComponent"],
                component_game_character_game_character_component__WEBPACK_IMPORTED_MODULE_21__["GameCharacterComponent"],
                component_game_data_element_game_data_element_component__WEBPACK_IMPORTED_MODULE_22__["GameDataElementComponent"],
                component_game_object_inventory_game_object_inventory_component__WEBPACK_IMPORTED_MODULE_23__["GameObjectInventoryComponent"],
                component_game_table_mask_game_table_mask_component__WEBPACK_IMPORTED_MODULE_24__["GameTableMaskComponent"],
                component_game_table_setting_game_table_setting_component__WEBPACK_IMPORTED_MODULE_25__["GameTableSettingComponent"],
                component_game_table_game_table_component__WEBPACK_IMPORTED_MODULE_26__["GameTableComponent"],
                component_jukebox_jukebox_component__WEBPACK_IMPORTED_MODULE_27__["JukeboxComponent"],
                component_lobby_lobby_component__WEBPACK_IMPORTED_MODULE_28__["LobbyComponent"],
                component_modal_modal_component__WEBPACK_IMPORTED_MODULE_29__["ModalComponent"],
                component_overview_panel_overview_panel_component__WEBPACK_IMPORTED_MODULE_31__["OverviewPanelComponent"],
                component_password_check_password_check_component__WEBPACK_IMPORTED_MODULE_32__["PasswordCheckComponent"],
                component_peer_menu_peer_menu_component__WEBPACK_IMPORTED_MODULE_34__["PeerMenuComponent"],
                component_room_setting_room_setting_component__WEBPACK_IMPORTED_MODULE_35__["RoomSettingComponent"],
                component_ui_panel_ui_panel_component__WEBPACK_IMPORTED_MODULE_39__["UIPanelComponent"],
                pipe_safe_pipe__WEBPACK_IMPORTED_MODULE_45__["SafePipe"],
                component_chat_palette_chat_palette_component__WEBPACK_IMPORTED_MODULE_11__["ChatPaletteComponent"],
                component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_38__["TextViewComponent"],
                component_terrain_terrain_component__WEBPACK_IMPORTED_MODULE_36__["TerrainComponent"],
                component_peer_cursor_peer_cursor_component__WEBPACK_IMPORTED_MODULE_33__["PeerCursorComponent"],
                component_text_note_text_note_component__WEBPACK_IMPORTED_MODULE_37__["TextNoteComponent"],
                directive_movable_directive__WEBPACK_IMPORTED_MODULE_41__["MovableDirective"],
                directive_rotable_directive__WEBPACK_IMPORTED_MODULE_43__["RotableDirective"],
                component_network_indicator_network_indicator_component__WEBPACK_IMPORTED_MODULE_30__["NetworkIndicatorComponent"],
                component_dice_symbol_dice_symbol_component__WEBPACK_IMPORTED_MODULE_16__["DiceSymbolComponent"],
                directive_tooltip_directive__WEBPACK_IMPORTED_MODULE_44__["TooltipDirective"],
                directive_draggable_directive__WEBPACK_IMPORTED_MODULE_40__["DraggableDirective"],
                directive_resizable_directive__WEBPACK_IMPORTED_MODULE_42__["ResizableDirective"],
            ],
            imports: [
                _angular_platform_browser__WEBPACK_IMPORTED_MODULE_4__["BrowserModule"],
                _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_5__["BrowserAnimationsModule"],
                _angular_common__WEBPACK_IMPORTED_MODULE_1__["CommonModule"],
                _angular_forms__WEBPACK_IMPORTED_MODULE_3__["FormsModule"]
            ],
            providers: [
                service_app_config_service__WEBPACK_IMPORTED_MODULE_46__["AppConfigService"],
                service_chat_message_service__WEBPACK_IMPORTED_MODULE_47__["ChatMessageService"],
                service_context_menu_service__WEBPACK_IMPORTED_MODULE_48__["ContextMenuService"],
                service_modal_service__WEBPACK_IMPORTED_MODULE_50__["ModalService"],
                service_game_object_inventory_service__WEBPACK_IMPORTED_MODULE_49__["GameObjectInventoryService"],
                service_panel_service__WEBPACK_IMPORTED_MODULE_51__["PanelService"],
                service_pointer_device_service__WEBPACK_IMPORTED_MODULE_52__["PointerDeviceService"],
                service_tabletop_service__WEBPACK_IMPORTED_MODULE_53__["TabletopService"],
            ],
            entryComponents: [
                component_modal_modal_component__WEBPACK_IMPORTED_MODULE_29__["ModalComponent"],
                component_ui_panel_ui_panel_component__WEBPACK_IMPORTED_MODULE_39__["UIPanelComponent"],
                component_password_check_password_check_component__WEBPACK_IMPORTED_MODULE_32__["PasswordCheckComponent"],
                component_peer_menu_peer_menu_component__WEBPACK_IMPORTED_MODULE_34__["PeerMenuComponent"],
                component_game_object_inventory_game_object_inventory_component__WEBPACK_IMPORTED_MODULE_23__["GameObjectInventoryComponent"],
                component_chat_palette_chat_palette_component__WEBPACK_IMPORTED_MODULE_11__["ChatPaletteComponent"],
                component_card_stack_list_card_stack_list_component__WEBPACK_IMPORTED_MODULE_7__["CardStackListComponent"],
                component_chat_tab_setting_chat_tab_setting_component__WEBPACK_IMPORTED_MODULE_12__["ChatTabSettingComponent"],
                component_chat_window_chat_window_component__WEBPACK_IMPORTED_MODULE_14__["ChatWindowComponent"],
                component_context_menu_context_menu_component__WEBPACK_IMPORTED_MODULE_15__["ContextMenuComponent"],
                component_game_table_setting_game_table_setting_component__WEBPACK_IMPORTED_MODULE_25__["GameTableSettingComponent"],
                component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_17__["FileSelecterComponent"],
                component_file_storage_file_storage_component__WEBPACK_IMPORTED_MODULE_18__["FileStorageComponent"],
                component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_20__["GameCharacterSheetComponent"],
                component_game_character_generator_game_character_generator_component__WEBPACK_IMPORTED_MODULE_19__["GameCharacterGeneratorComponent"],
                component_jukebox_jukebox_component__WEBPACK_IMPORTED_MODULE_27__["JukeboxComponent"],
                component_lobby_lobby_component__WEBPACK_IMPORTED_MODULE_28__["LobbyComponent"],
                component_room_setting_room_setting_component__WEBPACK_IMPORTED_MODULE_35__["RoomSettingComponent"],
                component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_38__["TextViewComponent"],
                component_text_note_text_note_component__WEBPACK_IMPORTED_MODULE_37__["TextNoteComponent"],
                component_overview_panel_overview_panel_component__WEBPACK_IMPORTED_MODULE_31__["OverviewPanelComponent"],
            ],
            bootstrap: [_app_component__WEBPACK_IMPORTED_MODULE_54__["AppComponent"]]
        })
    ], AppModule);
    return AppModule;
}());



/***/ }),

/***/ "./src/app/class/Jukebox.ts":
/*!**********************************!*\
  !*** ./src/app/class/Jukebox.ts ***!
  \**********************************/
/*! exports provided: Jukebox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Jukebox", function() { return Jukebox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/file-storage/audio-player */ "./src/app/class/core/file-storage/audio-player.ts");
/* harmony import */ var _core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/file-storage/audio-storage */ "./src/app/class/core/file-storage/audio-storage.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/synchronize-object/game-object */ "./src/app/class/core/synchronize-object/game-object.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");






var Jukebox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Jukebox, _super);
    function Jukebox() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.audioIdentifier = '';
        _this.startTime = 0;
        _this.isLoop = false;
        _this.isPlaying = false;
        _this.audioPlayer = new _core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_1__["AudioPlayer"]();
        return _this;
    }
    Object.defineProperty(Jukebox.prototype, "audio", {
        get: function () { return _core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_2__["AudioStorage"].instance.get(this.audioIdentifier); },
        enumerable: true,
        configurable: true
    });
    // GameObject Lifecycle
    Jukebox.prototype.onStoreAdded = function () {
        _super.prototype.onStoreAdded.call(this);
        this.unlockAfterUserInteraction();
    };
    // GameObject Lifecycle
    Jukebox.prototype.onStoreRemoved = function () {
        _super.prototype.onStoreRemoved.call(this);
        this._stop();
    };
    Jukebox.prototype.play = function (identifier, isLoop) {
        if (isLoop === void 0) { isLoop = false; }
        var audio = _core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_2__["AudioStorage"].instance.get(identifier);
        if (!audio || !audio.isReady)
            return;
        this.audioIdentifier = identifier;
        this.isPlaying = true;
        this.isLoop = isLoop;
        this._play();
    };
    Jukebox.prototype._play = function () {
        this._stop();
        if (!this.audio || !this.audio.isReady) {
            this.playAfterFileUpdate();
            return;
        }
        this.audioPlayer.loop = true;
        this.audioPlayer.play(this.audio);
    };
    Jukebox.prototype.stop = function () {
        this.audioIdentifier = '';
        this.isPlaying = false;
        this._stop();
    };
    Jukebox.prototype._stop = function () {
        this.unregisterEvent();
        this.audioPlayer.stop();
    };
    Jukebox.prototype.playAfterFileUpdate = function () {
        var _this = this;
        _core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].register(this)
            .on('UPDATE_AUDIO_RESOURE', -100, function (event) {
            _this._play();
        });
    };
    Jukebox.prototype.unlockAfterUserInteraction = function () {
        var _this = this;
        var callback = function () {
            document.body.removeEventListener('touchstart', callback, true);
            document.body.removeEventListener('mousedown', callback, true);
            _this.audioPlayer.stop();
            if (_this.isPlaying)
                _this._play();
        };
        document.body.addEventListener('touchstart', callback, true);
        document.body.addEventListener('mousedown', callback, true);
    };
    Jukebox.prototype.unregisterEvent = function () {
        _core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].unregister(this, 'UPDATE_AUDIO_RESOURE');
    };
    // override
    Jukebox.prototype.apply = function (context) {
        var audioIdentifier = this.audioIdentifier;
        var isPlaying = this.isPlaying;
        _super.prototype.apply.call(this, context);
        if ((audioIdentifier !== this.audioIdentifier || !isPlaying) && this.isPlaying) {
            this._play();
        }
        else if (isPlaying !== this.isPlaying && !this.isPlaying) {
            this._stop();
        }
    };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncVar"])()
    ], Jukebox.prototype, "audioIdentifier", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncVar"])()
    ], Jukebox.prototype, "startTime", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncVar"])()
    ], Jukebox.prototype, "isLoop", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncVar"])()
    ], Jukebox.prototype, "isPlaying", void 0);
    Jukebox = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncObject"])('jukebox')
    ], Jukebox);
    return Jukebox;
}(_core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_4__["GameObject"]));



/***/ }),

/***/ "./src/app/class/card-stack.ts":
/*!*************************************!*\
  !*** ./src/app/class/card-stack.ts ***!
  \*************************************/
/*! exports provided: CardStack */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CardStack", function() { return CardStack; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _card__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./card */ "./src/app/class/card.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _data_element__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _peer_cursor__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var _tabletop_object__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./tabletop-object */ "./src/app/class/tabletop-object.ts");
/* harmony import */ var _tabletop_object_util__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./tabletop-object-util */ "./src/app/class/tabletop-object-util.ts");









var CardStack = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CardStack, _super);
    function CardStack() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.rotate = 0;
        _this.zindex = 0;
        _this.owner = '';
        _this.isShowTotal = true;
        return _this;
    }
    CardStack_1 = CardStack;
    Object.defineProperty(CardStack.prototype, "name", {
        get: function () { return this.getCommonValue('name', ''); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStack.prototype, "ownerName", {
        get: function () {
            var object = _peer_cursor__WEBPACK_IMPORTED_MODULE_6__["PeerCursor"].find(this.owner);
            return object ? object.name : '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStack.prototype, "hasOwner", {
        get: function () { return _peer_cursor__WEBPACK_IMPORTED_MODULE_6__["PeerCursor"].find(this.owner) != null; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStack.prototype, "cardRoot", {
        get: function () {
            var e_1, _a;
            try {
                for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var node = _c.value;
                    if (node.getAttribute('name') === 'cardRoot')
                        return node;
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStack.prototype, "cards", {
        get: function () { return this.cardRoot ? this.cardRoot.children : []; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStack.prototype, "topCard", {
        get: function () { return this.isEmpty ? null : this.cards[0]; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStack.prototype, "isEmpty", {
        get: function () { return this.cards.length < 1; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStack.prototype, "imageFile", {
        get: function () { return this.topCard ? this.topCard.imageFile : null; },
        enumerable: true,
        configurable: true
    });
    // ObjectNode Lifecycle
    CardStack.prototype.onChildRemoved = function (child) {
        _super.prototype.onChildRemoved.call(this, child);
        if (child instanceof _card__WEBPACK_IMPORTED_MODULE_1__["Card"]) {
            _core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].trigger('CARD_STACK_DECREASED', { cardStackIdentifier: this.identifier, cardIdentifier: child.identifier });
        }
    };
    CardStack.prototype.shuffle = function () {
        var e_2, _a;
        if (!this.cardRoot)
            return;
        var length = this.cardRoot.children.length;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.cards), _c = _b.next(); !_c.done; _c = _b.next()) {
                var card = _c.value;
                card.index = Math.random() * length;
                card.rotate = Math.floor(Math.random() * 2) * 180;
                this.setSamePositionFor(card);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return this.cards;
    };
    CardStack.prototype.drawCard = function () {
        var card = this.topCard ? this.cardRoot.removeChild(this.topCard) : null;
        if (card) {
            card.rotate += this.rotate;
            if (360 < card.rotate)
                card.rotate -= 360;
            this.setSamePositionFor(card);
            card.toTopmost();
        }
        return card;
    };
    CardStack.prototype.drawCardAll = function () {
        var e_3, _a;
        var cards = this.cards;
        try {
            for (var cards_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](cards), cards_1_1 = cards_1.next(); !cards_1_1.done; cards_1_1 = cards_1.next()) {
                var card = cards_1_1.value;
                this.cardRoot.removeChild(card);
                card.rotate += this.rotate;
                this.setSamePositionFor(card);
                if (360 < card.rotate)
                    card.rotate -= 360;
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (cards_1_1 && !cards_1_1.done && (_a = cards_1.return)) _a.call(cards_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return cards;
    };
    CardStack.prototype.faceUp = function () {
        if (this.topCard) {
            this.topCard.faceUp();
            this.setSamePositionFor(this.topCard);
        }
    };
    CardStack.prototype.faceDown = function () {
        if (this.topCard) {
            this.topCard.faceDown();
            this.setSamePositionFor(this.topCard);
        }
    };
    CardStack.prototype.faceUpAll = function () {
        var e_4, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.cards), _c = _b.next(); !_c.done; _c = _b.next()) {
                var card = _c.value;
                card.faceUp();
                this.setSamePositionFor(card);
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    CardStack.prototype.faceDownAll = function () {
        var e_5, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.cards), _c = _b.next(); !_c.done; _c = _b.next()) {
                var card = _c.value;
                card.faceDown();
                this.setSamePositionFor(card);
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_5) throw e_5.error; }
        }
    };
    CardStack.prototype.uprightAll = function () {
        var e_6, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.cards), _c = _b.next(); !_c.done; _c = _b.next()) {
                var card = _c.value;
                card.rotate = 0;
                this.setSamePositionFor(card);
            }
        }
        catch (e_6_1) { e_6 = { error: e_6_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_6) throw e_6.error; }
        }
    };
    CardStack.prototype.unifyCardsSize = function (size) {
        var e_7, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.cards), _c = _b.next(); !_c.done; _c = _b.next()) {
                var card = _c.value;
                if (card.size !== size)
                    card.size = size;
            }
        }
        catch (e_7_1) { e_7 = { error: e_7_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_7) throw e_7.error; }
        }
    };
    CardStack.prototype.putOnTop = function (card) {
        if (!this.cardRoot)
            return null;
        if (!this.topCard)
            return this.putOnBottom(card);
        card.owner = '';
        card.zindex = 0;
        var delta = Math.abs(card.rotate - this.rotate);
        if (180 < delta)
            delta = 360 - delta;
        card.rotate = delta <= 90 ? 0 : 180;
        this.setSamePositionFor(card);
        return this.cardRoot.insertBefore(card, this.topCard);
    };
    CardStack.prototype.putOnBottom = function (card) {
        if (!this.cardRoot)
            return null;
        card.owner = '';
        card.zindex = 0;
        var delta = Math.abs(card.rotate - this.rotate);
        if (180 < delta)
            delta = 360 - delta;
        card.rotate = delta <= 90 ? 0 : 180;
        this.setSamePositionFor(card);
        return this.cardRoot.appendChild(card);
    };
    CardStack.prototype.toTopmost = function () {
        Object(_tabletop_object_util__WEBPACK_IMPORTED_MODULE_8__["moveToTopmost"])(this, ['card']);
    };
    // override
    CardStack.prototype.setLocation = function (location) {
        var e_8, _a;
        _super.prototype.setLocation.call(this, location);
        var cards = this.cards;
        try {
            for (var cards_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](cards), cards_2_1 = cards_2.next(); !cards_2_1.done; cards_2_1 = cards_2.next()) {
                var card = cards_2_1.value;
                card.setLocation(location);
            }
        }
        catch (e_8_1) { e_8 = { error: e_8_1 }; }
        finally {
            try {
                if (cards_2_1 && !cards_2_1.done && (_a = cards_2.return)) _a.call(cards_2);
            }
            finally { if (e_8) throw e_8.error; }
        }
    };
    CardStack.prototype.setSamePositionFor = function (card) {
        card.location.name = this.location.name;
        card.location.x = this.location.x;
        card.location.y = this.location.y;
        card.posZ = this.posZ;
    };
    CardStack.create = function (name, identifier) {
        var object = null;
        if (identifier) {
            object = new CardStack_1(identifier);
        }
        else {
            object = new CardStack_1();
        }
        object.createDataElements();
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_5__["DataElement"].create('name', name, {}, 'name_' + object.identifier));
        var cardRoot = new _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__["ObjectNode"]('cardRoot_' + object.identifier);
        cardRoot.setAttribute('name', 'cardRoot');
        cardRoot.initialize();
        object.appendChild(cardRoot);
        object.initialize();
        return object;
    };
    var CardStack_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], CardStack.prototype, "rotate", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], CardStack.prototype, "zindex", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], CardStack.prototype, "owner", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], CardStack.prototype, "isShowTotal", void 0);
    CardStack = CardStack_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncObject"])('card-stack')
    ], CardStack);
    return CardStack;
}(_tabletop_object__WEBPACK_IMPORTED_MODULE_7__["TabletopObject"]));



/***/ }),

/***/ "./src/app/class/card.ts":
/*!*******************************!*\
  !*** ./src/app/class/card.ts ***!
  \*******************************/
/*! exports provided: CardState, Card */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CardState", function() { return CardState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Card", function() { return Card; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _data_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _peer_cursor__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var _tabletop_object__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./tabletop-object */ "./src/app/class/tabletop-object.ts");
/* harmony import */ var _tabletop_object_util__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./tabletop-object-util */ "./src/app/class/tabletop-object-util.ts");







var CardState;
(function (CardState) {
    CardState[CardState["FRONT"] = 0] = "FRONT";
    CardState[CardState["BACK"] = 1] = "BACK";
})(CardState || (CardState = {}));
var Card = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Card, _super);
    function Card() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.state = CardState.FRONT;
        _this.rotate = 0;
        _this.owner = '';
        _this.zindex = 0;
        return _this;
    }
    Card_1 = Card;
    Object.defineProperty(Card.prototype, "name", {
        get: function () { return this.getCommonValue('name', ''); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "size", {
        get: function () { return this.getCommonValue('size', 2); },
        set: function (size) { this.setCommonValue('size', size); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "frontImage", {
        get: function () { return this.getImageFile('front'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "backImage", {
        get: function () { return this.getImageFile('back'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "imageFile", {
        get: function () { return this.isVisible ? this.frontImage : this.backImage; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "ownerName", {
        get: function () {
            var object = _peer_cursor__WEBPACK_IMPORTED_MODULE_4__["PeerCursor"].find(this.owner);
            return object ? object.name : '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "hasOwner", {
        get: function () { return _peer_cursor__WEBPACK_IMPORTED_MODULE_4__["PeerCursor"].find(this.owner) != null; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "isHand", {
        get: function () { return _core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerId === this.owner; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "isFront", {
        get: function () { return this.state === CardState.FRONT; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Card.prototype, "isVisible", {
        get: function () { return this.isHand || this.isFront; },
        enumerable: true,
        configurable: true
    });
    Card.prototype.faceUp = function () {
        this.state = CardState.FRONT;
        this.owner = '';
    };
    Card.prototype.faceDown = function () {
        this.state = CardState.BACK;
        this.owner = '';
    };
    Card.prototype.toTopmost = function () {
        Object(_tabletop_object_util__WEBPACK_IMPORTED_MODULE_6__["moveToTopmost"])(this, ['card-stack']);
    };
    Card.create = function (name, fornt, back, size, identifier) {
        if (size === void 0) { size = 2; }
        var object = null;
        if (identifier) {
            object = new Card_1(identifier);
        }
        else {
            object = new Card_1();
        }
        object.createDataElements();
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('name', name, {}, 'name_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('size', size, {}, 'size_' + object.identifier));
        object.imageDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('front', fornt, { type: 'image' }, 'front_' + object.identifier));
        object.imageDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('back', back, { type: 'image' }, 'back_' + object.identifier));
        object.initialize();
        return object;
    };
    var Card_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], Card.prototype, "state", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], Card.prototype, "rotate", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], Card.prototype, "owner", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], Card.prototype, "zindex", void 0);
    Card = Card_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('card')
    ], Card);
    return Card;
}(_tabletop_object__WEBPACK_IMPORTED_MODULE_5__["TabletopObject"]));



/***/ }),

/***/ "./src/app/class/chat-message.ts":
/*!***************************************!*\
  !*** ./src/app/class/chat-message.ts ***!
  \***************************************/
/*! exports provided: ChatMessage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatMessage", function() { return ChatMessage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");





var ChatMessage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ChatMessage, _super);
    function ChatMessage() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._sendTo = [];
        _this._tags = [];
        return _this;
    }
    Object.defineProperty(ChatMessage.prototype, "tabIdentifier", {
        get: function () { return this.parent.identifier; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "text", {
        get: function () { return this.value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "timestamp", {
        get: function () {
            var timestamp = this.getAttribute('timestamp');
            var num = timestamp ? +timestamp : 0;
            return Number.isNaN(num) ? 1 : num;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "sendTo", {
        get: function () {
            if (this._to !== this.to) {
                this._to = this.to;
                this._sendTo = this.to != null && 0 < this.to.trim().length ? this.to.trim().split(/\s+/) : [];
            }
            return this._sendTo;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "tags", {
        get: function () {
            if (this._tag !== this.tag) {
                this._tag = this.tag;
                this._tags = this.tag != null && 0 < this.tag.trim().length ? this.tag.trim().split(/\s+/) : [];
            }
            return this._tags;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "image", {
        get: function () { return _core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_1__["ImageStorage"].instance.get(this.imageIdentifier); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "index", {
        get: function () { return this.minorIndex + this.timestamp; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "isDirect", {
        get: function () { return 0 < this.sendTo.length ? true : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "isSendFromSelf", {
        get: function () { return this.from === _core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.id || this.originFrom === _core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.id; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "isRelatedToMe", {
        get: function () { return (-1 < this.sendTo.indexOf(_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.id)) || this.isSendFromSelf ? true : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "isDisplayable", {
        get: function () { return this.isDirect ? this.isRelatedToMe : true; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "isSystem", {
        get: function () { return -1 < this.tags.indexOf('system') ? true : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "isDicebot", {
        get: function () { return this.isSystem && this.from === 'System-BCDice' ? true : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatMessage.prototype, "isSecret", {
        get: function () { return -1 < this.tags.indexOf('secret') ? true : false; },
        enumerable: true,
        configurable: true
    });
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], ChatMessage.prototype, "originFrom", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], ChatMessage.prototype, "from", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], ChatMessage.prototype, "to", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], ChatMessage.prototype, "name", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], ChatMessage.prototype, "tag", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], ChatMessage.prototype, "dicebot", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], ChatMessage.prototype, "imageIdentifier", void 0);
    ChatMessage = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncObject"])('chat')
    ], ChatMessage);
    return ChatMessage;
}(_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__["ObjectNode"]));



/***/ }),

/***/ "./src/app/class/chat-palette.ts":
/*!***************************************!*\
  !*** ./src/app/class/chat-palette.ts ***!
  \***************************************/
/*! exports provided: ChatPalette */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatPalette", function() { return ChatPalette; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _core_system_util_string_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/system/util/string-util */ "./src/app/class/core/system/util/string-util.ts");




var ChatPalette = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ChatPalette, _super);
    function ChatPalette() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.dicebot = '';
        _this._palettes = [];
        _this._paletteLines = [];
        _this._paletteVariables = [];
        _this.isAnalized = false;
        return _this;
    }
    Object.defineProperty(ChatPalette.prototype, "paletteLines", {
        //TODO: キャラシ項目のコピー
        get: function () {
            if (!this.isAnalized)
                this.parse(this.value);
            return this._paletteLines;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatPalette.prototype, "paletteVariables", {
        get: function () {
            if (!this.isAnalized)
                this.parse(this.value);
            return this._paletteVariables;
        },
        enumerable: true,
        configurable: true
    });
    ChatPalette.prototype.getPalette = function () {
        if (!this.isAnalized)
            this.parse(this.value);
        return this._palettes;
    };
    ChatPalette.prototype.setPalette = function (paletteSource) {
        this.value = paletteSource;
        this.isAnalized = false;
    };
    ChatPalette.prototype.evaluate = function (line, extendVariables) {
        var _this = this;
        var evaluate = '';
        if (typeof line === 'string') {
            evaluate = line;
        }
        else {
            evaluate = line.palette;
        }
        evaluate = _core_system_util_string_util__WEBPACK_IMPORTED_MODULE_3__["StringUtil"].toHalfWidth(evaluate);
        console.log(evaluate);
        var limit = 128;
        var loop = 0;
        var isContinue = true;
        while (isContinue) {
            loop++;
            isContinue = false;
            evaluate = evaluate.replace(/\{\s*([^\{\}]+)\s*\}/g, function (match, name) {
                var e_1, _a;
                console.log(name);
                isContinue = true;
                try {
                    for (var _b = (e_1 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](_this.paletteVariables)), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var variable = _c.value;
                        if (variable.name == name)
                            return variable.value;
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                if (extendVariables) {
                    var element = extendVariables.getFirstElementByName(name);
                    if (element)
                        return element.isNumberResource ? element.currentValue + '' : element.value + '';
                }
                return '';
            });
            if (limit < loop)
                isContinue = false;
        }
        return evaluate;
    };
    ChatPalette.prototype.parse = function (paletteSource) {
        var e_2, _a;
        this._palettes = paletteSource.split('\n');
        this._paletteLines = [];
        this._paletteVariables = [];
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this._palettes), _c = _b.next(); !_c.done; _c = _b.next()) {
                var palette = _c.value;
                var variable = this.parseVariable(palette);
                if (variable) {
                    this._paletteVariables.push(variable);
                    continue;
                }
                var line = { palette: palette };
                this._paletteLines.push(line);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this.isAnalized = true;
    };
    ChatPalette.prototype.parseVariable = function (palette) {
        palette = _core_system_util_string_util__WEBPACK_IMPORTED_MODULE_3__["StringUtil"].toHalfWidth(palette);
        var array = /^\s*\/\/([^=\{\}\s]+)\s*=\s*(.+)\s*/gi.exec(palette);
        if (!array)
            return null;
        var variable = {
            name: array[1],
            value: array[2]
        };
        return variable;
    };
    // override
    ChatPalette.prototype.apply = function (context) {
        _super.prototype.apply.call(this, context);
        this.isAnalized = false;
    };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], ChatPalette.prototype, "dicebot", void 0);
    ChatPalette = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('chat-palette')
    ], ChatPalette);
    return ChatPalette;
}(_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__["ObjectNode"]));



/***/ }),

/***/ "./src/app/class/chat-tab-list.ts":
/*!****************************************!*\
  !*** ./src/app/class/chat-tab-list.ts ***!
  \****************************************/
/*! exports provided: ChatTabList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatTabList", function() { return ChatTabList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _chat_tab__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chat-tab */ "./src/app/class/chat-tab.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");





var ChatTabList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ChatTabList, _super);
    function ChatTabList() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    // GameObject Lifecycle
    ChatTabList.prototype.onStoreAdded = function () {
        _super.prototype.onStoreAdded.call(this);
        _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.remove(this); // ObjectStoreには登録しない
    };
    ChatTabList.prototype.innerXml = function () {
        var e_1, _a;
        var xml = '';
        var gameObjects = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.getObjects(_chat_tab__WEBPACK_IMPORTED_MODULE_1__["ChatTab"]);
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](gameObjects.concat()), _c = _b.next(); !_c.done; _c = _b.next()) {
                var gameObject = _c.value;
                xml += gameObject.toXml();
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return xml;
    };
    ChatTabList.prototype.parseInnerXml = function (element) {
        var e_2, _a;
        var gameObjects = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.getObjects(_chat_tab__WEBPACK_IMPORTED_MODULE_1__["ChatTab"]);
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](gameObjects.concat()), _c = _b.next(); !_c.done; _c = _b.next()) {
                var gameObject = _c.value;
                gameObject.destroy();
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        _super.prototype.parseInnerXml.call(this, element);
    };
    ChatTabList = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncObject"])('chat-tab-list')
    ], ChatTabList);
    return ChatTabList;
}(_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__["ObjectNode"]));



/***/ }),

/***/ "./src/app/class/chat-tab.ts":
/*!***********************************!*\
  !*** ./src/app/class/chat-tab.ts ***!
  \***********************************/
/*! exports provided: ChatTab */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatTab", function() { return ChatTab; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _chat_message__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chat-message */ "./src/app/class/chat-message.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/synchronize-object/object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");






var ChatTab = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ChatTab, _super);
    function ChatTab() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.name = 'タブ';
        _this._unreadLength = 0;
        return _this;
    }
    Object.defineProperty(ChatTab.prototype, "chatMessages", {
        get: function () { return this.children; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatTab.prototype, "unreadLength", {
        get: function () { return this._unreadLength; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatTab.prototype, "hasUnread", {
        get: function () { return 0 < this.unreadLength; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatTab.prototype, "latestTimeStamp", {
        get: function () {
            var lastIndex = this.chatMessages.length - 1;
            return lastIndex < 0 ? 0 : this.chatMessages[lastIndex].timestamp;
        },
        enumerable: true,
        configurable: true
    });
    // ObjectNode Lifecycle
    ChatTab.prototype.onChildAdded = function (child) {
        _super.prototype.onChildAdded.call(this, child);
        if (child.parent === this && child instanceof _chat_message__WEBPACK_IMPORTED_MODULE_1__["ChatMessage"] && child.isDisplayable) {
            this._unreadLength++;
            _core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].trigger('MESSAGE_ADDED', { tabIdentifier: this.identifier, messageIdentifier: child.identifier });
        }
    };
    ChatTab.prototype.addMessage = function (message) {
        message.tabIdentifier = this.identifier;
        var chat = new _chat_message__WEBPACK_IMPORTED_MODULE_1__["ChatMessage"]();
        for (var key in message) {
            if (key === 'identifier')
                continue;
            if (key === 'tabIdentifier')
                continue;
            if (key === 'text') {
                chat.value = message[key];
                continue;
            }
            if (message[key] == null || message[key] === '')
                continue;
            chat.setAttribute(key, message[key]);
        }
        chat.initialize();
        _core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].trigger('SEND_MESSAGE', { tabIdentifier: this.identifier, messageIdentifier: chat.identifier });
        this.appendChild(chat);
        return chat;
    };
    ChatTab.prototype.markForRead = function () {
        this._unreadLength = 0;
    };
    ChatTab.prototype.innerXml = function () {
        var e_1, _a;
        var xml = '';
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                if (child instanceof _chat_message__WEBPACK_IMPORTED_MODULE_1__["ChatMessage"] && !child.isDisplayable)
                    continue;
                xml += _core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_4__["ObjectSerializer"].instance.toXml(child);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return xml;
    };
    ;
    ChatTab.prototype.parseInnerXml = function (element) {
        return _super.prototype.parseInnerXml.call(this, element);
    };
    ;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], ChatTab.prototype, "name", void 0);
    ChatTab = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncObject"])('chat-tab')
    ], ChatTab);
    return ChatTab;
}(_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__["ObjectNode"]));



/***/ }),

/***/ "./src/app/class/core/file-storage/audio-file.ts":
/*!*******************************************************!*\
  !*** ./src/app/class/core/file-storage/audio-file.ts ***!
  \*******************************************************/
/*! exports provided: AudioState, AudioFile */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AudioState", function() { return AudioState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AudioFile", function() { return AudioFile; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _file_reader_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./file-reader-util */ "./src/app/class/core/file-storage/file-reader-util.ts");


var AudioState;
(function (AudioState) {
    AudioState[AudioState["NULL"] = 0] = "NULL";
    AudioState[AudioState["THUMBNAIL"] = 1] = "THUMBNAIL";
    AudioState[AudioState["COMPLETE"] = 2] = "COMPLETE";
    AudioState[AudioState["URL"] = 1000] = "URL";
})(AudioState || (AudioState = {}));
var AudioFile = /** @class */ (function () {
    function AudioFile() {
        this.context = {
            identifier: '',
            name: '',
            blob: null,
            type: '',
            url: ''
        };
        this.isHidden = false;
    }
    Object.defineProperty(AudioFile.prototype, "identifier", {
        get: function () { return this.context.identifier; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(AudioFile.prototype, "name", {
        get: function () { return this.context.name; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(AudioFile.prototype, "blob", {
        get: function () { return this.context.blob; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(AudioFile.prototype, "url", {
        get: function () { return this.context.url; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(AudioFile.prototype, "isReady", {
        get: function () { return AudioState.NULL < this.state; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioFile.prototype, "state", {
        get: function () {
            if (!this.url && !this.blob)
                return AudioState.NULL;
            if (this.url && !this.blob)
                return AudioState.URL;
            return AudioState.COMPLETE;
        },
        enumerable: true,
        configurable: true
    });
    AudioFile.createEmpty = function (identifier) {
        var audio = new AudioFile();
        audio.context.identifier = identifier;
        return audio;
    };
    AudioFile.create = function (arg) {
        if (typeof arg === 'string') {
            var audio = new AudioFile();
            audio.context.identifier = arg;
            audio.context.name = arg;
            audio.context.url = arg;
            return audio;
        }
        else {
            var audio = new AudioFile();
            audio.apply(arg);
            return audio;
        }
    };
    AudioFile.createAsync = function (arg) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(arg instanceof File)) return [3 /*break*/, 2];
                        return [4 /*yield*/, AudioFile._createAsync(arg, arg.name)];
                    case 1: return [2 /*return*/, _a.sent()];
                    case 2:
                        if (!(arg instanceof Blob)) return [3 /*break*/, 4];
                        return [4 /*yield*/, AudioFile._createAsync(arg)];
                    case 3: return [2 /*return*/, _a.sent()];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    AudioFile._createAsync = function (blob, name) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var arrayBuffer, audio, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_1__["FileReaderUtil"].readAsArrayBufferAsync(blob)];
                    case 1:
                        arrayBuffer = _b.sent();
                        audio = new AudioFile();
                        _a = audio.context;
                        return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_1__["FileReaderUtil"].calcSHA256Async(arrayBuffer)];
                    case 2:
                        _a.identifier = _b.sent();
                        audio.context.name = name;
                        audio.context.blob = new Blob([arrayBuffer], { type: blob.type });
                        audio.context.type = audio.context.blob.type;
                        audio.context.url = window.URL.createObjectURL(audio.context.blob);
                        if (!audio.context.name)
                            audio.context.name = audio.context.identifier;
                        return [2 /*return*/, audio];
                }
            });
        });
    };
    AudioFile.prototype.destroy = function () {
        this.revokeURLs();
    };
    AudioFile.prototype.apply = function (context) {
        if (!this.context.identifier && context.identifier)
            this.context.identifier = context.identifier;
        if (context.name)
            this.context.name = context.name;
        if (!this.context.blob && context.blob)
            this.context.blob = context.blob;
        if (!this.context.type && context.type)
            this.context.type = context.type;
        if (!this.context.url && context.url) {
            if (this.state !== AudioState.URL)
                window.URL.revokeObjectURL(this.context.url);
            this.context.url = context.url;
        }
        this.createURLs();
    };
    AudioFile.prototype.createURLs = function () {
        if (this.state === AudioState.URL)
            return;
        if (this.context.blob && this.context.url === '')
            this.context.url = window.URL.createObjectURL(this.context.blob);
    };
    AudioFile.prototype.revokeURLs = function () {
        if (this.state === AudioState.URL)
            return;
        window.URL.revokeObjectURL(this.context.url);
    };
    AudioFile.prototype.toContext = function () {
        return {
            identifier: this.context.identifier,
            name: this.context.name,
            blob: this.context.blob,
            type: this.context.type,
            url: this.context.url
        };
    };
    return AudioFile;
}());



/***/ }),

/***/ "./src/app/class/core/file-storage/audio-player.ts":
/*!*********************************************************!*\
  !*** ./src/app/class/core/file-storage/audio-player.ts ***!
  \*********************************************************/
/*! exports provided: VolumeType, AudioPlayer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VolumeType", function() { return VolumeType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AudioPlayer", function() { return AudioPlayer; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _audio_file__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./audio-file */ "./src/app/class/core/file-storage/audio-file.ts");
/* harmony import */ var _file_reader_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./file-reader-util */ "./src/app/class/core/file-storage/file-reader-util.ts");



var VolumeType;
(function (VolumeType) {
    VolumeType[VolumeType["MASTER"] = 0] = "MASTER";
    VolumeType[VolumeType["AUDITION"] = 1] = "AUDITION";
})(VolumeType || (VolumeType = {}));
var AudioPlayer = /** @class */ (function () {
    function AudioPlayer(audio) {
        this.volumeType = VolumeType.MASTER;
        this.audio = audio;
    }
    Object.defineProperty(AudioPlayer, "audioContext", {
        get: function () {
            if (!AudioPlayer._audioContext)
                AudioPlayer._audioContext = new (window.AudioContext || window.webkitAudioContext)();
            return AudioPlayer._audioContext;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer, "volume", {
        get: function () { return AudioPlayer._volume; },
        set: function (volume) {
            AudioPlayer._volume = volume;
            AudioPlayer.masterGainNode.gain.setTargetAtTime(AudioPlayer._volume, AudioPlayer.audioContext.currentTime, 0.01);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer, "auditionVolume", {
        get: function () { return AudioPlayer._auditionVolume; },
        set: function (auditionVolume) {
            AudioPlayer._auditionVolume = auditionVolume;
            AudioPlayer.auditionGainNode.gain.setTargetAtTime(AudioPlayer._auditionVolume, AudioPlayer.audioContext.currentTime, 0.01);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer, "masterGainNode", {
        get: function () {
            if (!AudioPlayer._masterGainNode) {
                var masterGain = AudioPlayer.audioContext.createGain();
                masterGain.gain.setValueAtTime(AudioPlayer._volume, AudioPlayer.audioContext.currentTime);
                masterGain.connect(AudioPlayer.audioContext.destination);
                AudioPlayer._masterGainNode = masterGain;
            }
            return AudioPlayer._masterGainNode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer, "auditionGainNode", {
        get: function () {
            if (!AudioPlayer._auditionGainNode) {
                var auditionGain = AudioPlayer.audioContext.createGain();
                auditionGain.gain.setValueAtTime(AudioPlayer._auditionVolume, AudioPlayer.audioContext.currentTime);
                auditionGain.connect(AudioPlayer.audioContext.destination);
                AudioPlayer._auditionGainNode = auditionGain;
            }
            return AudioPlayer._auditionGainNode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer, "rootNode", {
        get: function () { return AudioPlayer.masterGainNode; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer, "auditionNode", {
        get: function () { return AudioPlayer.auditionGainNode; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer.prototype, "audioElm", {
        get: function () {
            var _this = this;
            if (!this._audioElm) {
                this._audioElm = new Audio();
                this._audioElm.onplay = function () { };
                this._audioElm.onpause = function () { _this.mediaElementSource.disconnect(); };
                this._audioElm.onended = function () { _this.mediaElementSource.disconnect(); };
            }
            return this._audioElm;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer.prototype, "mediaElementSource", {
        get: function () {
            if (!this._mediaElementSource)
                this._mediaElementSource = AudioPlayer.audioContext.createMediaElementSource(this.audioElm);
            return this._mediaElementSource;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer.prototype, "volume", {
        get: function () { return this.audioElm.volume; },
        set: function (volume) { this.audioElm.volume = volume; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer.prototype, "loop", {
        get: function () { return this.audioElm.loop; },
        set: function (loop) { this.audioElm.loop = loop; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioPlayer.prototype, "paused", {
        get: function () { return this.audioElm.paused; },
        enumerable: true,
        configurable: true
    });
    AudioPlayer.play = function (audio, volume) {
        if (volume === void 0) { volume = 1.0; }
        this.playBufferAsync(audio, volume);
    };
    AudioPlayer.prototype.play = function (audio) {
        if (audio === void 0) { audio = this.audio; }
        this.stop();
        this.audio = audio;
        if (!this.audio)
            return;
        var url = this.audio.url;
        if (audio.state === _audio_file__WEBPACK_IMPORTED_MODULE_1__["AudioState"].URL) {
            if (AudioPlayer.cacheMap.has(audio.identifier)) {
                url = AudioPlayer.cacheMap.get(audio.identifier).url;
            }
            else {
                AudioPlayer.createCacheAsync(audio);
            }
        }
        this.mediaElementSource.connect(this.getConnectingAudioNode());
        this.audioElm.src = url;
        this.audioElm.load();
        this.audioElm.play().catch(function (reason) { console.warn(reason); });
    };
    AudioPlayer.prototype.pause = function () {
        this.audioElm.pause();
    };
    AudioPlayer.prototype.stop = function () {
        if (!this.audioElm)
            return;
        this.pause();
        this.audioElm.currentTime = 0;
        this.audioElm.src = '';
        this.audioElm.load();
        this.mediaElementSource.disconnect();
    };
    AudioPlayer.prototype.getConnectingAudioNode = function () {
        switch (this.volumeType) {
            case VolumeType.AUDITION:
                return AudioPlayer.auditionNode;
            default:
                return AudioPlayer.rootNode;
        }
    };
    AudioPlayer.playBufferAsync = function (audio, volume) {
        if (volume === void 0) { volume = 1.0; }
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var source, gain;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, AudioPlayer.createBufferSourceAsync(audio)];
                    case 1:
                        source = _a.sent();
                        if (!source)
                            return [2 /*return*/];
                        gain = AudioPlayer.audioContext.createGain();
                        gain.gain.setValueAtTime(volume, AudioPlayer.audioContext.currentTime);
                        gain.connect(AudioPlayer.rootNode);
                        source.connect(gain);
                        source.onended = function () {
                            source.stop();
                            source.disconnect();
                            gain.disconnect();
                            source.buffer = null;
                        };
                        source.start();
                        return [2 /*return*/];
                }
            });
        });
    };
    AudioPlayer.createBufferSourceAsync = function (audio) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var blob, cache, decodedData, source, reason_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!audio)
                            return [2 /*return*/, null];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, , 7]);
                        blob = audio.blob;
                        if (!(audio.state === _audio_file__WEBPACK_IMPORTED_MODULE_1__["AudioState"].URL)) return [3 /*break*/, 4];
                        if (!AudioPlayer.cacheMap.has(audio.identifier)) return [3 /*break*/, 2];
                        blob = AudioPlayer.cacheMap.get(audio.identifier).blob;
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, AudioPlayer.createCacheAsync(audio)];
                    case 3:
                        cache = _a.sent();
                        blob = cache && cache.blob ? cache.blob : null;
                        _a.label = 4;
                    case 4:
                        if (!blob)
                            return [2 /*return*/, null];
                        return [4 /*yield*/, this.decodeAudioDataAsync(blob)];
                    case 5:
                        decodedData = _a.sent();
                        source = AudioPlayer.audioContext.createBufferSource();
                        source.buffer = decodedData;
                        return [2 /*return*/, source];
                    case 6:
                        reason_1 = _a.sent();
                        console.warn(reason_1);
                        return [2 /*return*/, null];
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    AudioPlayer.decodeAudioDataAsync = function (blob) {
        var _this = this;
        return new Promise(function (resolve, reject) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
            var _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _b = (_a = AudioPlayer.audioContext).decodeAudioData;
                        return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_2__["FileReaderUtil"].readAsArrayBufferAsync(blob)];
                    case 1:
                        _b.apply(_a, [_c.sent(),
                            function (decodedData) { return resolve(decodedData); },
                            function (error) { return reject(error); }]);
                        return [2 /*return*/];
                }
            });
        }); });
    };
    AudioPlayer.getBlobAsync = function (audio) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var response, blob, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (audio.blob)
                            return [2 /*return*/, audio.blob];
                        if (audio.url.length < 1)
                            throw new Error('えっ なにそれ怖い');
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 4, , 5]);
                        return [4 /*yield*/, fetch(audio.url)];
                    case 2:
                        response = _a.sent();
                        if (!response.ok)
                            throw new Error('Network response was not ok.');
                        return [4 /*yield*/, response.blob()];
                    case 3:
                        blob = _a.sent();
                        return [2 /*return*/, blob];
                    case 4:
                        error_1 = _a.sent();
                        console.warn('There has been a problem with your fetch operation: ', error_1.message);
                        throw error_1;
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    AudioPlayer.createCacheAsync = function (audio) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var cache, _a, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        cache = { url: audio.url, blob: null };
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 3, , 4]);
                        _a = cache;
                        return [4 /*yield*/, AudioPlayer.getBlobAsync(audio)];
                    case 2:
                        _a.blob = _b.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        e_1 = _b.sent();
                        console.error(e_1);
                        return [2 /*return*/, cache];
                    case 4:
                        if (AudioPlayer.cacheMap.has(audio.identifier)) {
                            return [2 /*return*/, AudioPlayer.cacheMap.get(audio.identifier)];
                        }
                        cache.url = URL.createObjectURL(cache.blob);
                        AudioPlayer.cacheMap.set(audio.identifier, cache);
                        return [2 /*return*/, cache];
                }
            });
        });
    };
    AudioPlayer.resumeAudioContext = function () {
        AudioPlayer.audioContext.resume();
        var callback = function () {
            AudioPlayer.audioContext.resume();
            document.removeEventListener('touchstart', callback, true);
            document.removeEventListener('mousedown', callback, true);
            console.log('resumeAudioContext');
        };
        document.addEventListener('touchstart', callback, true);
        document.addEventListener('mousedown', callback, true);
    };
    AudioPlayer._volume = 0.5;
    AudioPlayer._auditionVolume = 0.5;
    AudioPlayer.cacheMap = new Map();
    return AudioPlayer;
}());



/***/ }),

/***/ "./src/app/class/core/file-storage/audio-sharing-system.ts":
/*!*****************************************************************!*\
  !*** ./src/app/class/core/file-storage/audio-sharing-system.ts ***!
  \*****************************************************************/
/*! exports provided: AudioSharingSystem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AudioSharingSystem", function() { return AudioSharingSystem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _audio_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./audio-file */ "./src/app/class/core/file-storage/audio-file.ts");
/* harmony import */ var _audio_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./audio-storage */ "./src/app/class/core/file-storage/audio-storage.ts");
/* harmony import */ var _buffer_sharing_task__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./buffer-sharing-task */ "./src/app/class/core/file-storage/buffer-sharing-task.ts");
/* harmony import */ var _file_reader_util__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./file-reader-util */ "./src/app/class/core/file-storage/file-reader-util.ts");






var AudioSharingSystem = /** @class */ (function () {
    function AudioSharingSystem() {
        this.taskMap = new Map();
        this.maxTransmission = 1;
    }
    Object.defineProperty(AudioSharingSystem, "instance", {
        get: function () {
            if (!AudioSharingSystem._instance)
                AudioSharingSystem._instance = new AudioSharingSystem();
            return AudioSharingSystem._instance;
        },
        enumerable: true,
        configurable: true
    });
    AudioSharingSystem.prototype.initialize = function () {
        var _this = this;
        console.log('AudioSharingSystem ready...');
        this.destroy();
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].register(this)
            .on('CONNECT_PEER', -1, function (event) {
            if (!event.isSendFromSelf)
                return;
            console.log('CONNECT_PEER AudioStorageService !!!', event.data.peer);
            _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.synchronize();
        })
            .on('SYNCHRONIZE_AUDIO_LIST', function (event) {
            var e_1, _a;
            if (event.isSendFromSelf)
                return;
            console.log('SYNCHRONIZE_AUDIO_LIST ' + event.sendFrom);
            var otherCatalog = event.data;
            var request = [];
            console.log('SYNCHRONIZE_AUDIO_LIST active tasks ', _this.taskMap.size);
            try {
                for (var otherCatalog_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](otherCatalog), otherCatalog_1_1 = otherCatalog_1.next(); !otherCatalog_1_1.done; otherCatalog_1_1 = otherCatalog_1.next()) {
                    var item = otherCatalog_1_1.value;
                    var audio = _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.get(item.identifier);
                    if (audio === null) {
                        audio = _audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioFile"].createEmpty(item.identifier);
                        _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.add(audio);
                    }
                    if (audio.state < _audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioState"].COMPLETE && !_this.taskMap.has[item.identifier]) {
                        request.push({ identifier: item.identifier, state: audio.state });
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (otherCatalog_1_1 && !otherCatalog_1_1.done && (_a = otherCatalog_1.return)) _a.call(otherCatalog_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (request.length < 1 && otherCatalog.length < _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.getCatalog().length) {
                _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.synchronize(event.sendFrom);
            }
            if (request.length < 1 || _this.isTransmission()) {
                return;
            }
            var index = Math.floor(Math.random() * request.length);
            _this.request([request[index]], event.sendFrom);
        })
            .on('REQUEST_AUDIO_RESOURE', function (event) {
            var e_2, _a, e_3, _b;
            if (event.isSendFromSelf)
                return;
            var request = event.data.identifiers;
            var randomRequest = [];
            try {
                for (var request_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](request), request_1_1 = request_1.next(); !request_1_1.done; request_1_1 = request_1.next()) {
                    var item = request_1_1.value;
                    var audio = _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.get(item.identifier);
                    if (item.state < audio.state)
                        randomRequest.push({ identifier: item.identifier, state: item.state });
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (request_1_1 && !request_1_1.done && (_a = request_1.return)) _a.call(request_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
            if (_this.isTransmission() === false && 0 < randomRequest.length) {
                // 送信
                console.log('REQUEST_AUDIO_RESOURE Send!!! ' + event.data.receiver + ' -> ' + randomRequest);
                var index = Math.floor(Math.random() * randomRequest.length);
                var item = randomRequest[index];
                var audio = _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.get(item.identifier);
                _this.startSendTransmission(audio, event.data.receiver);
            }
            else {
                // 中継
                var candidatePeers = event.data.candidatePeers;
                var index = candidatePeers.indexOf(_system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerId);
                if (-1 < index)
                    candidatePeers.splice(index, 1);
                try {
                    for (var candidatePeers_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](candidatePeers), candidatePeers_1_1 = candidatePeers_1.next(); !candidatePeers_1_1.done; candidatePeers_1_1 = candidatePeers_1.next()) {
                        var peer = candidatePeers_1_1.value;
                        console.log('REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! ' + peer + ' -> ' + event.data.identifiers);
                        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call(event, peer);
                        return;
                    }
                }
                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                finally {
                    try {
                        if (candidatePeers_1_1 && !candidatePeers_1_1.done && (_b = candidatePeers_1.return)) _b.call(candidatePeers_1);
                    }
                    finally { if (e_3) throw e_3.error; }
                }
                console.log('REQUEST_FILE_RESOURE ImageStorageService あぶれた...' + event.data.receiver, randomRequest.length, _this.taskMap);
            }
        })
            .on('STOP_AUDIO_TRANSMISSION', function (event) {
            var identifier = event.data.identifier;
            _this.stopTransmission(identifier);
            _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.synchronize();
            console.log('STOP_AUDIO_TRANSMISSION ' + identifier, _this.taskMap.size);
        })
            .on('UPDATE_AUDIO_RESOURE', function (event) {
            var e_4, _a;
            var updateAudios = event.data;
            console.log('UPDATE_AUDIO_RESOURE AudioStorageService ' + event.sendFrom + ' -> ', updateAudios);
            try {
                for (var updateAudios_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updateAudios), updateAudios_1_1 = updateAudios_1.next(); !updateAudios_1_1.done; updateAudios_1_1 = updateAudios_1.next()) {
                    var context = updateAudios_1_1.value;
                    if (context.blob)
                        context.blob = new Blob([context.blob], { type: context.type });
                    _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.add(context);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (updateAudios_1_1 && !updateAudios_1_1.done && (_a = updateAudios_1.return)) _a.call(updateAudios_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        })
            .on('START_AUDIO_TRANSMISSION', function (event) {
            console.log('START_AUDIO_TRANSMISSION ' + event.data.fileIdentifier, _this.isTransmission());
            var identifier = event.data.fileIdentifier;
            if (_this.isTransmission() || _this.taskMap.has(identifier)) {
                _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('STOP_AUDIO_TRANSMISSION', { identifier: identifier }, event.sendFrom);
            }
            else {
                _this.startReceiveTransmission(identifier);
            }
        });
    };
    AudioSharingSystem.prototype.destroy = function () {
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].unregister(this);
    };
    AudioSharingSystem.prototype.startSendTransmission = function (audio, sendTo) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var context, _a, task;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        this.taskMap.set(audio.identifier, null);
                        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('START_AUDIO_TRANSMISSION', { fileIdentifier: audio.identifier }, sendTo);
                        context = {
                            identifier: audio.identifier,
                            name: audio.name,
                            blob: null,
                            type: '',
                            url: null
                        };
                        if (!(audio.state === _audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioState"].URL)) return [3 /*break*/, 1];
                        context.url = audio.url;
                        return [3 /*break*/, 3];
                    case 1:
                        _a = context;
                        return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_5__["FileReaderUtil"].readAsArrayBufferAsync(audio.blob)];
                    case 2:
                        _a.blob = (_b.sent());
                        context.type = audio.blob.type;
                        _b.label = 3;
                    case 3: return [4 /*yield*/, _buffer_sharing_task__WEBPACK_IMPORTED_MODULE_4__["BufferSharingTask"].createSendTask(context, sendTo, audio.identifier)];
                    case 4:
                        task = _b.sent();
                        this.taskMap.set(audio.identifier, task);
                        task.onfinish = function () {
                            _this.stopTransmission(task.identifier);
                            _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.synchronize();
                        };
                        task.ontimeout = function () {
                            _this.stopTransmission(task.identifier);
                            _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.synchronize();
                        };
                        return [2 /*return*/];
                }
            });
        });
    };
    AudioSharingSystem.prototype.startReceiveTransmission = function (identifier) {
        var _this = this;
        this.stopTransmission(identifier);
        if (this.taskMap.has(identifier))
            return;
        var audio = _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.get(identifier);
        var task = _buffer_sharing_task__WEBPACK_IMPORTED_MODULE_4__["BufferSharingTask"].createReceiveTask(identifier);
        this.taskMap.set(identifier, task);
        task.onprogress = function (task, loded, total) {
            var context = audio.toContext();
            context.name = (loded * 100 / total).toFixed(1) + '%';
            audio.apply(context);
        };
        task.onfinish = function (task, data) {
            _this.stopTransmission(task.identifier);
            _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].trigger('UPDATE_AUDIO_RESOURE', [data]);
            _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.synchronize();
        };
        task.ontimeout = function () {
            _this.stopTransmission(task.identifier);
            _audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.synchronize();
        };
        console.log('startFileTransmission => ', this.taskMap.size);
    };
    AudioSharingSystem.prototype.stopTransmission = function (identifier) {
        var task = this.taskMap.get(identifier);
        if (task) {
            task.cancel();
        }
        this.taskMap.delete(identifier);
        console.log('stopFileTransmission => ', this.taskMap.size);
    };
    AudioSharingSystem.prototype.request = function (request, peer) {
        console.log('requestFile() ' + peer);
        var peers = _system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerIds;
        peers.splice(peers.indexOf(_system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerId), 1);
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('REQUEST_AUDIO_RESOURE', { identifiers: request, receiver: _system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerId, candidatePeers: peers }, peer);
    };
    AudioSharingSystem.prototype.isTransmission = function () {
        if (this.maxTransmission <= this.taskMap.size) {
            return true;
        }
        else {
            return false;
        }
    };
    return AudioSharingSystem;
}());



/***/ }),

/***/ "./src/app/class/core/file-storage/audio-storage.ts":
/*!**********************************************************!*\
  !*** ./src/app/class/core/file-storage/audio-storage.ts ***!
  \**********************************************************/
/*! exports provided: AudioStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AudioStorage", function() { return AudioStorage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _audio_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./audio-file */ "./src/app/class/core/file-storage/audio-file.ts");



var AudioStorage = /** @class */ (function () {
    function AudioStorage() {
        this.hash = {};
        console.log('AudioStorage ready...');
    }
    Object.defineProperty(AudioStorage, "instance", {
        get: function () {
            if (!AudioStorage._instance)
                AudioStorage._instance = new AudioStorage();
            return AudioStorage._instance;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioStorage.prototype, "audios", {
        get: function () {
            var audios = [];
            for (var identifier in this.hash) {
                audios.push(this.hash[identifier]);
            }
            return audios;
        },
        enumerable: true,
        configurable: true
    });
    AudioStorage.prototype.destroy = function () {
        for (var identifier in this.hash) {
            this.delete(identifier);
        }
    };
    AudioStorage.prototype.addAsync = function (arg) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var audio;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioFile"].createAsync(arg)];
                    case 1:
                        audio = _a.sent();
                        return [2 /*return*/, this._add(audio)];
                }
            });
        });
    };
    AudioStorage.prototype.add = function (arg) {
        var audio;
        if (typeof arg === 'string') {
            audio = _audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioFile"].create(arg);
        }
        else if (arg instanceof _audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioFile"]) {
            audio = arg;
        }
        else {
            if (this.update(arg))
                return this.hash[arg.identifier];
            audio = _audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioFile"].create(arg);
        }
        return this._add(audio);
    };
    AudioStorage.prototype._add = function (audio) {
        this.lazySynchronize(100);
        if (this.update(audio))
            return this.hash[audio.identifier];
        this.hash[audio.identifier] = audio;
        console.log('addNewFile()', audio);
        return audio;
    };
    AudioStorage.prototype.update = function (audio) {
        var context;
        if (audio instanceof _audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioFile"]) {
            context = audio.toContext();
        }
        else {
            context = audio;
        }
        var updateAudio = this.hash[audio.identifier];
        if (updateAudio) {
            updateAudio.apply(audio);
            return true;
        }
        return false;
    };
    AudioStorage.prototype.delete = function (identifier) {
        var audio = this.hash[identifier];
        if (audio) {
            audio.destroy();
            delete this.hash[identifier];
            return true;
        }
        return false;
    };
    AudioStorage.prototype.get = function (identifier) {
        var audio = this.hash[identifier];
        if (audio)
            return audio;
        return null;
    };
    AudioStorage.prototype.synchronize = function (peer) {
        clearTimeout(this.lazyTimer);
        this.lazyTimer = null;
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('SYNCHRONIZE_AUDIO_LIST', this.getCatalog(), peer);
    };
    AudioStorage.prototype.lazySynchronize = function (ms, peer) {
        var _this = this;
        clearTimeout(this.lazyTimer);
        this.lazyTimer = setTimeout(function () {
            _this.synchronize(peer);
        }, ms);
    };
    AudioStorage.prototype.getCatalog = function () {
        var e_1, _a;
        var catalog = [];
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](AudioStorage.instance.audios), _c = _b.next(); !_c.done; _c = _b.next()) {
                var audio = _c.value;
                if (_audio_file__WEBPACK_IMPORTED_MODULE_2__["AudioState"].COMPLETE <= audio.state) {
                    catalog.push({ identifier: audio.identifier, state: audio.state });
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return catalog;
    };
    return AudioStorage;
}());



/***/ }),

/***/ "./src/app/class/core/file-storage/buffer-sharing-task.ts":
/*!****************************************************************!*\
  !*** ./src/app/class/core/file-storage/buffer-sharing-task.ts ***!
  \****************************************************************/
/*! exports provided: BufferSharingTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BufferSharingTask", function() { return BufferSharingTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var msgpack_lite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! msgpack-lite */ "./node_modules/msgpack-lite/lib/browser.js");
/* harmony import */ var msgpack_lite__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(msgpack_lite__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _system_util_zero_timeout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../system/util/zero-timeout */ "./src/app/class/core/system/util/zero-timeout.ts");
/* harmony import */ var _file_reader_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./file-reader-util */ "./src/app/class/core/file-storage/file-reader-util.ts");





var BufferSharingTask = /** @class */ (function () {
    function BufferSharingTask(data, sendTo) {
        this.chanks = [];
        this.chankSize = 32 * 1024;
        this.chankReceiveCount = 0;
        this.sentChankIndex = 0;
        this.completedChankIndex = 0;
        this.startTime = 0;
        this.data = data;
        this.uint8Array = msgpack_lite__WEBPACK_IMPORTED_MODULE_1__["encode"](data);
        this._sendTo = sendTo;
    }
    Object.defineProperty(BufferSharingTask.prototype, "identifier", {
        get: function () { return this._identifier; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(BufferSharingTask.prototype, "sendTo", {
        get: function () { return this._sendTo; },
        enumerable: true,
        configurable: true
    });
    ;
    BufferSharingTask.createSendTask = function (data, sendTo, identifier) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var task, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        task = new BufferSharingTask(data, sendTo);
                        _a = task;
                        if (!(identifier != null)) return [3 /*break*/, 1];
                        _b = identifier;
                        return [3 /*break*/, 3];
                    case 1: return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_4__["FileReaderUtil"].calcSHA256Async(task.uint8Array)];
                    case 2:
                        _b = _c.sent();
                        _c.label = 3;
                    case 3:
                        _a._identifier = _b;
                        task.initializeSend();
                        return [2 /*return*/, task];
                }
            });
        });
    };
    BufferSharingTask.createReceiveTask = function (identifier) {
        var task = new BufferSharingTask();
        task._identifier = identifier;
        task.initializeReceive();
        return task;
    };
    BufferSharingTask.prototype.cancel = function () {
        this.dispose();
        if (this.oncancel)
            this.oncancel(this);
    };
    BufferSharingTask.prototype.dispose = function () {
        _system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(this);
        clearTimeout(this.sendChankTimer);
        clearTimeout(this.timeoutTimer);
        this.onprogress = this.onfinish = this.ontimeout = this.oncancel = null;
    };
    BufferSharingTask.prototype.initializeSend = function () {
        var _this = this;
        var total = Math.ceil(this.uint8Array.byteLength / this.chankSize);
        this.chanks = new Array(total);
        console.log('チャンク分割 ' + this.identifier, this.chanks.length);
        _system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
            .on('FILE_MORE_CHANK_' + this.identifier, function (event) {
            if (_this.sendTo !== event.sendFrom)
                return;
            _this.completedChankIndex = event.data;
            if (_this.sendChankTimer == null) {
                clearTimeout(_this.timeoutTimer);
                _this.sendChank(_this.sentChankIndex + 1);
            }
        })
            .on('DISCONNECT_PEER', function (event) {
            if (event.data.peer !== _this.sendTo)
                return;
            console.warn('送信キャンセル', _this, event.data.peer);
            if (_this.ontimeout)
                _this.ontimeout(_this);
            if (_this.onfinish)
                _this.onfinish(_this, _this.data);
            _this.dispose();
        });
        this.sentChankIndex = this.completedChankIndex = 0;
        Object(_system_util_zero_timeout__WEBPACK_IMPORTED_MODULE_3__["setZeroTimeout"])(function () { return _this.sendChank(0); });
    };
    BufferSharingTask.prototype.sendChank = function (index) {
        var _this = this;
        var chank = this.uint8Array.slice(index * this.chankSize, (index + 1) * this.chankSize);
        var data = { index: index, length: this.chanks.length, chank: chank };
        _system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].call('FILE_SEND_CHANK_' + this.identifier, data, this.sendTo);
        this.sentChankIndex = index;
        if (this.chanks.length <= index + 1) {
            _system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].call('FILE_SEND_END_' + this.identifier, null, this.sendTo);
            console.log('バッファ送信完了', this.identifier);
            if (this.onfinish)
                this.onfinish(this, this.data);
            this.dispose();
        }
        else if (this.completedChankIndex + 4 <= index) {
            this.sendChankTimer = null;
            this.resetTimeout();
        }
        else {
            this.sendChankTimer = Object(_system_util_zero_timeout__WEBPACK_IMPORTED_MODULE_3__["setZeroTimeout"])(function () { _this.sendChank(_this.sentChankIndex + 1); });
        }
    };
    BufferSharingTask.prototype.initializeReceive = function () {
        var _this = this;
        this.resetTimeout();
        this.startTime = performance.now();
        this.chankReceiveCount = 0;
        _system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
            .on('FILE_SEND_CHANK_' + this.identifier, function (event) {
            if (_this.chanks.length < 1)
                _this.chanks = new Array(event.data.length);
            if (_this.chanks[event.data.index] != null) {
                console.log("already received. [" + event.data.index + "] <" + _this.identifier + ">");
                return;
            }
            _this.chankReceiveCount++;
            _this.chanks[event.data.index] = event.data.chank;
            if (_this.onprogress)
                _this.onprogress(_this, event.data.index, event.data.length);
            if (_this.chanks.length <= _this.chankReceiveCount) {
                _this.finishReceive();
            }
            else {
                _this.resetTimeout();
                if ((event.data.index + 1) % 1 === 0) {
                    _system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].call('FILE_MORE_CHANK_' + _this.identifier, event.data.index, event.sendFrom);
                }
            }
        });
    };
    BufferSharingTask.prototype.finishReceive = function () {
        var e_1, _a, e_2, _b;
        console.log('バッファ受信完了', this.identifier);
        if (this.timeoutTimer)
            clearTimeout(this.timeoutTimer);
        _system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(this);
        var sumLength = 0;
        try {
            for (var _c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.chanks), _d = _c.next(); !_d.done; _d = _c.next()) {
                var chank = _d.value;
                sumLength += chank.byteLength;
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
            }
            finally { if (e_1) throw e_1.error; }
        }
        var time = performance.now() - this.startTime;
        var rate = (sumLength / 1024 / 1024) / (time / 1000);
        console.log((sumLength / 1024).toFixed(2) + "KB " + (time / 1000).toFixed(2) + "\u79D2 \u8EE2\u9001\u901F\u5EA6: " + rate.toFixed(2) + "MB/s");
        var uint8Array = new Uint8Array(sumLength);
        var pos = 0;
        try {
            for (var _e = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.chanks), _f = _e.next(); !_f.done; _f = _e.next()) {
                var chank = _f.value;
                uint8Array.set(chank, pos);
                pos += chank.byteLength;
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this.data = msgpack_lite__WEBPACK_IMPORTED_MODULE_1__["decode"](uint8Array);
        if (this.onfinish)
            this.onfinish(this, this.data);
        this.dispose();
    };
    BufferSharingTask.prototype.resetTimeout = function () {
        var _this = this;
        clearTimeout(this.timeoutTimer);
        this.timeoutTimer = setTimeout(function () {
            if (_this.ontimeout)
                _this.ontimeout(_this);
            if (_this.onfinish)
                _this.onfinish(_this, _this.data);
            _this.dispose();
        }, 15 * 1000);
    };
    return BufferSharingTask;
}());



/***/ }),

/***/ "./src/app/class/core/file-storage/canvas-util.ts":
/*!********************************************************!*\
  !*** ./src/app/class/core/file-storage/canvas-util.ts ***!
  \********************************************************/
/*! exports provided: CanvasUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CanvasUtil", function() { return CanvasUtil; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var CanvasUtil;
(function (CanvasUtil) {
    /**
     * https://github.com/viliusle/Hermite-resize
     * Hermite resize - fast image resize/resample using Hermite filter. 1 cpu version!
     *
     * @param {HtmlElement} canvas
     * @param {int} width
     * @param {int} height
     * @param {boolean} resize_canvas if true, canvas will be resized. Optional.
     */
    function resize(canvas, width, height, resize_canvas) {
        var width_source = canvas.width;
        var height_source = canvas.height;
        width = Math.round(width);
        height = Math.round(height);
        var ratio_w = width_source / width;
        var ratio_h = height_source / height;
        var ratio_w_half = Math.ceil(ratio_w / 2);
        var ratio_h_half = Math.ceil(ratio_h / 2);
        var ctx = canvas.getContext('2d');
        var img = ctx.getImageData(0, 0, width_source, height_source);
        var img2 = ctx.createImageData(width, height);
        var data = img.data;
        var data2 = img2.data;
        for (var j = 0; j < height; j++) {
            for (var i = 0; i < width; i++) {
                var x2 = (i + j * width) * 4;
                var weight = 0;
                var weights = 0;
                var weights_alpha = 0;
                var gx_r = 0;
                var gx_g = 0;
                var gx_b = 0;
                var gx_a = 0;
                var center_y = (j + 0.5) * ratio_h;
                var yy_start = Math.floor(j * ratio_h);
                var yy_stop = Math.ceil((j + 1) * ratio_h);
                for (var yy = yy_start; yy < yy_stop; yy++) {
                    var dy = Math.abs(center_y - (yy + 0.5)) / ratio_h_half;
                    var center_x = (i + 0.5) * ratio_w;
                    var w0 = dy * dy; //pre-calc part of w
                    var xx_start = Math.floor(i * ratio_w);
                    var xx_stop = Math.ceil((i + 1) * ratio_w);
                    for (var xx = xx_start; xx < xx_stop; xx++) {
                        var dx = Math.abs(center_x - (xx + 0.5)) / ratio_w_half;
                        var w = Math.sqrt(w0 + dx * dx);
                        if (w >= 1) {
                            //pixel too far
                            continue;
                        }
                        //hermite filter
                        weight = 2 * w * w * w - 3 * w * w + 1;
                        var pos_x = 4 * (xx + yy * width_source);
                        //alpha
                        gx_a += weight * data[pos_x + 3];
                        weights_alpha += weight;
                        //colors
                        if (data[pos_x + 3] < 255)
                            weight = weight * data[pos_x + 3] / 250;
                        gx_r += weight * data[pos_x];
                        gx_g += weight * data[pos_x + 1];
                        gx_b += weight * data[pos_x + 2];
                        weights += weight;
                    }
                }
                data2[x2] = gx_r / weights;
                data2[x2 + 1] = gx_g / weights;
                data2[x2 + 2] = gx_b / weights;
                data2[x2 + 3] = gx_a / weights_alpha;
            }
        }
        //clear and resize canvas
        if (resize_canvas === true) {
            canvas.width = width;
            canvas.height = height;
        }
        else {
            ctx.clearRect(0, 0, width_source, height_source);
        }
        //draw
        ctx.putImageData(img2, 0, 0);
    }
    CanvasUtil.resize = resize;
})(CanvasUtil || (CanvasUtil = {}));


/***/ }),

/***/ "./src/app/class/core/file-storage/file-archiver.ts":
/*!**********************************************************!*\
  !*** ./src/app/class/core/file-storage/file-archiver.ts ***!
  \**********************************************************/
/*! exports provided: FileArchiver */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileArchiver", function() { return FileArchiver; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var file_saver__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! file-saver */ "./node_modules/file-saver/dist/FileSaver.min.js");
/* harmony import */ var file_saver__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(file_saver__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var jszip_dist_jszip_min_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jszip/dist/jszip.min.js */ "./node_modules/jszip/dist/jszip.min.js");
/* harmony import */ var jszip_dist_jszip_min_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jszip_dist_jszip_min_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _system_util_xml_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../system/util/xml-util */ "./src/app/class/core/system/util/xml-util.ts");
/* harmony import */ var _audio_storage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./audio-storage */ "./src/app/class/core/file-storage/audio-storage.ts");
/* harmony import */ var _file_reader_util__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./file-reader-util */ "./src/app/class/core/file-storage/file-reader-util.ts");
/* harmony import */ var _image_storage__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _mime_type__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./mime-type */ "./src/app/class/core/file-storage/mime-type.ts");









var FileArchiver = /** @class */ (function () {
    function FileArchiver() {
        console.log('FileArchiver ready...');
    }
    Object.defineProperty(FileArchiver, "instance", {
        get: function () {
            if (!FileArchiver._instance)
                FileArchiver._instance = new FileArchiver();
            return FileArchiver._instance;
        },
        enumerable: true,
        configurable: true
    });
    FileArchiver.prototype.initialize = function () {
        this.destroy();
        this.addEventListeners();
    };
    FileArchiver.prototype.destroy = function () {
        this.removeEventListeners();
    };
    FileArchiver.prototype.addEventListeners = function () {
        var _this = this;
        this.removeEventListeners();
        this.callbackOnDragEnter = function (e) { return _this.onDragEnter(e); };
        this.callbackOnDragOver = function (e) { return _this.onDragOver(e); };
        this.callbackOnDrop = function (e) { return _this.onDrop(e); };
        document.body.addEventListener('dragenter', this.callbackOnDragEnter, false);
        document.body.addEventListener('dragover', this.callbackOnDragOver, false);
        document.body.addEventListener('drop', this.callbackOnDrop, false);
    };
    FileArchiver.prototype.removeEventListeners = function () {
        document.body.removeEventListener('dragenter', this.callbackOnDragEnter, false);
        document.body.removeEventListener('dragover', this.callbackOnDragOver, false);
        document.body.removeEventListener('drop', this.callbackOnDrop, false);
        this.callbackOnDragEnter = null;
        this.callbackOnDragOver = null;
        this.callbackOnDrop = null;
    };
    FileArchiver.prototype.onDragEnter = function (event) {
        event.stopPropagation();
        event.preventDefault();
    };
    ;
    FileArchiver.prototype.onDragOver = function (event) {
        event.stopPropagation();
        event.preventDefault();
    };
    ;
    FileArchiver.prototype.onDrop = function (event) {
        event.stopPropagation();
        event.preventDefault();
        console.log('onDrop', event.dataTransfer);
        var files = event.dataTransfer.files;
        this.load(files);
    };
    ;
    FileArchiver.prototype.load = function (files) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var length, i;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        length = files.length;
                        i = 0;
                        _a.label = 1;
                    case 1:
                        if (!(i < length)) return [3 /*break*/, 7];
                        return [4 /*yield*/, this.handleImage(files[i])];
                    case 2:
                        _a.sent();
                        return [4 /*yield*/, this.handleAudio(files[i])];
                    case 3:
                        _a.sent();
                        return [4 /*yield*/, this.handleText(files[i])];
                    case 4:
                        _a.sent();
                        return [4 /*yield*/, this.handleZip(files[i])];
                    case 5:
                        _a.sent();
                        _system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].trigger('FILE_LOADED', { file: files[i] });
                        _a.label = 6;
                    case 6:
                        i++;
                        return [3 /*break*/, 1];
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    FileArchiver.prototype.handleImage = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (file.type.indexOf('image/') < 0)
                            return [2 /*return*/];
                        console.log(file.name + ' type:' + file.type);
                        if (2 * 1024 * 1024 < file.size)
                            return [2 /*return*/];
                        return [4 /*yield*/, _image_storage__WEBPACK_IMPORTED_MODULE_7__["ImageStorage"].instance.addAsync(file)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    FileArchiver.prototype.handleAudio = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (file.type.indexOf('audio/') < 0)
                            return [2 /*return*/];
                        console.log(file.name + ' type:' + file.type);
                        if (10 * 1024 * 1024 < file.size)
                            return [2 /*return*/];
                        return [4 /*yield*/, _audio_storage__WEBPACK_IMPORTED_MODULE_5__["AudioStorage"].instance.addAsync(file)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    FileArchiver.prototype.handleText = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var xmlElement, _a, _b, reason_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (file.type.indexOf('text/') < 0)
                            return [2 /*return*/];
                        console.log(file.name + ' type:' + file.type);
                        _c.label = 1;
                    case 1:
                        _c.trys.push([1, 3, , 4]);
                        _b = (_a = _system_util_xml_util__WEBPACK_IMPORTED_MODULE_4__["XmlUtil"]).xml2element;
                        return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_6__["FileReaderUtil"].readAsTextAsync(file)];
                    case 2:
                        xmlElement = _b.apply(_a, [_c.sent()]);
                        if (xmlElement)
                            _system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].trigger('XML_LOADED', { xmlElement: xmlElement });
                        return [3 /*break*/, 4];
                    case 3:
                        reason_1 = _c.sent();
                        console.warn(reason_1);
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    FileArchiver.prototype.handleZip = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var zip, reason_2, zipEntries, zipEntries_1, zipEntries_1_1, zipEntry, arraybuffer, reason_3, e_1_1;
            var e_1, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!(0 <= file.type.indexOf('application/') || file.type.length < 1))
                            return [2 /*return*/];
                        zip = new jszip_dist_jszip_min_js__WEBPACK_IMPORTED_MODULE_2__();
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, zip.loadAsync(file)];
                    case 2:
                        zip = _b.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        reason_2 = _b.sent();
                        console.warn(reason_2);
                        return [2 /*return*/];
                    case 4:
                        zipEntries = [];
                        zip.forEach(function (relativePath, zipEntry) { return zipEntries.push(zipEntry); });
                        _b.label = 5;
                    case 5:
                        _b.trys.push([5, 13, 14, 15]);
                        zipEntries_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](zipEntries), zipEntries_1_1 = zipEntries_1.next();
                        _b.label = 6;
                    case 6:
                        if (!!zipEntries_1_1.done) return [3 /*break*/, 12];
                        zipEntry = zipEntries_1_1.value;
                        _b.label = 7;
                    case 7:
                        _b.trys.push([7, 10, , 11]);
                        return [4 /*yield*/, zipEntry.async('arraybuffer')];
                    case 8:
                        arraybuffer = _b.sent();
                        console.log(zipEntry.name + ' 解凍...', arraybuffer);
                        return [4 /*yield*/, this.load([new File([arraybuffer], zipEntry.name, { type: _mime_type__WEBPACK_IMPORTED_MODULE_8__["MimeType"].type(zipEntry.name) })])];
                    case 9:
                        _b.sent();
                        return [3 /*break*/, 11];
                    case 10:
                        reason_3 = _b.sent();
                        console.warn(reason_3);
                        return [3 /*break*/, 11];
                    case 11:
                        zipEntries_1_1 = zipEntries_1.next();
                        return [3 /*break*/, 6];
                    case 12: return [3 /*break*/, 15];
                    case 13:
                        e_1_1 = _b.sent();
                        e_1 = { error: e_1_1 };
                        return [3 /*break*/, 15];
                    case 14:
                        try {
                            if (zipEntries_1_1 && !zipEntries_1_1.done && (_a = zipEntries_1.return)) _a.call(zipEntries_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                        return [7 /*endfinally*/];
                    case 15: return [2 /*return*/];
                }
            });
        });
    };
    FileArchiver.prototype.save = function (files, zipName) {
        if (!files)
            return;
        var zip = new jszip_dist_jszip_min_js__WEBPACK_IMPORTED_MODULE_2__();
        var length = files.length;
        for (var i = 0; i < length; i++) {
            var file = files[i];
            zip.file(file.name, file);
        }
        zip.generateAsync({
            type: 'blob',
            compression: 'DEFLATE',
            compressionOptions: {
                level: 6
            }
        }).then(function (blob) { return Object(file_saver__WEBPACK_IMPORTED_MODULE_1__["saveAs"])(blob, zipName + '.zip'); });
    };
    return FileArchiver;
}());



/***/ }),

/***/ "./src/app/class/core/file-storage/file-reader-util.ts":
/*!*************************************************************!*\
  !*** ./src/app/class/core/file-storage/file-reader-util.ts ***!
  \*************************************************************/
/*! exports provided: FileReaderUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileReaderUtil", function() { return FileReaderUtil; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var crypto_js_lib_typedarrays_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto-js/lib-typedarrays.js */ "./node_modules/crypto-js/lib-typedarrays.js");
/* harmony import */ var crypto_js_lib_typedarrays_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto_js_lib_typedarrays_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var crypto_js_sha256_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto-js/sha256.js */ "./node_modules/crypto-js/sha256.js");
/* harmony import */ var crypto_js_sha256_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto_js_sha256_js__WEBPACK_IMPORTED_MODULE_2__);



var FileReaderUtil;
(function (FileReaderUtil) {
    function readAsArrayBufferAsync(blob) {
        return new Promise(function (resolve, reject) {
            var reader = new FileReader();
            reader.onload = function (event) { resolve(reader.result); };
            reader.onabort = reader.onerror = function (e) { reject(e); };
            reader.readAsArrayBuffer(blob);
        });
    }
    FileReaderUtil.readAsArrayBufferAsync = readAsArrayBufferAsync;
    function readAsTextAsync(blob) {
        return new Promise(function (resolve, reject) {
            var reader = new FileReader();
            reader.onload = function (event) { resolve(reader.result); };
            reader.onabort = reader.onerror = function (e) { reject(e); };
            reader.readAsText(blob);
        });
    }
    FileReaderUtil.readAsTextAsync = readAsTextAsync;
    function calcSHA256Async(arg) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                if (arg instanceof Blob) {
                    return [2 /*return*/, _calcSHA256Async(arg)];
                }
                else {
                    return [2 /*return*/, _calcSHA256(arg)];
                }
                return [2 /*return*/];
            });
        });
    }
    FileReaderUtil.calcSHA256Async = calcSHA256Async;
    function _calcSHA256Async(blob) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = _calcSHA256;
                        return [4 /*yield*/, FileReaderUtil.readAsArrayBufferAsync(blob)];
                    case 1: return [2 /*return*/, _a.apply(void 0, [_b.sent()])];
                }
            });
        });
    }
    function _calcSHA256(arrayBuffer) {
        var wordArray = crypto_js_lib_typedarrays_js__WEBPACK_IMPORTED_MODULE_1__["create"](arrayBuffer);
        return crypto_js_sha256_js__WEBPACK_IMPORTED_MODULE_2__(wordArray).toString();
    }
})(FileReaderUtil || (FileReaderUtil = {}));


/***/ }),

/***/ "./src/app/class/core/file-storage/image-file.ts":
/*!*******************************************************!*\
  !*** ./src/app/class/core/file-storage/image-file.ts ***!
  \*******************************************************/
/*! exports provided: ImageState, ImageFile */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageState", function() { return ImageState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageFile", function() { return ImageFile; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _canvas_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./canvas-util */ "./src/app/class/core/file-storage/canvas-util.ts");
/* harmony import */ var _file_reader_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./file-reader-util */ "./src/app/class/core/file-storage/file-reader-util.ts");



var ImageState;
(function (ImageState) {
    ImageState[ImageState["NULL"] = 0] = "NULL";
    ImageState[ImageState["THUMBNAIL"] = 1] = "THUMBNAIL";
    ImageState[ImageState["COMPLETE"] = 2] = "COMPLETE";
    ImageState[ImageState["URL"] = 1000] = "URL";
})(ImageState || (ImageState = {}));
var ImageFile = /** @class */ (function () {
    function ImageFile() {
        this.context = {
            identifier: '',
            name: '',
            blob: null,
            type: '',
            url: '',
            thumbnail: {
                blob: null,
                type: '',
                url: '',
            }
        };
    }
    Object.defineProperty(ImageFile.prototype, "identifier", {
        get: function () { return this.context.identifier; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(ImageFile.prototype, "name", {
        get: function () { return this.context.name; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(ImageFile.prototype, "blob", {
        get: function () { return this.context.blob ? this.context.blob : this.context.thumbnail.blob; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(ImageFile.prototype, "url", {
        get: function () { return this.context.url ? this.context.url : this.context.thumbnail.url; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(ImageFile.prototype, "thumbnail", {
        get: function () { return this.context.thumbnail; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(ImageFile.prototype, "state", {
        get: function () {
            if (!this.url && !this.blob)
                return ImageState.NULL;
            if (this.url && !this.blob)
                return ImageState.URL;
            if (this.blob === this.thumbnail.blob)
                return ImageState.THUMBNAIL;
            return ImageState.COMPLETE;
        },
        enumerable: true,
        configurable: true
    });
    ImageFile.createEmpty = function (identifier) {
        var imageFile = new ImageFile();
        imageFile.context.identifier = identifier;
        return imageFile;
    };
    ImageFile.create = function (arg) {
        if (typeof arg === 'string') {
            var imageFile = new ImageFile();
            imageFile.context.identifier = arg;
            imageFile.context.name = arg;
            imageFile.context.url = arg;
            return imageFile;
        }
        else {
            var imageFile = new ImageFile();
            imageFile.apply(arg);
            return imageFile;
        }
    };
    ImageFile.createAsync = function (arg) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(arg instanceof File)) return [3 /*break*/, 2];
                        return [4 /*yield*/, ImageFile._createAsync(arg, arg.name)];
                    case 1: return [2 /*return*/, _a.sent()];
                    case 2:
                        if (!(arg instanceof Blob)) return [3 /*break*/, 4];
                        return [4 /*yield*/, ImageFile._createAsync(arg)];
                    case 3: return [2 /*return*/, _a.sent()];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    ImageFile._createAsync = function (blob, name) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var arrayBuffer, imageFile, _a, _b, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_2__["FileReaderUtil"].readAsArrayBufferAsync(blob)];
                    case 1:
                        arrayBuffer = _c.sent();
                        imageFile = new ImageFile();
                        _a = imageFile.context;
                        return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_2__["FileReaderUtil"].calcSHA256Async(arrayBuffer)];
                    case 2:
                        _a.identifier = _c.sent();
                        imageFile.context.name = name;
                        imageFile.context.blob = new Blob([arrayBuffer], { type: blob.type });
                        imageFile.context.url = window.URL.createObjectURL(imageFile.context.blob);
                        _c.label = 3;
                    case 3:
                        _c.trys.push([3, 5, , 6]);
                        _b = imageFile.context;
                        return [4 /*yield*/, ImageFile.createThumbnailAsync(imageFile.context)];
                    case 4:
                        _b.thumbnail = _c.sent();
                        return [3 /*break*/, 6];
                    case 5:
                        e_1 = _c.sent();
                        throw e_1;
                    case 6:
                        if (imageFile.context.name != null)
                            imageFile.context.name = imageFile.context.identifier;
                        return [2 /*return*/, imageFile];
                }
            });
        });
    };
    ImageFile.prototype.destroy = function () {
        this.revokeURLs();
    };
    ImageFile.prototype.apply = function (context) {
        if (!this.context.identifier && context.identifier)
            this.context.identifier = context.identifier;
        if (!this.context.name && context.name)
            this.context.name = context.name;
        if (!this.context.blob && context.blob)
            this.context.blob = context.blob;
        if (!this.context.type && context.type)
            this.context.type = context.type;
        if (!this.context.url && context.url) {
            if (this.state !== ImageState.URL)
                window.URL.revokeObjectURL(this.context.url);
            this.context.url = context.url;
        }
        if (!this.context.thumbnail.blob && context.thumbnail.blob)
            this.context.thumbnail.blob = context.thumbnail.blob;
        if (!this.context.thumbnail.type && context.thumbnail.type)
            this.context.thumbnail.type = context.thumbnail.type;
        if (!this.context.thumbnail.url && context.thumbnail.url) {
            if (this.state !== ImageState.URL)
                window.URL.revokeObjectURL(this.context.thumbnail.url);
            this.context.thumbnail.url = context.thumbnail.url;
        }
        this.createURLs();
    };
    ImageFile.prototype.toContext = function () {
        return {
            identifier: this.context.identifier,
            name: this.context.name,
            blob: this.context.blob,
            type: this.context.type,
            url: this.context.url,
            thumbnail: {
                blob: this.context.thumbnail.blob,
                type: this.context.thumbnail.type,
                url: this.context.thumbnail.url,
            }
        };
    };
    ImageFile.prototype.createURLs = function () {
        if (this.state === ImageState.URL)
            return;
        if (this.context.blob && this.context.url === '')
            this.context.url = window.URL.createObjectURL(this.context.blob);
        if (this.context.thumbnail.blob && this.context.thumbnail.url === '')
            this.context.thumbnail.url = window.URL.createObjectURL(this.context.thumbnail.blob);
    };
    ImageFile.prototype.revokeURLs = function () {
        if (this.state === ImageState.URL)
            return;
        window.URL.revokeObjectURL(this.context.url);
        window.URL.revokeObjectURL(this.context.thumbnail.url);
    };
    ImageFile.createThumbnailAsync = function (context) {
        return new Promise(function (resolve, reject) {
            var canvas = document.createElement('canvas');
            var render = canvas.getContext('2d');
            var image = new Image();
            image.onload = function (event) {
                var scale = 128 / (image.width < image.height ? image.height : image.width);
                scale = scale < 1 ? scale : 1.0;
                var dstWidth = image.width * scale;
                var dstHeight = image.height * scale;
                canvas.width = image.width; //dstWidth;
                canvas.height = image.height; //dstHeight;
                //render.drawImage(image, 0, 0, image.width, image.height, 0, 0, dstWidth, dstHeight);
                render.drawImage(image, 0, 0);
                _canvas_util__WEBPACK_IMPORTED_MODULE_1__["CanvasUtil"].resize(canvas, dstWidth, dstHeight, true);
                canvas.toBlob(function (blob) {
                    var thumbnail = {
                        type: blob.type,
                        blob: blob,
                        url: window.URL.createObjectURL(blob),
                    };
                    resolve(thumbnail);
                }, context.blob.type);
            };
            image.onabort = image.onerror = function () {
                reject();
            };
            image.src = context.url;
        });
    };
    ImageFile.Empty = ImageFile.createEmpty('null');
    return ImageFile;
}());



/***/ }),

/***/ "./src/app/class/core/file-storage/image-sharing-system.ts":
/*!*****************************************************************!*\
  !*** ./src/app/class/core/file-storage/image-sharing-system.ts ***!
  \*****************************************************************/
/*! exports provided: FileSharingSystem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileSharingSystem", function() { return FileSharingSystem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _system_util_uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../system/util/uuid */ "./src/app/class/core/system/util/uuid.ts");
/* harmony import */ var _buffer_sharing_task__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./buffer-sharing-task */ "./src/app/class/core/file-storage/buffer-sharing-task.ts");
/* harmony import */ var _file_reader_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./file-reader-util */ "./src/app/class/core/file-storage/file-reader-util.ts");
/* harmony import */ var _image_file__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _image_storage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _mime_type__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./mime-type */ "./src/app/class/core/file-storage/mime-type.ts");








var FileSharingSystem = /** @class */ (function () {
    function FileSharingSystem() {
        this.taskMap = new Map();
        this.maxTransmission = 1;
        console.log('FileSharingSystem ready...');
    }
    Object.defineProperty(FileSharingSystem, "instance", {
        get: function () {
            if (!FileSharingSystem._instance)
                FileSharingSystem._instance = new FileSharingSystem();
            return FileSharingSystem._instance;
        },
        enumerable: true,
        configurable: true
    });
    FileSharingSystem.prototype.initialize = function () {
        var _this = this;
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].register(this)
            .on('CONNECT_PEER', 1, function (event) {
            if (!event.isSendFromSelf)
                return;
            console.log('CONNECT_PEER ImageStorageService !!!', event.data.peer);
            _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.synchronize();
        })
            .on('XML_LOADED', function (event) {
            convertUrlImage(event.data.xmlElement);
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            var e_1, _a;
            if (event.isSendFromSelf)
                return;
            console.log('SYNCHRONIZE_FILE_LIST ImageStorageService ' + event.sendFrom);
            var otherCatalog = event.data;
            var request = [];
            try {
                for (var otherCatalog_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](otherCatalog), otherCatalog_1_1 = otherCatalog_1.next(); !otherCatalog_1_1.done; otherCatalog_1_1 = otherCatalog_1.next()) {
                    var item = otherCatalog_1_1.value;
                    var image = _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.get(item.identifier);
                    if (image === null) {
                        image = _image_file__WEBPACK_IMPORTED_MODULE_5__["ImageFile"].createEmpty(item.identifier);
                        _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.add(image);
                    }
                    if (image.state < _image_file__WEBPACK_IMPORTED_MODULE_5__["ImageState"].COMPLETE) {
                        request.push({ identifier: item.identifier, state: image.state });
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (otherCatalog_1_1 && !otherCatalog_1_1.done && (_a = otherCatalog_1.return)) _a.call(otherCatalog_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (request.length < 1 && otherCatalog.length < _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.getCatalog().length) {
                _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.synchronize(event.sendFrom);
            }
            if (request.length < 1 || _this.isTransmission()) {
                return;
            }
            _this.request(request, event.sendFrom);
        })
            .on('REQUEST_FILE_RESOURE', function (event) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
            var request, randomRequest, request_1, request_1_1, item, image, updateImages, candidatePeers, index, candidatePeers_1, candidatePeers_1_1, peer;
            var e_2, _a, e_3, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                if (event.isSendFromSelf)
                    return [2 /*return*/];
                request = event.data.identifiers;
                randomRequest = [];
                try {
                    for (request_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](request), request_1_1 = request_1.next(); !request_1_1.done; request_1_1 = request_1.next()) {
                        item = request_1_1.value;
                        image = _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.get(item.identifier);
                        if (item.state < image.state)
                            randomRequest.push({ identifier: item.identifier, state: item.state });
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (request_1_1 && !request_1_1.done && (_a = request_1.return)) _a.call(request_1);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                if (this.isTransmission() === false && 0 < randomRequest.length) {
                    updateImages = this.makeSendUpdateImages(randomRequest);
                    console.log('REQUEST_FILE_RESOURE ImageStorageService Send!!! ' + event.data.receiver + ' -> ' + updateImages.length);
                    this.startSendTransmission(updateImages, event.data.receiver);
                }
                else {
                    candidatePeers = event.data.candidatePeers;
                    index = candidatePeers.indexOf(_system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerId);
                    if (-1 < index)
                        candidatePeers.splice(index, 1);
                    try {
                        for (candidatePeers_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](candidatePeers), candidatePeers_1_1 = candidatePeers_1.next(); !candidatePeers_1_1.done; candidatePeers_1_1 = candidatePeers_1.next()) {
                            peer = candidatePeers_1_1.value;
                            console.log('REQUEST_FILE_RESOURE ImageStorageService Relay!!! ' + peer + ' -> ' + event.data.identifiers);
                            _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call(event, peer);
                            return [2 /*return*/];
                        }
                    }
                    catch (e_3_1) { e_3 = { error: e_3_1 }; }
                    finally {
                        try {
                            if (candidatePeers_1_1 && !candidatePeers_1_1.done && (_b = candidatePeers_1.return)) _b.call(candidatePeers_1);
                        }
                        finally { if (e_3) throw e_3.error; }
                    }
                    console.log('REQUEST_FILE_RESOURE ImageStorageService あぶれた...' + event.data.receiver, randomRequest.length, this.taskMap);
                }
                return [2 /*return*/];
            });
        }); })
            .on('UPDATE_FILE_RESOURE', function (event) {
            var e_4, _a;
            var updateImages = event.data.updateImages;
            console.log('UPDATE_FILE_RESOURE ImageStorageService ' + event.sendFrom + ' -> ', updateImages);
            try {
                for (var updateImages_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updateImages), updateImages_1_1 = updateImages_1.next(); !updateImages_1_1.done; updateImages_1_1 = updateImages_1.next()) {
                    var context = updateImages_1_1.value;
                    if (context.blob)
                        context.blob = new Blob([context.blob], { type: context.type });
                    if (context.thumbnail.blob)
                        context.thumbnail.blob = new Blob([context.thumbnail.blob], { type: context.thumbnail.type });
                    _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.add(context);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (updateImages_1_1 && !updateImages_1_1.done && (_a = updateImages_1.return)) _a.call(updateImages_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        })
            .on('START_FILE_TRANSMISSION', function (event) {
            var identifier = event.data.taskIdentifier;
            console.log('START_FILE_TRANSMISSION ' + identifier);
            _this.startReceiveTransmission(identifier);
        });
    };
    FileSharingSystem.prototype.destroy = function () {
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].unregister(this);
    };
    FileSharingSystem.prototype.startSendTransmission = function (updateImages, sendTo) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var identifier, updateImages_2, updateImages_2_1, context, _a, _b, e_5_1, task;
            var e_5, _c;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                switch (_d.label) {
                    case 0:
                        identifier = _system_util_uuid__WEBPACK_IMPORTED_MODULE_2__["UUID"].generateUuid();
                        this.taskMap.set(identifier, null);
                        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('START_FILE_TRANSMISSION', { taskIdentifier: identifier }, sendTo);
                        _d.label = 1;
                    case 1:
                        _d.trys.push([1, 8, 9, 10]);
                        updateImages_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updateImages), updateImages_2_1 = updateImages_2.next();
                        _d.label = 2;
                    case 2:
                        if (!!updateImages_2_1.done) return [3 /*break*/, 7];
                        context = updateImages_2_1.value;
                        if (!context.thumbnail.blob) return [3 /*break*/, 4];
                        _a = context.thumbnail;
                        return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_4__["FileReaderUtil"].readAsArrayBufferAsync(context.thumbnail.blob)];
                    case 3:
                        _a.blob = (_d.sent());
                        return [3 /*break*/, 6];
                    case 4:
                        if (!context.blob) return [3 /*break*/, 6];
                        _b = context;
                        return [4 /*yield*/, _file_reader_util__WEBPACK_IMPORTED_MODULE_4__["FileReaderUtil"].readAsArrayBufferAsync(context.blob)];
                    case 5:
                        _b.blob = (_d.sent());
                        _d.label = 6;
                    case 6:
                        updateImages_2_1 = updateImages_2.next();
                        return [3 /*break*/, 2];
                    case 7: return [3 /*break*/, 10];
                    case 8:
                        e_5_1 = _d.sent();
                        e_5 = { error: e_5_1 };
                        return [3 /*break*/, 10];
                    case 9:
                        try {
                            if (updateImages_2_1 && !updateImages_2_1.done && (_c = updateImages_2.return)) _c.call(updateImages_2);
                        }
                        finally { if (e_5) throw e_5.error; }
                        return [7 /*endfinally*/];
                    case 10: return [4 /*yield*/, _buffer_sharing_task__WEBPACK_IMPORTED_MODULE_3__["BufferSharingTask"].createSendTask(updateImages, sendTo, identifier)];
                    case 11:
                        task = _d.sent();
                        this.taskMap.set(task.identifier, task);
                        task.onfinish = function (task, data) {
                            _this.stopTransmission(task.identifier);
                            _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.synchronize();
                        };
                        task.ontimeout = function (task) {
                            _this.stopTransmission(task.identifier);
                            _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.synchronize();
                        };
                        return [2 /*return*/];
                }
            });
        });
    };
    FileSharingSystem.prototype.startReceiveTransmission = function (identifier) {
        var _this = this;
        this.stopTransmission(identifier);
        if (this.taskMap.has(identifier))
            return;
        var task = _buffer_sharing_task__WEBPACK_IMPORTED_MODULE_3__["BufferSharingTask"].createReceiveTask(identifier);
        this.taskMap.set(identifier, task);
        task.onfinish = function (task, data) {
            _this.stopTransmission(task.identifier);
            _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].trigger('UPDATE_FILE_RESOURE', { identifier: task.identifier, updateImages: data });
            _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.synchronize();
        };
        task.ontimeout = function (task) {
            _this.stopTransmission(task.identifier);
            _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.synchronize();
        };
        console.log('startFileTransmission => ', this.taskMap.size);
    };
    FileSharingSystem.prototype.stopTransmission = function (identifier) {
        var task = this.taskMap.get(identifier);
        if (task) {
            task.cancel();
        }
        this.taskMap.delete(identifier);
        console.log('stopFileTransmission => ', this.taskMap.size);
    };
    FileSharingSystem.prototype.request = function (request, peer) {
        console.log('requestFile() ' + peer);
        var peers = _system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerIds;
        peers.splice(peers.indexOf(_system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerId), 1);
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('REQUEST_FILE_RESOURE', { identifiers: request, receiver: _system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerId, candidatePeers: peers }, peer);
    };
    FileSharingSystem.prototype.makeSendUpdateImages = function (catalog, maxSize) {
        var _a;
        if (maxSize === void 0) { maxSize = 1024 * 1024 * 0.5; }
        var updateImages = [];
        var byteSize = 0;
        // Fisher-Yates
        for (var i = catalog.length - 1; 0 <= i; i--) {
            var rand = Math.floor(Math.random() * (i + 1));
            _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"]([catalog[rand], catalog[i]], 2), catalog[i] = _a[0], catalog[rand] = _a[1];
        }
        catalog.sort(function (a, b) {
            if (a.state < b.state)
                return -1;
            if (a.state > b.state)
                return 1;
            return 0;
        });
        for (var i = 0; i < catalog.length; i++) {
            var item = catalog[i];
            var image = _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.get(item.identifier);
            var context = {
                identifier: image.identifier,
                name: image.name,
                type: '',
                blob: null,
                url: null,
                thumbnail: { type: '', blob: null, url: null, }
            };
            if (image.state === _image_file__WEBPACK_IMPORTED_MODULE_5__["ImageState"].URL) {
                context.url = image.url;
            }
            else if (item.state === _image_file__WEBPACK_IMPORTED_MODULE_5__["ImageState"].NULL) {
                context.thumbnail.blob = image.thumbnail.blob; //
                context.thumbnail.type = image.thumbnail.type;
            }
            else {
                context.blob = image.blob; //
                context.type = image.blob.type;
            }
            var size = context.blob
                ? context.blob.size
                : context.thumbnail.blob
                    ? context.thumbnail.blob.size
                    : 100;
            if (0 < byteSize && maxSize < byteSize + size)
                break;
            updateImages.push(context);
            byteSize += size;
        }
        return updateImages;
    };
    FileSharingSystem.prototype.isTransmission = function () {
        if (this.maxTransmission <= this.taskMap.size) {
            return true;
        }
        else {
            return false;
        }
    };
    return FileSharingSystem;
}());

function convertUrlImage(xmlElement) {
    var e_6, _a;
    var urls = [];
    var imageElements = xmlElement.querySelectorAll('*[type="image"]');
    for (var i = 0; i < imageElements.length; i++) {
        var url = imageElements[i].innerHTML;
        if (!_image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.get(url) && 0 < _mime_type__WEBPACK_IMPORTED_MODULE_7__["MimeType"].type(url).length) {
            urls.push(url);
        }
    }
    imageElements = xmlElement.querySelectorAll('*[imageIdentifier]');
    for (var i = 0; i < imageElements.length; i++) {
        var url = imageElements[i].getAttribute('imageIdentifier');
        if (!_image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.get(url) && 0 < _mime_type__WEBPACK_IMPORTED_MODULE_7__["MimeType"].type(url).length) {
            urls.push(url);
        }
    }
    try {
        for (var urls_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](urls), urls_1_1 = urls_1.next(); !urls_1_1.done; urls_1_1 = urls_1.next()) {
            var url = urls_1_1.value;
            _image_storage__WEBPACK_IMPORTED_MODULE_6__["ImageStorage"].instance.add(url);
        }
    }
    catch (e_6_1) { e_6 = { error: e_6_1 }; }
    finally {
        try {
            if (urls_1_1 && !urls_1_1.done && (_a = urls_1.return)) _a.call(urls_1);
        }
        finally { if (e_6) throw e_6.error; }
    }
}


/***/ }),

/***/ "./src/app/class/core/file-storage/image-storage.ts":
/*!**********************************************************!*\
  !*** ./src/app/class/core/file-storage/image-storage.ts ***!
  \**********************************************************/
/*! exports provided: ImageStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageStorage", function() { return ImageStorage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _image_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./image-file */ "./src/app/class/core/file-storage/image-file.ts");



var ImageStorage = /** @class */ (function () {
    function ImageStorage() {
        this.imageHash = {};
        console.log('ImageStorage ready...');
    }
    Object.defineProperty(ImageStorage, "instance", {
        get: function () {
            if (!ImageStorage._instance)
                ImageStorage._instance = new ImageStorage();
            return ImageStorage._instance;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageStorage.prototype, "images", {
        get: function () {
            var images = [];
            for (var identifier in this.imageHash) {
                images.push(this.imageHash[identifier]);
            }
            return images;
        },
        enumerable: true,
        configurable: true
    });
    ImageStorage.prototype.destroy = function () {
        for (var identifier in this.imageHash) {
            this.delete(identifier);
        }
    };
    ImageStorage.prototype.addAsync = function (arg) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var image;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].createAsync(arg)];
                    case 1:
                        image = _a.sent();
                        return [2 /*return*/, this._add(image)];
                }
            });
        });
    };
    ImageStorage.prototype.add = function (arg) {
        var image;
        if (typeof arg === 'string') {
            image = _image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].create(arg);
        }
        else if (arg instanceof _image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"]) {
            image = arg;
        }
        else {
            if (this.update(arg))
                return this.imageHash[arg.identifier];
            image = _image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].create(arg);
        }
        return this._add(image);
    };
    ImageStorage.prototype._add = function (image) {
        this.lazySynchronize(100);
        if (this.update(image))
            return this.imageHash[image.identifier];
        this.imageHash[image.identifier] = image;
        console.log('addNewFile()', image);
        return image;
    };
    ImageStorage.prototype.update = function (image) {
        var context;
        if (image instanceof _image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"]) {
            context = image.toContext();
        }
        else {
            context = image;
        }
        var updatingImage = this.imageHash[image.identifier];
        if (updatingImage) {
            updatingImage.apply(image);
            return true;
        }
        return false;
    };
    ImageStorage.prototype.delete = function (identifier) {
        var deleteImage = this.imageHash[identifier];
        if (deleteImage) {
            deleteImage.destroy();
            delete this.imageHash[identifier];
            return true;
        }
        return false;
    };
    ImageStorage.prototype.get = function (identifier) {
        var image = this.imageHash[identifier];
        if (image)
            return image;
        return null;
    };
    ImageStorage.prototype.synchronize = function (peer) {
        clearTimeout(this.lazyTimer);
        this.lazyTimer = null;
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('SYNCHRONIZE_FILE_LIST', this.getCatalog(), peer);
    };
    ImageStorage.prototype.lazySynchronize = function (ms, peer) {
        var _this = this;
        clearTimeout(this.lazyTimer);
        this.lazyTimer = setTimeout(function () {
            _this.synchronize(peer);
        }, ms);
    };
    ImageStorage.prototype.getCatalog = function () {
        var e_1, _a;
        var catalog = [];
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.images), _c = _b.next(); !_c.done; _c = _b.next()) {
                var image = _c.value;
                if (_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageState"].COMPLETE <= image.state) {
                    catalog.push({ identifier: image.identifier, state: image.state });
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return catalog;
    };
    return ImageStorage;
}());



/***/ }),

/***/ "./src/app/class/core/file-storage/mime-type.ts":
/*!******************************************************!*\
  !*** ./src/app/class/core/file-storage/mime-type.ts ***!
  \******************************************************/
/*! exports provided: MimeType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MimeType", function() { return MimeType; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var MimeType;
(function (MimeType) {
    var types = {
        gif: 'image/gif',
        jpg: 'image/jpeg',
        jpeg: 'image/jpeg',
        jpe: 'image/jpeg',
        png: 'image/png',
        apng: 'image/apng',
        webp: 'image/webp',
        svg: 'image/svg+xml',
        svgz: 'image/svg+xml',
        ico: 'image/x-icon',
        cur: 'image/x-icon',
        bmp: 'image/bmp',
        html: 'text/html',
        htm: 'text/html',
        shtml: 'text/html',
        xml: 'text/xml',
        yml: 'text/yaml',
        yaml: 'text/yaml',
        json: 'application/json',
        map: 'application/json',
        zip: 'application/zip',
        mp3: 'audio/mp3',
        wav: 'audio/wav',
        m4a: 'audio/aac',
        ogg: 'audio/ogg',
        mpg: 'video/mpeg',
        mpeg: 'video/mpeg',
        mp4: 'video/mp4',
        webm: 'video/webm'
    };
    function type(fileName) {
        var ext = fileName.replace(/.*[\.\/\\]/, '').toLowerCase();
        return types[ext] ? types[ext] : '';
    }
    MimeType.type = type;
    function extension(mimeType) {
        for (var key in types) {
            if (types[key] === mimeType) {
                return key;
            }
        }
        return mimeType.split('/')[1];
    }
    MimeType.extension = extension;
})(MimeType || (MimeType = {}));


/***/ }),

/***/ "./src/app/class/core/synchronize-object/decorator-core.ts":
/*!*****************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/decorator-core.ts ***!
  \*****************************************************************/
/*! exports provided: defineSyncObject, defineSyncVariable, defineSyncAttribute */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defineSyncObject", function() { return defineSyncObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defineSyncVariable", function() { return defineSyncVariable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defineSyncAttribute", function() { return defineSyncAttribute; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _object_factory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./object-factory */ "./src/app/class/core/synchronize-object/object-factory.ts");


function defineSyncObject(alias) {
    return function (constructor) {
        _object_factory__WEBPACK_IMPORTED_MODULE_1__["ObjectFactory"].instance.register(constructor, alias);
    };
}
function defineSyncVariable() {
    return function (target, key) {
        function getter() {
            return this.context.syncData[key];
        }
        function setter(value) {
            this.context.syncData[key] = value;
            this.update();
        }
        Object.defineProperty(target, key, {
            get: getter,
            set: setter,
            enumerable: true,
            configurable: true
        });
    };
}
function defineSyncAttribute() {
    return function (target, key) {
        function getter() {
            return this.getAttribute(key);
        }
        function setter(value) {
            this.setAttribute(key, value);
        }
        Object.defineProperty(target, key, {
            get: getter,
            set: setter,
            enumerable: true,
            configurable: true
        });
    };
}


/***/ }),

/***/ "./src/app/class/core/synchronize-object/decorator.ts":
/*!************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/decorator.ts ***!
  \************************************************************/
/*! exports provided: SyncObject, SyncVar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SyncObject", function() { return SyncObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SyncVar", function() { return SyncVar; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _decorator_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./decorator-core */ "./src/app/class/core/synchronize-object/decorator-core.ts");
/* harmony import */ var _object_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./object-node */ "./src/app/class/core/synchronize-object/object-node.ts");



function SyncObject(alias) {
    return function (constructor) {
        Object(_decorator_core__WEBPACK_IMPORTED_MODULE_1__["defineSyncObject"])(alias)(constructor);
    };
}
function SyncVar() {
    return function (target, key) {
        if (target instanceof _object_node__WEBPACK_IMPORTED_MODULE_2__["ObjectNode"]) {
            Object(_decorator_core__WEBPACK_IMPORTED_MODULE_1__["defineSyncAttribute"])()(target, key);
        }
        else {
            Object(_decorator_core__WEBPACK_IMPORTED_MODULE_1__["defineSyncVariable"])()(target, key);
        }
    };
}


/***/ }),

/***/ "./src/app/class/core/synchronize-object/game-object.ts":
/*!**************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/game-object.ts ***!
  \**************************************************************/
/*! exports provided: GameObject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameObject", function() { return GameObject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system_util_uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system/util/uuid */ "./src/app/class/core/system/util/uuid.ts");
/* harmony import */ var _object_factory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./object-factory */ "./src/app/class/core/synchronize-object/object-factory.ts");
/* harmony import */ var _object_serializer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _object_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./object-store */ "./src/app/class/core/synchronize-object/object-store.ts");





var GameObject = /** @class */ (function () {
    function GameObject(identifier) {
        if (identifier === void 0) { identifier = _system_util_uuid__WEBPACK_IMPORTED_MODULE_1__["UUID"].generateUuid(); }
        this.context = {
            aliasName: this.constructor.aliasName,
            identifier: '',
            majorVersion: 0,
            minorVersion: 0,
            syncData: {}
        };
        this.context.identifier = identifier;
    }
    Object.defineProperty(GameObject, "aliasName", {
        get: function () { return _object_factory__WEBPACK_IMPORTED_MODULE_2__["ObjectFactory"].instance.getAlias(this); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObject.prototype, "aliasName", {
        get: function () { return this.context.aliasName; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObject.prototype, "identifier", {
        get: function () { return this.context.identifier; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObject.prototype, "version", {
        get: function () { return this.context.majorVersion + this.context.minorVersion; },
        enumerable: true,
        configurable: true
    });
    GameObject.prototype.initialize = function () {
        _object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.add(this);
    };
    GameObject.prototype.destroy = function () {
        _object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.delete(this);
    };
    // GameObject Lifecycle
    GameObject.prototype.onStoreAdded = function () { };
    // GameObject Lifecycle
    GameObject.prototype.onStoreRemoved = function () { };
    GameObject.prototype.update = function () {
        this.versionUp();
        _object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.update(this.identifier);
    };
    GameObject.prototype.versionUp = function () {
        this.context.majorVersion += 1;
        this.context.minorVersion = Math.random();
    };
    GameObject.prototype.apply = function (context) {
        if (context !== null && this.identifier === context.identifier) {
            this.context.majorVersion = context.majorVersion;
            this.context.minorVersion = context.minorVersion;
            this.context.syncData = context.syncData;
        }
    };
    GameObject.prototype.clone = function () {
        var xmlString = this.toXml();
        return _object_serializer__WEBPACK_IMPORTED_MODULE_3__["ObjectSerializer"].instance.parseXml(xmlString);
    };
    GameObject.prototype.toContext = function () {
        return {
            aliasName: this.context.aliasName,
            identifier: this.context.identifier,
            majorVersion: this.context.majorVersion,
            minorVersion: this.context.minorVersion,
            syncData: JSON.parse(JSON.stringify(this.context.syncData))
        };
    };
    GameObject.prototype.toXml = function () {
        return _object_serializer__WEBPACK_IMPORTED_MODULE_3__["ObjectSerializer"].instance.toXml(this);
    };
    return GameObject;
}());



/***/ }),

/***/ "./src/app/class/core/synchronize-object/object-factory.ts":
/*!*****************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/object-factory.ts ***!
  \*****************************************************************/
/*! exports provided: ObjectFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObjectFactory", function() { return ObjectFactory; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var ObjectFactory = /** @class */ (function () {
    function ObjectFactory() {
        this.constructorMap = new Map();
        this.aliasMap = new Map();
        console.log('ObjectFactory ready...');
    }
    Object.defineProperty(ObjectFactory, "instance", {
        get: function () {
            if (!ObjectFactory._instance)
                ObjectFactory._instance = new ObjectFactory();
            return ObjectFactory._instance;
        },
        enumerable: true,
        configurable: true
    });
    ;
    ObjectFactory.prototype.register = function (constructor, alias) {
        if (!alias)
            alias = constructor.name || constructor.toString().match(/function\s*([^(]*)\(/)[1];
        if (this.constructorMap.has(alias)) {
            console.error('その alias<' + alias + '> はすでに割り当て済みじゃねー？');
            return;
        }
        if (this.aliasMap.has(constructor)) {
            console.error('その constructor はすでに登録済みじゃねー？', constructor);
            return;
        }
        console.log('addGameObjectFactory -> ' + alias);
        this.constructorMap.set(alias, constructor);
        this.aliasMap.set(constructor, alias);
    };
    ObjectFactory.prototype.create = function (alias, identifer) {
        var classConstructor = this.constructorMap.get(alias);
        if (!classConstructor) {
            console.error(alias + 'という名のＧameObjectクラスは定義されていません');
            return null;
        }
        var gameObject = new classConstructor(identifer);
        return gameObject;
    };
    ObjectFactory.prototype.getAlias = function (constructor) {
        return this.aliasMap.get(constructor);
    };
    return ObjectFactory;
}());



/***/ }),

/***/ "./src/app/class/core/synchronize-object/object-node.ts":
/*!**************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/object-node.ts ***!
  \**************************************************************/
/*! exports provided: ObjectNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObjectNode", function() { return ObjectNode; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system_util_xml_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system/util/xml-util */ "./src/app/class/core/system/util/xml-util.ts");
/* harmony import */ var _decorator_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./decorator-core */ "./src/app/class/core/synchronize-object/decorator-core.ts");
/* harmony import */ var _game_object__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./game-object */ "./src/app/class/core/synchronize-object/game-object.ts");
/* harmony import */ var _object_serializer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _object_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./object-store */ "./src/app/class/core/synchronize-object/object-store.ts");






var ObjectNode = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ObjectNode, _super);
    function ObjectNode() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.value = '';
        _this.attributes = {};
        _this.parentIdentifier = '';
        _this.majorIndex = 0;
        _this.minorIndex = Math.random();
        _this._children = [];
        _this.needsSort = true;
        return _this;
    }
    ObjectNode_1 = ObjectNode;
    Object.defineProperty(ObjectNode.prototype, "index", {
        get: function () { return this.majorIndex + this.minorIndex; },
        set: function (index) {
            this.majorIndex = index | 0;
            this.minorIndex = index - this.majorIndex;
            if (this.parent)
                this.parent.needsSort = true;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectNode.prototype, "parent", {
        get: function () { return _object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(this.parentIdentifier); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectNode.prototype, "parentId", {
        get: function () { return this.parentIdentifier; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectNode.prototype, "parentIsAssigned", {
        get: function () { return 0 < this.parentIdentifier.length; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectNode.prototype, "parentIsUnknown", {
        get: function () { return this.parentIsAssigned && _object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(this.parentIdentifier) == null; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectNode.prototype, "parentIsDestroyed", {
        get: function () { return this.parentIsAssigned && _object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.isDeleted(this.parentIdentifier); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectNode.prototype, "children", {
        get: function () {
            if (this.needsSort) {
                this.needsSort = false;
                this._children.sort(function (a, b) { return a.index - b.index; });
            }
            return this._children.concat();
        },
        enumerable: true,
        configurable: true
    });
    // override
    ObjectNode.prototype.destroy = function () {
        var e_1, _a;
        _super.prototype.destroy.call(this);
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this._children.concat()), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                child.destroy();
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this._children = [];
    };
    // GameObject Lifecycle
    ObjectNode.prototype.onStoreAdded = function () {
        _super.prototype.onStoreAdded.call(this);
        this.initializeChildren();
    };
    // GameObject Lifecycle
    ObjectNode.prototype.onStoreRemoved = function () {
        _super.prototype.onStoreRemoved.call(this);
        if (this.parent)
            this.parent.removeChild(this);
    };
    // ObjectNode Lifecycle
    ObjectNode.prototype.onChildAdded = function (child) { };
    // ObjectNode Lifecycle
    ObjectNode.prototype.onChildRemoved = function (child) { };
    ObjectNode.prototype._onChildAdded = function (child) {
        var node = this;
        while (node) {
            node.onChildAdded(child);
            node = node.parent;
            if (node === this)
                break;
        }
    };
    ObjectNode.prototype._onChildRemoved = function (child) {
        var node = this;
        while (node) {
            node.onChildRemoved(child);
            node = node.parent;
            if (node === this)
                break;
        }
    };
    ObjectNode.prototype.initializeChildren = function () {
        var e_2, _a;
        if (ObjectNode_1.unknownNodes[this.identifier] == null)
            return;
        var objects = ObjectNode_1.unknownNodes[this.identifier];
        try {
            for (var objects_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](objects), objects_1_1 = objects_1.next(); !objects_1_1.done; objects_1_1 = objects_1.next()) {
                var object = objects_1_1.value;
                if (object.parent === this)
                    this.updateChildren(object);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (objects_1_1 && !objects_1_1.done && (_a = objects_1.return)) _a.call(objects_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        if (ObjectNode_1.unknownNodes[this.identifier]) {
            delete ObjectNode_1.unknownNodes[this.identifier];
        }
    };
    ObjectNode.prototype.updateChildren = function (child) {
        if (child === void 0) { child = this; }
        var index = this._children.indexOf(child);
        var isAdded = false;
        var isMyChild = child.parent === this;
        if (index < 0 && isMyChild) {
            this._children.push(child);
            index = this._children.length - 1;
            isAdded = true;
        }
        else if (0 <= index && !isMyChild) {
            this._children.splice(index, 1);
            this._onChildRemoved(child);
            return;
        }
        else if (index < 0 && !isMyChild) {
            return;
        }
        if (!this._children.length)
            return;
        var prevIndex = index - 1 < 0 ? 0 : index - 1;
        var nextIndex = this._children.length - 1 < index + 1 ? this._children.length - 1 : index + 1;
        if (this._children[prevIndex].index > child.index || child.index > this._children[nextIndex].index)
            this.needsSort = true;
        if (isAdded)
            this._onChildAdded(child);
    };
    ObjectNode.prototype.updateIndexs = function () {
        var children = this.children;
        for (var i = 0; i < children.length; i++) {
            children[i].majorIndex = i;
            children[i].minorIndex = Math.random();
        }
    };
    ObjectNode.prototype.appendChild = function (child) {
        if (child.contains(this))
            return null;
        if (child.parent && child.parent !== this)
            child.parent.removeChild(child);
        var lastIndex = 0 < this.children.length ? this.children[this.children.length - 1].majorIndex + 1 : 0;
        child.parentIdentifier = this.identifier;
        child.majorIndex = lastIndex;
        child.minorIndex = Math.random();
        this.updateChildren(child);
        return child;
    };
    ObjectNode.prototype.insertBefore = function (child, reference) {
        if (child.contains(this))
            return null;
        if (child === reference && child.parent === this)
            return child;
        if (child.parent && child.parent !== this)
            child.parent.removeChild(child);
        var index = this.children.indexOf(reference);
        if (index < 0)
            return this.appendChild(child);
        child.parentIdentifier = this.identifier;
        var prevIndex = 0 < index ? this.children[index - 1].index : 0;
        var diff = reference.index - prevIndex;
        var insertIndex = prevIndex + diff * (0.45 + 0.1 * Math.random());
        child.majorIndex = insertIndex | 0;
        child.minorIndex = insertIndex - child.majorIndex;
        this.updateChildren(child);
        if (diff < 1e-7) {
            this.updateIndexs();
        }
        return child;
    };
    ObjectNode.prototype.removeChild = function (child) {
        var children = this.children;
        var index = children.indexOf(child);
        if (index < 0)
            return null;
        child.parentIdentifier = '';
        child.majorIndex = 0;
        child.minorIndex = Math.random();
        this.updateChildren(child);
        return child;
    };
    ObjectNode.prototype.contains = function (child) {
        var parent = child.parent;
        while (parent) {
            if (parent === child) {
                console.error('あ やっべ、循環参照', child);
                return false;
            }
            if (parent === this)
                return true;
            parent = parent.parent;
        }
        return false;
    };
    ObjectNode.prototype.setAttribute = function (name, value) {
        this.attributes[name] = value;
        this.update();
    };
    ObjectNode.prototype.getAttribute = function (name) {
        if (this.attributes[name] == null) {
            return '';
        }
        return this.attributes[name];
    };
    ObjectNode.prototype.removeAttribute = function (name) {
        delete this.attributes[name];
        this.update();
    };
    ObjectNode.prototype.toAttributes = function () {
        return _object_serializer__WEBPACK_IMPORTED_MODULE_4__["ObjectSerializer"].toAttributes(this.attributes);
    };
    ;
    ObjectNode.prototype.parseAttributes = function (attributes) {
        _object_serializer__WEBPACK_IMPORTED_MODULE_4__["ObjectSerializer"].parseAttributes(this.attributes, attributes);
    };
    ;
    ObjectNode.prototype.innerXml = function () {
        var e_3, _a;
        var xml = '';
        xml += _system_util_xml_util__WEBPACK_IMPORTED_MODULE_1__["XmlUtil"].encodeEntityReference(this.value + '');
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                xml += _object_serializer__WEBPACK_IMPORTED_MODULE_4__["ObjectSerializer"].instance.toXml(child);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return xml;
    };
    ;
    ObjectNode.prototype.parseInnerXml = function (element) {
        var children = element.children;
        if (0 < children.length) {
            for (var i = 0; i < children.length; i++) {
                var child = _object_serializer__WEBPACK_IMPORTED_MODULE_4__["ObjectSerializer"].instance.parseXml(children[i]);
                if (child instanceof ObjectNode_1)
                    this.appendChild(child);
            }
        }
        else {
            this.value = _system_util_xml_util__WEBPACK_IMPORTED_MODULE_1__["XmlUtil"].decodeEntityReference(element.innerHTML);
        }
    };
    ;
    // override
    ObjectNode.prototype.apply = function (context) {
        var oldParent = this.parent;
        _super.prototype.apply.call(this, context);
        if (oldParent && this.parent !== oldParent)
            oldParent.updateChildren(this);
        if (this.parent) {
            this.parent.updateChildren(this);
        }
        else if (this.parentIsAssigned) {
            if (!(this.parentIdentifier in ObjectNode_1.unknownNodes)) {
                ObjectNode_1.unknownNodes[this.parentIdentifier] = [];
            }
            ObjectNode_1.unknownNodes[this.parentIdentifier].push(this);
        }
    };
    var ObjectNode_1;
    // TODO 名前　親Nodeの存在が未知の状態であるNode
    ObjectNode.unknownNodes = {};
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_decorator_core__WEBPACK_IMPORTED_MODULE_2__["defineSyncVariable"])()
    ], ObjectNode.prototype, "value", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_decorator_core__WEBPACK_IMPORTED_MODULE_2__["defineSyncVariable"])()
    ], ObjectNode.prototype, "attributes", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_decorator_core__WEBPACK_IMPORTED_MODULE_2__["defineSyncVariable"])()
    ], ObjectNode.prototype, "parentIdentifier", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_decorator_core__WEBPACK_IMPORTED_MODULE_2__["defineSyncVariable"])()
    ], ObjectNode.prototype, "majorIndex", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_decorator_core__WEBPACK_IMPORTED_MODULE_2__["defineSyncVariable"])()
    ], ObjectNode.prototype, "minorIndex", void 0);
    ObjectNode = ObjectNode_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_decorator_core__WEBPACK_IMPORTED_MODULE_2__["defineSyncObject"])('node')
    ], ObjectNode);
    return ObjectNode;
}(_game_object__WEBPACK_IMPORTED_MODULE_3__["GameObject"]));



/***/ }),

/***/ "./src/app/class/core/synchronize-object/object-serializer.ts":
/*!********************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/object-serializer.ts ***!
  \********************************************************************/
/*! exports provided: ObjectSerializer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObjectSerializer", function() { return ObjectSerializer; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system_util_xml_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system/util/xml-util */ "./src/app/class/core/system/util/xml-util.ts");
/* harmony import */ var _object_factory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./object-factory */ "./src/app/class/core/synchronize-object/object-factory.ts");



var ObjectSerializer = /** @class */ (function () {
    function ObjectSerializer() {
        console.log('ObjectSerializer ready...');
    }
    Object.defineProperty(ObjectSerializer, "instance", {
        get: function () {
            if (!ObjectSerializer._instance)
                ObjectSerializer._instance = new ObjectSerializer();
            return ObjectSerializer._instance;
        },
        enumerable: true,
        configurable: true
    });
    ;
    ObjectSerializer.prototype.toXml = function (gameObject) {
        var xml = '';
        var attributes = 'toAttributes' in gameObject ? gameObject.toAttributes() : ObjectSerializer.toAttributes(gameObject.toContext().syncData);
        var tagName = gameObject.aliasName;
        var attrStr = '';
        for (var name_1 in attributes) {
            var attribute = _system_util_xml_util__WEBPACK_IMPORTED_MODULE_1__["XmlUtil"].encodeEntityReference(attributes[name_1] + '');
            if (attribute == null)
                continue;
            attrStr += ' ' + name_1 + '="' + attribute + '"';
        }
        xml += "<" + (tagName + attrStr) + ">";
        xml += 'innerXml' in gameObject ? gameObject.innerXml() : '';
        xml += "</" + tagName + ">";
        return xml;
    };
    ObjectSerializer.toAttributes = function (syncData) {
        var attributes = {};
        for (var syncVar in syncData) {
            var item = syncData[syncVar];
            var key = syncVar;
            var childAttr = ObjectSerializer.make2Attributes(item, key);
            for (var name_2 in childAttr) {
                attributes[name_2] = childAttr[name_2];
            }
        }
        return attributes;
    };
    ObjectSerializer.make2Attributes = function (item, key) {
        var attributes = {};
        if (Array.isArray(item)) {
            var arrayAttributes = ObjectSerializer.array2attributes(item, key);
            for (var name_3 in arrayAttributes) {
                attributes[name_3] = arrayAttributes[name_3];
            }
        }
        else if (typeof item === 'object') {
            var objAttributes = ObjectSerializer.object2attributes(item, key);
            for (var name_4 in objAttributes) {
                attributes[name_4] = objAttributes[name_4];
            }
        }
        else {
            attributes[key] = item;
        }
        return attributes;
    };
    ObjectSerializer.object2attributes = function (obj, rootKey) {
        var attributes = {};
        for (var objKey in obj) {
            var item = obj[objKey];
            var key = rootKey + '.' + objKey;
            var childAttr = ObjectSerializer.make2Attributes(item, key);
            for (var name_5 in childAttr) {
                attributes[name_5] = childAttr[name_5];
            }
        }
        return attributes;
    };
    ObjectSerializer.array2attributes = function (array, rootKey) {
        var attributes = {};
        for (var i = 0; i < array.length; i++) {
            var item = array[i];
            var key = rootKey + '.' + i;
            var childAttr = ObjectSerializer.make2Attributes(item, key);
            for (var name_6 in childAttr) {
                attributes[name_6] = childAttr[name_6];
            }
        }
        return attributes;
    };
    ObjectSerializer.prototype.parseXml = function (xml) {
        var xmlElement = null;
        if (typeof xml === 'string') {
            xmlElement = _system_util_xml_util__WEBPACK_IMPORTED_MODULE_1__["XmlUtil"].xml2element(xml);
        }
        else {
            xmlElement = xml;
        }
        if (!xmlElement) {
            console.error('xmlElementが空です');
            return null;
        }
        var gameObject = _object_factory__WEBPACK_IMPORTED_MODULE_2__["ObjectFactory"].instance.create(xmlElement.tagName);
        if (!gameObject)
            return null;
        if ('parseAttributes' in gameObject) {
            gameObject.parseAttributes(xmlElement.attributes);
        }
        else {
            var context = gameObject.toContext();
            ObjectSerializer.parseAttributes(context.syncData, xmlElement.attributes);
            gameObject.apply(context);
        }
        gameObject.initialize();
        if ('parseInnerXml' in gameObject) {
            gameObject.parseInnerXml(xmlElement);
        }
        return gameObject;
    };
    ObjectSerializer.parseAttributes = function (syncData, attributes) {
        var _a;
        for (var i = 0; i < attributes.length; i++) {
            var value = attributes[i].value;
            value = _system_util_xml_util__WEBPACK_IMPORTED_MODULE_1__["XmlUtil"].decodeEntityReference(value);
            var split = attributes[i].name.split('.');
            var key = split[0];
            var obj = syncData;
            if (1 < split.length) {
                (_a = ObjectSerializer.attributes2object(split, obj, key), obj = _a.obj, key = _a.key);
            }
            var type = typeof obj[key];
            if (type !== 'string' && obj[key] != null) {
                value = JSON.parse(value);
            }
            obj[key] = value;
        }
        return syncData;
    };
    ObjectSerializer.attributes2object = function (split, obj, key) {
        // 階層構造の解析 foo.bar.0="abc" 等
        // 処理として実装こそしているが、xmlの仕様としては良くないので使用するべきではない.
        var parentObj = null;
        for (var i = 0; i < split.length; i++) {
            var index = parseInt(split[i]);
            if (parentObj && !Number.isNaN(index) && !Array.isArray(obj) && Object.keys(parentObj).length) {
                parentObj[key] = [];
                obj = parentObj[key];
            }
            key = Number.isNaN(index) ? split[i] : index;
            if (i + 1 < split.length) {
                if (obj[key] === undefined)
                    obj[key] = typeof key === 'number' ? [] : {};
                parentObj = obj;
                obj = obj[key];
            }
        }
        return { obj: obj, key: key };
    };
    ObjectSerializer.parseInnerXml = function (element) {
        return null;
    };
    return ObjectSerializer;
}());



/***/ }),

/***/ "./src/app/class/core/synchronize-object/object-store.ts":
/*!***************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/object-store.ts ***!
  \***************************************************************/
/*! exports provided: ObjectStore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObjectStore", function() { return ObjectStore; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _system_util_zero_timeout__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../system/util/zero-timeout */ "./src/app/class/core/system/util/zero-timeout.ts");



var ObjectStore = /** @class */ (function () {
    function ObjectStore() {
        var _this = this;
        this.identifierMap = new Map();
        this.aliasNameMap = new Map();
        this.garbageMap = new Map();
        this.queueMap = new Map();
        this.updateInterval = null;
        this.garbageCollectionInterval = null;
        this.updateCallback = function () { _this.updateQueue(); };
        console.log('ObjectStore ready...');
    }
    Object.defineProperty(ObjectStore, "instance", {
        get: function () {
            if (!ObjectStore._instance)
                ObjectStore._instance = new ObjectStore();
            return ObjectStore._instance;
        },
        enumerable: true,
        configurable: true
    });
    ;
    ObjectStore.prototype.add = function (object, shouldBroadcast) {
        if (shouldBroadcast === void 0) { shouldBroadcast = true; }
        if (this.get(object.identifier) != null || this.isDeleted(object.identifier))
            return null;
        this.identifierMap.set(object.identifier, object);
        var objectsMap = this.aliasNameMap.has(object.aliasName) ? this.aliasNameMap.get(object.aliasName) : this.aliasNameMap.set(object.aliasName, new Map()).get(object.aliasName);
        objectsMap.set(object.identifier, object);
        object.onStoreAdded();
        if (shouldBroadcast)
            this.update(object.toContext());
        return object;
    };
    ObjectStore.prototype.remove = function (object) {
        if (!this.identifierMap.has(object.identifier))
            return null;
        this.identifierMap.delete(object.identifier);
        var objectsMap = this.aliasNameMap.get(object.aliasName);
        if (objectsMap)
            objectsMap.delete(object.identifier);
        object.onStoreRemoved();
        return object;
    };
    ObjectStore.prototype.delete = function (arg, shouldBroadcast) {
        if (shouldBroadcast === void 0) { shouldBroadcast = true; }
        var object = null;
        var identifier = null;
        if (typeof arg === 'string') {
            object = this.get(arg);
            identifier = arg;
        }
        else {
            object = arg;
            identifier = arg.identifier;
        }
        this.markForDelete(identifier);
        return object == null ? null : this._delete(object, shouldBroadcast);
    };
    ObjectStore.prototype._delete = function (object, shouldBroadcast) {
        if (this.remove(object) === null)
            return null;
        if (shouldBroadcast)
            _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('DELETE_GAME_OBJECT', { identifier: object.identifier });
        return object;
    };
    ObjectStore.prototype.markForDelete = function (identifier) {
        this.garbageMap.set(identifier, performance.now());
        this.garbageCollection(10 * 60 * 1000);
    };
    ObjectStore.prototype.get = function (identifier) {
        return this.identifierMap.has(identifier) ? this.identifierMap.get(identifier) : null;
    };
    ObjectStore.prototype.getObjects = function (arg) {
        if (arg == null) {
            return Array.from(this.identifierMap.values());
        }
        var aliasName = '';
        if (typeof arg === 'string') {
            aliasName = arg;
        }
        else {
            aliasName = arg.aliasName;
        }
        return this.aliasNameMap.has(aliasName) ? Array.from(this.aliasNameMap.get(aliasName).values()) : [];
    };
    ObjectStore.prototype.update = function (arg) {
        var context = null;
        if (typeof arg === 'string') {
            var object = this.get(arg);
            if (object)
                context = object.toContext();
        }
        else {
            context = arg;
        }
        if (!context)
            return;
        if (this.queueMap.has(context.identifier)) {
            var queue = this.queueMap.get(context.identifier);
            for (var key in context) {
                queue[key] = context[key];
            }
            return;
        }
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('UPDATE_GAME_OBJECT', context);
        this.queueMap.set(context.identifier, context);
        if (this.updateInterval === null) {
            this.updateInterval = Object(_system_util_zero_timeout__WEBPACK_IMPORTED_MODULE_2__["setZeroTimeout"])(this.updateCallback);
        }
    };
    ObjectStore.prototype.updateQueue = function () {
        this.queueMap.clear();
        this.updateInterval = null;
    };
    ObjectStore.prototype.isDeleted = function (identifier) {
        var timeStamp = this.garbageMap.get(identifier);
        return timeStamp != null;
    };
    ObjectStore.prototype.getCatalog = function () {
        var e_1, _a;
        var catalog = [];
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.identifierMap.values()), _c = _b.next(); !_c.done; _c = _b.next()) {
                var object = _c.value;
                catalog.push({ identifier: object.identifier, version: object.version });
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return catalog;
    };
    ObjectStore.prototype.clearDeleteHistory = function () {
        this.garbageMap.clear();
    };
    ObjectStore.prototype.garbageCollection = function (arg) {
        var _this = this;
        if (typeof arg === 'number') {
            if (this.garbageCollectionInterval === null) {
                this.garbageCollectionInterval = setTimeout(function () { _this.garbageCollectionInterval = null; }, 1000);
                this._garbageCollection(arg);
            }
        }
        else {
            this.garbageMap.delete(arg.identifier);
        }
    };
    ObjectStore.prototype._garbageCollection = function (ms) {
        var nowDate = performance.now();
        var checkLength = this.garbageMap.size - 100000;
        if (checkLength < 1)
            return;
        var entries = this.garbageMap.entries();
        while (checkLength < 1) {
            checkLength--;
            var item = entries.next();
            if (item.done)
                break;
            var identifier = item.value[0];
            var timeStamp = item.value[1];
            if (timeStamp + ms < nowDate)
                continue;
            this.garbageMap.delete(identifier);
        }
    };
    return ObjectStore;
}());



/***/ }),

/***/ "./src/app/class/core/synchronize-object/object-synchronizer.ts":
/*!**********************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/object-synchronizer.ts ***!
  \**********************************************************************/
/*! exports provided: ObjectSynchronizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObjectSynchronizer", function() { return ObjectSynchronizer; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _object_factory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./object-factory */ "./src/app/class/core/synchronize-object/object-factory.ts");
/* harmony import */ var _object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _synchronize_task__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./synchronize-task */ "./src/app/class/core/synchronize-object/synchronize-task.ts");





var ObjectSynchronizer = /** @class */ (function () {
    function ObjectSynchronizer() {
        this.requestMap = new Map();
        this.tasks = [];
    }
    Object.defineProperty(ObjectSynchronizer, "instance", {
        get: function () {
            if (!ObjectSynchronizer._instance)
                ObjectSynchronizer._instance = new ObjectSynchronizer();
            return ObjectSynchronizer._instance;
        },
        enumerable: true,
        configurable: true
    });
    ObjectSynchronizer.prototype.initialize = function () {
        var _this = this;
        this.destroy();
        console.log('ObjectSynchronizer ready...');
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].register(this)
            .on('CONNECT_PEER', 2, function (event) {
            if (!event.isSendFromSelf)
                return;
            console.log('CONNECT_PEER GameRoomService !!!', event.data.peer);
            _this.sendCatalog(event.data.peer);
        })
            .on('SYNCHRONIZE_GAME_OBJECT', function (event) {
            var e_1, _a;
            if (event.isSendFromSelf)
                return;
            console.log('SYNCHRONIZE_GAME_OBJECT ' + event.sendFrom);
            var catalog = event.data;
            try {
                for (var catalog_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](catalog), catalog_1_1 = catalog_1.next(); !catalog_1_1.done; catalog_1_1 = catalog_1.next()) {
                    var item = catalog_1_1.value;
                    if (_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.isDeleted(item.identifier)) {
                        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('DELETE_GAME_OBJECT', { identifier: item.identifier }, event.sendFrom);
                    }
                    else {
                        _this.addRequestMap(item, event.sendFrom);
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (catalog_1_1 && !catalog_1_1.done && (_a = catalog_1.return)) _a.call(catalog_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            _this.synchronize();
        })
            .on('REQUEST_GAME_OBJECT', function (event) {
            if (event.isSendFromSelf)
                return;
            if (_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.isDeleted(event.data)) {
                _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('DELETE_GAME_OBJECT', { identifier: event.data }, event.sendFrom);
            }
            else {
                var object = _object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(event.data);
                if (object)
                    _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('UPDATE_GAME_OBJECT', object.toContext(), event.sendFrom);
            }
        })
            .on('UPDATE_GAME_OBJECT', function (event) {
            var context = event.data;
            var object = _object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(context.identifier);
            if (object) {
                if (!event.isSendFromSelf)
                    _this.updateObject(object, context);
            }
            else if (_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.isDeleted(context.identifier)) {
                _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('DELETE_GAME_OBJECT', { identifier: context.identifier }, event.sendFrom);
            }
            else {
                _this.createObject(context);
            }
        })
            .on('DELETE_GAME_OBJECT', function (event) {
            var context = event.data;
            _object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.delete(context.identifier, false);
        });
    };
    ObjectSynchronizer.prototype.destroy = function () {
        _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].unregister(this);
    };
    ObjectSynchronizer.prototype.updateObject = function (object, context) {
        if (context.majorVersion + context.minorVersion > object.version) {
            object.apply(context);
        }
    };
    ObjectSynchronizer.prototype.createObject = function (context) {
        var newObject = _object_factory__WEBPACK_IMPORTED_MODULE_2__["ObjectFactory"].instance.create(context.aliasName, context.identifier);
        if (!newObject) {
            console.warn(context.aliasName + ' is Unknown...?', context);
            return;
        }
        _object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.add(newObject, false);
        newObject.apply(context);
    };
    ObjectSynchronizer.prototype.sendCatalog = function (sendTo) {
        var catalog = _object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.getCatalog();
        var interval = setInterval(function () {
            var count = catalog.length < 2048 ? catalog.length : 2048;
            _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('SYNCHRONIZE_GAME_OBJECT', catalog.splice(0, count), sendTo);
            if (catalog.length < 1)
                clearInterval(interval);
        });
    };
    ObjectSynchronizer.prototype.addRequestMap = function (item, sendFrom) {
        var request = this.requestMap.get(item.identifier);
        if (request && request.version === item.version) {
            request.holderIds.push(sendFrom);
        }
        else if (!request || request.version < item.version) {
            this.requestMap.set(item.identifier, { identifier: item.identifier, version: item.version, holderIds: [sendFrom], ttl: 2 });
        }
    };
    ObjectSynchronizer.prototype.synchronize = function () {
        while (0 < this.requestMap.size && this.tasks.length < 32)
            this.runSynchronizeTask();
    };
    ObjectSynchronizer.prototype.runSynchronizeTask = function () {
        var _this = this;
        var requests = this.makeRequestList();
        if (requests.length < 1)
            return;
        var task = _synchronize_task__WEBPACK_IMPORTED_MODULE_4__["SynchronizeTask"].create(requests);
        this.tasks.push(task);
        task.onfinish = function (task) {
            _this.tasks.splice(_this.tasks.indexOf(task), 1);
            _this.synchronize();
        };
        task.ontimeout = function (task, remainedRequests) {
            console.log('GameObject synchronize タイムアウト');
            remainedRequests.forEach(function (request) { return _this.requestMap.set(request.identifier, request); });
        };
    };
    ObjectSynchronizer.prototype.makeRequestList = function (maxRequest) {
        if (maxRequest === void 0) { maxRequest = 32; }
        var entries = this.requestMap.entries();
        var requests = [];
        while (requests.length < maxRequest) {
            var item = entries.next();
            if (item.done)
                break;
            var identifier = item.value[0];
            var request = item.value[1];
            var gameObject = _object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(request.identifier);
            if (!gameObject || gameObject.version < request.version)
                requests.push(request);
            this.requestMap.delete(identifier);
        }
        return requests;
    };
    return ObjectSynchronizer;
}());



/***/ }),

/***/ "./src/app/class/core/synchronize-object/synchronize-task.ts":
/*!*******************************************************************!*\
  !*** ./src/app/class/core/synchronize-object/synchronize-task.ts ***!
  \*******************************************************************/
/*! exports provided: SynchronizeTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SynchronizeTask", function() { return SynchronizeTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _system__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system */ "./src/app/class/core/system/index.ts");


var SynchronizeTask = /** @class */ (function () {
    function SynchronizeTask() {
        this.requestMap = new Map();
    }
    SynchronizeTask.create = function (requests) {
        if (SynchronizeTask.tasksMap.size < 1) {
            _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].register(SynchronizeTask.key)
                .on('UPDATE_GAME_OBJECT', function (event) {
                if (event.isSendFromSelf)
                    return;
                SynchronizeTask.onUpdate(event.data.identifier);
            })
                .on('DELETE_GAME_OBJECT', function (event) {
                if (event.isSendFromSelf)
                    return;
                SynchronizeTask.onUpdate(event.data.identifier);
            });
        }
        var task = new SynchronizeTask();
        task.initialize(requests);
        return task;
    };
    SynchronizeTask.prototype.cancel = function () {
        clearTimeout(this.timeoutTimer);
        this.onfinish = this.ontimeout = null;
    };
    SynchronizeTask.prototype.initialize = function (requests) {
        var e_1, _a;
        var _this = this;
        try {
            for (var requests_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](requests), requests_1_1 = requests_1.next(); !requests_1_1.done; requests_1_1 = requests_1.next()) {
                var request = requests_1_1.value;
                request.ttl--;
                this.requestMap.set(request.identifier, request);
                var tasks = SynchronizeTask.tasksMap.get(request.identifier);
                if (tasks == null)
                    tasks = [];
                tasks.push(this);
                SynchronizeTask.tasksMap.set(request.identifier, tasks);
                _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].call('REQUEST_GAME_OBJECT', request.identifier, this.randomChoice(request.holderIds));
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (requests_1_1 && !requests_1_1.done && (_a = requests_1.return)) _a.call(requests_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        if (this.requestMap.size < 1) {
            setTimeout(function () {
                if (_this.onfinish)
                    _this.onfinish(_this);
                _this.cancel();
            });
            return;
        }
        this.resetTimeout();
    };
    SynchronizeTask.onUpdate = function (identifier) {
        var e_2, _a;
        if (!SynchronizeTask.tasksMap.has(identifier))
            return;
        var tasks = SynchronizeTask.tasksMap.get(identifier);
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](tasks.concat()), _c = _b.next(); !_c.done; _c = _b.next()) {
                var task = _c.value;
                task.onUpdate(identifier);
                if (task.requestMap.size < 1)
                    tasks.splice(tasks.indexOf(task), 1);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        if (tasks.length < 1)
            SynchronizeTask.tasksMap.delete(identifier);
        if (SynchronizeTask.tasksMap.size < 1)
            _system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].unregister(SynchronizeTask.key);
    };
    SynchronizeTask.prototype.onUpdate = function (identifier) {
        this.requestMap.delete(identifier);
        if (this.onsynchronize)
            this.onsynchronize(this, identifier);
        if (this.requestMap.size < 1) {
            if (this.onfinish)
                this.onfinish(this);
            this.cancel();
        }
        else {
            this.resetTimeout();
        }
    };
    SynchronizeTask.prototype.randomChoice = function (peers) {
        var peerContexts = _system__WEBPACK_IMPORTED_MODULE_1__["Network"].peerContexts.filter(function (peerContext) { return peerContext.isOpen && -1 < peers.indexOf(peerContext.fullstring); });
        if (peerContexts.length < 1)
            return null;
        var min = 0;
        var max = peerContexts.length;
        var index = Math.floor(Math.random() * (max - min)) + min;
        var peerId = peerContexts[index].fullstring;
        return peerId;
    };
    SynchronizeTask.prototype.resetTimeout = function () {
        var _this = this;
        clearTimeout(this.timeoutTimer);
        this.timeoutTimer = setTimeout(function () {
            if (_this.ontimeout)
                _this.ontimeout(_this, Array.from(_this.requestMap.values()).filter(function (request) { return 0 <= request.ttl; }));
            if (_this.onfinish)
                _this.onfinish(_this);
            _this.cancel();
        }, 30 * 1000);
    };
    SynchronizeTask.key = {};
    SynchronizeTask.tasksMap = new Map();
    return SynchronizeTask;
}());



/***/ }),

/***/ "./src/app/class/core/system/event/event-system.ts":
/*!*********************************************************!*\
  !*** ./src/app/class/core/system/event/event-system.ts ***!
  \*********************************************************/
/*! exports provided: EventSystem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventSystem", function() { return EventSystem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _network_network__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../network/network */ "./src/app/class/core/system/network/network.ts");
/* harmony import */ var _event__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./event */ "./src/app/class/core/system/event/event.ts");
/* harmony import */ var _listener__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./listener */ "./src/app/class/core/system/event/listener.ts");




var EventSystem = /** @class */ (function () {
    function EventSystem() {
        this.listenerMap = new Map();
        console.log('EventSystem ready...');
    }
    Object.defineProperty(EventSystem, "instance", {
        get: function () {
            if (!EventSystem._instance) {
                EventSystem._instance = new EventSystem();
                EventSystem._instance.initializeNetworkEvent();
            }
            return EventSystem._instance;
        },
        enumerable: true,
        configurable: true
    });
    EventSystem.prototype.register = function (key) {
        var listener = new _listener__WEBPACK_IMPORTED_MODULE_3__["Listener"](this, key);
        return listener;
    };
    EventSystem.prototype.unregister = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (args.length === 1) {
            return this._unregister(args[0], null, null);
        }
        else if (args.length === 2) {
            if (typeof args[1] === 'string') {
                return this._unregister(args[0], args[1], null);
            }
            else {
                return this._unregister(args[0], null, args[1]);
            }
        }
        else {
            return this._unregister(args[0], args[1], args[2]);
        }
    };
    EventSystem.prototype._unregister = function (key, eventName, callback) {
        var e_1, _a, e_2, _b;
        if (key === void 0) { key = this; }
        var listenersIterator = this.listenerMap.values();
        try {
            for (var listenersIterator_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](listenersIterator), listenersIterator_1_1 = listenersIterator_1.next(); !listenersIterator_1_1.done; listenersIterator_1_1 = listenersIterator_1.next()) {
                var listeners = listenersIterator_1_1.value;
                try {
                    for (var _c = (e_2 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](listeners.concat())), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var listener = _d.value;
                        if (listener.isEqual(key, eventName, callback)) {
                            listener.unregister();
                        }
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (listenersIterator_1_1 && !listenersIterator_1_1.done && (_a = listenersIterator_1.return)) _a.call(listenersIterator_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    EventSystem.prototype.registerListener = function (listener) {
        var listeners = this.getListeners(listener.eventName);
        listeners.push(listener);
        listeners.sort(function (a, b) { return b.priority - a.priority; });
        this.listenerMap.set(listener.eventName, listeners);
        return listener;
    };
    EventSystem.prototype.unregisterListener = function (listener) {
        var listeners = this.getListeners(listener.eventName);
        var index = listeners.indexOf(listener);
        if (index < 0)
            return null;
        listeners.splice(index, 1);
        listener.unregister();
        if (listeners.length < 1)
            this.listenerMap.delete(listener.eventName);
        return listener;
    };
    EventSystem.prototype.call = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (typeof args[0] === 'string') {
            this._call(new _event__WEBPACK_IMPORTED_MODULE_2__["Event"](args[0], args[1]), args[2]);
        }
        else {
            this._call(args[0], args[1]);
        }
    };
    EventSystem.prototype._call = function (event, sendTo) {
        var context = event.toContext();
        _network_network__WEBPACK_IMPORTED_MODULE_1__["Network"].instance.send(context, sendTo);
    };
    EventSystem.prototype.trigger = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (args.length === 2) {
            this._trigger(new _event__WEBPACK_IMPORTED_MODULE_2__["Event"](args[0], args[1]));
        }
        else if (args[0] instanceof _event__WEBPACK_IMPORTED_MODULE_2__["Event"]) {
            return this._trigger(args[0]);
        }
        else {
            return this._trigger(new _event__WEBPACK_IMPORTED_MODULE_2__["Event"](args[0].eventName, args[0].data, args[0].sendFrom));
        }
    };
    EventSystem.prototype._trigger = function (event) {
        var e_3, _a;
        var listeners = this.getListeners(event.eventName).concat(this.getListeners('*'));
        try {
            for (var listeners_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](listeners), listeners_1_1 = listeners_1.next(); !listeners_1_1.done; listeners_1_1 = listeners_1.next()) {
                var listener = listeners_1_1.value;
                listener.trigger(event);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (listeners_1_1 && !listeners_1_1.done && (_a = listeners_1.return)) _a.call(listeners_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return event;
    };
    EventSystem.prototype.getListeners = function (eventName) {
        return this.listenerMap.has(eventName) ? this.listenerMap.get(eventName) : [];
    };
    EventSystem.prototype.initializeNetworkEvent = function () {
        var _this = this;
        var callback = _network_network__WEBPACK_IMPORTED_MODULE_1__["Network"].instance.callback;
        callback.onOpen = function (peerId) {
            _this.trigger('OPEN_NETWORK', { peer: peerId });
        };
        callback.onClose = function (peerId) {
            _this.trigger('CLOSE_NETWORK', { peer: peerId });
        };
        callback.onConnect = function (peerId) {
            _this.sendSystemMessage('<' + peerId + '> connect <DataConnection>');
            _this.trigger('CONNECT_PEER', { peer: peerId });
        };
        callback.onDisconnect = function (peerId) {
            _this.sendSystemMessage('<' + peerId + '> disconnect <DataConnection>');
            _this.trigger('DISCONNECT_PEER', { peer: peerId });
        };
        callback.onData = function (peerId, data) {
            var e_4, _a;
            try {
                for (var data_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](data), data_1_1 = data_1.next(); !data_1_1.done; data_1_1 = data_1.next()) {
                    var event_1 = data_1_1.value;
                    _this.trigger(event_1);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (data_1_1 && !data_1_1.done && (_a = data_1.return)) _a.call(data_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        };
        callback.onError = function (peerId, err) {
            _this.sendSystemMessage('<' + peerId + '> ' + err);
        };
    };
    EventSystem.prototype.sendSystemMessage = function (message) {
        console.log(message);
    };
    return EventSystem;
}());



/***/ }),

/***/ "./src/app/class/core/system/event/event.ts":
/*!**************************************************!*\
  !*** ./src/app/class/core/system/event/event.ts ***!
  \**************************************************/
/*! exports provided: Event */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Event", function() { return Event; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _network_network__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../network/network */ "./src/app/class/core/system/network/network.ts");


var Event = /** @class */ (function () {
    function Event(eventName, data, sendFrom) {
        if (sendFrom === void 0) { sendFrom = _network_network__WEBPACK_IMPORTED_MODULE_1__["Network"].instance.peerId; }
        this.eventName = eventName;
        this.data = data;
        this.sendFrom = sendFrom;
        this.isSendFromSelf = false;
        this.isSendFromSelf = this.sendFrom === _network_network__WEBPACK_IMPORTED_MODULE_1__["Network"].instance.peerId;
    }
    Event.prototype.toContext = function () {
        return {
            sendFrom: this.sendFrom,
            eventName: this.eventName,
            data: this.data,
        };
    };
    return Event;
}());



/***/ }),

/***/ "./src/app/class/core/system/event/listener.ts":
/*!*****************************************************!*\
  !*** ./src/app/class/core/system/event/listener.ts ***!
  \*****************************************************/
/*! exports provided: Listener */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Listener", function() { return Listener; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var Listener = /** @class */ (function () {
    function Listener(subject, key) {
        this._priority = 0;
        this._isRegistered = false;
        this._subject = subject;
        this._key = key;
    }
    Object.defineProperty(Listener.prototype, "subject", {
        get: function () { return this._subject; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Listener.prototype, "key", {
        get: function () { return this._key; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Listener.prototype, "eventName", {
        get: function () { return this._eventName; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Listener.prototype, "priority", {
        get: function () { return this._priority; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Listener.prototype, "callback", {
        get: function () { return this._callback; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Listener.prototype, "isOnlyOnce", {
        get: function () { return this._isOnlyOnce; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Listener.prototype, "isRegistered", {
        get: function () { return this._isRegistered; },
        enumerable: true,
        configurable: true
    });
    Listener.prototype.on = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        this._isOnlyOnce = false;
        if (args.length === 2) {
            return this.register(args[0], 0, args[1]);
        }
        else {
            return this.register(args[0], args[1], args[2]);
        }
    };
    Listener.prototype.once = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var listener = this.on.apply(this, args);
        this._isOnlyOnce = true;
        return listener;
    };
    Listener.prototype.register = function (eventName, priority, callback) {
        if (this.isRegistered)
            this.unregister();
        this._eventName = eventName ? eventName : '*';
        this._priority = priority;
        this._callback = callback;
        this.subject.registerListener(this);
        this._isRegistered = true;
        return new Listener(this.subject, this.key);
    };
    Listener.prototype.unregister = function () {
        this.subject.unregisterListener(this);
        this._callback = null;
        this._isRegistered = false;
        return this;
    };
    Listener.prototype.trigger = function (event) {
        if (this.callback && this.isRegistered) {
            this.callback.apply(this.key, [event, this]);
            if (this.isOnlyOnce)
                this.unregister();
        }
    };
    Listener.prototype.isEqual = function (key, eventName, callback) {
        var matchTarget = (key == null || key === this.key);
        var matchEventName = (eventName == null || eventName === this.eventName);
        var matchCallback = (callback == null || callback === this.callback);
        return matchTarget && matchEventName && matchCallback;
    };
    return Listener;
}());



/***/ }),

/***/ "./src/app/class/core/system/index.ts":
/*!********************************************!*\
  !*** ./src/app/class/core/system/index.ts ***!
  \********************************************/
/*! exports provided: Event, Listener, EventSystem, Network */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventSystem", function() { return EventSystem; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Network", function() { return Network; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _event_event_system__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./event/event-system */ "./src/app/class/core/system/event/event-system.ts");
/* harmony import */ var _network_network__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./network/network */ "./src/app/class/core/system/network/network.ts");
/* harmony import */ var _event_event__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./event/event */ "./src/app/class/core/system/event/event.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Event", function() { return _event_event__WEBPACK_IMPORTED_MODULE_3__["Event"]; });

/* harmony import */ var _event_listener__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./event/listener */ "./src/app/class/core/system/event/listener.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Listener", function() { return _event_listener__WEBPACK_IMPORTED_MODULE_4__["Listener"]; });






var EventSystem = _event_event_system__WEBPACK_IMPORTED_MODULE_1__["EventSystem"].instance;
var Network = _network_network__WEBPACK_IMPORTED_MODULE_2__["Network"].instance;


/***/ }),

/***/ "./src/app/class/core/system/network/connection.ts":
/*!*********************************************************!*\
  !*** ./src/app/class/core/system/network/connection.ts ***!
  \*********************************************************/
/*! exports provided: ConnectionCallback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ConnectionCallback", function() { return ConnectionCallback; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var ConnectionCallback = /** @class */ (function () {
    function ConnectionCallback() {
    }
    return ConnectionCallback;
}());



/***/ }),

/***/ "./src/app/class/core/system/network/network.ts":
/*!******************************************************!*\
  !*** ./src/app/class/core/system/network/network.ts ***!
  \******************************************************/
/*! exports provided: Network */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Network", function() { return Network; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_zero_timeout__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/zero-timeout */ "./src/app/class/core/system/util/zero-timeout.ts");
/* harmony import */ var _connection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./connection */ "./src/app/class/core/system/network/connection.ts");
/* harmony import */ var _skyway_connection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./skyway-connection */ "./src/app/class/core/system/network/skyway-connection.ts");




var Network = /** @class */ (function () {
    function Network() {
        var _this = this;
        this.callback = new _connection__WEBPACK_IMPORTED_MODULE_2__["ConnectionCallback"]();
        this.key = '';
        this.queue = [];
        this.sendInterval = null;
        this.sendCallback = function () { _this.sendQueue(); };
        this.callbackUnload = function (e) { _this.close(); };
        console.log('Network ready...');
    }
    Object.defineProperty(Network, "instance", {
        get: function () {
            if (!Network._instance)
                Network._instance = new Network();
            return Network._instance;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Network.prototype, "peerId", {
        get: function () { return this.connection ? this.connection.peerId : '???'; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Network.prototype, "peerIds", {
        get: function () { return this.connection ? this.connection.peerIds.concat() : []; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Network.prototype, "peerContexts", {
        get: function () { return this.connection ? this.connection.peerContexts.concat() : []; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Network.prototype, "peerContext", {
        get: function () { return this.connection ? this.connection.peerContext : null; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Network.prototype, "isOpen", {
        get: function () { return this.connection && this.connection.peerContext ? this.connection.peerContext.isOpen : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Network.prototype, "bandwidthUsage", {
        get: function () { return this.connection ? this.connection.bandwidthUsage : 0; },
        enumerable: true,
        configurable: true
    });
    Network.prototype.open = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (this.connection && this.connection.peerContext) {
            console.warn('It is already opened.');
            this.close();
        }
        console.log('PeerRoom ready...', args);
        this.connection = this.initializeConnection();
        this.connection.open.apply(this.connection, args);
        window.addEventListener('unload', this.callbackUnload, false);
    };
    Network.prototype.close = function () {
        if (this.connection)
            this.connection.close();
        this.connection = null;
        window.removeEventListener('unload', this.callbackUnload, false);
        console.log('Network close...');
    };
    Network.prototype.connect = function (peerId) {
        if (this.connection)
            return this.connection.connect(peerId);
        return false;
    };
    Network.prototype.disconnect = function (peerId) {
        if (!this.connection)
            return;
        if (this.connection.disconnect(peerId)) {
            console.log('<disconnectPeer()> Peer:' + peerId);
            this.disconnect(peerId);
        }
    };
    Network.prototype.send = function (data, sendTo) {
        this.queue.push({ data: data, sendTo: sendTo });
        if (this.sendInterval === null) {
            this.sendInterval = Object(_util_zero_timeout__WEBPACK_IMPORTED_MODULE_1__["setZeroTimeout"])(this.sendCallback);
        }
    };
    Network.prototype.sendQueue = function () {
        var e_1, _a;
        var broadcast = [];
        var unicast = {};
        var echocast = [];
        var length = this.queue.length < 128 ? this.queue.length : 128;
        var items = this.queue.splice(0, length);
        try {
            for (var items_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {
                var item = items_1_1.value;
                if (item.sendTo == null) {
                    broadcast.push(item.data);
                }
                else if (item.sendTo === this.peerId) {
                    echocast.push(item.data);
                }
                else {
                    if (!(item.sendTo in unicast))
                        unicast[item.sendTo] = [];
                    unicast[item.sendTo].push(item.data);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        // できるだけ一纏めにして送る
        if (this.connection) {
            if (broadcast.length)
                this.connection.send(broadcast);
            for (var sendTo in unicast)
                this.connection.send(unicast[sendTo], sendTo);
        }
        // 自分自身への送信
        if (this.callback.onData) {
            this.callback.onData(null, broadcast);
            this.callback.onData(this.peerId, echocast);
        }
        if (0 < this.queue.length) {
            this.sendInterval = Object(_util_zero_timeout__WEBPACK_IMPORTED_MODULE_1__["setZeroTimeout"])(this.sendCallback);
        }
        else {
            this.sendInterval = null;
        }
    };
    Network.prototype.setApiKey = function (key) {
        if (this.key !== key)
            console.log('Key Change');
        this.key = key;
    };
    Network.prototype.listAllPeers = function () {
        return this.connection ? this.connection.listAllPeers() : Promise.resolve([]);
    };
    Network.prototype.initializeConnection = function () {
        var _this = this;
        var store = new _skyway_connection__WEBPACK_IMPORTED_MODULE_3__["SkyWayConnection"]();
        store.setApiKey(this.key);
        store.callback.onOpen = function (peerId) { if (_this.callback.onOpen)
            _this.callback.onOpen(peerId); };
        store.callback.onClose = function (peerId) { if (_this.callback.onClose)
            _this.callback.onClose(peerId); };
        store.callback.onConnect = function (peerId) { if (_this.callback.onConnect)
            _this.callback.onConnect(peerId); };
        store.callback.onDisconnect = function (peerId) { if (_this.callback.onDisconnect)
            _this.callback.onDisconnect(peerId); };
        store.callback.onData = function (peerId, data) { if (_this.callback.onData)
            _this.callback.onData(peerId, data); };
        store.callback.onError = function (peerId, err) { if (_this.callback.onError)
            _this.callback.onError(peerId, err); };
        if (0 < this.queue.length && this.sendInterval === null)
            this.sendInterval = Object(_util_zero_timeout__WEBPACK_IMPORTED_MODULE_1__["setZeroTimeout"])(this.sendCallback);
        return store;
    };
    return Network;
}());



/***/ }),

/***/ "./src/app/class/core/system/network/peer-context.ts":
/*!***********************************************************!*\
  !*** ./src/app/class/core/system/network/peer-context.ts ***!
  \***********************************************************/
/*! exports provided: PeerContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PeerContext", function() { return PeerContext; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var lzbase62_lzbase62_min_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lzbase62/lzbase62.min.js */ "./node_modules/lzbase62/lzbase62.min.js");
/* harmony import */ var lzbase62_lzbase62_min_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lzbase62_lzbase62_min_js__WEBPACK_IMPORTED_MODULE_1__);


var PeerContext = /** @class */ (function () {
    function PeerContext(fullstring) {
        this.fullstring = '';
        this.id = '';
        this.room = '';
        this.roomName = '';
        this.password = '';
        this.isOpen = false;
        this.parse(fullstring);
    }
    Object.defineProperty(PeerContext.prototype, "isRoom", {
        get: function () { return 0 < this.room.length ? true : false; },
        enumerable: true,
        configurable: true
    });
    PeerContext.prototype.parse = function (fullstring) {
        try {
            this.fullstring = fullstring;
            var array = /^(\w{6})((\w{3})(\w*)-(\w*))?/ig.exec(fullstring);
            this.id = array[1];
            if (array[2] == null)
                return;
            this.room = array[3];
            this.roomName = lzbase62_lzbase62_min_js__WEBPACK_IMPORTED_MODULE_1__["decompress"](array[4]);
            this.password = lzbase62_lzbase62_min_js__WEBPACK_IMPORTED_MODULE_1__["decompress"](array[5]);
        }
        catch (e) {
            this.id = fullstring;
            console.warn(e);
        }
    };
    PeerContext.create = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        console.log('create', args);
        if (args.length <= 1) {
            return PeerContext._create.apply(this, args);
        }
        else {
            return PeerContext._createRoom.apply(this, args);
        }
    };
    PeerContext._create = function (peerId) {
        if (peerId === void 0) { peerId = ''; }
        return new PeerContext(peerId);
    };
    PeerContext._createRoom = function (peerId, roomId, roomName, password) {
        if (peerId === void 0) { peerId = ''; }
        if (roomId === void 0) { roomId = ''; }
        if (roomName === void 0) { roomName = ''; }
        if (password === void 0) { password = ''; }
        var fullstring = peerId + roomId + lzbase62_lzbase62_min_js__WEBPACK_IMPORTED_MODULE_1__["compress"](roomName) + '-' + lzbase62_lzbase62_min_js__WEBPACK_IMPORTED_MODULE_1__["compress"](password);
        try {
            console.log(fullstring);
        }
        catch (e) {
            console.error(e);
            return null;
        }
        return new PeerContext(fullstring);
    };
    PeerContext.generateId = function (format) {
        if (format === void 0) { format = '******'; }
        var h = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
        var k = format;
        k = format.replace(/\*/g, function (c) {
            var r = Math.floor(Math.random() * (h.length));
            return h[r];
        });
        return k;
    };
    return PeerContext;
}());



/***/ }),

/***/ "./src/app/class/core/system/network/skyway-connection.ts":
/*!****************************************************************!*\
  !*** ./src/app/class/core/system/network/skyway-connection.ts ***!
  \****************************************************************/
/*! exports provided: SkyWayConnection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SkyWayConnection", function() { return SkyWayConnection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var msgpack_lite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! msgpack-lite */ "./node_modules/msgpack-lite/lib/browser.js");
/* harmony import */ var msgpack_lite__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(msgpack_lite__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _util_compress__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/compress */ "./src/app/class/core/system/util/compress.ts");
/* harmony import */ var _util_zero_timeout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/zero-timeout */ "./src/app/class/core/system/util/zero-timeout.ts");
/* harmony import */ var _connection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./connection */ "./src/app/class/core/system/network/connection.ts");
/* harmony import */ var _peer_context__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./peer-context */ "./src/app/class/core/system/network/peer-context.ts");
/* harmony import */ var _skyway_data_connection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./skyway-data-connection */ "./src/app/class/core/system/network/skyway-data-connection.ts");







var SkyWayConnection = /** @class */ (function () {
    function SkyWayConnection() {
        this._peerIds = [];
        this.peerContexts = [];
        this.callback = new _connection__WEBPACK_IMPORTED_MODULE_4__["ConnectionCallback"]();
        this.bandwidthUsage = 0;
        this.key = '';
        this.connections = [];
        this.listAllPeersCache = [];
        this.httpRequestInterval = performance.now() + 500;
        this.queue = Promise.resolve();
        this.relayingPeerIds = new Map();
    }
    Object.defineProperty(SkyWayConnection.prototype, "peerId", {
        get: function () { return this.peerContext ? this.peerContext.fullstring : '???'; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SkyWayConnection.prototype, "peerIds", {
        get: function () { return this._peerIds; },
        enumerable: true,
        configurable: true
    });
    SkyWayConnection.prototype.open = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        console.log('open', args);
        if (args.length === 0) {
            this.peerContext = _peer_context__WEBPACK_IMPORTED_MODULE_5__["PeerContext"].create(_peer_context__WEBPACK_IMPORTED_MODULE_5__["PeerContext"].generateId());
        }
        else if (args.length === 1) {
            this.peerContext = _peer_context__WEBPACK_IMPORTED_MODULE_5__["PeerContext"].create(args[0]);
        }
        else {
            this.peerContext = _peer_context__WEBPACK_IMPORTED_MODULE_5__["PeerContext"].create(args[0], args[1], args[2], args[3]);
        }
        this.openPeer();
    };
    SkyWayConnection.prototype.close = function () {
        if (this.peer)
            this.peer.destroy();
        this.disconnectAll();
        this.peer = null;
        this.peerContext = null;
    };
    SkyWayConnection.prototype.connect = function (peerId) {
        if (!this.shouldConnect(peerId))
            return false;
        var conn = new _skyway_data_connection__WEBPACK_IMPORTED_MODULE_6__["SkyWayDataConnection"](this.peer.connect(peerId, {
            serialization: 'none',
            metadata: { sendFrom: this.peerId }
        }));
        this.openDataConnection(conn);
        return true;
    };
    SkyWayConnection.prototype.shouldConnect = function (peerId) {
        if (!this.peer || !this.peerId) {
            console.log('connect() is Fail. IDが割り振られるまで待てや');
            return false;
        }
        if (this.peerId === peerId) {
            console.log('connect() is Fail. ' + peerId + ' is me.');
            return false;
        }
        if (this.findDataConnection(peerId)) {
            console.log('connect() is Fail. <' + peerId + '> is already connecting.');
            return false;
        }
        if (peerId && peerId.length && peerId !== this.peerId)
            return true;
        return false;
    };
    SkyWayConnection.prototype.disconnect = function (peerId) {
        var conn = this.findDataConnection(peerId);
        if (!conn)
            return false;
        this.closeDataConnection(conn);
        return true;
    };
    SkyWayConnection.prototype.disconnectAll = function () {
        var e_1, _a;
        console.log('<closeAllDataConnection()>');
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.connections.concat()), _c = _b.next(); !_c.done; _c = _b.next()) {
                var conn = _c.value;
                this.closeDataConnection(conn);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    SkyWayConnection.prototype.send = function (data, sendTo) {
        var _this = this;
        if (this.connections.length < 1)
            return;
        var container = {
            data: msgpack_lite__WEBPACK_IMPORTED_MODULE_1__["encode"](data),
            ttl: 1
        };
        var byteLength = container.data.byteLength;
        this.bandwidthUsage += byteLength;
        this.queue = this.queue.then(function () { return new Promise(function (resolve, reject) {
            Object(_util_zero_timeout__WEBPACK_IMPORTED_MODULE_3__["setZeroTimeout"])(function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var compressed;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!(1 * 1024 < container.data.byteLength)) return [3 /*break*/, 2];
                            return [4 /*yield*/, Object(_util_compress__WEBPACK_IMPORTED_MODULE_2__["compressAsync"])(container.data)];
                        case 1:
                            compressed = _a.sent();
                            if (compressed.byteLength < container.data.byteLength) {
                                container.data = compressed;
                                container.isCompressed = true;
                            }
                            _a.label = 2;
                        case 2:
                            if (sendTo) {
                                this.sendUnicast(container, sendTo);
                            }
                            else {
                                this.sendBroadcast(container);
                            }
                            this.bandwidthUsage -= byteLength;
                            return [2 /*return*/, resolve()];
                    }
                });
            }); });
        }); });
    };
    SkyWayConnection.prototype.sendUnicast = function (container, sendTo) {
        container.ttl = 0;
        var conn = this.findDataConnection(sendTo);
        if (conn && conn.open)
            conn.send(container);
    };
    SkyWayConnection.prototype.sendBroadcast = function (container) {
        var e_2, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.connections), _c = _b.next(); !_c.done; _c = _b.next()) {
                var conn = _c.value;
                if (conn.open)
                    conn.send(container);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    SkyWayConnection.prototype.setApiKey = function (key) {
        if (this.key !== key)
            console.log('Key Change');
        this.key = key;
    };
    SkyWayConnection.prototype.listAllPeers = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            if (!_this.peer)
                return resolve([]);
            var now = performance.now();
            if (now < _this.httpRequestInterval) {
                console.warn('httpRequestInterval... ' + (_this.httpRequestInterval - now));
                resolve(_this.listAllPeersCache.concat());
                return;
            }
            _this.httpRequestInterval = now + 6000;
            _this.peer.listAllPeers(function (list) {
                _this.listAllPeersCache = list.concat();
                resolve(list);
            });
        });
    };
    SkyWayConnection.prototype.openPeer = function () {
        var _this = this;
        if (this.peer) {
            console.warn('It is already opened.');
            this.close();
        }
        var peer = new Peer(this.peerContext.fullstring, { key: this.key }); // SkyWay
        peer.on('open', function (id) {
            console.log('My peer ID is: ' + id);
            if (!_this.peerContext || _this.peerContext.fullstring !== id) {
                _this.peerContext = new _peer_context__WEBPACK_IMPORTED_MODULE_5__["PeerContext"](id);
            }
            _this.peerContext.isOpen = true;
            console.log('My peer Context', _this.peerContext);
            if (_this.callback.onOpen)
                _this.callback.onOpen(_this.peerId);
        });
        peer.on('connection', function (conn) {
            _this.openDataConnection(new _skyway_data_connection__WEBPACK_IMPORTED_MODULE_6__["SkyWayDataConnection"](conn));
        });
        peer.on('error', function (err) {
            console.error('<' + _this.peerId + '> ' + err.type + ' => ' + err.message);
            var errorMessage = _this.getSkyWayErrorMessage(err.type);
            errorMessage += ': ' + err.message;
            switch (err.type) {
                case 'peer-unavailable':
                case 'invalid-id':
                case 'invalid-key':
                case 'list-error':
                case 'server-error':
                    break;
                case 'disconnected':
                case 'socket-error':
                default:
                    if (_this.peerContext && _this.peerContext.isOpen) {
                        if (_this.callback.onClose)
                            _this.callback.onClose(_this.peerId);
                    }
                    break;
            }
            if (_this.callback.onError)
                _this.callback.onError(_this.peerId, errorMessage);
        });
        this.peer = peer;
    };
    SkyWayConnection.prototype.openDataConnection = function (conn) {
        var _this = this;
        if (this.addDataConnection(conn) === false)
            return;
        var index = this.connections.indexOf(conn);
        var context = null;
        if (0 <= index)
            context = this.peerContexts[index];
        var timeout = setTimeout(function () {
            _this.closeDataConnection(conn);
            if (_this.callback.onDisconnect)
                _this.callback.onDisconnect(conn.remoteId);
        }, 15000);
        conn.on('data', function (data) {
            _this.onData(conn, data);
        });
        conn.on('open', function () {
            if (timeout !== null)
                clearTimeout(timeout);
            timeout = null;
            if (context)
                context.isOpen = true;
            _this.updatePeerList();
            if (_this.callback.onConnect)
                _this.callback.onConnect(conn.remoteId);
        });
        conn.on('close', function () {
            if (timeout !== null)
                clearTimeout(timeout);
            timeout = null;
            _this.closeDataConnection(conn);
            if (_this.callback.onDisconnect)
                _this.callback.onDisconnect(conn.remoteId);
        });
        conn.on('error', function (err) {
            if (timeout !== null)
                clearTimeout(timeout);
            timeout = null;
            _this.closeDataConnection(conn);
            if (_this.callback.onError)
                _this.callback.onError(conn.remoteId, err);
        });
    };
    SkyWayConnection.prototype.closeDataConnection = function (conn) {
        conn.close();
        var index = this.connections.indexOf(conn);
        if (0 <= index) {
            console.log(conn.remoteId + ' is えんいー' + 'index:' + index + ' length:' + this.connections.length);
            this.connections.splice(index, 1);
            this.peerContexts.splice(index, 1);
        }
        this.relayingPeerIds.delete(conn.remoteId);
        this.relayingPeerIds.forEach(function (peerIds) {
            var index = peerIds.indexOf(conn.remoteId);
            if (0 <= index)
                peerIds.splice(index, 1);
        });
        console.log('<close()> Peer:' + conn.remoteId + ' length:' + this.connections.length + ':' + this.peerContexts.length);
        this.updatePeerList();
    };
    SkyWayConnection.prototype.addDataConnection = function (conn) {
        var existConn = this.findDataConnection(conn.remoteId);
        if (existConn !== null) {
            console.log('add() is Fail. ' + conn.remoteId + ' is already connecting.');
            if (existConn !== conn) {
                if (existConn.metadata.sendFrom < conn.metadata.sendFrom) {
                    this.closeDataConnection(conn);
                }
                else {
                    this.closeDataConnection(existConn);
                    this.addDataConnection(conn);
                    return true;
                }
            }
            return false;
        }
        this.connections.push(conn);
        this.peerContexts.push(new _peer_context__WEBPACK_IMPORTED_MODULE_5__["PeerContext"](conn.remoteId));
        console.log('<add()> Peer:' + conn.remoteId + ' length:' + this.connections.length);
        return true;
    };
    SkyWayConnection.prototype.findDataConnection = function (peerId) {
        var e_3, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.connections), _c = _b.next(); !_c.done; _c = _b.next()) {
                var conn = _c.value;
                if (conn.remoteId === peerId) {
                    return conn;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return null;
    };
    SkyWayConnection.prototype.onData = function (conn, container) {
        var _this = this;
        if (container.peers && 0 < container.peers.length)
            this.onUpdatePeerList(conn, container);
        if (0 < container.ttl)
            this.onRelay(conn, container);
        if (this.callback.onData) {
            var byteLength_1 = container.data.byteLength;
            this.bandwidthUsage += byteLength_1;
            this.queue = this.queue.then(function () { return new Promise(function (resolve, reject) {
                Object(_util_zero_timeout__WEBPACK_IMPORTED_MODULE_3__["setZeroTimeout"])(function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                    var data, _a;
                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                        switch (_b.label) {
                            case 0:
                                if (!container.isCompressed) return [3 /*break*/, 2];
                                return [4 /*yield*/, Object(_util_compress__WEBPACK_IMPORTED_MODULE_2__["decompressAsync"])(container.data)];
                            case 1:
                                _a = _b.sent();
                                return [3 /*break*/, 3];
                            case 2:
                                _a = container.data;
                                _b.label = 3;
                            case 3:
                                data = _a;
                                this.callback.onData(conn.remoteId, msgpack_lite__WEBPACK_IMPORTED_MODULE_1__["decode"](data));
                                this.bandwidthUsage -= byteLength_1;
                                return [2 /*return*/, resolve()];
                        }
                    });
                }); });
            }); });
        }
    };
    SkyWayConnection.prototype.onRelay = function (conn, container) {
        var e_4, _a;
        container.ttl--;
        var relayingPeerIds = this.relayingPeerIds.get(conn.remoteId);
        if (relayingPeerIds == null)
            return;
        try {
            for (var relayingPeerIds_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](relayingPeerIds), relayingPeerIds_1_1 = relayingPeerIds_1.next(); !relayingPeerIds_1_1.done; relayingPeerIds_1_1 = relayingPeerIds_1.next()) {
                var peerId = relayingPeerIds_1_1.value;
                var conn_1 = this.findDataConnection(peerId);
                if (conn_1 && conn_1.open) {
                    console.log('<' + peerId + '> 転送しなきゃ・・・');
                    conn_1.send(container);
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (relayingPeerIds_1_1 && !relayingPeerIds_1_1.done && (_a = relayingPeerIds_1.return)) _a.call(relayingPeerIds_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    SkyWayConnection.prototype.onUpdatePeerList = function (conn, container) {
        var e_5, _a;
        var relayingPeerIds = [];
        var unknownPeerIds = [];
        var diff = diffArray(this._peerIds, container.peers);
        relayingPeerIds = diff.diff1;
        unknownPeerIds = diff.diff2;
        this.relayingPeerIds.set(conn.remoteId, relayingPeerIds);
        container.peers = container.peers.concat(relayingPeerIds);
        if (unknownPeerIds.length) {
            try {
                for (var unknownPeerIds_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](unknownPeerIds), unknownPeerIds_1_1 = unknownPeerIds_1.next(); !unknownPeerIds_1_1.done; unknownPeerIds_1_1 = unknownPeerIds_1.next()) {
                    var peerId = unknownPeerIds_1_1.value;
                    if (this.connect(peerId))
                        console.log('auto connect to unknown Peer <' + peerId + '>');
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (unknownPeerIds_1_1 && !unknownPeerIds_1_1.done && (_a = unknownPeerIds_1.return)) _a.call(unknownPeerIds_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
    };
    SkyWayConnection.prototype.updatePeerList = function () {
        var e_6, _a;
        var peers = [];
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.connections), _c = _b.next(); !_c.done; _c = _b.next()) {
                var conn = _c.value;
                if (conn.open)
                    peers.push(conn.remoteId);
            }
        }
        catch (e_6_1) { e_6 = { error: e_6_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_6) throw e_6.error; }
        }
        peers.push(this.peerId);
        peers.sort(function (a, b) {
            if (a > b)
                return 1;
            if (a < b)
                return -1;
            return 0;
        });
        this._peerIds = peers;
        console.log('<update()>', peers);
        this.notifyPeerList();
        return peers;
    };
    SkyWayConnection.prototype.notifyPeerList = function () {
        if (this.connections.length < 1)
            return;
        var container = {
            data: msgpack_lite__WEBPACK_IMPORTED_MODULE_1__["encode"]([]),
            peers: this._peerIds,
            ttl: 1
        };
        this.sendBroadcast(container);
    };
    SkyWayConnection.prototype.getSkyWayErrorMessage = function (errType) {
        switch (errType) {
            case 'peer-unavailable':
                return 'そのPeer IDは存在しません。';
            case 'invalid-id':
                return 'Peer IDが不正です。';
            case 'invalid-key':
                return 'SkyWay APIキーが無効です。';
            case 'list-error':
                return 'SkyWay APIキーのREST APIが許可されてません。';
            case 'server-error':
                return 'SkyWayのシグナリングサーバからPeer一覧を取得できませんでした。';
            case 'disconnected':
                return 'SkyWayのシグナリングサーバに接続されていません。';
            case 'socket-error':
                return 'SkyWayのシグナリングサーバとの接続が失われました。';
            default:
                return 'SkyWayに関する不明なエラーが発生しました(' + errType + ')';
        }
    };
    return SkyWayConnection;
}());

function diffArray(array1, array2) {
    var e_7, _a;
    var diff1 = [];
    var diff2 = [];
    var includesInArray1 = false;
    var includesInArray2 = false;
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](array1.concat(array2)), _c = _b.next(); !_c.done; _c = _b.next()) {
            var item = _c.value;
            includesInArray1 = array1.includes(item);
            includesInArray2 = array2.includes(item);
            if (includesInArray1 && !includesInArray2) {
                diff1.push(item);
            }
            else if (!includesInArray1 && includesInArray2) {
                diff2.push(item);
            }
        }
    }
    catch (e_7_1) { e_7 = { error: e_7_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_7) throw e_7.error; }
    }
    return { diff1: diff1, diff2: diff2 };
}


/***/ }),

/***/ "./src/app/class/core/system/network/skyway-data-connection.ts":
/*!*********************************************************************!*\
  !*** ./src/app/class/core/system/network/skyway-data-connection.ts ***!
  \*********************************************************************/
/*! exports provided: SkyWayDataConnection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SkyWayDataConnection", function() { return SkyWayDataConnection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! events */ "./node_modules/events/events.js");
/* harmony import */ var events__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(events__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var msgpack_lite__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! msgpack-lite */ "./node_modules/msgpack-lite/lib/browser.js");
/* harmony import */ var msgpack_lite__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(msgpack_lite__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _util_uuid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/uuid */ "./src/app/class/core/system/util/uuid.ts");
/* harmony import */ var _util_zero_timeout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/zero-timeout */ "./src/app/class/core/system/util/zero-timeout.ts");





;
;
var SkyWayDataConnection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SkyWayDataConnection, _super);
    function SkyWayDataConnection(conn) {
        var _this = _super.call(this) || this;
        _this.conn = conn;
        _this.chunkSize = 15.5 * 1024;
        _this.receivedMap = new Map();
        conn.on('data', function (data) { return _this.onData(data); });
        conn.on('open', function () {
            exchangeSkyWayImplementation(conn);
            _this.emit('open');
        });
        conn.on('close', function () { return _this.emit('close'); });
        conn.on('error', function (err) { return _this.emit('error', err); });
        return _this;
    }
    Object.defineProperty(SkyWayDataConnection.prototype, "open", {
        get: function () { return this.conn.open; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SkyWayDataConnection.prototype, "remoteId", {
        get: function () { return this.conn.remoteId; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SkyWayDataConnection.prototype, "metadata", {
        get: function () { return this.conn.metadata; },
        enumerable: true,
        configurable: true
    });
    SkyWayDataConnection.prototype.close = function () {
        this.conn.close();
    };
    SkyWayDataConnection.prototype.send = function (data) {
        var encodedData = msgpack_lite__WEBPACK_IMPORTED_MODULE_2__["encode"](data);
        var total = Math.ceil(encodedData.byteLength / this.chunkSize);
        if (total <= 1) {
            this.conn.send(encodedData);
            return;
        }
        var id = _util_uuid__WEBPACK_IMPORTED_MODULE_3__["UUID"].generateUuid();
        var sliceData = null;
        var chank = null;
        for (var sliceIndex = 0; sliceIndex < total; sliceIndex++) {
            sliceData = encodedData.slice(sliceIndex * this.chunkSize, (sliceIndex + 1) * this.chunkSize);
            chank = { id: id, data: sliceData, index: sliceIndex, total: total };
            this.conn.send(msgpack_lite__WEBPACK_IMPORTED_MODULE_2__["encode"](chank));
        }
    };
    SkyWayDataConnection.prototype.onData = function (data) {
        var e_1, _a;
        var chank = msgpack_lite__WEBPACK_IMPORTED_MODULE_2__["decode"](new Uint8Array(data));
        if (chank.id == null) {
            this.emit('data', chank);
            return;
        }
        var received = this.receivedMap.get(chank.id);
        if (received == null) {
            received = { id: chank.id, chanks: new Array(chank.total), length: 0, byteLength: 0 };
            this.receivedMap.set(chank.id, received);
        }
        if (received.chanks[chank.index] != null)
            return;
        received.length++;
        received.byteLength += chank.data.byteLength;
        received.chanks[chank.index] = chank.data;
        if (received.length < chank.total)
            return;
        this.receivedMap.delete(chank.id);
        var uint8Array = new Uint8Array(received.byteLength);
        var pos = 0;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](received.chanks), _c = _b.next(); !_c.done; _c = _b.next()) {
                var c = _c.value;
                uint8Array.set(c, pos);
                pos += c.byteLength;
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        var decodedData = msgpack_lite__WEBPACK_IMPORTED_MODULE_2__["decode"](uint8Array);
        this.emit('data', decodedData);
    };
    return SkyWayDataConnection;
}(events__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]));

/*
SkyWay の DataConnection._startSendLoop() を取り替える.
setInterval() に由来する遅延を解消するが skyway-js-sdk の更新次第で動作しなくなるので注意.

https://github.com/skyway/skyway-js-sdk/blob/master/src/peer/dataConnection.js
*/
function exchangeSkyWayImplementation(conn) {
    if (conn._dc && conn._sendBuffer) {
        conn._startSendLoop = startSendLoopZeroTimeout;
    }
}
function startSendLoopZeroTimeout() {
    if (!this.sendInterval) {
        this.sendInterval = Object(_util_zero_timeout__WEBPACK_IMPORTED_MODULE_4__["setZeroTimeout"])(sendBuffertZeroTimeout.bind(this));
    }
}
function sendBuffertZeroTimeout() {
    var currMsg = this._sendBuffer.shift();
    try {
        this._dc.send(currMsg);
    }
    catch (error) {
        this._sendBuffer.push(currMsg);
    }
    if (this._sendBuffer.length === 0) {
        this.sendInterval = undefined;
    }
    else {
        this.sendInterval = Object(_util_zero_timeout__WEBPACK_IMPORTED_MODULE_4__["setZeroTimeout"])(sendBuffertZeroTimeout.bind(this));
    }
}


/***/ }),

/***/ "./src/app/class/core/system/util/compress.ts":
/*!****************************************************!*\
  !*** ./src/app/class/core/system/util/compress.ts ***!
  \****************************************************/
/*! exports provided: compressAsync, decompressAsync */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compressAsync", function() { return compressAsync; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "decompressAsync", function() { return decompressAsync; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var pako__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pako */ "./node_modules/pako/index.js");
/* harmony import */ var pako__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pako__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _zero_timeout__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./zero-timeout */ "./src/app/class/core/system/util/zero-timeout.ts");



function compressAsync(data, chunkSize) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var deflate, e_1;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    deflate = new pako__WEBPACK_IMPORTED_MODULE_1__["Deflate"]({ level: 2, gzip: true });
                    _a.label = 1;
                case 1:
                    _a.trys.push([1, 3, , 4]);
                    return [4 /*yield*/, processAsync(deflate, data, chunkSize)];
                case 2:
                    _a.sent();
                    return [2 /*return*/, deflate.result];
                case 3:
                    e_1 = _a.sent();
                    console.error(e_1);
                    return [3 /*break*/, 4];
                case 4: return [2 /*return*/, null];
            }
        });
    });
}
function decompressAsync(data, chunkSize) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var inflate, e_2;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    inflate = new pako__WEBPACK_IMPORTED_MODULE_1__["Inflate"]();
                    _a.label = 1;
                case 1:
                    _a.trys.push([1, 3, , 4]);
                    return [4 /*yield*/, processAsync(inflate, data, chunkSize)];
                case 2:
                    _a.sent();
                    return [2 /*return*/, inflate.result];
                case 3:
                    e_2 = _a.sent();
                    console.error(e_2);
                    return [3 /*break*/, 4];
                case 4: return [2 /*return*/, null];
            }
        });
    });
}
function processAsync(pakoObj, data, chunkSize) {
    if (chunkSize === void 0) { chunkSize = 16 * 1024; }
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var total, sliceData, sliceIndex;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    total = Math.ceil(data.byteLength / chunkSize);
                    sliceData = null;
                    sliceIndex = 0;
                    _a.label = 1;
                case 1:
                    if (!(sliceIndex < total)) return [3 /*break*/, 4];
                    return [4 /*yield*/, waitTickAsync()];
                case 2:
                    _a.sent();
                    sliceData = data.slice(sliceIndex * chunkSize, (sliceIndex + 1) * chunkSize);
                    pakoObj.push(sliceData, total <= sliceIndex + 1);
                    _a.label = 3;
                case 3:
                    sliceIndex++;
                    return [3 /*break*/, 1];
                case 4:
                    if (pakoObj.err)
                        throw new Error("error: " + pakoObj.err);
                    return [2 /*return*/, pakoObj];
            }
        });
    });
}
function waitTickAsync() {
    return new Promise(function (resolve) { return Object(_zero_timeout__WEBPACK_IMPORTED_MODULE_2__["setZeroTimeout"])(resolve); });
}


/***/ }),

/***/ "./src/app/class/core/system/util/promise-queue.ts":
/*!*********************************************************!*\
  !*** ./src/app/class/core/system/util/promise-queue.ts ***!
  \*********************************************************/
/*! exports provided: PromiseQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PromiseQueue", function() { return PromiseQueue; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var PromiseQueue = /** @class */ (function () {
    function PromiseQueue(name) {
        if (name === void 0) { name = 'Queue'; }
        this.name = name;
        this.queue = Promise.resolve();
        this._length = 0;
    }
    Object.defineProperty(PromiseQueue.prototype, "length", {
        get: function () { return this._length; },
        enumerable: true,
        configurable: true
    });
    PromiseQueue.prototype.add = function (arg) {
        var _this = this;
        this._length++;
        console.log(this.name + " add: " + this._length);
        if (typeof arg.then == 'function') {
            this.queue = this.queue.then(function () { return arg; }); // promise
        }
        else if (0 < arg.length) {
            this.queue = this.queue.then(function () { return new Promise(arg); }); // executor
        }
        else {
            this.queue = this.queue.then(arg); // task
        }
        var ret = this.queue;
        this.queue = this.queue.catch(function (reason) {
            console.error(reason);
        });
        this.queue = this.queue.then(function () {
            _this._length--;
            console.log(_this.name + " done: " + _this._length);
        });
        return ret;
    };
    return PromiseQueue;
}());



/***/ }),

/***/ "./src/app/class/core/system/util/string-util.ts":
/*!*******************************************************!*\
  !*** ./src/app/class/core/system/util/string-util.ts ***!
  \*******************************************************/
/*! exports provided: StringUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StringUtil", function() { return StringUtil; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var StringUtil;
(function (StringUtil) {
    function toHalfWidth(str) {
        return str.replace(/[！-～]/g, function (c) { return String.fromCharCode(c.charCodeAt(0) - 0xFEE0); });
    }
    StringUtil.toHalfWidth = toHalfWidth;
})(StringUtil || (StringUtil = {}));


/***/ }),

/***/ "./src/app/class/core/system/util/uuid.ts":
/*!************************************************!*\
  !*** ./src/app/class/core/system/util/uuid.ts ***!
  \************************************************/
/*! exports provided: UUID */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UUID", function() { return UUID; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var UUID;
(function (UUID) {
    var lut = [];
    for (var i = 0; i < 256; i++) {
        lut[i] = (i < 16 ? '0' : '') + (i).toString(16);
    }
    function generateUuid() {
        var dvals = new Uint32Array(4);
        window.crypto.getRandomValues(dvals);
        var d0 = dvals[0];
        var d1 = dvals[1];
        var d2 = dvals[2];
        var d3 = dvals[3];
        return lut[d0 & 0xff] + lut[d0 >> 8 & 0xff] + lut[d0 >> 16 & 0xff] + lut[d0 >> 24 & 0xff] + '-' +
            lut[d1 & 0xff] + lut[d1 >> 8 & 0xff] + '-' + lut[d1 >> 16 & 0x0f | 0x40] + lut[d1 >> 24 & 0xff] + '-' +
            lut[d2 & 0x3f | 0x80] + lut[d2 >> 8 & 0xff] + '-' + lut[d2 >> 16 & 0xff] + lut[d2 >> 24 & 0xff] + lut[d3 & 0xff] + lut[d3 >> 8 & 0xff] + lut[d3 >> 16 & 0xff] + lut[d3 >> 24 & 0xff];
    }
    UUID.generateUuid = generateUuid;
})(UUID || (UUID = {}));


/***/ }),

/***/ "./src/app/class/core/system/util/xml-util.ts":
/*!****************************************************!*\
  !*** ./src/app/class/core/system/util/xml-util.ts ***!
  \****************************************************/
/*! exports provided: XmlUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "XmlUtil", function() { return XmlUtil; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var XmlUtil;
(function (XmlUtil) {
    function xml2element(xml) {
        var domParser = new DOMParser();
        var xmlDocument = null;
        try {
            xml = sanitizeXml(xml);
            xmlDocument = domParser.parseFromString(xml, 'application/xml');
            var parsererror = xmlDocument.getElementsByTagName('parsererror');
            if (parsererror.length) {
                console.error('XMLのパースに失敗しました', xmlDocument.documentElement);
                xmlDocument = null;
            }
        }
        catch (error) {
            console.error(error);
        }
        return xmlDocument ? xmlDocument.documentElement : null;
    }
    XmlUtil.xml2element = xml2element;
    function encodeEntityReference(string) {
        return string.replace(/&/g, '&amp;').replace(/"/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
    }
    XmlUtil.encodeEntityReference = encodeEntityReference;
    function decodeEntityReference(string) {
        return string.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');
    }
    XmlUtil.decodeEntityReference = decodeEntityReference;
    function sanitizeXml(xml) {
        return xml.replace(/([^\x09\x0A\x0D\x20-\uD7FF\uE000-\uFFFC\u{10000}-\u{10FFFF}])/ug, '').trim();
    }
})(XmlUtil || (XmlUtil = {}));


/***/ }),

/***/ "./src/app/class/core/system/util/zero-timeout.ts":
/*!********************************************************!*\
  !*** ./src/app/class/core/system/util/zero-timeout.ts ***!
  \********************************************************/
/*! exports provided: setZeroTimeout, clearZeroTimeout */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setZeroTimeout", function() { return setZeroTimeout; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clearZeroTimeout", function() { return clearZeroTimeout; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var i = 0;
var timeouts = new Map();
var channel = new MessageChannel();
function setZeroTimeout(fn) {
    if (i === 0x100000000) // max queue size
        i = 0;
    if (++i in timeouts)
        throw new Error('setZeroTimeout queue overflow.');
    timeouts.set(i, fn);
    channel.port2.postMessage(i);
    return i;
}
function clearZeroTimeout(id) {
    timeouts.delete(id);
}
channel.port1.onmessage = function (ev) {
    var fn = timeouts.get(ev.data);
    if (fn) {
        timeouts.delete(ev.data);
        fn();
    }
};
channel.port1.start();
channel.port2.start();


/***/ }),

/***/ "./src/app/class/data-element.ts":
/*!***************************************!*\
  !*** ./src/app/class/data-element.ts ***!
  \***************************************/
/*! exports provided: DataElement */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DataElement", function() { return DataElement; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");



var DataElement = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DataElement, _super);
    function DataElement() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DataElement_1 = DataElement;
    Object.defineProperty(DataElement.prototype, "isNumberResource", {
        get: function () { return this.type != null && this.type === 'numberResource'; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DataElement.prototype, "isNote", {
        get: function () { return this.type != null && this.type === 'note'; },
        enumerable: true,
        configurable: true
    });
    DataElement.create = function (name, value, attributes, identifier) {
        if (value === void 0) { value = ''; }
        if (attributes === void 0) { attributes = {}; }
        if (identifier === void 0) { identifier = ''; }
        var dataElement;
        if (identifier && 0 < identifier.length) {
            dataElement = new DataElement_1(identifier);
        }
        else {
            dataElement = new DataElement_1();
        }
        dataElement.attributes = attributes;
        dataElement.name = name;
        dataElement.value = value;
        dataElement.initialize();
        return dataElement;
    };
    DataElement.prototype.getElementsByName = function (name) {
        var e_1, _a;
        var children = [];
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                if (child instanceof DataElement_1) {
                    if (child.getAttribute('name') === name)
                        children.push(child);
                    Array.prototype.push.apply(children, child.getElementsByName(name));
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return children;
    };
    DataElement.prototype.getElementsByType = function (type) {
        var e_2, _a;
        var children = [];
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                if (child instanceof DataElement_1) {
                    if (child.getAttribute('type') === type)
                        children.push(child);
                    Array.prototype.push.apply(children, child.getElementsByType(type));
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return children;
    };
    DataElement.prototype.getFirstElementByName = function (name) {
        var e_3, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                if (child instanceof DataElement_1) {
                    if (child.getAttribute('name') === name)
                        return child;
                    var match = child.getFirstElementByName(name);
                    if (match)
                        return match;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return null;
    };
    var DataElement_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DataElement.prototype, "name", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DataElement.prototype, "type", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DataElement.prototype, "currentValue", void 0);
    DataElement = DataElement_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('data')
    ], DataElement);
    return DataElement;
}(_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__["ObjectNode"]));



/***/ }),

/***/ "./src/app/class/data-summary-setting.ts":
/*!***********************************************!*\
  !*** ./src/app/class/data-summary-setting.ts ***!
  \***********************************************/
/*! exports provided: SortOrder, DataSummarySetting */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SortOrder", function() { return SortOrder; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DataSummarySetting", function() { return DataSummarySetting; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/game-object */ "./src/app/class/core/synchronize-object/game-object.ts");



var SortOrder;
(function (SortOrder) {
    SortOrder["ASC"] = "ASC";
    SortOrder["DESC"] = "DESC";
})(SortOrder || (SortOrder = {}));
var DataSummarySetting = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DataSummarySetting, _super);
    function DataSummarySetting() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.sortTag = 'name';
        _this.sortOrder = SortOrder.ASC;
        _this.dataTag = 'HP MP 敏捷度 生命力 精神力';
        return _this;
    }
    DataSummarySetting_1 = DataSummarySetting;
    Object.defineProperty(DataSummarySetting, "instance", {
        get: function () {
            if (!DataSummarySetting_1._instance) {
                DataSummarySetting_1._instance = new DataSummarySetting_1('DataSummarySetting');
                DataSummarySetting_1._instance.initialize();
            }
            return DataSummarySetting_1._instance;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DataSummarySetting.prototype, "dataTags", {
        get: function () {
            if (this._dataTag !== this.dataTag) {
                this._dataTag = this.dataTag;
                this._dataTags = this.dataTag != null && 0 < this.dataTag.trim().length ? this.dataTag.trim().split(/\s+/) : [];
            }
            return this._dataTags;
        },
        enumerable: true,
        configurable: true
    });
    DataSummarySetting.prototype.innerXml = function () { return ''; };
    DataSummarySetting.prototype.parseInnerXml = function (element) {
        // XMLからの新規作成を許可せず、既存のオブジェクトを更新する
        var context = DataSummarySetting_1.instance.toContext();
        context.syncData = this.toContext().syncData;
        DataSummarySetting_1.instance.apply(context);
        DataSummarySetting_1.instance.update();
        this.destroy();
    };
    var DataSummarySetting_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DataSummarySetting.prototype, "sortTag", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DataSummarySetting.prototype, "sortOrder", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DataSummarySetting.prototype, "dataTag", void 0);
    DataSummarySetting = DataSummarySetting_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('summary-setting')
    ], DataSummarySetting);
    return DataSummarySetting;
}(_core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_2__["GameObject"]));



/***/ }),

/***/ "./src/app/class/database/database.ts":
/*!********************************************!*\
  !*** ./src/app/class/database/database.ts ***!
  \********************************************/
/*! exports provided: Database */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Database", function() { return Database; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_system_util_promise_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/system/util/promise-queue */ "./src/app/class/core/system/util/promise-queue.ts");


// 試験実装中
var Database = /** @class */ (function () {
    function Database() {
        this.queue = new _core_system_util_promise_queue__WEBPACK_IMPORTED_MODULE_1__["PromiseQueue"]('DatabaseQueue');
        this.openDB(Database.DB_NAME, Database.VERSION);
    }
    Database.prototype.openDB = function (dbName, version) {
        var _this = this;
        return this.queue.add(function (resolve, reject) {
            console.log('openDB');
            var request = indexedDB.open(dbName, version);
            request.onerror = function (event) {
                console.error(request.error, event);
                if (request.error.name === 'VersionError') {
                    indexedDB.deleteDatabase(dbName);
                    _this.openDB(dbName, version);
                }
                // request.errorCode に対して行うこと!
                resolve();
            };
            request.onblocked = function (event) {
                console.warn('openDB onblocked');
                // 他のタブがデータベースを読み込んでいる場合は、処理を進める前に
                // それらを閉じなければなりません。
                alert('このサイトを開いている他のタブをすべて閉じてください!');
            };
            request.onupgradeneeded = function (event) {
                console.log('openDB onupgradeneeded');
                _this.initializeDB(request.result);
                _this.createStores();
            };
            request.onsuccess = function (event) {
                console.log('openDB onsuccess');
                _this.initializeDB(request.result);
                resolve();
            };
        });
    };
    Database.prototype.createStores = function () {
        console.log('createStores');
        if (this.db.objectStoreNames.contains('PeerHistory')) {
            this.db.deleteObjectStore('PeerHistory');
        }
        var objectStore = this.db.createObjectStore('PeerHistory', { keyPath: 'peerId' });
        objectStore.createIndex('timestamp', 'timestamp', { unique: false });
        // データを追加する前に objectStore の作成を完了させるため、 
        // transaction oncomplete を使用します。
        objectStore.transaction.oncomplete = function (event) {
            console.log('createStores oncomplete');
            // 新たに作成した objectStore に値を保存します。
            /*
            var customerObjectStore = db.transaction("customers", "readwrite").objectStore("customers");
            for (var i in customerData) {
              customerObjectStore.add(customerData[i]);
            }
            */
        };
    };
    Database.prototype.initializeDB = function (db) {
        console.log('initializeDB');
        // 別のページがバージョン変更を求めた場合に、通知されるようにするためのハンドラを追加するようにしてください。
        // データベースを閉じなければなりません。データベースを閉じると、別のページがデータベースをアップグレードできます。
        // これを行わなければ、ユーザがタブを閉じるまでデータベースはアップグレードされません。
        db.onversionchange = function (event) {
            console.warn('db.onversionchange.');
            db.close();
            alert('新しいバージョンのページが使用可能になりました。再読み込みしてください!');
        };
        db.onabort = function (event) {
            console.error(event);
        };
        db.onerror = function (event) {
            console.error(event);
        };
        this.db = db;
        // データベースを使用する処理
    };
    Database.prototype.addPeerHistory = function (myPeer, otherPeers) {
        var _this = this;
        this.queue.add(function (resolve, reject) {
            console.log('addPeerHistory');
            var transaction = _this.db.transaction(['PeerHistory'], 'readwrite');
            var store = transaction.objectStore('PeerHistory');
            transaction.oncomplete = function (event) {
                console.log('addPeerHistory done.', 'readwrite');
                resolve();
            };
            transaction.onerror = function (event) {
                console.error(event);
                resolve();
            };
            var history = {
                peerId: myPeer,
                timestamp: Date.now(),
                history: otherPeers
            };
            store.put(history);
        });
    };
    Database.prototype.deletePeerHistory = function (peerId) {
        var _this = this;
        this.queue.add(function (resolve, reject) {
            var transaction = _this.db.transaction(['PeerHistory'], 'readwrite');
            var store = transaction.objectStore('PeerHistory');
            transaction.oncomplete = function (event) {
                console.log('addPeerHistory done.', 'readwrite');
                resolve();
            };
            transaction.onerror = function (event) {
                console.error(event);
                resolve();
            };
            store.delete(peerId);
        });
    };
    Database.prototype.getPeerHistory = function () {
        var _this = this;
        return this.queue.add(function (resolve, reject) {
            console.log('getPeerHistory');
            var transaction = _this.db.transaction(['PeerHistory'], 'readonly');
            var store = transaction.objectStore('PeerHistory');
            var request = store.openCursor();
            var history = [];
            transaction.oncomplete = function (event) {
                console.log('getPeerHistory done.');
                resolve(history);
            };
            transaction.onerror = function (event) {
                console.error(event);
                resolve(history);
            };
            request.onerror = function (event) {
                console.error(event);
                resolve(history);
            };
            request.onsuccess = function (event) {
                var cursor = request.result;
                if (cursor) {
                    console.log('id:' + cursor.key + ' value:', cursor.value);
                    history.push(cursor.value);
                    cursor.continue();
                }
                else {
                    console.log('Entries all displayed.');
                }
            };
        });
    };
    Database.DB_NAME = 'UdonariumDataBase';
    Database.VERSION = 1;
    return Database;
}());



/***/ }),

/***/ "./src/app/class/dice-bot.ts":
/*!***********************************!*\
  !*** ./src/app/class/dice-bot.ts ***!
  \***********************************/
/*! exports provided: DiceBot */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiceBot", function() { return DiceBot; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/game-object */ "./src/app/class/core/synchronize-object/game-object.ts");
/* harmony import */ var _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _core_system_util_promise_queue__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./core/system/util/promise-queue */ "./src/app/class/core/system/util/promise-queue.ts");
/* harmony import */ var _core_system_util_string_util__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./core/system/util/string-util */ "./src/app/class/core/system/util/string-util.ts");







var DiceBot = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DiceBot, _super);
    function DiceBot() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DiceBot_1 = DiceBot;
    // GameObject Lifecycle
    DiceBot.prototype.onStoreAdded = function () {
        var _this = this;
        _super.prototype.onStoreAdded.call(this);
        DiceBot_1.queue.add(DiceBot_1.loadScriptAsync('./assets/cgiDiceBot.js'));
        _core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('SEND_MESSAGE', function (event) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
            var chatMessage, text, gameType, regArray, repeat, rollText, finalResult, i, rollResult, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        chatMessage = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(event.data.messageIdentifier);
                        if (!chatMessage || !chatMessage.isSendFromSelf || chatMessage.isSystem)
                            return [2 /*return*/];
                        text = _core_system_util_string_util__WEBPACK_IMPORTED_MODULE_6__["StringUtil"].toHalfWidth(chatMessage.text);
                        gameType = chatMessage.tag;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, , 7]);
                        regArray = /^((\d+)?\s+)?([^\s]*)?/ig.exec(text);
                        repeat = (regArray[2] != null) ? Number(regArray[2]) : 1;
                        rollText = (regArray[3] != null) ? regArray[3] : text;
                        finalResult = { result: '', isSecret: false };
                        i = 0;
                        _a.label = 2;
                    case 2:
                        if (!(i < repeat && i < 32)) return [3 /*break*/, 5];
                        return [4 /*yield*/, DiceBot_1.diceRollAsync(rollText, gameType)];
                    case 3:
                        rollResult = _a.sent();
                        if (rollResult.result.length < 1)
                            return [3 /*break*/, 5];
                        finalResult.result += rollResult.result;
                        finalResult.isSecret = finalResult.isSecret || rollResult.isSecret;
                        if (1 < repeat)
                            finalResult.result += " #" + (i + 1);
                        _a.label = 4;
                    case 4:
                        i++;
                        return [3 /*break*/, 2];
                    case 5:
                        this.sendResultMessage(finalResult, chatMessage);
                        return [3 /*break*/, 7];
                    case 6:
                        e_1 = _a.sent();
                        console.error(e_1);
                        return [3 /*break*/, 7];
                    case 7: return [2 /*return*/];
                }
            });
        }); });
    };
    // GameObject Lifecycle
    DiceBot.prototype.onStoreRemoved = function () {
        _super.prototype.onStoreRemoved.call(this);
        _core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    DiceBot.prototype.sendResultMessage = function (rollResult, originalMessage) {
        var result = rollResult.result;
        var isSecret = rollResult.isSecret;
        if (result.length < 1)
            return;
        result = result.replace(/[＞]/g, function (s) { return '→'; }).trim();
        var diceBotMessage = {
            identifier: '',
            tabIdentifier: originalMessage.tabIdentifier,
            originFrom: originalMessage.from,
            from: 'System-BCDice',
            timestamp: originalMessage.timestamp + 1,
            imageIdentifier: '',
            tag: isSecret ? 'system secret' : 'system',
            name: isSecret ? '<Secret-BCDice：' + originalMessage.name + '>' : '<BCDice：' + originalMessage.name + '>',
            text: result
        };
        if (originalMessage.to != null && 0 < originalMessage.to.length) {
            diceBotMessage.to = originalMessage.to;
            if (originalMessage.to.indexOf(originalMessage.from) < 0) {
                diceBotMessage.to += ' ' + originalMessage.from;
            }
        }
        var chatTab = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(originalMessage.tabIdentifier);
        if (chatTab)
            chatTab.addMessage(diceBotMessage);
    };
    DiceBot.diceRollAsync = function (message, gameType) {
        DiceBot_1.queue.add(DiceBot_1.loadDiceBotAsync(gameType));
        return DiceBot_1.queue.add(function () {
            if ('Opal' in window === false) {
                console.warn('Opal is not loaded...');
                return { result: '', isSecret: false };
            }
            var result = [];
            var dir = [];
            var diceBotTablePrefix = 'diceBotTable_';
            var isNeedResult = true;
            try {
                Opal.gvars.isDebug = false;
                var cgiDiceBot = Opal.CgiDiceBot.$new();
                result = cgiDiceBot.$roll(message, gameType, dir, diceBotTablePrefix, isNeedResult);
                console.log('diceRoll!!!', result);
                console.log('isSecret!!!', cgiDiceBot.isSecret);
                return { result: result[0], isSecret: cgiDiceBot.isSecret };
            }
            catch (e) {
                console.error(e);
            }
            return { result: '', isSecret: false };
        });
    };
    DiceBot.getHelpMessage = function (gameType) {
        DiceBot_1.queue.add(DiceBot_1.loadDiceBotAsync(gameType));
        return DiceBot_1.queue.add(function () {
            if ('Opal' in window === false) {
                console.warn('Opal is not loaded...');
                return '';
            }
            var help = '';
            try {
                var bcdice = Opal.CgiDiceBot.$new().$newBcDice();
                bcdice.$setGameByTitle(gameType);
                help = bcdice.diceBot.$getHelpMessage();
            }
            catch (e) {
                console.error(e);
            }
            return help;
        });
    };
    DiceBot.loadDiceBotAsync = function (gameType) {
        return new Promise(function (resolve, reject) {
            var e_2, _a;
            console.log('loadDiceBotAsync');
            gameType = gameType.replace(/\./g, function (s) { return '_'; });
            if ((!gameType && gameType.length < 1) || DiceBot_1.loadedDiceBots[gameType]) {
                console.log(gameType + ' is loaded');
                resolve();
                return;
            }
            DiceBot_1.loadedDiceBots[gameType] = false;
            var promises = [];
            var scriptPath = './assets/dicebot/' + gameType + '.js';
            promises.push(DiceBot_1.loadScriptAsync(scriptPath));
            try {
                for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](DiceBot_1.extratablesTables), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var table = _c.value;
                    if (!table.indexOf(gameType)) {
                        var path = './assets/extratables/' + table;
                        promises.push(DiceBot_1.loadExtratablesAsync(path, table));
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_2) throw e_2.error; }
            }
            Promise.all(promises).then(function () {
                DiceBot_1.loadedDiceBots[gameType] = true;
                resolve();
            });
        });
    };
    DiceBot.loadScriptAsync = function (path) {
        return new Promise(function (resolve, reject) {
            var head = document.head;
            var script = document.createElement('script');
            script.src = path;
            head.appendChild(script);
            script.onload = function (e) {
                if (head && script.parentNode)
                    head.removeChild(script);
                console.log(path + ' is loading OK!!!');
                resolve();
            };
            script.onabort = script.onerror = function (e) {
                if (head && script.parentNode)
                    head.removeChild(script);
                console.error(e);
                resolve();
            };
        });
    };
    DiceBot.loadExtratablesAsync = function (path, table) {
        return new Promise(function (resolve, reject) {
            fetch(path)
                .then(function (response) {
                if (response.ok)
                    return response.text();
                throw new Error('Network response was not ok.');
            })
                .then(function (text) {
                var array = /((.+)_(.+)).txt$/ig.exec(table);
                Opal.TableFileData.$setVirtualTableData(array[1], array[2], array[3], text);
                console.log(table + ' is loading OK!!!');
                resolve();
            })
                .catch(function (error) {
                console.warn('There has been a problem with your fetch operation: ', error.message);
                resolve();
            });
        });
    };
    var DiceBot_1;
    DiceBot.loadedDiceBots = {};
    DiceBot.queue = new _core_system_util_promise_queue__WEBPACK_IMPORTED_MODULE_5__["PromiseQueue"]('DiceBotQueue');
    DiceBot.diceBotInfos = [
        { script: 'EarthDawn', game: 'アースドーン' },
        { script: 'EarthDawn3', game: 'アースドーン3版' },
        { script: 'EarthDawn4', game: 'アースドーン4版' },
        { script: 'Airgetlamh', game: '朱の孤塔のエアゲトラム' },
        { script: 'Amadeus', game: 'アマデウス' },
        { script: 'Arianrhod', game: 'アリアンロッド' },
        { script: 'OrgaRain', game: '在りて遍くオルガレイン' },
        { script: 'Alshard', game: 'アルシャード' },
        { script: 'ArsMagica', game: 'アルスマギカ' },
        { script: 'IthaWenUa', game: 'イサー・ウェン＝アー' },
        { script: 'Insane', game: 'インセイン' },
        { script: 'WitchQuest', game: 'ウィッチクエスト' },
        { script: 'Warhammer', game: 'ウォーハンマー' },
        { script: 'Utakaze', game: 'ウタカゼ' },
        { script: 'Alsetto', game: '詩片のアルセット' },
        { script: 'AceKillerGene', game: 'エースキラージーン' },
        { script: 'EclipsePhase', game: 'エクリプス・フェイズ' },
        { script: 'Elysion', game: 'エリュシオン' },
        { script: 'Elric', game: 'エルリック！' },
        { script: 'EmbryoMachine', game: 'エムブリオマシン' },
        { script: 'EndBreaker', game: 'エンドブレイカー' },
        { script: 'Oukahoushin3rd', game: '央華封神RPG第三版' },
        { script: 'GardenOrder', game: 'ガーデンオーダー' },
        { script: 'CardRanker', game: 'カードランカー' },
        { script: 'Gurps', game: 'ガープス' },
        { script: 'GurpsFW', game: 'ガープスフィルトウィズ' },
        { script: 'ChaosFlare', game: 'カオスフレア' },
        { script: 'OneWayHeroics', game: '片道勇者' },
        { script: 'Kamigakari', game: '神我狩' },
        { script: 'Garako', game: 'ガラコと破界の塔' },
        { script: 'KanColle', game: '艦これRPG' },
        { script: 'Gundog', game: 'ガンドッグ' },
        { script: 'GundogZero', game: 'ガンドッグ・ゼロ' },
        { script: 'GundogRevised', game: 'ガンドッグ・リヴァイズド' },
        { script: 'KillDeathBusiness', game: 'キルデスビジネス' },
        { script: 'StellarKnights', game: '銀剣のステラナイツ' },
        { script: 'Cthulhu', game: 'クトゥルフ' },
        { script: 'CthulhuTech', game: 'クトゥルフテック' },
        { script: 'KurayamiCrying', game: 'クラヤミクライン' },
        { script: 'GranCrest', game: 'グランクレスト' },
        { script: 'GeishaGirlwithKatana', game: 'ゲイシャ・ガール・ウィズ・カタナ' },
        { script: 'GehennaAn', game: 'ゲヘナ・アナスタシス' },
        { script: 'Illusio', game: '晃天のイルージオ' },
        { script: 'CodeLayerd', game: 'コード：レイヤード' },
        { script: 'Avandner', game: '黒絢のアヴァンドナー' },
        { script: 'Gorilla', game: 'ゴリラTRPG' },
        { script: 'ColossalHunter', game: 'コロッサルハンター' },
        { script: 'Postman', game: '壊れた世界のポストマン' },
        { script: 'Satasupe', game: 'サタスペ' },
        { script: 'SharedFantasia', game: 'Shared†Fantasia' },
        { script: 'JamesBond', game: 'ジェームズ・ボンド007' },
        { script: 'LiveraDoll', game: '紫縞のリヴラドール' },
        { script: 'ShinobiGami', game: 'シノビガミ' },
        { script: 'ShadowRun', game: 'シャドウラン' },
        { script: 'ShadowRun4', game: 'シャドウラン第４版' },
        { script: 'ShadowRun5', game: 'シャドウラン第５版' },
        { script: 'ShoujoTenrankai', game: '少女展爛会' },
        { script: 'Alter_raise', game: '心衝想機TRPGアルトレイズ' },
        { script: 'ShinkuuGakuen', game: '真空学園' },
        { script: 'Cthulhu7th', game: '新クトゥルフ' },
        { script: 'ShinMegamiTenseiKakuseihen', game: '真・女神転生TRPG　覚醒篇' },
        { script: 'SRS', game: 'Standard RPG System' },
        { script: 'ScreamHighSchool', game: 'スクリームハイスクール' },
        { script: 'SterileLife', game: 'ステラーライフTRPG' },
        { script: 'StratoShout', game: 'ストラトシャウト' },
        { script: 'TherapieSein', game: '青春疾患セラフィザイン' },
        { script: 'EtrianOdysseySRS', game: '世界樹の迷宮SRS' },
        { script: 'ZettaiReido', game: '絶対隷奴' },
        { script: 'SevenFortressMobius', game: 'セブン＝フォートレス メビウス' },
        { script: 'SwordWorld', game: 'ソードワールド' },
        { script: 'SwordWorld2_0', game: 'ソードワールド2.0' },
        { script: 'SwordWorld2_5', game: 'ソードワールド2.5' },
        { script: 'Villaciel', game: '蒼天のヴィラシエル' },
        { script: 'DarkSouls', game: 'ダークソウルTRPG' },
        { script: 'DarkDaysDrive', game: 'ダークデイズドライブ' },
        { script: 'DarkBlaze', game: 'ダークブレイズ' },
        { script: 'DungeonsAndDoragons', game: 'ダンジョンズ＆ドラゴンズ' },
        { script: 'DiceOfTheDead', game: 'ダイス・オブ・ザ・デッド' },
        { script: 'DoubleCross', game: 'ダブルクロス2nd,3rd' },
        { script: 'Paradiso', game: 'チェレステ色のパラディーゾ' },
        { script: 'CrashWorld', game: '墜落世界' },
        { script: 'StrangerOfSwordCity', game: '剣の街の異邦人TRPG' },
        { script: 'DetatokoSaga', game: 'でたとこサーガ' },
        { script: 'DeadlineHeroes', game: 'デッドラインヒーローズ' },
        { script: 'DemonParasite', game: 'デモンパラサイト' },
        { script: 'TokyoGhostResearch', game: '東京ゴーストリサーチ' },
        { script: 'TokyoNova', game: 'トーキョーＮ◎ＶＡ' },
        { script: 'Torg', game: 'トーグ' },
        { script: 'Torg1_5', game: 'トーグ1.5版' },
        { script: 'TokumeiTenkousei', game: '特命転攻生' },
        { script: 'Dracurouge', game: 'ドラクルージュ' },
        { script: 'TrinitySeven', game: 'トリニティセブンRPG' },
        { script: 'TwilightGunsmoke', game: 'トワイライト・ガンスモーク' },
        { script: 'TunnelsAndTrolls', game: 'トンネルズ＆トロールズ' },
        { script: 'NightWizard', game: 'ナイトウィザード2版' },
        { script: 'NightWizard3rd', game: 'ナイトウィザード3版' },
        { script: 'NightmareHunterDeep', game: 'ナイトメアハンター=ディープ' },
        { script: 'NinjaSlayer', game: 'ニンジャスレイヤーTRPG' },
        { script: 'Nuekagami', game: '鵺鏡' },
        { script: 'Nechronica', game: 'ネクロニカ' },
        { script: 'HarnMaster', game: 'ハーンマスター' },
        { script: 'Skynauts', game: '歯車の塔の探空士' },
        { script: 'HatsuneMiku', game: '初音ミクTRPG ココロダンジョン' },
        { script: 'BattleTech', game: 'バトルテック' },
        { script: 'ParasiteBlood', game: 'パラサイトブラッド' },
        { script: 'Paranoia', game: 'パラノイア' },
        { script: 'BarnaKronika', game: 'バルナ・クロニカ' },
        { script: 'PulpCthulhu', game: 'パルプ・クトゥルフ' },
        { script: 'Raisondetre', game: '叛逆レゾンデートル' },
        { script: 'BadLife', game: '犯罪活劇RPGバッドライフ' },
        { script: 'HuntersMoon', game: 'ハンターズムーン' },
        { script: 'Peekaboo', game: 'ピーカーブー' },
        { script: 'BeastBindTrinity', game: 'ビーストバインド トリニティ' },
        { script: 'BeginningIdol', game: 'ビギニングアイドル' },
        { script: 'PhantasmAdventure', game: 'ファンタズムアドベンチャー' },
        { script: 'FilledWith', game: 'フィルトウィズ' },
        { script: 'FutariSousa', game: 'フタリソウサ' },
        { script: 'BlindMythos', game: 'ブラインド・ミトス' },
        { script: 'BloodCrusade', game: 'ブラッド・クルセイド' },
        { script: 'BloodMoon', game: 'ブラッド・ムーン' },
        { script: 'FullMetalPanic', game: 'フルメタル・パニック！' },
        { script: 'BladeOfArcana', game: 'ブレイド・オブ・アルカナ' },
        { script: 'Strave', game: '碧空のストレイヴ' },
        { script: 'Pendragon', game: 'ペンドラゴン' },
        { script: 'HouraiGakuen', game: '蓬莱学園の冒険!!' },
        { script: 'MagicaLogia', game: 'マギカロギア' },
        { script: 'MeikyuDays', game: '迷宮デイズ' },
        { script: 'MeikyuKingdom', game: '迷宮キングダム' },
        { script: 'MetallicGuadian', game: 'メタリックガーディアン' },
        { script: 'MetalHead', game: 'メタルヘッド' },
        { script: 'MetalHeadExtream', game: 'メタルヘッドエクストリーム' },
        { script: 'MonotoneMusium', game: 'モノトーン・ミュージアム' },
        { script: 'YankeeYogSothoth', game: 'ヤンキー＆ヨグ＝ソトース' },
        { script: 'GoldenSkyStories', game: 'ゆうやけこやけ' },
        { script: 'Ryutama', game: 'りゅうたま' },
        { script: 'RuneQuest', game: 'ルーンクエスト' },
        { script: 'LogHorizon', game: 'ログ・ホライズン' },
        { script: 'RokumonSekai2', game: '六門世界2nd' },
        { script: 'RoleMaster', game: 'ロールマスター' },
        { script: 'LostRecord', game: 'ロストレコード' },
        { script: 'LostRoyal', game: 'ロストロイヤル' },
        { script: 'WaresBlade', game: 'ワースブレイド' },
        { script: 'WorldOfDarkness', game: 'ワールドオブダークネス' },
        { script: 'WARPS', game: 'ワープス' },
        { script: 'Hieizan', game: '比叡山炎上' },
        { script: 'InfiniteFantasia', game: '無限のファンタジア' },
        { script: 'Chill', game: 'Chill' },
        { script: 'Chill3', game: 'Chill 3' },
        { script: 'NjslyrBattle', game: 'NJSLYRBATTLE' },
        { script: 'Pathfinder', game: 'Pathfinder' }
    ];
    DiceBot.extratablesTables = [
        'BloodCrusade_TD2T.txt',
        'BloodCrusade_TD3T.txt',
        'BloodCrusade_TD4T.txt',
        'BloodCrusade_TD5T.txt',
        'BloodCrusade_TD6T.txt',
        'BloodCrusade_TDHT.txt',
        'BloodMoon_ID2T.txt',
        'BloodMoon_IDT.txt',
        'BloodMoon_RAT.txt',
        'CardRanker_BFT.txt',
        'CardRanker_CDT.txt',
        'CardRanker_CST.txt',
        'CardRanker_DT.txt',
        'CardRanker_GDT.txt',
        'CardRanker_OST.txt',
        'CardRanker_SST.txt',
        'CardRanker_ST.txt',
        'CardRanker_TDT.txt',
        'CardRanker_WT.txt',
        'Elysion_EBT.txt',
        'Elysion_GIT.txt',
        'Elysion_HBT.txt',
        'Elysion_HT.txt',
        'Elysion_IT.txt',
        'Elysion_JH.txt',
        'Elysion_KT.txt',
        'Elysion_NA.txt',
        'Elysion_NT.txt',
        'Elysion_OJ1.txt',
        'Elysion_OJ2.txt',
        'Elysion_TBT.txt',
        'Elysion_UBT.txt',
        'Elysion_UT1.txt',
        'Elysion_UT2.txt',
        'Elysion_UT3.txt',
        'Elysion_UT4.txt',
        'HuntersMoon_DS1ET.txt',
        'HuntersMoon_DS2ET.txt',
        'HuntersMoon_DS3ET.txt',
        'HuntersMoon_EE1ET.txt',
        'HuntersMoon_EE2ET.txt',
        'HuntersMoon_EE3ET.txt',
        'HuntersMoon_ERT.txt',
        'HuntersMoon_ET1ET.txt',
        'HuntersMoon_ET2ET.txt',
        'HuntersMoon_ET3ET.txt',
        'HuntersMoon_MST.txt',
        'HuntersMoon_TK1ET.txt',
        'HuntersMoon_TK2ET.txt',
        'HuntersMoon_TK3ET.txt',
        'Kamigakari_ET.txt',
        'Kamigakari_KT.txt',
        'Kamigakari_NT.txt',
        'KanColle_BT2.txt',
        'KanColle_BT3.txt',
        'KanColle_BT4.txt',
        'KanColle_BT5.txt',
        'KanColle_BT6.txt',
        'KanColle_BT7.txt',
        'KanColle_BT8.txt',
        'KanColle_BT9.txt',
        'KanColle_BT10.txt',
        'KanColle_BT11.txt',
        'KanColle_BT12.txt',
        'KanColle_ETIT.txt',
        'KanColle_LFDT.txt',
        'KanColle_LFVT.txt',
        'KanColle_LSFT.txt',
        'KanColle_WPCN.txt',
        'KanColle_WPFA.txt',
        'KanColle_WPMC.txt',
        'KanColle_WPMCN.txt',
        'KillDeathBusiness_ANSPT.txt',
        'KillDeathBusiness_MASPT.txt',
        'KillDeathBusiness_MOSPT.txt',
        'KillDeathBusiness_PASPT.txt',
        'KillDeathBusiness_POSPT.txt',
        'KillDeathBusiness_UMSPT.txt',
        'Oukahoushin3rd_BKT.txt',
        'Oukahoushin3rd_KKT.txt',
        'Oukahoushin3rd_NHT.txt',
        'Oukahoushin3rd_SDT.txt',
        'Oukahoushin3rd_SKT.txt',
        'Oukahoushin3rd_STT.txt',
        'Oukahoushin3rd_UKT.txt',
        'ShinobiGami_AKST.txt',
        'ShinobiGami_CLST.txt',
        'ShinobiGami_DXST.txt',
        'ShinobiGami_HC.txt',
        'ShinobiGami_HK.txt',
        'ShinobiGami_HLST.txt',
        'ShinobiGami_HM.txt',
        'ShinobiGami_HO.txt',
        'ShinobiGami_HR.txt',
        'ShinobiGami_HS.txt',
        'ShinobiGami_HT.txt',
        'ShinobiGami_HY.txt',
        'ShinobiGami_NTST.txt',
        'ShinobiGami_OTKRT.txt',
        'ShinobiGami_PLST.txt',
        'BloodCrusade_BDST.txt',
        'BloodCrusade_CYST.txt',
        'BloodCrusade_DMST.txt',
        'BloodCrusade_MNST.txt',
        'BloodCrusade_SLST.txt',
        'BloodCrusade_TD1T.txt'
    ];
    DiceBot = DiceBot_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('dice-bot')
    ], DiceBot);
    return DiceBot;
}(_core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_2__["GameObject"]));



/***/ }),

/***/ "./src/app/class/dice-symbol.ts":
/*!**************************************!*\
  !*** ./src/app/class/dice-symbol.ts ***!
  \**************************************/
/*! exports provided: DiceType, DiceSymbol */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiceType", function() { return DiceType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiceSymbol", function() { return DiceSymbol; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _data_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _peer_cursor__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var _tabletop_object__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./tabletop-object */ "./src/app/class/tabletop-object.ts");






var DiceType;
(function (DiceType) {
    DiceType[DiceType["D2"] = 0] = "D2";
    DiceType[DiceType["D4"] = 1] = "D4";
    DiceType[DiceType["D6"] = 2] = "D6";
    DiceType[DiceType["D8"] = 3] = "D8";
    DiceType[DiceType["D10"] = 4] = "D10";
    DiceType[DiceType["D10_10TIMES"] = 5] = "D10_10TIMES";
    DiceType[DiceType["D12"] = 6] = "D12";
    DiceType[DiceType["D20"] = 7] = "D20";
})(DiceType || (DiceType = {}));
var DiceSymbol = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DiceSymbol, _super);
    function DiceSymbol() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.face = '0';
        _this.owner = '';
        _this.rotate = 0;
        return _this;
    }
    DiceSymbol_1 = DiceSymbol;
    Object.defineProperty(DiceSymbol.prototype, "name", {
        get: function () { return this.getCommonValue('name', ''); },
        set: function (name) { this.setCommonValue('name', name); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbol.prototype, "size", {
        get: function () { return this.getCommonValue('size', 1); },
        set: function (size) { this.setCommonValue('size', size); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbol.prototype, "faces", {
        get: function () { return this.imageDataElement.children.map(function (element) { return element.name; }); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbol.prototype, "imageFile", {
        get: function () {
            return this.isVisible ?
                this.getImageFile(this.face)
                : this.faces.length
                    ? this.getImageFile(this.faces[0])
                    : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbol.prototype, "ownerName", {
        get: function () {
            var object = _peer_cursor__WEBPACK_IMPORTED_MODULE_4__["PeerCursor"].find(this.owner);
            return object ? object.name : '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbol.prototype, "hasOwner", {
        get: function () { return _peer_cursor__WEBPACK_IMPORTED_MODULE_4__["PeerCursor"].find(this.owner) != null; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbol.prototype, "isMine", {
        get: function () { return _core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerId === this.owner; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbol.prototype, "isVisible", {
        get: function () { return !this.hasOwner || this.isMine; },
        enumerable: true,
        configurable: true
    });
    DiceSymbol.prototype.diceRoll = function () {
        var faces = this.faces;
        this.face = 0 < faces.length ? faces[Math.floor(Math.random() * faces.length)] : '';
        return this.face;
    };
    DiceSymbol.prototype.setDicetype = function (type) {
        this.makeDiceFace(type);
    };
    DiceSymbol.prototype.makeDiceFace = function (type, identifierSuffix) {
        var _this = this;
        var sided = 1;
        var faces = [];
        var faceGeneratorFunc = function (index) { return (index + 1) + ''; };
        switch (type) {
            case DiceType.D2:
                sided = 2;
                break;
            case DiceType.D4:
                sided = 4;
                break;
            case DiceType.D6:
                sided = 6;
                break;
            case DiceType.D8:
                sided = 8;
                break;
            case DiceType.D10_10TIMES:
                faceGeneratorFunc = function (index) { return (index + 1) + '0'; };
            case DiceType.D10:
                sided = 10;
                break;
            case DiceType.D12:
                sided = 12;
                break;
            case DiceType.D20:
                sided = 20;
                break;
            default:
                sided = 2;
                break;
        }
        for (var i = 0; i < sided; i++) {
            var faceName = faceGeneratorFunc(i);
            var identifier = identifierSuffix != null ? faceName + '_' + identifierSuffix : null;
            faces.push(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create(faceName, '', { type: 'image' }, identifier));
        }
        this.imageDataElement.children.forEach(function (element) { return element.destroy(); });
        faces.forEach(function (element) { return _this.imageDataElement.appendChild(element); });
        this.face = faces[0].name;
        return faces;
    };
    DiceSymbol.create = function (name, type, size, identifier) {
        var object = identifier ? new DiceSymbol_1(identifier) : new DiceSymbol_1();
        object.createDataElements();
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('name', name, {}, 'name_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('size', size, {}, 'size_' + object.identifier));
        object.makeDiceFace(type, object.identifier);
        object.initialize();
        return object;
    };
    var DiceSymbol_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DiceSymbol.prototype, "face", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DiceSymbol.prototype, "owner", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], DiceSymbol.prototype, "rotate", void 0);
    DiceSymbol = DiceSymbol_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('dice-symbol')
    ], DiceSymbol);
    return DiceSymbol;
}(_tabletop_object__WEBPACK_IMPORTED_MODULE_5__["TabletopObject"]));



/***/ }),

/***/ "./src/app/class/game-character.ts":
/*!*****************************************!*\
  !*** ./src/app/class/game-character.ts ***!
  \*****************************************/
/*! exports provided: GameCharacter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameCharacter", function() { return GameCharacter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _chat_palette__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chat-palette */ "./src/app/class/chat-palette.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _data_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _tabletop_object__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./tabletop-object */ "./src/app/class/tabletop-object.ts");





var GameCharacter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GameCharacter, _super);
    function GameCharacter() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.rotate = 0;
        _this.roll = 0;
        return _this;
    }
    GameCharacter_1 = GameCharacter;
    Object.defineProperty(GameCharacter.prototype, "name", {
        get: function () { return this.getCommonValue('name', ''); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameCharacter.prototype, "size", {
        get: function () { return this.getCommonValue('size', 1); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameCharacter.prototype, "chatPalette", {
        get: function () {
            var e_1, _a;
            try {
                for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var child = _c.value;
                    if (child instanceof _chat_palette__WEBPACK_IMPORTED_MODULE_1__["ChatPalette"])
                        return child;
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    GameCharacter.create = function (name, size, imageIdentifier) {
        var gameCharacter = new GameCharacter_1();
        gameCharacter.createDataElements();
        gameCharacter.initialize();
        gameCharacter.createTestGameDataElement(name, size, imageIdentifier);
        return gameCharacter;
    };
    GameCharacter.prototype.createTestGameDataElement = function (name, size, imageIdentifier) {
        this.createDataElements();
        var nameElement = _data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('name', name, {}, 'name_' + this.identifier);
        var sizeElement = _data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('size', size, {}, 'size_' + this.identifier);
        if (this.imageDataElement.getFirstElementByName('imageIdentifier')) {
            this.imageDataElement.getFirstElementByName('imageIdentifier').value = imageIdentifier;
        }
        var resourceElement = _data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('リソース', '', {}, 'リソース' + this.identifier);
        var hpElement = _data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('HP', 200, { 'type': 'numberResource', 'currentValue': '200' }, 'HP_' + this.identifier);
        var mpElement = _data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('MP', 100, { 'type': 'numberResource', 'currentValue': '100' }, 'MP_' + this.identifier);
        this.commonDataElement.appendChild(nameElement);
        this.commonDataElement.appendChild(sizeElement);
        this.detailDataElement.appendChild(resourceElement);
        resourceElement.appendChild(hpElement);
        resourceElement.appendChild(mpElement);
        //TEST
        var testElement = _data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('情報', '', {}, '情報' + this.identifier);
        this.detailDataElement.appendChild(testElement);
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('説明', 'ここに説明を書く\nあいうえお', { 'type': 'note' }, '説明' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('メモ', '任意の文字列\n１\n２\n３\n４\n５', { 'type': 'note' }, 'メモ' + this.identifier));
        //TEST
        testElement = _data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('能力', '', {}, '能力' + this.identifier);
        this.detailDataElement.appendChild(testElement);
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('器用度', 24, {}, '器用度' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('敏捷度', 24, {}, '敏捷度' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('筋力', 24, {}, '筋力' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('生命力', 24, {}, '生命力' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('知力', 24, {}, '知力' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('精神力', 24, {}, '精神力' + this.identifier));
        //TEST
        testElement = _data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('戦闘特技', '', {}, '戦闘特技' + this.identifier);
        this.detailDataElement.appendChild(testElement);
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('Lv1', '全力攻撃', {}, 'Lv1' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('Lv3', '武器習熟/ソード', {}, 'Lv3' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('Lv5', '武器習熟/ソードⅡ', {}, 'Lv5' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('Lv7', '頑強', {}, 'Lv7' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('Lv9', '薙ぎ払い', {}, 'Lv9' + this.identifier));
        testElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('自動', '治癒適正', {}, '自動' + this.identifier));
        var domParser = new DOMParser();
        var gameCharacterXMLDocument = domParser.parseFromString(this.rootDataElement.toXml(), 'application/xml');
        var palette = new _chat_palette__WEBPACK_IMPORTED_MODULE_1__["ChatPalette"]('ChatPalette_' + this.identifier);
        palette.setPalette("\u30C1\u30E3\u30C3\u30C8\u30D1\u30EC\u30C3\u30C8\u5165\u529B\u4F8B\uFF1A\n2d6+1 \u30C0\u30A4\u30B9\u30ED\u30FC\u30EB\n\uFF11\uFF44\uFF12\uFF10\uFF0B{\u654F\u6377}\uFF0B\uFF5B\u683C\u95D8\uFF5D\u3000{name}\u306E\u683C\u95D8\uFF01\n//\u654F\u6377=10+{\u654F\u6377A}\n//\u654F\u6377A=10\n//\u683C\u95D8\uFF1D\uFF11");
        palette.initialize();
        this.appendChild(palette);
    };
    var GameCharacter_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], GameCharacter.prototype, "rotate", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], GameCharacter.prototype, "roll", void 0);
    GameCharacter = GameCharacter_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncObject"])('character')
    ], GameCharacter);
    return GameCharacter;
}(_tabletop_object__WEBPACK_IMPORTED_MODULE_4__["TabletopObject"]));



/***/ }),

/***/ "./src/app/class/game-table-mask.ts":
/*!******************************************!*\
  !*** ./src/app/class/game-table-mask.ts ***!
  \******************************************/
/*! exports provided: GameTableMask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameTableMask", function() { return GameTableMask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _data_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _tabletop_object__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./tabletop-object */ "./src/app/class/tabletop-object.ts");




var GameTableMask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GameTableMask, _super);
    function GameTableMask() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.isLock = false;
        return _this;
    }
    GameTableMask_1 = GameTableMask;
    Object.defineProperty(GameTableMask.prototype, "name", {
        get: function () { return this.getCommonValue('name', ''); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableMask.prototype, "width", {
        get: function () { return this.getCommonValue('width', 1); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableMask.prototype, "height", {
        get: function () { return this.getCommonValue('height', 1); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableMask.prototype, "opacity", {
        get: function () {
            var element = this.getElement('opacity', this.commonDataElement);
            var num = element ? element.currentValue / element.value : 1;
            return Number.isNaN(num) ? 1 : num;
        },
        enumerable: true,
        configurable: true
    });
    GameTableMask.create = function (name, width, height, opacity, identifier) {
        var object = null;
        if (identifier) {
            object = new GameTableMask_1(identifier);
        }
        else {
            object = new GameTableMask_1();
        }
        object.createDataElements();
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('name', name, {}, 'name_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('width', width, {}, 'width_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('height', height, {}, 'height_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('opacity', opacity, { type: 'numberResource', currentValue: opacity }, 'opacity_' + object.identifier));
        object.initialize();
        return object;
    };
    var GameTableMask_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTableMask.prototype, "isLock", void 0);
    GameTableMask = GameTableMask_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('table-mask')
    ], GameTableMask);
    return GameTableMask;
}(_tabletop_object__WEBPACK_IMPORTED_MODULE_3__["TabletopObject"]));



/***/ }),

/***/ "./src/app/class/game-table.ts":
/*!*************************************!*\
  !*** ./src/app/class/game-table.ts ***!
  \*************************************/
/*! exports provided: GridType, FilterType, GameTable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GridType", function() { return GridType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FilterType", function() { return FilterType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameTable", function() { return GameTable; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _game_table_mask__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./game-table-mask */ "./src/app/class/game-table-mask.ts");
/* harmony import */ var _terrain__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./terrain */ "./src/app/class/terrain.ts");






var GridType;
(function (GridType) {
    GridType[GridType["SQUARE"] = 0] = "SQUARE";
    GridType[GridType["HEX_VERTICAL"] = 1] = "HEX_VERTICAL";
    GridType[GridType["HEX_HORIZONTAL"] = 2] = "HEX_HORIZONTAL";
})(GridType || (GridType = {}));
var FilterType;
(function (FilterType) {
    FilterType["NONE"] = "";
    FilterType["WHITE"] = "white";
    FilterType["BLACK"] = "black";
})(FilterType || (FilterType = {}));
var GameTable = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GameTable, _super);
    function GameTable() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.name = 'テーブル';
        _this.width = 20;
        _this.height = 20;
        _this.gridSize = 50;
        _this.imageIdentifier = 'imageIdentifier';
        _this.backgroundImageIdentifier = 'imageIdentifier';
        _this.backgroundFilterType = FilterType.NONE;
        _this.selected = false;
        _this.gridType = GridType.SQUARE;
        _this.gridColor = '#000000e6';
        return _this;
    }
    Object.defineProperty(GameTable.prototype, "terrains", {
        get: function () {
            var terrains = [];
            this.children.forEach(function (object) {
                if (object instanceof _terrain__WEBPACK_IMPORTED_MODULE_5__["Terrain"])
                    terrains.push(object);
            });
            return terrains;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTable.prototype, "masks", {
        get: function () {
            var masks = [];
            this.children.forEach(function (object) {
                if (object instanceof _game_table_mask__WEBPACK_IMPORTED_MODULE_4__["GameTableMask"])
                    masks.push(object);
            });
            return masks;
        },
        enumerable: true,
        configurable: true
    });
    // GameObject Lifecycle
    GameTable.prototype.onStoreAdded = function () {
        _super.prototype.onStoreAdded.call(this);
        if (this.selected)
            _core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].trigger('SELECT_GAME_TABLE', { identifier: this.identifier });
    };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "name", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "width", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "height", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "gridSize", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "imageIdentifier", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "backgroundImageIdentifier", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "backgroundFilterType", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "selected", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "gridType", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], GameTable.prototype, "gridColor", void 0);
    GameTable = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('game-table')
    ], GameTable);
    return GameTable;
}(_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__["ObjectNode"]));



/***/ }),

/***/ "./src/app/class/peer-cursor.ts":
/*!**************************************!*\
  !*** ./src/app/class/peer-cursor.ts ***!
  \**************************************/
/*! exports provided: PeerCursor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PeerCursor", function() { return PeerCursor; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/game-object */ "./src/app/class/core/synchronize-object/game-object.ts");
/* harmony import */ var _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");






var PeerCursor = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](PeerCursor, _super);
    function PeerCursor() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.peerId = '';
        _this.name = '';
        _this.imageIdentifier = '';
        return _this;
    }
    PeerCursor_1 = PeerCursor;
    Object.defineProperty(PeerCursor.prototype, "isMine", {
        get: function () { return (PeerCursor_1.myCursor && PeerCursor_1.myCursor === this); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PeerCursor.prototype, "image", {
        get: function () { return _core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_1__["ImageStorage"].instance.get(this.imageIdentifier); },
        enumerable: true,
        configurable: true
    });
    // GameObject Lifecycle
    PeerCursor.prototype.onStoreAdded = function () {
        var _this = this;
        _super.prototype.onStoreAdded.call(this);
        if (!this.isMine) {
            _core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].register(this)
                .on('DISCONNECT_PEER', -1000, function (event) {
                if (event.data.peer !== _this.peerId)
                    return;
                delete PeerCursor_1.hash[_this.peerId];
                _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.remove(_this);
            });
        }
    };
    // GameObject Lifecycle
    PeerCursor.prototype.onStoreRemoved = function () {
        _super.prototype.onStoreRemoved.call(this);
        _core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].unregister(this);
        delete PeerCursor_1.hash[this.peerId];
    };
    PeerCursor.find = function (peerId) {
        var e_1, _a;
        var identifier = PeerCursor_1.hash[peerId];
        if (identifier != null && _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.get(identifier))
            return _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.get(identifier);
        var cursors = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.getObjects(PeerCursor_1);
        try {
            for (var cursors_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](cursors), cursors_1_1 = cursors_1.next(); !cursors_1_1.done; cursors_1_1 = cursors_1.next()) {
                var cursor = cursors_1_1.value;
                if (cursor.peerId === peerId) {
                    PeerCursor_1.hash[peerId] = cursor.identifier;
                    return cursor;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (cursors_1_1 && !cursors_1_1.done && (_a = cursors_1.return)) _a.call(cursors_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return null;
    };
    PeerCursor.createMyCursor = function () {
        if (PeerCursor_1.myCursor) {
            console.warn('It is already created.');
            return PeerCursor_1.myCursor;
        }
        PeerCursor_1.myCursor = new PeerCursor_1();
        PeerCursor_1.myCursor.peerId = _core_system__WEBPACK_IMPORTED_MODULE_5__["Network"].peerId;
        PeerCursor_1.myCursor.initialize();
        return PeerCursor_1.myCursor;
    };
    // override
    PeerCursor.prototype.apply = function (context) {
        if (context.syncData['peerId'] !== this.peerId) {
            PeerCursor_1.hash[context.syncData['peerId']] = PeerCursor_1.hash[this.peerId];
            delete PeerCursor_1.hash[this.peerId];
        }
        _super.prototype.apply.call(this, context);
    };
    PeerCursor.prototype.isPeerAUdon = function () {
        return /u.*d.*o.*n/ig.exec(this.peerId) != null;
    };
    var PeerCursor_1;
    PeerCursor.myCursor = null;
    PeerCursor.hash = {};
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], PeerCursor.prototype, "peerId", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], PeerCursor.prototype, "name", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncVar"])()
    ], PeerCursor.prototype, "imageIdentifier", void 0);
    PeerCursor = PeerCursor_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_2__["SyncObject"])('PeerCursor')
    ], PeerCursor);
    return PeerCursor;
}(_core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_3__["GameObject"]));



/***/ }),

/***/ "./src/app/class/room.ts":
/*!*******************************!*\
  !*** ./src/app/class/room.ts ***!
  \*******************************/
/*! exports provided: Room */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Room", function() { return Room; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _card__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./card */ "./src/app/class/card.ts");
/* harmony import */ var _card_stack__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./card-stack */ "./src/app/class/card-stack.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/synchronize-object/game-object */ "./src/app/class/core/synchronize-object/game-object.ts");
/* harmony import */ var _core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./core/synchronize-object/object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _dice_symbol__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./dice-symbol */ "./src/app/class/dice-symbol.ts");
/* harmony import */ var _game_character__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./game-character */ "./src/app/class/game-character.ts");
/* harmony import */ var _game_table__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./game-table */ "./src/app/class/game-table.ts");
/* harmony import */ var _game_table_mask__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./game-table-mask */ "./src/app/class/game-table-mask.ts");
/* harmony import */ var _terrain__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./terrain */ "./src/app/class/terrain.ts");
/* harmony import */ var _text_note__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./text-note */ "./src/app/class/text-note.ts");













var Room = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Room, _super);
    function Room() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    // GameObject Lifecycle
    Room.prototype.onStoreAdded = function () {
        _super.prototype.onStoreAdded.call(this);
        _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.remove(this); // ObjectStoreには登録しない
    };
    Room.prototype.innerXml = function () {
        var e_1, _a;
        var xml = '';
        var objects = [];
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_game_table__WEBPACK_IMPORTED_MODULE_9__["GameTable"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_game_character__WEBPACK_IMPORTED_MODULE_8__["GameCharacter"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_text_note__WEBPACK_IMPORTED_MODULE_12__["TextNote"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_card_stack__WEBPACK_IMPORTED_MODULE_2__["CardStack"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_card__WEBPACK_IMPORTED_MODULE_1__["Card"]).filter(function (obj) { return obj.parent === null; }));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_dice_symbol__WEBPACK_IMPORTED_MODULE_7__["DiceSymbol"]));
        try {
            for (var objects_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](objects), objects_1_1 = objects_1.next(); !objects_1_1.done; objects_1_1 = objects_1.next()) {
                var object = objects_1_1.value;
                xml += object.toXml();
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (objects_1_1 && !objects_1_1.done && (_a = objects_1.return)) _a.call(objects_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return xml;
    };
    Room.prototype.parseInnerXml = function (element) {
        var e_2, _a;
        var objects = [];
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_game_table__WEBPACK_IMPORTED_MODULE_9__["GameTable"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_game_table_mask__WEBPACK_IMPORTED_MODULE_10__["GameTableMask"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_terrain__WEBPACK_IMPORTED_MODULE_11__["Terrain"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_game_character__WEBPACK_IMPORTED_MODULE_8__["GameCharacter"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_text_note__WEBPACK_IMPORTED_MODULE_12__["TextNote"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_card_stack__WEBPACK_IMPORTED_MODULE_2__["CardStack"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_card__WEBPACK_IMPORTED_MODULE_1__["Card"]));
        objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.getObjects(_dice_symbol__WEBPACK_IMPORTED_MODULE_7__["DiceSymbol"]));
        try {
            for (var objects_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](objects), objects_2_1 = objects_2.next(); !objects_2_1.done; objects_2_1 = objects_2.next()) {
                var object = objects_2_1.value;
                object.destroy();
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (objects_2_1 && !objects_2_1.done && (_a = objects_2.return)) _a.call(objects_2);
            }
            finally { if (e_2) throw e_2.error; }
        }
        for (var i = 0; i < element.children.length; i++) {
            _core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_5__["ObjectSerializer"].instance.parseXml(element.children[i]);
        }
    };
    Room = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncObject"])('room')
    ], Room);
    return Room;
}(_core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_4__["GameObject"]));



/***/ }),

/***/ "./src/app/class/sound-effect.ts":
/*!***************************************!*\
  !*** ./src/app/class/sound-effect.ts ***!
  \***************************************/
/*! exports provided: PresetSound, SoundEffect */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PresetSound", function() { return PresetSound; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SoundEffect", function() { return SoundEffect; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/file-storage/audio-player */ "./src/app/class/core/file-storage/audio-player.ts");
/* harmony import */ var _core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/file-storage/audio-storage */ "./src/app/class/core/file-storage/audio-storage.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/synchronize-object/game-object */ "./src/app/class/core/synchronize-object/game-object.ts");
/* harmony import */ var _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");







var PresetSound = /** @class */ (function () {
    function PresetSound() {
    }
    PresetSound.dicePick = '';
    PresetSound.dicePut = '';
    PresetSound.diceRoll1 = '';
    PresetSound.diceRoll2 = '';
    PresetSound.cardDraw = '';
    PresetSound.cardPick = '';
    PresetSound.cardPut = '';
    PresetSound.cardShuffle = '';
    PresetSound.piecePick = '';
    PresetSound.piecePut = '';
    PresetSound.blockPick = '';
    PresetSound.blockPut = '';
    PresetSound.lock = '';
    PresetSound.unlock = '';
    PresetSound.sweep = '';
    return PresetSound;
}());

var SoundEffect = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SoundEffect, _super);
    function SoundEffect() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SoundEffect_1 = SoundEffect;
    // GameObject Lifecycle
    SoundEffect.prototype.onStoreAdded = function () {
        _super.prototype.onStoreAdded.call(this);
        _core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].register(this)
            .on('SOUND_EFFECT', function (event) {
            _core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_1__["AudioPlayer"].play(_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_2__["AudioStorage"].instance.get(event.data), 0.5);
        })
            .on('SEND_MESSAGE', function (event) {
            var chatMessage = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(event.data.messageIdentifier);
            if (!chatMessage || !chatMessage.isSendFromSelf || !chatMessage.isDicebot)
                return;
            if (Math.random() < 0.5) {
                SoundEffect_1.play(PresetSound.diceRoll1);
            }
            else {
                SoundEffect_1.play(PresetSound.diceRoll2);
            }
        });
    };
    // GameObject Lifecycle
    SoundEffect.prototype.onStoreRemoved = function () {
        _super.prototype.onStoreRemoved.call(this);
        _core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].unregister(this);
    };
    SoundEffect.prototype.play = function (arg) {
        SoundEffect_1.play(arg);
    };
    SoundEffect.play = function (arg) {
        var identifier = '';
        if (typeof arg === 'string') {
            identifier = arg;
        }
        else {
            identifier = arg.identifier;
        }
        SoundEffect_1._play(identifier);
    };
    SoundEffect._play = function (identifier) {
        _core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].call('SOUND_EFFECT', identifier);
    };
    var SoundEffect_1;
    SoundEffect = SoundEffect_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncObject"])('sound-effect')
    ], SoundEffect);
    return SoundEffect;
}(_core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_4__["GameObject"]));



/***/ }),

/***/ "./src/app/class/table-selecter.ts":
/*!*****************************************!*\
  !*** ./src/app/class/table-selecter.ts ***!
  \*****************************************/
/*! exports provided: TableSelecter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableSelecter", function() { return TableSelecter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/synchronize-object/game-object */ "./src/app/class/core/synchronize-object/game-object.ts");
/* harmony import */ var _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _game_table__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./game-table */ "./src/app/class/game-table.ts");






var TableSelecter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TableSelecter, _super);
    function TableSelecter() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.viewTableIdentifier = '';
        _this.gridShow = false; // true=常時グリッド表示
        _this.gridSnap = true;
        return _this;
    }
    // GameObject Lifecycle
    TableSelecter.prototype.onStoreAdded = function () {
        var _this = this;
        _super.prototype.onStoreAdded.call(this);
        _core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('SELECT_GAME_TABLE', function (event) {
            console.log('SELECT_GAME_TABLE ' + _this.identifier);
            if (_this.viewTable)
                _this.viewTable.selected = false;
            _this.viewTableIdentifier = event.data.identifier;
            if (_this.viewTable)
                _this.viewTable.selected = true;
        });
    };
    // GameObject Lifecycle
    TableSelecter.prototype.onStoreRemoved = function () {
        _super.prototype.onStoreRemoved.call(this);
        _core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    Object.defineProperty(TableSelecter.prototype, "viewTable", {
        get: function () {
            var table = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(this.viewTableIdentifier);
            if (!table) {
                table = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.getObjects(_game_table__WEBPACK_IMPORTED_MODULE_5__["GameTable"])[0];
                if (table && (this.viewTableIdentifier.length < 1 || _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.isDeleted(this.viewTableIdentifier))) {
                    this.viewTableIdentifier = table.identifier;
                    _core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].trigger('SELECT_GAME_TABLE', { identifier: table.identifier });
                }
            }
            return table;
        },
        enumerable: true,
        configurable: true
    });
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], TableSelecter.prototype, "viewTableIdentifier", void 0);
    TableSelecter = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('TableSelecter')
    ], TableSelecter);
    return TableSelecter;
}(_core_synchronize_object_game_object__WEBPACK_IMPORTED_MODULE_2__["GameObject"]));



/***/ }),

/***/ "./src/app/class/tabletop-object-util.ts":
/*!***********************************************!*\
  !*** ./src/app/class/tabletop-object-util.ts ***!
  \***********************************************/
/*! exports provided: moveToTopmost */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "moveToTopmost", function() { return moveToTopmost; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");


function moveToTopmost(topmost, otherRelatives) {
    if (otherRelatives === void 0) { otherRelatives = []; }
    var objects = _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_1__["ObjectStore"].instance.getObjects(topmost.aliasName);
    otherRelatives.forEach(function (aliasName) { return objects = objects.concat(_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_1__["ObjectStore"].instance.getObjects(aliasName)); });
    objects = objects.filter(function (obj) { return obj.isVisibleOnTable; });
    var maxZindex = -1;
    var hasConflict = false;
    for (var i = 0; i < objects.length; i++) {
        if (maxZindex === objects[i].zindex) {
            hasConflict = true;
        }
        else if (maxZindex < objects[i].zindex) {
            maxZindex = objects[i].zindex;
            hasConflict = false;
        }
    }
    if (maxZindex === topmost.zindex && !hasConflict)
        return;
    topmost.zindex = maxZindex + 1;
    if (topmost.zindex < objects.length + 256)
        return;
    objects.sort(function (a, b) { return a.zindex - b.zindex; });
    for (var i = 0; i < objects.length; i++) {
        objects[i].zindex = i;
    }
}


/***/ }),

/***/ "./src/app/class/tabletop-object.ts":
/*!******************************************!*\
  !*** ./src/app/class/tabletop-object.ts ***!
  \******************************************/
/*! exports provided: TabletopObject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TabletopObject", function() { return TabletopObject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _data_element__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./data-element */ "./src/app/class/data-element.ts");







var TabletopObject = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TabletopObject, _super);
    function TabletopObject() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.location = {
            name: 'table',
            x: 0,
            y: 0
        };
        _this.posZ = 0;
        _this._imageFile = _core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_1__["ImageFile"].Empty;
        _this._dataElements = {};
        return _this;
    }
    Object.defineProperty(TabletopObject.prototype, "isVisibleOnTable", {
        get: function () { return this.location.name === 'table' && (!this.parentIsAssigned || this.parentIsDestroyed); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopObject.prototype, "rootDataElement", {
        // GameDataElement getter/setter
        get: function () {
            var e_1, _a;
            try {
                for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var node = _c.value;
                    if (node.getAttribute('name') === this.aliasName)
                        return node;
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopObject.prototype, "imageDataElement", {
        get: function () { return this.getElement('image'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopObject.prototype, "commonDataElement", {
        get: function () { return this.getElement('common'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopObject.prototype, "detailDataElement", {
        get: function () { return this.getElement('detail'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopObject.prototype, "imageFile", {
        get: function () {
            if (!this.imageDataElement)
                return this._imageFile;
            var imageIdElement = this.imageDataElement.getFirstElementByName('imageIdentifier');
            if (imageIdElement && this._imageFile.identifier !== imageIdElement.value) {
                var file = _core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_2__["ImageStorage"].instance.get(imageIdElement.value);
                this._imageFile = file ? file : _core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_1__["ImageFile"].Empty;
            }
            return this._imageFile;
        },
        enumerable: true,
        configurable: true
    });
    TabletopObject.prototype.createDataElements = function () {
        this.initialize();
        var aliasName = this.aliasName;
        if (!this.rootDataElement) {
            var rootElement = _data_element__WEBPACK_IMPORTED_MODULE_6__["DataElement"].create(aliasName, '', {}, aliasName + '_' + this.identifier);
            this.appendChild(rootElement);
        }
        if (!this.imageDataElement) {
            this.rootDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_6__["DataElement"].create('image', '', {}, 'image_' + this.identifier));
            this.imageDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_6__["DataElement"].create('imageIdentifier', '', { type: 'image' }, 'imageIdentifier_' + this.identifier));
        }
        if (!this.commonDataElement)
            this.rootDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_6__["DataElement"].create('common', '', {}, 'common_' + this.identifier));
        if (!this.detailDataElement)
            this.rootDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_6__["DataElement"].create('detail', '', {}, 'detail_' + this.identifier));
    };
    TabletopObject.prototype.getElement = function (name, from) {
        if (from === void 0) { from = this.rootDataElement; }
        if (!from)
            return null;
        var element = this._dataElements[name] ? _core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(this._dataElements[name]) : null;
        if (!element || !from.contains(element)) {
            element = from.getFirstElementByName(name);
            this._dataElements[name] = element ? element.identifier : null;
        }
        return element;
    };
    TabletopObject.prototype.getCommonValue = function (elementName, defaultValue) {
        var element = this.getElement(elementName, this.commonDataElement);
        if (!element)
            return defaultValue;
        if (typeof defaultValue === 'number') {
            var number = +element.value;
            return (Number.isNaN(number) ? defaultValue : number);
        }
        else {
            return (element.value + '');
        }
    };
    TabletopObject.prototype.setCommonValue = function (elementName, value) {
        var element = this.getElement(elementName, this.commonDataElement);
        if (!element) {
            return;
        }
        element.value = value;
    };
    TabletopObject.prototype.getImageFile = function (elementName) {
        if (!this.imageDataElement)
            return null;
        var image = this.getElement(elementName, this.imageDataElement);
        return image ? _core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_2__["ImageStorage"].instance.get(image.value) : null;
    };
    TabletopObject.prototype.setImageFile = function (elementName, imageFile) {
        var image = imageFile ? this.getElement(elementName, this.imageDataElement) : null;
        if (!image)
            return;
        image.value = imageFile.identifier;
    };
    TabletopObject.prototype.setLocation = function (location) {
        this.location.name = location;
        this.update();
    };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncVar"])()
    ], TabletopObject.prototype, "location", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncVar"])()
    ], TabletopObject.prototype, "posZ", void 0);
    TabletopObject = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_3__["SyncObject"])('TabletopObject')
    ], TabletopObject);
    return TabletopObject;
}(_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_4__["ObjectNode"]));



/***/ }),

/***/ "./src/app/class/terrain.ts":
/*!**********************************!*\
  !*** ./src/app/class/terrain.ts ***!
  \**********************************/
/*! exports provided: TerrainViewState, Terrain */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TerrainViewState", function() { return TerrainViewState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Terrain", function() { return Terrain; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _data_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _tabletop_object__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./tabletop-object */ "./src/app/class/tabletop-object.ts");




var TerrainViewState;
(function (TerrainViewState) {
    TerrainViewState[TerrainViewState["NULL"] = 0] = "NULL";
    TerrainViewState[TerrainViewState["FLOOR"] = 1] = "FLOOR";
    TerrainViewState[TerrainViewState["WALL"] = 2] = "WALL";
    TerrainViewState[TerrainViewState["ALL"] = 3] = "ALL";
})(TerrainViewState || (TerrainViewState = {}));
var Terrain = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Terrain, _super);
    function Terrain() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.isLocked = false;
        _this.mode = TerrainViewState.ALL;
        _this.rotate = 0;
        return _this;
    }
    Terrain_1 = Terrain;
    Object.defineProperty(Terrain.prototype, "width", {
        get: function () { return this.getCommonValue('width', 1); },
        set: function (width) { this.setCommonValue('width', width); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Terrain.prototype, "height", {
        get: function () { return this.getCommonValue('height', 1); },
        set: function (height) { this.setCommonValue('height', height); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Terrain.prototype, "depth", {
        get: function () { return this.getCommonValue('depth', 1); },
        set: function (depth) { this.setCommonValue('depth', depth); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Terrain.prototype, "name", {
        get: function () { return this.getCommonValue('name', ''); },
        set: function (name) { this.setCommonValue('name', name); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Terrain.prototype, "wallImage", {
        get: function () { return this.getImageFile('wall'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Terrain.prototype, "floorImage", {
        get: function () { return this.getImageFile('floor'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Terrain.prototype, "hasWall", {
        get: function () { return this.mode & TerrainViewState.WALL ? true : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Terrain.prototype, "hasFloor", {
        get: function () { return this.mode & TerrainViewState.FLOOR ? true : false; },
        enumerable: true,
        configurable: true
    });
    Terrain.create = function (name, width, depth, height, wall, floor, identifier) {
        var object = null;
        if (identifier) {
            object = new Terrain_1(identifier);
        }
        else {
            object = new Terrain_1();
        }
        object.createDataElements();
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('name', name, {}, 'name_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('width', width, {}, 'width_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('height', height, {}, 'height_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('depth', depth, {}, 'depth_' + object.identifier));
        object.imageDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('wall', wall, { type: 'image' }, 'wall_' + object.identifier));
        object.imageDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('floor', floor, { type: 'image' }, 'floor_' + object.identifier));
        object.initialize();
        return object;
    };
    var Terrain_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], Terrain.prototype, "isLocked", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], Terrain.prototype, "mode", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], Terrain.prototype, "rotate", void 0);
    Terrain = Terrain_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('terrain')
    ], Terrain);
    return Terrain;
}(_tabletop_object__WEBPACK_IMPORTED_MODULE_3__["TabletopObject"]));



/***/ }),

/***/ "./src/app/class/text-note.ts":
/*!************************************!*\
  !*** ./src/app/class/text-note.ts ***!
  \************************************/
/*! exports provided: TextNote */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextNote", function() { return TextNote; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/synchronize-object/decorator */ "./src/app/class/core/synchronize-object/decorator.ts");
/* harmony import */ var _data_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _tabletop_object__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./tabletop-object */ "./src/app/class/tabletop-object.ts");
/* harmony import */ var _tabletop_object_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./tabletop-object-util */ "./src/app/class/tabletop-object-util.ts");





var TextNote = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextNote, _super);
    function TextNote() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.rotate = 0;
        _this.zindex = 0;
        _this.password = '';
        return _this;
    }
    TextNote_1 = TextNote;
    Object.defineProperty(TextNote.prototype, "width", {
        get: function () { return this.getCommonValue('width', 1); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNote.prototype, "height", {
        get: function () { return this.getCommonValue('height', 1); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNote.prototype, "fontSize", {
        get: function () { return this.getCommonValue('fontsize', 1); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNote.prototype, "title", {
        get: function () { return this.getCommonValue('title', ''); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNote.prototype, "text", {
        get: function () { return this.getCommonValue('text', ''); },
        set: function (text) { this.setCommonValue('text', text); },
        enumerable: true,
        configurable: true
    });
    TextNote.prototype.toTopmost = function () {
        Object(_tabletop_object_util__WEBPACK_IMPORTED_MODULE_4__["moveToTopmost"])(this);
    };
    TextNote.create = function (title, text, fontSize, width, height, identifier) {
        if (fontSize === void 0) { fontSize = 16; }
        if (width === void 0) { width = 1; }
        if (height === void 0) { height = 1; }
        var object = identifier ? new TextNote_1(identifier) : new TextNote_1();
        object.createDataElements();
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('width', width, {}, 'width_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('height', height, {}, 'height_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('fontsize', fontSize, {}, 'fontsize_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('title', title, {}, 'title_' + object.identifier));
        object.commonDataElement.appendChild(_data_element__WEBPACK_IMPORTED_MODULE_2__["DataElement"].create('text', text, { type: 'note', currentValue: text }, 'text_' + object.identifier));
        object.initialize();
        return object;
    };
    var TextNote_1;
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], TextNote.prototype, "rotate", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], TextNote.prototype, "zindex", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncVar"])()
    ], TextNote.prototype, "password", void 0);
    TextNote = TextNote_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_core_synchronize_object_decorator__WEBPACK_IMPORTED_MODULE_1__["SyncObject"])('text-note')
    ], TextNote);
    return TextNote;
}(_tabletop_object__WEBPACK_IMPORTED_MODULE_3__["TabletopObject"]));



/***/ }),

/***/ "./src/app/class/transform/css-number.ts":
/*!***********************************************!*\
  !*** ./src/app/class/transform/css-number.ts ***!
  \***********************************************/
/*! exports provided: CSSNumber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CSSNumber", function() { return CSSNumber; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var CSSNumber;
(function (CSSNumber) {
    function relation(value, relativeSize, defaultValue) {
        if (defaultValue === void 0) { defaultValue = 0; }
        if (typeof value === 'number') {
            return value;
        }
        else if (typeof value === 'string') {
            value = value.trim().toLowerCase();
            if (value.indexOf('%') > 0)
                return (parse(value.replace('%', ''), defaultValue) / 100) * relativeSize;
            else if (value.indexOf('px') > 0 || value.indexOf('pt') > 0)
                return parse(value.replace('px', ''), defaultValue);
            else if (value.indexOf('vw') > 0)
                return (parse(value.replace('vw', ''), defaultValue) / 100) * window.innerWidth;
            else if (value.indexOf('vh') > 0)
                return (parse(value.replace('vh', ''), defaultValue) / 100) * window.innerHeight;
            else if (value.indexOf('vm') > 0)
                return (parse(value.replace('vm', ''), defaultValue) / 100) * Math.min(window.innerWidth, window.innerHeight);
            else if (value.indexOf('em') > 0)
                return parse(value.replace('em', ''), defaultValue);
            else if (value === 'top' || value === 'left')
                return 0;
            else if (value === 'center' || value === 'middle')
                return relativeSize * 0.5;
            else if (value === 'bottom' || value === 'right')
                return relativeSize;
            return defaultValue;
        }
        return defaultValue;
    }
    CSSNumber.relation = relation;
    function parse(value, defaultValue) {
        if (defaultValue === void 0) { defaultValue = 0; }
        value = parseFloat(value);
        if (isNaN(value))
            return defaultValue;
        return value;
    }
    CSSNumber.parse = parse;
})(CSSNumber || (CSSNumber = {}));


/***/ }),

/***/ "./src/app/class/transform/matrix-3d.ts":
/*!**********************************************!*\
  !*** ./src/app/class/transform/matrix-3d.ts ***!
  \**********************************************/
/*! exports provided: Matrix3D */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Matrix3D", function() { return Matrix3D; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _css_number__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./css-number */ "./src/app/class/transform/css-number.ts");


var Matrix3D = /** @class */ (function () {
    function Matrix3D() {
        this.m11 = 1;
        this.m12 = 0;
        this.m13 = 0;
        this.m14 = 0;
        this.m21 = 0;
        this.m22 = 1;
        this.m23 = 0;
        this.m24 = 0;
        this.m31 = 0;
        this.m32 = 0;
        this.m33 = 1;
        this.m34 = 0;
        this.m41 = 0;
        this.m42 = 0;
        this.m43 = 0;
        this.m44 = 1;
    }
    Matrix3D.create = function (element, style, ret) {
        if (style === void 0) { style = null; }
        if (ret === void 0) { ret = new Matrix3D(); }
        if (element && element.ownerDocument)
            return ret.setCSS((style || window.getComputedStyle(element)).transform);
        return ret.identity();
    };
    Matrix3D.prototype.setData = function (data) {
        if (data == null)
            return;
        var l = data.length;
        if (l == 16) {
            this.m11 = data[0];
            this.m12 = data[1];
            this.m13 = data[2];
            this.m14 = data[3];
            this.m21 = data[4];
            this.m22 = data[5];
            this.m23 = data[6];
            this.m24 = data[7];
            this.m31 = data[8];
            this.m32 = data[9];
            this.m33 = data[10];
            this.m34 = data[11];
            this.m41 = data[12];
            this.m42 = data[13];
            this.m43 = data[14];
            this.m44 = data[15];
        }
        else if (l == 6) {
            this.m11 = data[0];
            this.m12 = data[1];
            this.m13 = 0;
            this.m14 = 0;
            this.m21 = data[2];
            this.m22 = data[3];
            this.m23 = 0;
            this.m24 = 0;
            this.m31 = 0;
            this.m32 = 0;
            this.m33 = 1;
            this.m34 = 0;
            this.m41 = data[4];
            this.m42 = data[5];
            this.m43 = 0;
            this.m44 = 1;
        }
        else if (l == 9) {
            this.m11 = data[0];
            this.m12 = data[1];
            this.m13 = 0;
            this.m14 = data[2];
            this.m21 = data[3];
            this.m22 = data[4];
            this.m23 = 0;
            this.m24 = data[5];
            this.m31 = 0;
            this.m32 = 0;
            this.m33 = 1;
            this.m34 = 0;
            this.m41 = data[6];
            this.m42 = data[7];
            this.m43 = 0;
            this.m44 = data[8];
        }
        return this;
    };
    Matrix3D.prototype.identity = function () {
        this.m11 = 1;
        this.m12 = 0;
        this.m13 = 0;
        this.m14 = 0;
        this.m21 = 0;
        this.m22 = 1;
        this.m23 = 0;
        this.m24 = 0;
        this.m31 = 0;
        this.m32 = 0;
        this.m33 = 1;
        this.m34 = 0;
        this.m41 = 0;
        this.m42 = 0;
        this.m43 = 0;
        this.m44 = 1;
        return this;
    };
    Matrix3D.prototype.scalar = function (scalar) {
        this.m11 *= scalar;
        this.m12 *= scalar;
        this.m13 *= scalar;
        this.m14 *= scalar;
        this.m21 *= scalar;
        this.m22 *= scalar;
        this.m23 *= scalar;
        this.m24 *= scalar;
        this.m31 *= scalar;
        this.m32 *= scalar;
        this.m33 *= scalar;
        this.m34 *= scalar;
        this.m41 *= scalar;
        this.m42 *= scalar;
        this.m43 *= scalar;
        this.m44 *= scalar;
        return this;
    };
    //based on http://code.metager.de/source/xref/mozilla/B2G/gecko/gfx/thebes/gfx3DMatrix.cpp#651
    Matrix3D.prototype.unproject = function (point, ret) {
        if (ret === void 0) { ret = { x: 0, y: 0, z: 0, w: 1 }; }
        var x = point.x * this.m11 + point.y * this.m21 + this.m41;
        var y = point.x * this.m12 + point.y * this.m22 + this.m42;
        var z = point.x * this.m13 + point.y * this.m23 + this.m43;
        var w = point.x * this.m14 + point.y * this.m24 + this.m44;
        var qx = x + this.m31;
        var qy = y + this.m32;
        var qz = z + this.m33;
        var qw = w + this.m34;
        if (w == 0)
            w = 0.0001;
        x /= w;
        y /= w;
        z /= w;
        if (qw == 0)
            qw = 0.0001;
        qx /= qw;
        qy /= qw;
        qz /= qw;
        var wz = qz - z;
        if (wz == 0) {
            ret.x = x;
            ret.y = y;
            ret.z = z;
            ret.w = z;
            return ret;
        }
        var t = -z / wz;
        x += t * (qx - x);
        y += t * (qy - y);
        ret.x = x;
        ret.y = y;
        ret.z = z;
        ret.w = z;
        return ret;
    };
    Matrix3D.prototype.project = function (point, ret) {
        if (ret === void 0) { ret = { x: 0, y: 0, z: 0, w: 1 }; }
        var z = point.z;
        var w = point.x * this.m14 + point.y * this.m24 + z * this.m34 + this.m44;
        var x = point.x * this.m11 + point.y * this.m21 + z * this.m31 + this.m41;
        var y = point.x * this.m12 + point.y * this.m22 + z * this.m32 + this.m42;
        if (w == 0)
            w = 0.0001;
        x /= w;
        y /= w;
        if (w < 0) {
            x -= this.m41;
            y -= this.m42;
            x *= 1 / w;
            y *= 1 / w;
            x += this.m41;
            y += this.m42;
        }
        ret.x = x;
        ret.y = y;
        ret.z = z;
        ret.w = z;
        return ret;
    };
    Matrix3D.prototype.append = function (b) {
        return Matrix3D.multiply(this, b, this);
    };
    Matrix3D.prototype.setPosition = function (position) {
        this.m41 = position.x;
        this.m42 = position.y;
        this.m43 = position.z;
        return this;
    };
    Matrix3D.prototype.getPosition = function (ret) {
        if (ret === void 0) { ret = { x: 0, y: 0, z: 0, w: 1 }; }
        ret.x = this.m41;
        ret.y = this.m42;
        ret.z = this.m43;
        return ret;
    };
    Matrix3D.makePosition = function (position, ret) {
        if (ret === void 0) { ret = new Matrix3D(); }
        ret.identity();
        ret.setPosition(position);
        return ret;
    };
    Matrix3D.prototype.appendPosition = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var position;
        if (args.length === 1) {
            position = args[0];
        }
        else {
            position = { x: args[0], y: args[1], z: args[2], w: 1 };
        }
        return this.append(Matrix3D.makePosition(position, Matrix3D.MATRIX3D));
    };
    Matrix3D.makePerspective = function (perspective, ret) {
        if (ret === void 0) { ret = new Matrix3D(); }
        ret.identity();
        ret.m34 = perspective ? -(1 / perspective) : 0;
        return ret;
    };
    Matrix3D.prototype.appendPerspective = function (perspective) {
        if (!perspective)
            return this;
        return this.append(Matrix3D.makePerspective(perspective, Matrix3D.MATRIX3D));
    };
    /**
    * Inverts the matrix.
    * -> based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm
    * -> based on https://github.com/mrdoob/three.js/blob/master/src/math/Matrix4.js
    */
    Matrix3D.prototype.invert = function (target) {
        target = target || this;
        var data = [];
        var n11 = this.m11, n12 = this.m12, n13 = this.m13, n14 = this.m14;
        var n21 = this.m21, n22 = this.m22, n23 = this.m23, n24 = this.m24;
        var n31 = this.m31, n32 = this.m32, n33 = this.m33, n34 = this.m34;
        var n41 = this.m41, n42 = this.m42, n43 = this.m43, n44 = this.m44;
        data[0] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;
        data[1] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;
        data[2] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;
        data[3] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;
        var det = n11 * data[0] + n21 * data[1] + n31 * data[2] + n41 * data[3];
        if (det == 0) {
            console.warn('Can not invert matrix, determinant is 0');
            return this;
        }
        data[4] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;
        data[5] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;
        data[6] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;
        data[7] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;
        data[8] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;
        data[9] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;
        data[10] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;
        data[11] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;
        data[12] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;
        data[13] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;
        data[14] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;
        data[15] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;
        target.setData(data);
        target.scalar(1 / det);
        return target;
    };
    Matrix3D.prototype.setCSS = function (cssString) {
        if (!cssString || cssString == 'none')
            return this.identity();
        var trans = cssString.replace('matrix3d(', '').replace('matrix(', '').replace(')', '').split(',');
        var l = trans.length;
        for (var i = 0; i < l; ++i) {
            trans[i] = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].parse(trans[i]);
        }
        return this.setData(trans);
    };
    Matrix3D.prototype.appendCSS = function (cssString, force2D) {
        if (force2D === void 0) { force2D = false; }
        if (!cssString || cssString == 'none')
            return this;
        if (force2D && cssString.indexOf('matrix3d') >= 0) {
            return this.append(Matrix3D.MATRIX3D.setCSS(cssString).flatten());
        }
        return this.append(Matrix3D.MATRIX3D.setCSS(cssString));
    };
    Matrix3D.prototype.flatten = function () {
        this.m31 = 0;
        this.m32 = 0;
        this.m33 = 1;
        this.m34 = 0;
        this.m44 = 1;
        this.m14 = 0;
        this.m24 = 0;
        this.m43 = 0;
        return this;
    };
    Matrix3D.multiply = function (a, b, ret) {
        if (ret === void 0) { ret = new Matrix3D(); }
        var m11 = a.m11 * b.m11 + a.m12 * b.m21 + a.m13 * b.m31 + a.m14 * b.m41;
        var m12 = a.m11 * b.m12 + a.m12 * b.m22 + a.m13 * b.m32 + a.m14 * b.m42;
        var m13 = a.m11 * b.m13 + a.m12 * b.m23 + a.m13 * b.m33 + a.m14 * b.m43;
        var m14 = a.m11 * b.m14 + a.m12 * b.m24 + a.m13 * b.m34 + a.m14 * b.m44;
        var m21 = a.m21 * b.m11 + a.m22 * b.m21 + a.m23 * b.m31 + a.m24 * b.m41;
        var m22 = a.m21 * b.m12 + a.m22 * b.m22 + a.m23 * b.m32 + a.m24 * b.m42;
        var m23 = a.m21 * b.m13 + a.m22 * b.m23 + a.m23 * b.m33 + a.m24 * b.m43;
        var m24 = a.m21 * b.m14 + a.m22 * b.m24 + a.m23 * b.m34 + a.m24 * b.m44;
        var m31 = a.m31 * b.m11 + a.m32 * b.m21 + a.m33 * b.m31 + a.m34 * b.m41;
        var m32 = a.m31 * b.m12 + a.m32 * b.m22 + a.m33 * b.m32 + a.m34 * b.m42;
        var m33 = a.m31 * b.m13 + a.m32 * b.m23 + a.m33 * b.m33 + a.m34 * b.m43;
        var m34 = a.m31 * b.m14 + a.m32 * b.m24 + a.m33 * b.m34 + a.m34 * b.m44;
        var m41 = a.m41 * b.m11 + a.m42 * b.m21 + a.m43 * b.m31 + a.m44 * b.m41;
        var m42 = a.m41 * b.m12 + a.m42 * b.m22 + a.m43 * b.m32 + a.m44 * b.m42;
        var m43 = a.m41 * b.m13 + a.m42 * b.m23 + a.m43 * b.m33 + a.m44 * b.m43;
        var m44 = a.m41 * b.m14 + a.m42 * b.m24 + a.m43 * b.m34 + a.m44 * b.m44;
        ret.m11 = m11;
        ret.m12 = m12;
        ret.m13 = m13;
        ret.m14 = m14;
        ret.m21 = m21;
        ret.m22 = m22;
        ret.m23 = m23;
        ret.m24 = m24;
        ret.m31 = m31;
        ret.m32 = m32;
        ret.m33 = m33;
        ret.m34 = m34;
        ret.m41 = m41;
        ret.m42 = m42;
        ret.m43 = m43;
        ret.m44 = m44;
        return ret;
    };
    Matrix3D.prototype.toString = function (fractionalDigits) {
        if (fractionalDigits === void 0) { fractionalDigits = 3; }
        return "m11=" + this.m11.toFixed(fractionalDigits)
            + "\tm21=" + this.m21.toFixed(fractionalDigits)
            + "\tm31=" + this.m31.toFixed(fractionalDigits)
            + "\tm41=" + this.m41.toFixed(fractionalDigits)
            + "\nm12=" + this.m12.toFixed(fractionalDigits)
            + "\tm22=" + this.m22.toFixed(fractionalDigits)
            + "\tm32=" + this.m32.toFixed(fractionalDigits)
            + "\tm42=" + this.m42.toFixed(fractionalDigits)
            + "\nm13=" + this.m13.toFixed(fractionalDigits)
            + "\tm23=" + this.m23.toFixed(fractionalDigits)
            + "\tm33=" + this.m33.toFixed(fractionalDigits)
            + "\tm43=" + this.m43.toFixed(fractionalDigits)
            + "\nm14=" + this.m14.toFixed(fractionalDigits)
            + "\tm24=" + this.m24.toFixed(fractionalDigits)
            + "\tm34=" + this.m34.toFixed(fractionalDigits)
            + "\tm44=" + this.m44.toFixed(fractionalDigits);
    };
    Matrix3D.MATRIX3D = new Matrix3D();
    return Matrix3D;
}());



/***/ }),

/***/ "./src/app/class/transform/transform.ts":
/*!**********************************************!*\
  !*** ./src/app/class/transform/transform.ts ***!
  \**********************************************/
/*! exports provided: Transform */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Transform", function() { return Transform; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _css_number__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./css-number */ "./src/app/class/transform/css-number.ts");
/* harmony import */ var _matrix_3d__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./matrix-3d */ "./src/app/class/transform/matrix-3d.ts");



var Transform = /** @class */ (function () {
    function Transform(element) {
        this.matrix = new _matrix_3d__WEBPACK_IMPORTED_MODULE_2__["Matrix3D"]();
        this.sceneTransform = new _matrix_3d__WEBPACK_IMPORTED_MODULE_2__["Matrix3D"]();
        this.inverseSceneTransform = new _matrix_3d__WEBPACK_IMPORTED_MODULE_2__["Matrix3D"]();
        this.initialize(element);
    }
    Transform.prototype.clear = function () {
        this.element = null;
        this.matrix.identity();
        return this;
    };
    Transform.prototype.initialize = function (element) {
        if (!element)
            return;
        this.element = element;
        var style = window.getComputedStyle(element);
        var parentWidth = 0;
        var parentHeight = 0;
        if (this.element.parentElement) {
            parentWidth = this.element.parentElement.clientWidth;
            parentHeight = this.element.parentElement.clientHeight;
        }
        else {
            parentWidth = window.innerWidth;
            parentHeight = window.innerHeight;
        }
        this.paddingLeft = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(style.paddingTop, parentWidth);
        this.paddingTop = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(style.paddingTop, parentHeight);
        this.marginLeft = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(style.marginLeft, parentWidth);
        this.marginTop = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(style.marginTop, parentHeight);
        this.borderLeft = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(style.borderLeft, parentWidth);
        this.borderTop = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(style.borderTop, parentHeight);
        this.matrix.setCSS(style.transform);
        this.sceneTransform.identity();
        this.extract(this, this.sceneTransform);
        this.sceneTransform.invert(this.inverseSceneTransform);
        return this;
    };
    Transform.prototype.globalToLocal = function (x, y, z) {
        if (z === void 0) { z = 0; }
        var ret = { x: x, y: y, z: z, w: 1 };
        this.inverseSceneTransform.unproject(ret, ret);
        this.fromBorderBox(ret);
        return ret;
    };
    Transform.prototype.localToGlobal = function (x, y, z) {
        if (z === void 0) { z = 0; }
        var ret = { x: x, y: y, z: z, w: 1 };
        this.sceneTransform.project(ret, ret);
        this.fromBorderBox(ret);
        return ret;
    };
    Transform.prototype.localToLocal = function (x, y, z, to) {
        var local = { x: x, y: y, z: z, w: 1 };
        var transformer = new Transform(to);
        var matrix = _matrix_3d__WEBPACK_IMPORTED_MODULE_2__["Matrix3D"].multiply(this.sceneTransform, transformer.inverseSceneTransform);
        var ret = { x: 0, y: 0, z: 0, w: 1 };
        ret.x = local.x * matrix.m11 + local.y * matrix.m21 + local.z * matrix.m31 + local.w * matrix.m41;
        ret.y = local.x * matrix.m12 + local.y * matrix.m22 + local.z * matrix.m32 + local.w * matrix.m42;
        ret.z = local.x * matrix.m13 + local.y * matrix.m23 + local.z * matrix.m33 + local.w * matrix.m43;
        ret.w = local.x * matrix.m14 + local.y * matrix.m24 + local.z * matrix.m34 + local.w * matrix.m44;
        transformer.clear();
        this.toBorderBox(ret);
        return ret;
    };
    Transform.prototype.extract = function (transform, matrix) {
        var element = transform.element;
        var node = element;
        while (node) {
            this.extractMatrix(node, matrix);
            if (node && node.style.position === 'fixed') {
                console.warn('fixed領域は計算が不正確');
                matrix.appendPosition(window.pageXOffset, window.pageYOffset, 0);
            }
            node = node.parentElement;
        }
    };
    Transform.prototype.extractMatrix = function (node, matrix) {
        if (matrix === void 0) { matrix = null; }
        if (!matrix)
            matrix = new _matrix_3d__WEBPACK_IMPORTED_MODULE_2__["Matrix3D"]();
        if (!node)
            return matrix;
        var element = node;
        var style = window.getComputedStyle(node);
        if (style.transform != 'none') {
            var origin_1 = style.transformOrigin ? style.transformOrigin.split(' ') : [];
            var originX = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(origin_1[0], element.offsetWidth, element.offsetWidth * 0.5);
            var originY = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(origin_1[1], element.offsetHeight, element.offsetHeight * 0.5);
            var originZ = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(origin_1[2], 0, 0);
            matrix.appendPosition(-originX, -originY, -originZ);
            matrix.appendCSS(style.transform);
            matrix.appendPosition(originX, originY, originZ);
        }
        var position = this.getPosition(node);
        matrix.appendPosition(position.x, position.y, 0);
        var perspective = 0;
        if (node.parentElement) {
            var parentStyle = window.getComputedStyle(node.parentElement);
            perspective = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].parse(parentStyle.perspective);
        }
        if (node.parentElement && perspective) {
            var parentStyle = window.getComputedStyle(node.parentElement);
            var perspectiveOrigin = parentStyle.perspectiveOrigin.split(' ');
            var perspectiveOriginX = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(perspectiveOrigin[0], element.parentElement.offsetWidth);
            var perspectiveOriginY = _css_number__WEBPACK_IMPORTED_MODULE_1__["CSSNumber"].relation(perspectiveOrigin[1], element.parentElement.offsetHeight);
            matrix.appendPosition(-perspectiveOriginX, -perspectiveOriginY, 0);
            matrix.appendPerspective(perspective);
            matrix.appendPosition(perspectiveOriginX, perspectiveOriginY, 0);
        }
        return matrix;
    };
    Transform.prototype.getPosition = function (node) {
        var ret = { x: 0, y: 0 };
        ret.x = !node.offsetParent ? node.offsetLeft : node.parentElement === node.offsetParent ? node.offsetLeft : node.parentElement.offsetParent === node.offsetParent ? node.offsetLeft - node.parentElement.offsetLeft : 0;
        ret.y = !node.offsetParent ? node.offsetTop : node.parentElement === node.offsetParent ? node.offsetTop : node.parentElement.offsetParent === node.offsetParent ? node.offsetTop - node.parentElement.offsetTop : 0;
        ret.x += node.offsetParent ? node.offsetParent.clientLeft : 0;
        ret.y += node.offsetParent ? node.offsetParent.clientTop : 0;
        return ret;
    };
    Transform.prototype.fromBorderBox = function (point) {
        point.x += this.paddingLeft;
        point.y += this.paddingTop;
        point.x += this.marginLeft;
        point.y += this.marginTop;
        point.x -= this.borderLeft;
        point.y -= this.borderTop;
    };
    Transform.prototype.toBorderBox = function (point) {
        point.x -= this.paddingLeft;
        point.y -= this.paddingTop;
        point.x -= this.marginLeft;
        point.y -= this.marginTop;
        point.x += this.borderLeft;
        point.y += this.borderTop;
    };
    return Transform;
}());



/***/ }),

/***/ "./src/app/component/badge/badge.component.css":
/*!*****************************************************!*\
  !*** ./src/app/component/badge/badge.component.css ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".badge {\n  min-width: 8px;\n  min-height: 8px;\n  font-size: 8px;\n  padding: 2px 4px;\n  border-radius: 100px;\n  text-align: center;\n  color: #eee; \n  background-color: rgb(207, 82, 82);\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2JhZGdlL2JhZGdlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxjQUFjO0VBQ2QsZUFBZTtFQUNmLGNBQWM7RUFDZCxnQkFBZ0I7RUFDaEIsb0JBQW9CO0VBQ3BCLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsa0NBQWtDO0FBQ3BDIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2JhZGdlL2JhZGdlLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuYmFkZ2Uge1xuICBtaW4td2lkdGg6IDhweDtcbiAgbWluLWhlaWdodDogOHB4O1xuICBmb250LXNpemU6IDhweDtcbiAgcGFkZGluZzogMnB4IDRweDtcbiAgYm9yZGVyLXJhZGl1czogMTAwcHg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgY29sb3I6ICNlZWU7IFxuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjA3LCA4MiwgODIpO1xufVxuIl19 */");

/***/ }),

/***/ "./src/app/component/badge/badge.component.ts":
/*!****************************************************!*\
  !*** ./src/app/component/badge/badge.component.ts ***!
  \****************************************************/
/*! exports provided: BadgeComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BadgeComponent", function() { return BadgeComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/animations */ "./node_modules/@angular/animations/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");



var BadgeComponent = /** @class */ (function () {
    function BadgeComponent() {
        this.count = 0;
        this.animeState = 'active';
    }
    BadgeComponent.prototype.ngOnChanges = function () {
        var _this = this;
        this.animeState = 'inactive';
        setTimeout(function () { _this.animeState = 'active'; });
    };
    BadgeComponent.prototype.animationShuffleDone = function (event) {
        this.animeState = 'inactive';
    };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], BadgeComponent.prototype, "count", void 0);
    BadgeComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
            selector: 'badge',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./badge.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/badge/badge.component.html")).default,
            animations: [
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('bounce', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["state"])('active', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: '' })),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => active', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('600ms ease', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0.5, 0.5, 0.5)', offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(2, 2, 2)', offset: 0.5 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0.75, 0.75, 0.75)', offset: 0.75 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.125, 1.125, 1.125)', offset: 0.875 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.0, 1.0, 1.0)', offset: 1.0 })
                        ]))
                    ])
                ])
            ],
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./badge.component.css */ "./src/app/component/badge/badge.component.css")).default]
        })
    ], BadgeComponent);
    return BadgeComponent;
}());



/***/ }),

/***/ "./src/app/component/card-stack-list/card-stack-list.component.css":
/*!*************************************************************************!*\
  !*** ./src/app/component/card-stack-list/card-stack-list.component.css ***!
  \*************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".box {\n  border-bottom:1px dotted #888;\n}\n\n.image-box {\n  display: inline-block;\n  vertical-align: top;\n}\n\n.image {\n  padding: 0px;\n  width: 64px;\n  height: 64px;\n  display: inline-block;\n  vertical-align: top;\n}\n\n.contain {\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2NhcmQtc3RhY2stbGlzdC9jYXJkLXN0YWNrLWxpc3QuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLDZCQUE2QjtBQUMvQjs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxZQUFZO0VBQ1osV0FBVztFQUNYLFlBQVk7RUFDWixxQkFBcUI7RUFDckIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0Usa0NBQWtDO0VBQ2xDLDRCQUE0QjtFQUM1Qix3QkFBd0I7QUFDMUIiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvY2FyZC1zdGFjay1saXN0L2NhcmQtc3RhY2stbGlzdC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmJveCB7XG4gIGJvcmRlci1ib3R0b206MXB4IGRvdHRlZCAjODg4O1xufVxuXG4uaW1hZ2UtYm94IHtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xufVxuXG4uaW1hZ2Uge1xuICBwYWRkaW5nOiAwcHg7XG4gIHdpZHRoOiA2NHB4O1xuICBoZWlnaHQ6IDY0cHg7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcbn1cblxuLmNvbnRhaW4ge1xuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXIgY2VudGVyO1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XG59Il19 */");

/***/ }),

/***/ "./src/app/component/card-stack-list/card-stack-list.component.ts":
/*!************************************************************************!*\
  !*** ./src/app/component/card-stack-list/card-stack-list.component.ts ***!
  \************************************************************************/
/*! exports provided: CardStackListComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CardStackListComponent", function() { return CardStackListComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");








var CardStackListComponent = /** @class */ (function () {
    function CardStackListComponent(panelService, changeDetector) {
        this.panelService = panelService;
        this.changeDetector = changeDetector;
        this.cardStack = null;
        this.owner = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId;
    }
    CardStackListComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.panelService.title = this.cardStack.name + ' のカード一覧';
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.cardStack || !object)
                return;
            if ((_this.cardStack === object)
                || (object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__["ObjectNode"] && _this.cardStack.contains(object))) {
                _this.changeDetector.markForCheck();
            }
            if (event.data.identifier === _this.cardStack.identifier && _this.cardStack.owner !== _this.owner) {
                _this.panelService.close();
            }
        })
            .on('DELETE_GAME_OBJECT', -1000, function (event) {
            if (_this.cardStack && _this.cardStack.identifier === event.data.identifier) {
                _this.panelService.close();
            }
        });
    };
    CardStackListComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
        if (this.cardStack.owner === this.owner) {
            this.cardStack.owner = '';
        }
    };
    CardStackListComponent.prototype.drawCard = function (card) {
        card.parent.removeChild(card);
        card.location.x = this.cardStack.location.x + 100 + (Math.random() * 50);
        card.location.y = this.cardStack.location.y + 25 + (Math.random() * 50);
        card.location.name = this.cardStack.location.name;
        card.rotate += this.cardStack.rotate;
        if (360 < card.rotate)
            card.rotate -= 360;
        card.toTopmost();
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].cardDraw);
    };
    CardStackListComponent.prototype.up = function (card) {
        var parent = card.parent;
        var index = parent.children.indexOf(card);
        if (0 < index) {
            var prev = parent.children[index - 1];
            parent.insertBefore(card, prev);
        }
    };
    CardStackListComponent.prototype.down = function (card) {
        var parent = card.parent;
        var index = parent.children.indexOf(card);
        if (index < parent.children.length - 1) {
            var next = parent.children[index + 1];
            parent.insertBefore(next, card);
        }
    };
    CardStackListComponent.prototype.close = function (needShuffle) {
        if (needShuffle === void 0) { needShuffle = false; }
        if (needShuffle) {
            this.cardStack.shuffle();
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].call('SHUFFLE_CARD_STACK', { identifier: this.cardStack.identifier });
            _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].cardShuffle);
        }
        this.panelService.close();
    };
    CardStackListComponent.prototype.showDetail = function (gameObject) {
        var coordinate = {
            x: this.panelService.left,
            y: this.panelService.top
        };
        var title = 'カード設定';
        if (gameObject.name.length)
            title += ' - ' + gameObject.name;
        var option = { title: title, left: coordinate.x + 10, top: coordinate.y + 20, width: 600, height: 600 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_6__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    CardStackListComponent.prototype.trackByCard = function (index, card) {
        return card.identifier;
    };
    CardStackListComponent.ctorParameters = function () { return [
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_7__["PanelService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], CardStackListComponent.prototype, "cardStack", void 0);
    CardStackListComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'card-stack-list',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./card-stack-list.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/card-stack-list/card-stack-list.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./card-stack-list.component.css */ "./src/app/component/card-stack-list/card-stack-list.component.css")).default]
        })
    ], CardStackListComponent);
    return CardStackListComponent;
}());



/***/ }),

/***/ "./src/app/component/card-stack/card-stack.component.css":
/*!***************************************************************!*\
  !*** ./src/app/component/card-stack/card-stack.component.css ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".is-grab {\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n\n.is-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.is-transition {\n  -webkit-transition: -webkit-transform 132ms linear;\n  transition: -webkit-transform 132ms linear;\n  transition: transform 132ms linear;\n  transition: transform 132ms linear, -webkit-transform 132ms linear;\n}\n\n.is-3d {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n\n.is-pointer-events-auto {\n  pointer-events: auto;\n}\n\n.is-empty {\n  height: 100px;\n  width: 100px;\n}\n\n.component {\n  position: absolute;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  \n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n}\n\n.component-content {\n  height: 100%;\n  width: 100%;\n  margin-top: -5px;\n  margin-left: -5px;\n  border: solid 5px #CCCCCC;\n  border-radius: 5px;\n  background-color: #CCCCCC;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n}\n\n.card-image {\n  display: block;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin: auto;\n  height: auto;\n  width: 100%;\n}\n\n.rotate-grab {\n  position: absolute;\n  width: 28px;\n  height: 28px;\n  box-sizing: border-box;\n  cursor: -moz-default;\n  cursor: -webkit-default;\n  cursor: default;\n  z-index: 1;\n  padding: 2px;\n  background-color: #CCCCCC;\n  border-radius: 100%;\n  color: #444;\n  font-size: 8px;\n}\n\n.rotate-grab {\n  display: none;\n}\n\n.component:hover .rotate-grab {\n  display: block;\n  opacity: 0.5;\n}\n\n.component:active .rotate-grab {\n  display: none;\n}\n\n.component .rotate-grab:hover, .component .rotate-grab:active {\n  display: block;\n  opacity: 1;\n}\n\n.of-left-top {\n  top: -14px;\n  left: -14px;\n}\n\n.of-left-bottom {\n  bottom: -14px;\n  left: -14px;\n}\n\n.of-right-bottom {\n  bottom: -14px;\n  right: -14px;\n}\n\n.of-right-top {\n  top: -14px;\n  right: -14px;\n}\n\n.name-tag {\n  box-sizing: border-box;\n  font-size: 15px;\n  padding: 3px 9px;\n  border-radius: 24px;\n  position: absolute;\n  top: 50%\n}\n\n.has-length-limit {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  max-width: 18em;\n}\n\n.is-nowrap {\n  white-space: nowrap;\n}\n\n.is-black-background {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n\n.material-icons {\n  display: none;\n}\n\n.component:hover .material-icons, .component:active .material-icons {\n  display: inline;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2NhcmQtc3RhY2svY2FyZC1zdGFjay5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUUsb0JBQW9CO0VBQ3BCLFlBQVk7QUFDZDs7QUFFQTtFQUVFLHdCQUF3QjtFQUN4QixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxrREFBa0Q7RUFDbEQsMENBQWtDO0VBQWxDLGtDQUFrQztFQUFsQyxrRUFBa0M7QUFDcEM7O0FBRUE7RUFDRSxvQ0FBb0M7RUFDcEMsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0UsYUFBYTtFQUNiLFlBQVk7QUFDZDs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixtQ0FBMkI7VUFBM0IsMkJBQTJCO0VBQzNCLHNCQUFzQjtFQUN0Qix5QkFBeUI7RUFDekIscUJBQWlCO01BQWpCLGlCQUFpQjs7RUFFakIsb0JBQW9CO0VBQ3BCLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFLFlBQVk7RUFDWixXQUFXO0VBQ1gsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtFQUNqQix5QkFBeUI7RUFDekIsa0JBQWtCO0VBQ2xCLHlCQUF5QjtFQUN6QixtQ0FBMkI7VUFBM0IsMkJBQTJCO0FBQzdCOztBQUVBO0VBQ0UsY0FBYztFQUNkLE1BQU07RUFDTixPQUFPO0VBQ1AsU0FBUztFQUNULFFBQVE7RUFDUixZQUFZO0VBQ1osWUFBWTtFQUNaLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsWUFBWTtFQUNaLHNCQUFzQjtFQUN0QixvQkFBb0I7RUFDcEIsdUJBQXVCO0VBQ3ZCLGVBQWU7RUFDZixVQUFVO0VBQ1YsWUFBWTtFQUNaLHlCQUF5QjtFQUN6QixtQkFBbUI7RUFDbkIsV0FBVztFQUNYLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxhQUFhO0FBQ2Y7O0FBRUE7RUFDRSxjQUFjO0VBQ2QsWUFBWTtBQUNkOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsY0FBYztFQUNkLFVBQVU7QUFDWjs7QUFFQTtFQUNFLFVBQVU7RUFDVixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsV0FBVztBQUNiOztBQUVBO0VBQ0UsYUFBYTtFQUNiLFlBQVk7QUFDZDs7QUFFQTtFQUNFLFVBQVU7RUFDVixZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsZUFBZTtFQUNmLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsa0JBQWtCO0VBQ2xCO0FBQ0Y7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLHVCQUF1QjtFQUN2QixlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsV0FBVztFQUNYLHVDQUF1QztBQUN6Qzs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFDQTtFQUNFLGVBQWU7QUFDakIiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvY2FyZC1zdGFjay9jYXJkLXN0YWNrLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuaXMtZ3JhYiB7XG4gIGN1cnNvcjogLW1vei1ncmFiO1xuICBjdXJzb3I6IC13ZWJraXQtZ3JhYjtcbiAgY3Vyc29yOiBncmFiO1xufVxuXG4uaXMtZ3JhYmJpbmcge1xuICBjdXJzb3I6IC1tb3otZ3JhYmJpbmc7XG4gIGN1cnNvcjogLXdlYmtpdC1ncmFiYmluZztcbiAgY3Vyc29yOiBncmFiYmluZztcbn1cblxuLmlzLXRyYW5zaXRpb24ge1xuICAtd2Via2l0LXRyYW5zaXRpb246IC13ZWJraXQtdHJhbnNmb3JtIDEzMm1zIGxpbmVhcjtcbiAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDEzMm1zIGxpbmVhcjtcbn1cblxuLmlzLTNkIHtcbiAgLXdlYmtpdC10cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkO1xuICB0cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkO1xufVxuXG4uaXMtcG9pbnRlci1ldmVudHMtbm9uZSB7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xufVxuXG4uaXMtcG9pbnRlci1ldmVudHMtYXV0byB7XG4gIHBvaW50ZXItZXZlbnRzOiBhdXRvO1xufVxuXG4uaXMtZW1wdHkge1xuICBoZWlnaHQ6IDEwMHB4O1xuICB3aWR0aDogMTAwcHg7XG59XG5cbi5jb21wb25lbnQge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjtcbiAgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gIFxuICAtbW96LXVzZXItZHJhZzogbm9uZTtcbiAgLXdlYmtpdC11c2VyLWRyYWc6IG5vbmU7XG59XG5cbi5jb21wb25lbnQtY29udGVudCB7XG4gIGhlaWdodDogMTAwJTtcbiAgd2lkdGg6IDEwMCU7XG4gIG1hcmdpbi10b3A6IC01cHg7XG4gIG1hcmdpbi1sZWZ0OiAtNXB4O1xuICBib3JkZXI6IHNvbGlkIDVweCAjQ0NDQ0NDO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIGJhY2tncm91bmQtY29sb3I6ICNDQ0NDQ0M7XG4gIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjtcbn1cblxuLmNhcmQtaW1hZ2Uge1xuICBkaXNwbGF5OiBibG9jaztcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICBib3R0b206IDA7XG4gIHJpZ2h0OiAwO1xuICBtYXJnaW46IGF1dG87XG4gIGhlaWdodDogYXV0bztcbiAgd2lkdGg6IDEwMCU7XG59XG5cbi5yb3RhdGUtZ3JhYiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDI4cHg7XG4gIGhlaWdodDogMjhweDtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgY3Vyc29yOiAtbW96LWRlZmF1bHQ7XG4gIGN1cnNvcjogLXdlYmtpdC1kZWZhdWx0O1xuICBjdXJzb3I6IGRlZmF1bHQ7XG4gIHotaW5kZXg6IDE7XG4gIHBhZGRpbmc6IDJweDtcbiAgYmFja2dyb3VuZC1jb2xvcjogI0NDQ0NDQztcbiAgYm9yZGVyLXJhZGl1czogMTAwJTtcbiAgY29sb3I6ICM0NDQ7XG4gIGZvbnQtc2l6ZTogOHB4O1xufVxuXG4ucm90YXRlLWdyYWIge1xuICBkaXNwbGF5OiBub25lO1xufVxuXG4uY29tcG9uZW50OmhvdmVyIC5yb3RhdGUtZ3JhYiB7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICBvcGFjaXR5OiAwLjU7XG59XG5cbi5jb21wb25lbnQ6YWN0aXZlIC5yb3RhdGUtZ3JhYiB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG5cbi5jb21wb25lbnQgLnJvdGF0ZS1ncmFiOmhvdmVyLCAuY29tcG9uZW50IC5yb3RhdGUtZ3JhYjphY3RpdmUge1xuICBkaXNwbGF5OiBibG9jaztcbiAgb3BhY2l0eTogMTtcbn1cblxuLm9mLWxlZnQtdG9wIHtcbiAgdG9wOiAtMTRweDtcbiAgbGVmdDogLTE0cHg7XG59XG5cbi5vZi1sZWZ0LWJvdHRvbSB7XG4gIGJvdHRvbTogLTE0cHg7XG4gIGxlZnQ6IC0xNHB4O1xufVxuXG4ub2YtcmlnaHQtYm90dG9tIHtcbiAgYm90dG9tOiAtMTRweDtcbiAgcmlnaHQ6IC0xNHB4O1xufVxuXG4ub2YtcmlnaHQtdG9wIHtcbiAgdG9wOiAtMTRweDtcbiAgcmlnaHQ6IC0xNHB4O1xufVxuXG4ubmFtZS10YWcge1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBmb250LXNpemU6IDE1cHg7XG4gIHBhZGRpbmc6IDNweCA5cHg7XG4gIGJvcmRlci1yYWRpdXM6IDI0cHg7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiA1MCVcbn1cblxuLmhhcy1sZW5ndGgtbGltaXQge1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgbWF4LXdpZHRoOiAxOGVtO1xufVxuXG4uaXMtbm93cmFwIHtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbn1cblxuLmlzLWJsYWNrLWJhY2tncm91bmQge1xuICBjb2xvcjogI0NDQztcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDMwLCAwLjgpO1xufVxuXG4ubWF0ZXJpYWwtaWNvbnMge1xuICBkaXNwbGF5OiBub25lO1xufVxuLmNvbXBvbmVudDpob3ZlciAubWF0ZXJpYWwtaWNvbnMsIC5jb21wb25lbnQ6YWN0aXZlIC5tYXRlcmlhbC1pY29ucyB7XG4gIGRpc3BsYXk6IGlubGluZTtcbn1cbiJdfQ== */");

/***/ }),

/***/ "./src/app/component/card-stack/card-stack.component.ts":
/*!**************************************************************!*\
  !*** ./src/app/component/card-stack/card-stack.component.ts ***!
  \**************************************************************/
/*! exports provided: CardStackComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CardStackComponent", function() { return CardStackComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/animations */ "./node_modules/@angular/animations/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_card__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/card */ "./src/app/class/card.ts");
/* harmony import */ var _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/card-stack */ "./src/app/class/card-stack.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_card_stack_list_card_stack_list_component__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! component/card-stack-list/card-stack-list.component */ "./src/app/component/card-stack-list/card-stack-list.component.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var directive_input_handler__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! directive/input-handler */ "./src/app/directive/input-handler.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
















var CardStackComponent = /** @class */ (function () {
    function CardStackComponent(ngZone, contextMenuService, panelService, elementRef, changeDetector, pointerDeviceService) {
        this.ngZone = ngZone;
        this.contextMenuService = contextMenuService;
        this.panelService = panelService;
        this.elementRef = elementRef;
        this.changeDetector = changeDetector;
        this.pointerDeviceService = pointerDeviceService;
        this.cardStack = null;
        this.is3D = false;
        this.animeState = 'inactive';
        this.iconHiddenTimer = null;
        this.gridSize = 50;
        this.movableOption = {};
        this.rotableOption = {};
        this.doubleClickTimer = null;
        this.doubleClickPoint = { x: 0, y: 0 };
        this.input = null;
    }
    Object.defineProperty(CardStackComponent.prototype, "name", {
        get: function () { return this.cardStack.name; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "rotate", {
        get: function () { return this.cardStack.rotate; },
        set: function (rotate) { this.cardStack.rotate = rotate; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "zindex", {
        get: function () { return this.cardStack.zindex; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "isShowTotal", {
        get: function () { return this.cardStack.isShowTotal; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "cards", {
        get: function () { return this.cardStack.cards; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "isEmpty", {
        get: function () { return this.cardStack.isEmpty; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "size", {
        get: function () {
            var card = this.cardStack.topCard;
            return (card ? card.size : 2);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "hasOwner", {
        get: function () { return this.cardStack.hasOwner; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "ownerName", {
        get: function () { return this.cardStack.ownerName; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "topCard", {
        get: function () { return this.cardStack.topCard; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "imageFile", {
        get: function () { return this.cardStack.imageFile; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardStackComponent.prototype, "isIconHidden", {
        get: function () { return this.iconHiddenTimer != null; },
        enumerable: true,
        configurable: true
    });
    ;
    CardStackComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__["EventSystem"].register(this)
            .on('SHUFFLE_CARD_STACK', -1000, function (event) {
            if (event.data.identifier === _this.cardStack.identifier) {
                _this.animeState = 'active';
                _this.changeDetector.markForCheck();
            }
        })
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_6__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.cardStack || !object)
                return;
            if ((_this.cardStack === object)
                || (object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_5__["ObjectNode"] && _this.cardStack.contains(object))
                || (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_8__["PeerCursor"] && object.peerId === _this.cardStack.owner)) {
                _this.changeDetector.markForCheck();
            }
        })
            .on('CARD_STACK_DECREASED', function (event) {
            if (event.data.cardStackIdentifier === _this.cardStack.identifier && _this.cardStack)
                _this.changeDetector.markForCheck();
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('UPDATE_FILE_RESOURE', -1000, function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('DISCONNECT_PEER', function (event) {
            if (_this.cardStack.owner === event.data.peer)
                _this.changeDetector.markForCheck();
        });
        this.movableOption = {
            tabletopObject: this.cardStack,
            transformCssOffset: 'translateZ(0.15px)',
            colideLayers: ['terrain']
        };
        this.rotableOption = {
            tabletopObject: this.cardStack
        };
    };
    CardStackComponent.prototype.ngAfterViewInit = function () {
        this.input = new directive_input_handler__WEBPACK_IMPORTED_MODULE_12__["InputHandler"](this.elementRef.nativeElement);
        this.input.onStart = this.onInputStart.bind(this);
    };
    CardStackComponent.prototype.ngOnDestroy = function () {
        this.input.destroy();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__["EventSystem"].unregister(this);
    };
    CardStackComponent.prototype.animationShuffleStarted = function (event) {
    };
    CardStackComponent.prototype.animationShuffleDone = function (event) {
        this.animeState = 'inactive';
        this.changeDetector.markForCheck();
    };
    CardStackComponent.prototype.onCardDrop = function (e) {
        if (this.cardStack === e.detail || (e.detail instanceof _udonarium_card__WEBPACK_IMPORTED_MODULE_3__["Card"] === false && e.detail instanceof _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_4__["CardStack"] === false)) {
            return;
        }
        e.stopPropagation();
        e.preventDefault();
        if (e.detail instanceof _udonarium_card__WEBPACK_IMPORTED_MODULE_3__["Card"]) {
            var card = e.detail;
            var distance = Math.pow((card.location.x - this.cardStack.location.x), 2) + Math.pow((card.location.y - this.cardStack.location.y), 2) + Math.pow((card.posZ - this.cardStack.posZ), 2);
            if (distance < Math.pow(50, 2))
                this.cardStack.putOnTop(card);
        }
        else if (e.detail instanceof _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_4__["CardStack"]) {
            var cardStack = e.detail;
            var distance = Math.pow((cardStack.location.x - this.cardStack.location.x), 2) + Math.pow((cardStack.location.y - this.cardStack.location.y), 2) + Math.pow((cardStack.posZ - this.cardStack.posZ), 2);
            if (distance < Math.pow(25, 2))
                this.concatStack(cardStack);
        }
    };
    CardStackComponent.prototype.onDoubleClick = function (e) {
        var _this = this;
        if (!this.doubleClickTimer) {
            this.doubleClickTimer = setTimeout(function () {
                clearTimeout(_this.doubleClickTimer);
                _this.doubleClickTimer = null;
            }, 300);
            this.doubleClickPoint = this.input.pointer;
            return;
        }
        clearTimeout(this.doubleClickTimer);
        this.doubleClickTimer = null;
        var distance = Math.pow((this.doubleClickPoint.x - this.input.pointer.x), 2) + Math.pow((this.doubleClickPoint.y - this.input.pointer.y), 2);
        if (distance < Math.pow(10, 2)) {
            console.log('onDoubleClick !!!!');
            if (this.drawCard() != null) {
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
            }
        }
    };
    CardStackComponent.prototype.onDragstart = function (e) {
        e.stopPropagation();
        e.preventDefault();
    };
    CardStackComponent.prototype.onInputStart = function (e) {
        this.input.cancel();
        this.cardStack.toTopmost();
        this.onDoubleClick(e);
        if (e instanceof MouseEvent)
            this.startIconHiddenTimer();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: this.cardStack.identifier, className: 'GameCharacter' });
    };
    CardStackComponent.prototype.onContextMenu = function (e) {
        var _this = this;
        e.stopPropagation();
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        var position = this.pointerDeviceService.pointers[0];
        this.contextMenuService.open(position, [
            {
                name: '１枚引く', action: function () {
                    if (_this.drawCard() != null) {
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                    }
                }
            },
            {
                name: '７枚引く', action: function () {
                    if (_this.drawSeven() != null) {
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                    }
                }
            },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_13__["ContextMenuSeparator"],
            {
                name: '一番上を表にする', action: function () {
                    _this.cardStack.faceUp();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                }
            },
            {
                name: '一番上を裏にする', action: function () {
                    _this.cardStack.faceDown();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                }
            },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_13__["ContextMenuSeparator"],
            {
                name: 'すべて表にする', action: function () {
                    _this.cardStack.faceUpAll();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                }
            },
            {
                name: 'すべて裏にする', action: function () {
                    _this.cardStack.faceDownAll();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                }
            },
            {
                name: 'すべて正位置にする', action: function () {
                    _this.cardStack.uprightAll();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                }
            },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_13__["ContextMenuSeparator"],
            {
                name: 'シャッフル', action: function () {
                    _this.cardStack.shuffle();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardShuffle);
                    _udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__["EventSystem"].call('SHUFFLE_CARD_STACK', { identifier: _this.cardStack.identifier });
                }
            },
            { name: 'カード一覧', action: function () { _this.showStackList(_this.cardStack); } },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_13__["ContextMenuSeparator"],
            (this.isShowTotal
                ? { name: '枚数を非表示にする', action: function () { _this.cardStack.isShowTotal = false; } }
                : { name: '枚数を表示する', action: function () { _this.cardStack.isShowTotal = true; } }),
            { name: 'カードサイズを揃える', action: function () { if (_this.cardStack.topCard)
                    _this.cardStack.unifyCardsSize(_this.cardStack.topCard.size); } },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_13__["ContextMenuSeparator"],
            {
                name: '山札を人数分に分割する', action: function () {
                    _this.splitStack(_udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__["Network"].peerIds.length);
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                }
            },
            {
                name: '山札から７枚ずつ配る', action: function () {
                    if (_this.makeSevens() != null) {
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardDraw);
                    }
                }
            },
            {
                name: '山札を崩す', action: function () {
                    _this.breakStack();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardShuffle);
                }
            },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_13__["ContextMenuSeparator"],
            { name: '詳細を表示', action: function () { _this.showDetail(_this.cardStack); } },
            {
                name: 'コピーを作る', action: function () {
                    var cloneObject = _this.cardStack.clone();
                    cloneObject.location.x += _this.gridSize;
                    cloneObject.location.y += _this.gridSize;
                    cloneObject.owner = '';
                    cloneObject.toTopmost();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardPut);
                }
            },
            {
                name: '山札を削除する', action: function () {
                    _this.cardStack.setLocation('graveyard');
                    _this.cardStack.destroy();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].sweep);
                }
            },
        ], this.name);
    };
    CardStackComponent.prototype.onMove = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardPick);
    };
    CardStackComponent.prototype.onMoved = function () {
        var _this = this;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_9__["PresetSound"].cardPut);
        this.ngZone.run(function () { return _this.dispatchCardDropEvent(); });
    };
    CardStackComponent.prototype.drawCard = function () {
        var card = this.cardStack.drawCard();
        if (card) {
            this.cardStack.update(); // todo
            card.location.x += 100 + (Math.random() * 50);
            card.location.y += 25 + (Math.random() * 50);
            card.setLocation(this.cardStack.location.name);
        }
        return card;
    };
    CardStackComponent.prototype.drawSeven = function () {
        if (this.cardStack.cards.length == 0)
            return;
        var cardStack = _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_4__["CardStack"].create("手札");
        cardStack.location.x = this.cardStack.location.x + 50 - (Math.random() * 100);
        cardStack.location.y = this.cardStack.location.y + 50 - (Math.random() * 100);
        var cards = this.cardStack.cards;
        for (var i = 0; i < 7; i++) {
            var card = this.cardStack.drawCard();
            cardStack.putOnBottom(card);
            if (this.cardStack.cards.length == 0) {
                this.cardStack.setLocation('graveyard');
                this.cardStack.destroy();
                break;
            }
        }
        return cards;
    };
    CardStackComponent.prototype.breakStack = function () {
        var e_1, _a;
        var cards = this.cardStack.drawCardAll().reverse();
        try {
            for (var cards_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](cards), cards_1_1 = cards_1.next(); !cards_1_1.done; cards_1_1 = cards_1.next()) {
                var card = cards_1_1.value;
                card.location.x += 25 - (Math.random() * 50);
                card.location.y += 25 - (Math.random() * 50);
                card.toTopmost();
                card.setLocation(this.cardStack.location.name);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (cards_1_1 && !cards_1_1.done && (_a = cards_1.return)) _a.call(cards_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.cardStack.setLocation('graveyard');
        this.cardStack.destroy();
    };
    CardStackComponent.prototype.splitStack = function (split) {
        if (split < 2)
            return;
        var cardStacks = [];
        for (var i = 0; i < split; i++) {
            var cardStack = _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_4__["CardStack"].create(this.cardStack.name);
            cardStack.location.x = this.cardStack.location.x + 50 - (Math.random() * 100);
            cardStack.location.y = this.cardStack.location.y + 50 - (Math.random() * 100);
            cardStack.posZ = this.cardStack.posZ;
            cardStack.location.name = this.cardStack.location.name;
            cardStack.rotate = this.rotate;
            cardStack.toTopmost();
            cardStacks.push(cardStack);
        }
        var cards = this.cardStack.drawCardAll();
        this.cardStack.setLocation('graveyard');
        this.cardStack.destroy();
        var num = 0;
        var splitIndex = (cards.length / split) * (num + 1);
        for (var i = 0; i < cards.length; i++) {
            cardStacks[num].putOnBottom(cards[i]);
            if (splitIndex <= i + 1) {
                num++;
                splitIndex = (cards.length / split) * (num + 1);
            }
        }
    };
    CardStackComponent.prototype.makeSevens = function () {
        var cardStacks = [];
        var stack_count = Math.floor(this.cardStack.cards.length / 7);
        var is_to_destroy = (this.cardStack.cards.length % 7 == 0);
        if (stack_count == 0)
            return;
        var delta = (2 * Math.PI / stack_count);
        for (var i = 0; i < stack_count; i++) {
            var cardStack = _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_4__["CardStack"].create("手札");
            cardStack.location.x = this.cardStack.location.x + 250 * Math.sin(delta * i);
            cardStack.location.y = this.cardStack.location.y + 250 * Math.cos(delta * i);
            cardStack.posZ = this.cardStack.posZ;
            cardStack.location.name = this.cardStack.location.name;
            cardStack.rotate = this.rotate;
            cardStack.toTopmost();
            cardStacks.push(cardStack);
        }
        var cards = [];
        if (is_to_destroy) {
            cards = this.cardStack.drawCardAll();
            this.cardStack.setLocation('graveyard');
            this.cardStack.destroy();
        }
        else {
            cards = this.cardStack.cards;
        }
        var num = 0;
        for (var i = 0; i < stack_count; i++) {
            for (var j = 0; j < 7; j++) {
                cardStacks[i].putOnBottom(cards[num]);
                num++;
            }
        }
    };
    CardStackComponent.prototype.concatStack = function (topStack, bottomStack) {
        var e_2, _a;
        if (bottomStack === void 0) { bottomStack = this.cardStack; }
        var newCardStack = _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_4__["CardStack"].create(topStack.name);
        newCardStack.location.name = bottomStack.location.name;
        newCardStack.location.x = bottomStack.location.x;
        newCardStack.location.y = bottomStack.location.y;
        newCardStack.posZ = bottomStack.posZ;
        newCardStack.zindex = topStack.zindex;
        newCardStack.rotate = bottomStack.rotate;
        var bottomCards = bottomStack.drawCardAll();
        var topCards = topStack.drawCardAll();
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](topCards.concat(bottomCards)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var card = _c.value;
                newCardStack.putOnBottom(card);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        bottomStack.setLocation('');
        bottomStack.destroy();
        topStack.setLocation('');
        topStack.destroy();
    };
    CardStackComponent.prototype.dispatchCardDropEvent = function () {
        var element = this.elementRef.nativeElement;
        var parent = element.parentElement;
        var children = parent.children;
        var event = new CustomEvent('carddrop', { detail: this.cardStack, bubbles: true });
        for (var i = 0; i < children.length; i++) {
            children[i].dispatchEvent(event);
        }
    };
    CardStackComponent.prototype.showDetail = function (gameObject) {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: gameObject.identifier, className: gameObject.aliasName });
        var coordinate = this.pointerDeviceService.pointers[0];
        var title = '山札設定';
        if (gameObject.name.length)
            title += ' - ' + gameObject.name;
        var option = { title: title, left: coordinate.x - 300, top: coordinate.y - 300, width: 600, height: 600 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_11__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    CardStackComponent.prototype.showStackList = function (gameObject) {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: gameObject.identifier, className: gameObject.aliasName });
        var coordinate = this.pointerDeviceService.pointers[0];
        var option = { left: coordinate.x - 200, top: coordinate.y - 300, width: 400, height: 600 };
        this.cardStack.owner = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_7__["Network"].peerId;
        var component = this.panelService.open(component_card_stack_list_card_stack_list_component__WEBPACK_IMPORTED_MODULE_10__["CardStackListComponent"], option);
        component.cardStack = gameObject;
    };
    CardStackComponent.prototype.startIconHiddenTimer = function () {
        var _this = this;
        clearTimeout(this.iconHiddenTimer);
        this.iconHiddenTimer = setTimeout(function () {
            _this.iconHiddenTimer = null;
            _this.changeDetector.markForCheck();
        }, 300);
        this.changeDetector.markForCheck();
    };
    CardStackComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_2__["NgZone"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_13__["ContextMenuService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_14__["PanelService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ElementRef"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectorRef"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_15__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], CardStackComponent.prototype, "cardStack", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], CardStackComponent.prototype, "is3D", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["HostListener"])('carddrop', ['$event'])
    ], CardStackComponent.prototype, "onCardDrop", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["HostListener"])('dragstart', ['$event'])
    ], CardStackComponent.prototype, "onDragstart", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["HostListener"])('contextmenu', ['$event'])
    ], CardStackComponent.prototype, "onContextMenu", null);
    CardStackComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
            selector: 'card-stack',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./card-stack.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/card-stack/card-stack.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectionStrategy"].OnPush,
            animations: [
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('shuffle', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["state"])('active', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: '' })),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => active', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('800ms ease', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0, 0, 0) rotateZ(0deg)', offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.2, 1.2, 1.2) rotateZ(360deg)', offset: 0.5 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0.75, 0.75, 0.75) rotateZ(520deg)', offset: 0.75 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.125, 1.125, 1.125) rotateZ(630deg)', offset: 0.875 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.0, 1.0, 1.0) rotateZ(720deg)', offset: 1.0 })
                        ]))
                    ])
                ])
            ],
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./card-stack.component.css */ "./src/app/component/card-stack/card-stack.component.css")).default]
        })
    ], CardStackComponent);
    return CardStackComponent;
}());



/***/ }),

/***/ "./src/app/component/card/card.component.css":
/*!***************************************************!*\
  !*** ./src/app/component/card/card.component.css ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".is-grab {\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n\n.is-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.is-3d {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n\n.is-transition {\n  -webkit-transition: -webkit-transform 132ms linear;\n  transition: -webkit-transform 132ms linear;\n  transition: transform 132ms linear;\n  transition: transform 132ms linear, -webkit-transform 132ms linear;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n\n.is-pointer-events-auto {\n  pointer-events: auto;\n}\n\n.component {\n  position: absolute;\n  height: auto;\n  width: auto;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n  min-width: 25px;\n  min-height: 25px;\n}\n\n.component-content {\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.card-image {\n  display: block;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin: auto;\n  height: auto;\n  width: 100%;\n}\n\n.thumbnail-transform {\n  position: absolute;\n  -webkit-transform: scale(0.9);\n          transform: scale(0.9);\n}\n\n.is-translucent {\n  -webkit-filter: opacity(0.8);\n          filter: opacity(0.8);\n}\n\n.rotate-grab {\n  position: absolute;\n  width: 28px;\n  height: 28px;\n  box-sizing: border-box;\n  cursor: -moz-default;\n  cursor: -webkit-default;\n  cursor: default;\n  z-index: 1;\n  padding: 2px;\n  background-color: #CCCCCC;\n  border-radius: 100%;\n  color: #444;\n  font-size: 8px;\n}\n\n.rotate-grab {\n  display: none;\n}\n\n.component:hover .rotate-grab {\n  display: block;\n  opacity: 0.5;\n}\n\n.component:active .rotate-grab {\n  display: none;\n}\n\n.component .rotate-grab:hover, .component .rotate-grab:active {\n  display: block;\n  opacity: 1;\n}\n\n.of-left-top {\n  top: -10px;\n  left: -10px;\n  border-radius: 14px;\n}\n\n.of-left-bottom {\n  bottom: -10px;\n  left: -10px;\n  border-radius: 14px;\n}\n\n.of-right-bottom {\n  bottom: -10px;\n  right: -10px;\n  border-radius: 14px;\n}\n\n.of-right-top {\n  top: -10px;\n  right: -10px;\n  border-radius: 14px;\n}\n\n.border-bg {\n  position: absolute;\n  box-sizing: border-box;\n  border-radius: 8px;\n  background-color: rgba(204, 204, 204, 0.5);\n  top: -2px;\n  left: -2px;\n  right: -2px;\n  bottom: -2px;\n  z-index: -1;\n}\n\n.border-bg {\n  display: none;\n}\n\n.component:hover .border-bg {\n  display: block;\n}\n\n.component:active .border-bg {\n  display: none;\n}\n\n.name-tag {\n  box-sizing: border-box;\n  font-size: 15px;\n  padding: 3px 9px;\n  border-radius: 24px;\n  position: absolute;\n  top: 0;\n}\n\n.has-length-limit {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  max-width: 18em;\n}\n\n.is-nowrap {\n  white-space: nowrap;\n}\n\n.is-black-background {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n\n.material-icons {\n  display: none;\n}\n\n.component:hover .material-icons, .component:active .material-icons {\n  display: inline;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2NhcmQvY2FyZC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUUsb0JBQW9CO0VBQ3BCLFlBQVk7QUFDZDs7QUFFQTtFQUVFLHdCQUF3QjtFQUN4QixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxvQ0FBb0M7RUFDcEMsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0Usa0RBQWtEO0VBQ2xELDBDQUFrQztFQUFsQyxrQ0FBa0M7RUFBbEMsa0VBQWtDO0FBQ3BDOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFlBQVk7RUFDWixXQUFXO0VBQ1gsbUNBQTJCO1VBQTNCLDJCQUEyQjtFQUMzQixzQkFBc0I7RUFDdEIseUJBQXlCO0VBQ3pCLHFCQUFpQjtNQUFqQixpQkFBaUI7RUFDakIsb0JBQW9CO0VBQ3BCLHVCQUF1QjtFQUN2QixlQUFlO0VBQ2YsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsbUNBQTJCO1VBQTNCLDJCQUEyQjtFQUMzQixZQUFZO0VBQ1osV0FBVztFQUNYLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxNQUFNO0VBQ04sT0FBTztFQUNQLFNBQVM7RUFDVCxRQUFRO0VBQ1IsWUFBWTtFQUNaLFlBQVk7RUFDWixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsNkJBQXFCO1VBQXJCLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLDRCQUFvQjtVQUFwQixvQkFBb0I7QUFDdEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsb0JBQW9CO0VBQ3BCLHVCQUF1QjtFQUN2QixlQUFlO0VBQ2YsVUFBVTtFQUNWLFlBQVk7RUFDWix5QkFBeUI7RUFDekIsbUJBQW1CO0VBQ25CLFdBQVc7RUFDWCxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsY0FBYztFQUNkLFlBQVk7QUFDZDs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxVQUFVO0FBQ1o7O0FBRUE7RUFDRSxVQUFVO0VBQ1YsV0FBVztFQUNYLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGFBQWE7RUFDYixXQUFXO0VBQ1gsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsYUFBYTtFQUNiLFlBQVk7RUFDWixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxVQUFVO0VBQ1YsWUFBWTtFQUNaLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixzQkFBc0I7RUFDdEIsa0JBQWtCO0VBQ2xCLDBDQUEwQztFQUMxQyxTQUFTO0VBQ1QsVUFBVTtFQUNWLFdBQVc7RUFDWCxZQUFZO0VBQ1osV0FBVztBQUNiOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QixlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtFQUNuQixrQkFBa0I7RUFDbEIsTUFBTTtBQUNSOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtFQUNuQix1QkFBdUI7RUFDdkIsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCx1Q0FBdUM7QUFDekM7O0FBRUE7RUFDRSxhQUFhO0FBQ2Y7O0FBQ0E7RUFDRSxlQUFlO0FBQ2pCIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2NhcmQvY2FyZC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmlzLWdyYWIge1xuICBjdXJzb3I6IC1tb3otZ3JhYjtcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWI7XG4gIGN1cnNvcjogZ3JhYjtcbn1cblxuLmlzLWdyYWJiaW5nIHtcbiAgY3Vyc29yOiAtbW96LWdyYWJiaW5nO1xuICBjdXJzb3I6IC13ZWJraXQtZ3JhYmJpbmc7XG4gIGN1cnNvcjogZ3JhYmJpbmc7XG59XG5cbi5pcy0zZCB7XG4gIC13ZWJraXQtdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDtcbiAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDtcbn1cblxuLmlzLXRyYW5zaXRpb24ge1xuICAtd2Via2l0LXRyYW5zaXRpb246IC13ZWJraXQtdHJhbnNmb3JtIDEzMm1zIGxpbmVhcjtcbiAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDEzMm1zIGxpbmVhcjtcbn1cblxuLmlzLXBvaW50ZXItZXZlbnRzLW5vbmUge1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbn1cblxuLmlzLXBvaW50ZXItZXZlbnRzLWF1dG8ge1xuICBwb2ludGVyLWV2ZW50czogYXV0bztcbn1cblxuLmNvbXBvbmVudCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgaGVpZ2h0OiBhdXRvO1xuICB3aWR0aDogYXV0bztcbiAgYmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuO1xuICAtbW96LXVzZXItc2VsZWN0OiBub25lO1xuICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lO1xuICB1c2VyLXNlbGVjdDogbm9uZTtcbiAgLW1vei11c2VyLWRyYWc6IG5vbmU7XG4gIC13ZWJraXQtdXNlci1kcmFnOiBub25lO1xuICBtaW4td2lkdGg6IDI1cHg7XG4gIG1pbi1oZWlnaHQ6IDI1cHg7XG59XG5cbi5jb21wb25lbnQtY29udGVudCB7XG4gIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbn1cblxuLmNhcmQtaW1hZ2Uge1xuICBkaXNwbGF5OiBibG9jaztcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICBib3R0b206IDA7XG4gIHJpZ2h0OiAwO1xuICBtYXJnaW46IGF1dG87XG4gIGhlaWdodDogYXV0bztcbiAgd2lkdGg6IDEwMCU7XG59XG5cbi50aHVtYm5haWwtdHJhbnNmb3JtIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0cmFuc2Zvcm06IHNjYWxlKDAuOSk7XG59XG5cbi5pcy10cmFuc2x1Y2VudCB7XG4gIGZpbHRlcjogb3BhY2l0eSgwLjgpO1xufVxuXG4ucm90YXRlLWdyYWIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHdpZHRoOiAyOHB4O1xuICBoZWlnaHQ6IDI4cHg7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGN1cnNvcjogLW1vei1kZWZhdWx0O1xuICBjdXJzb3I6IC13ZWJraXQtZGVmYXVsdDtcbiAgY3Vyc29yOiBkZWZhdWx0O1xuICB6LWluZGV4OiAxO1xuICBwYWRkaW5nOiAycHg7XG4gIGJhY2tncm91bmQtY29sb3I6ICNDQ0NDQ0M7XG4gIGJvcmRlci1yYWRpdXM6IDEwMCU7XG4gIGNvbG9yOiAjNDQ0O1xuICBmb250LXNpemU6IDhweDtcbn1cblxuLnJvdGF0ZS1ncmFiIHtcbiAgZGlzcGxheTogbm9uZTtcbn1cblxuLmNvbXBvbmVudDpob3ZlciAucm90YXRlLWdyYWIge1xuICBkaXNwbGF5OiBibG9jaztcbiAgb3BhY2l0eTogMC41O1xufVxuXG4uY29tcG9uZW50OmFjdGl2ZSAucm90YXRlLWdyYWIge1xuICBkaXNwbGF5OiBub25lO1xufVxuXG4uY29tcG9uZW50IC5yb3RhdGUtZ3JhYjpob3ZlciwgLmNvbXBvbmVudCAucm90YXRlLWdyYWI6YWN0aXZlIHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIG9wYWNpdHk6IDE7XG59XG5cbi5vZi1sZWZ0LXRvcCB7XG4gIHRvcDogLTEwcHg7XG4gIGxlZnQ6IC0xMHB4O1xuICBib3JkZXItcmFkaXVzOiAxNHB4O1xufVxuXG4ub2YtbGVmdC1ib3R0b20ge1xuICBib3R0b206IC0xMHB4O1xuICBsZWZ0OiAtMTBweDtcbiAgYm9yZGVyLXJhZGl1czogMTRweDtcbn1cblxuLm9mLXJpZ2h0LWJvdHRvbSB7XG4gIGJvdHRvbTogLTEwcHg7XG4gIHJpZ2h0OiAtMTBweDtcbiAgYm9yZGVyLXJhZGl1czogMTRweDtcbn1cblxuLm9mLXJpZ2h0LXRvcCB7XG4gIHRvcDogLTEwcHg7XG4gIHJpZ2h0OiAtMTBweDtcbiAgYm9yZGVyLXJhZGl1czogMTRweDtcbn1cblxuLmJvcmRlci1iZyB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDIwNCwgMjA0LCAyMDQsIDAuNSk7XG4gIHRvcDogLTJweDtcbiAgbGVmdDogLTJweDtcbiAgcmlnaHQ6IC0ycHg7XG4gIGJvdHRvbTogLTJweDtcbiAgei1pbmRleDogLTE7XG59XG5cbi5ib3JkZXItYmcge1xuICBkaXNwbGF5OiBub25lO1xufVxuXG4uY29tcG9uZW50OmhvdmVyIC5ib3JkZXItYmcge1xuICBkaXNwbGF5OiBibG9jaztcbn1cblxuLmNvbXBvbmVudDphY3RpdmUgLmJvcmRlci1iZyB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG5cbi5uYW1lLXRhZyB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGZvbnQtc2l6ZTogMTVweDtcbiAgcGFkZGluZzogM3B4IDlweDtcbiAgYm9yZGVyLXJhZGl1czogMjRweDtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG59XG5cbi5oYXMtbGVuZ3RoLWxpbWl0IHtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gIG1heC13aWR0aDogMThlbTtcbn1cblxuLmlzLW5vd3JhcCB7XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG5cbi5pcy1ibGFjay1iYWNrZ3JvdW5kIHtcbiAgY29sb3I6ICNDQ0M7XG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMzAsIDMwLCAzMCwgMC44KTtcbn1cblxuLm1hdGVyaWFsLWljb25zIHtcbiAgZGlzcGxheTogbm9uZTtcbn1cbi5jb21wb25lbnQ6aG92ZXIgLm1hdGVyaWFsLWljb25zLCAuY29tcG9uZW50OmFjdGl2ZSAubWF0ZXJpYWwtaWNvbnMge1xuICBkaXNwbGF5OiBpbmxpbmU7XG59XG4iXX0= */");

/***/ }),

/***/ "./src/app/component/card/card.component.ts":
/*!**************************************************!*\
  !*** ./src/app/component/card/card.component.ts ***!
  \**************************************************/
/*! exports provided: CardComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CardComponent", function() { return CardComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_card__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/card */ "./src/app/class/card.ts");
/* harmony import */ var _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/card-stack */ "./src/app/class/card-stack.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var directive_input_handler__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! directive/input-handler */ "./src/app/directive/input-handler.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_tabletop_service__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! service/tabletop.service */ "./src/app/service/tabletop.service.ts");















var CardComponent = /** @class */ (function () {
    function CardComponent(ngZone, contextMenuService, panelService, elementRef, changeDetector, tabletopService, pointerDeviceService) {
        this.ngZone = ngZone;
        this.contextMenuService = contextMenuService;
        this.panelService = panelService;
        this.elementRef = elementRef;
        this.changeDetector = changeDetector;
        this.tabletopService = tabletopService;
        this.pointerDeviceService = pointerDeviceService;
        this.card = null;
        this.is3D = false;
        this.iconHiddenTimer = null;
        this.gridSize = 50;
        this.movableOption = {};
        this.rotableOption = {};
        this.doubleClickTimer = null;
        this.doubleClickPoint = { x: 0, y: 0 };
        this.input = null;
    }
    Object.defineProperty(CardComponent.prototype, "name", {
        get: function () { return this.card.name; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "state", {
        get: function () { return this.card.state; },
        set: function (state) { this.card.state = state; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "rotate", {
        get: function () { return this.card.rotate; },
        set: function (rotate) { this.card.rotate = rotate; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "owner", {
        get: function () { return this.card.owner; },
        set: function (owner) { this.card.owner = owner; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "zindex", {
        get: function () { return this.card.zindex; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "size", {
        get: function () { return this.adjustMinBounds(this.card.size); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "isHand", {
        get: function () { return this.card.isHand; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "isFront", {
        get: function () { return this.card.isFront; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "isVisible", {
        get: function () { return this.card.isVisible; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "hasOwner", {
        get: function () { return this.card.hasOwner; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "ownerName", {
        get: function () { return this.card.ownerName; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "imageFile", {
        get: function () { return this.card.imageFile; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "frontImage", {
        get: function () { return this.card.frontImage; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "backImage", {
        get: function () { return this.card.backImage; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CardComponent.prototype, "isIconHidden", {
        get: function () { return this.iconHiddenTimer != null; },
        enumerable: true,
        configurable: true
    });
    ;
    CardComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.card || !object)
                return;
            if ((_this.card === object)
                || (object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_4__["ObjectNode"] && _this.card.contains(object))
                || (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"] && object.peerId === _this.card.owner)) {
                _this.changeDetector.markForCheck();
            }
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('UPDATE_FILE_RESOURE', -1000, function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('DISCONNECT_PEER', function (event) {
            if (_this.card.owner === event.data.peer)
                _this.changeDetector.markForCheck();
        });
        this.movableOption = {
            tabletopObject: this.card,
            transformCssOffset: 'translateZ(0.15px)',
            colideLayers: ['terrain']
        };
        this.rotableOption = {
            tabletopObject: this.card
        };
    };
    CardComponent.prototype.ngAfterViewInit = function () {
        this.input = new directive_input_handler__WEBPACK_IMPORTED_MODULE_10__["InputHandler"](this.elementRef.nativeElement);
        this.input.onStart = this.onInputStart.bind(this);
    };
    CardComponent.prototype.ngOnDestroy = function () {
        this.input.destroy();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].unregister(this);
    };
    CardComponent.prototype.onCardDrop = function (e) {
        if (this.card === e.detail || (e.detail instanceof _udonarium_card__WEBPACK_IMPORTED_MODULE_2__["Card"] === false && e.detail instanceof _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_3__["CardStack"] === false)) {
            return;
        }
        e.stopPropagation();
        e.preventDefault();
        if (e.detail instanceof _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_3__["CardStack"]) {
            var cardStack = e.detail;
            var distance = Math.pow((cardStack.location.x - this.card.location.x), 2) + Math.pow((cardStack.location.y - this.card.location.y), 2) + Math.pow((cardStack.posZ - this.card.posZ), 2);
            if (distance < Math.pow(25, 2)) {
                cardStack.location.x = this.card.location.x;
                cardStack.location.y = this.card.location.y;
                cardStack.posZ = this.card.posZ;
                cardStack.putOnBottom(this.card);
            }
        }
    };
    CardComponent.prototype.onDoubleClick = function (e) {
        var _this = this;
        if (!this.doubleClickTimer) {
            this.doubleClickTimer = setTimeout(function () {
                clearTimeout(_this.doubleClickTimer);
                _this.doubleClickTimer = null;
            }, 300);
            this.doubleClickPoint = this.input.pointer;
            return;
        }
        clearTimeout(this.doubleClickTimer);
        this.doubleClickTimer = null;
        var distance = Math.pow((this.doubleClickPoint.x - this.input.pointer.x), 2) + Math.pow((this.doubleClickPoint.y - this.input.pointer.y), 2);
        if (distance < Math.pow(10, 2)) {
            console.log('onDoubleClick !!!!');
            if (this.hasOwner && !this.isHand)
                return;
            this.state = this.isVisible && !this.isHand ? _udonarium_card__WEBPACK_IMPORTED_MODULE_2__["CardState"].BACK : _udonarium_card__WEBPACK_IMPORTED_MODULE_2__["CardState"].FRONT;
            this.owner = '';
            _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardDraw);
        }
    };
    CardComponent.prototype.onDragstart = function (e) {
        e.stopPropagation();
        e.preventDefault();
    };
    CardComponent.prototype.onInputStart = function (e) {
        this.input.cancel();
        this.onDoubleClick(e);
        this.card.toTopmost();
        if (e instanceof MouseEvent)
            this.startIconHiddenTimer();
    };
    CardComponent.prototype.onContextMenu = function (e) {
        var _this = this;
        e.stopPropagation();
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        var position = this.pointerDeviceService.pointers[0];
        this.contextMenuService.open(position, [
            (!this.isVisible || this.isHand
                ? {
                    name: '表にする', action: function () {
                        _this.card.faceUp();
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardDraw);
                    }
                }
                : {
                    name: '裏にする', action: function () {
                        _this.card.faceDown();
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardDraw);
                    }
                }),
            (this.isHand
                ? {
                    name: '裏にする', action: function () {
                        _this.card.faceDown();
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardDraw);
                    }
                }
                : {
                    name: '自分だけ見る', action: function () {
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardDraw);
                        _this.card.faceDown();
                        _this.owner = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["Network"].peerId;
                    }
                }),
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_11__["ContextMenuSeparator"],
            {
                name: '重なったカードで山札を作る', action: function () {
                    _this.createStack();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardPut);
                }
            },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_11__["ContextMenuSeparator"],
            { name: 'カードを編集', action: function () { _this.showDetail(_this.card); } },
            {
                name: 'コピーを作る', action: function () {
                    var cloneObject = _this.card.clone();
                    cloneObject.location.x += _this.gridSize;
                    cloneObject.location.y += _this.gridSize;
                    cloneObject.toTopmost();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardPut);
                }
            },
            {
                name: '削除する', action: function () {
                    _this.card.destroy();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].sweep);
                }
            },
        ], this.isVisible ? this.name : 'カード');
    };
    CardComponent.prototype.onMove = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardPick);
    };
    CardComponent.prototype.onMoved = function () {
        var _this = this;
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].cardPut);
        this.ngZone.run(function () { return _this.dispatchCardDropEvent(); });
    };
    CardComponent.prototype.createStack = function () {
        var e_1, _a;
        var _this = this;
        var cardStack = _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_3__["CardStack"].create('山札');
        cardStack.location.x = this.card.location.x;
        cardStack.location.y = this.card.location.y;
        cardStack.posZ = this.card.posZ;
        cardStack.location.name = this.card.location.name;
        cardStack.rotate = this.rotate;
        cardStack.zindex = this.card.zindex;
        var cards = this.tabletopService.cards.filter(function (card) {
            var distance = Math.pow((card.location.x - _this.card.location.x), 2) + Math.pow((card.location.y - _this.card.location.y), 2) + Math.pow((card.posZ - _this.card.posZ), 2);
            return distance < Math.pow(100, 2);
        });
        cards.sort(function (a, b) {
            if (a.zindex < b.zindex)
                return 1;
            if (a.zindex > b.zindex)
                return -1;
            return 0;
        });
        try {
            for (var cards_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](cards), cards_1_1 = cards_1.next(); !cards_1_1.done; cards_1_1 = cards_1.next()) {
                var card = cards_1_1.value;
                cardStack.putOnBottom(card);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (cards_1_1 && !cards_1_1.done && (_a = cards_1.return)) _a.call(cards_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    CardComponent.prototype.dispatchCardDropEvent = function () {
        console.log('dispatchCardDropEvent');
        var element = this.elementRef.nativeElement;
        var parent = element.parentElement;
        var children = parent.children;
        var event = new CustomEvent('carddrop', { detail: this.card, bubbles: true });
        for (var i = 0; i < children.length; i++) {
            children[i].dispatchEvent(event);
        }
    };
    CardComponent.prototype.startIconHiddenTimer = function () {
        var _this = this;
        clearTimeout(this.iconHiddenTimer);
        this.iconHiddenTimer = setTimeout(function () {
            _this.iconHiddenTimer = null;
            _this.changeDetector.markForCheck();
        }, 300);
        this.changeDetector.markForCheck();
    };
    CardComponent.prototype.adjustMinBounds = function (value, min) {
        if (min === void 0) { min = 0; }
        return value < min ? min : value;
    };
    CardComponent.prototype.showDetail = function (gameObject) {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: gameObject.identifier, className: gameObject.aliasName });
        var coordinate = this.pointerDeviceService.pointers[0];
        var title = 'カード設定';
        if (gameObject.name.length)
            title += ' - ' + gameObject.name;
        var option = { title: title, left: coordinate.x - 300, top: coordinate.y - 300, width: 600, height: 600 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_9__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    CardComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_11__["ContextMenuService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_12__["PanelService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
        { type: service_tabletop_service__WEBPACK_IMPORTED_MODULE_14__["TabletopService"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_13__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], CardComponent.prototype, "card", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], CardComponent.prototype, "is3D", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('carddrop', ['$event'])
    ], CardComponent.prototype, "onCardDrop", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('dragstart', ['$event'])
    ], CardComponent.prototype, "onDragstart", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('contextmenu', ['$event'])
    ], CardComponent.prototype, "onContextMenu", null);
    CardComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'card',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./card.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/card/card.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./card.component.css */ "./src/app/component/card/card.component.css")).default]
        })
    ], CardComponent);
    return CardComponent;
}());



/***/ }),

/***/ "./src/app/component/chat-message/chat-message.component.css":
/*!*******************************************************************!*\
  !*** ./src/app/component/chat-message/chat-message.component.css ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".container {\n  width: 100%;\n  overflow-x: hidden;\n}\n.message {\n  display: -webkit-box;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n          flex-flow: row nowrap;\n  box-sizing: border-box;\n  padding: 5px 5px;\n  width: 100%;\n  word-wrap : break-word;\n  overflow-wrap:break-word;\n  border-bottom:1px dotted #999;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.message .image {\n  padding: 0px;\n  width: 50px;\n  height: 50px;\n  flex-shrink: 0;\n  vertical-align: top;\n}\n.message .image img {\n  width: 100%;\n  height: 100%;\n  vertical-align: bottom;\n  -o-object-fit: cover;\n     object-fit: cover;\n  -o-object-position: 50% 0%;\n     object-position: 50% 0%;\n}\n.message .body {\n  -webkit-box-flex: 1;\n          flex-grow: 1;\n}\n.message .title {\n  vertical-align: top;\n  font-size: 14px;\n  padding-left: 12px;\n}\n.message .text {\n  vertical-align: top;\n  padding: 2px 12px 0 12px;\n  font-size: 14px;\n}\n.message .tip {\n  font-size: 8px;\n  padding-left: 12px;\n}\n.msg-name {\n  font-weight: bold;\n}\n.msg-text {\n  white-space: pre-wrap;\n}\n.dicebot-message .msg-name {\n  font-size: 8px;\n}\n.dicebot-message .msg-text {\n  /*color:#22F;*/\n}\n.direct-message.dicebot-message .msg-text {\n  /*color:#CCF;*/\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2NoYXQtbWVzc2FnZS9jaGF0LW1lc3NhZ2UuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQVc7RUFDWCxrQkFBa0I7QUFDcEI7QUFDQTtFQUNFLG9CQUFhO0VBQWIsYUFBYTtFQUNiLDhCQUFxQjtFQUFyQiw2QkFBcUI7VUFBckIscUJBQXFCO0VBQ3JCLHNCQUFzQjtFQUN0QixnQkFBZ0I7RUFDaEIsV0FBVztFQUNYLHNCQUFzQjtFQUN0Qix3QkFBd0I7RUFDeEIsNkJBQTZCO0FBQy9CO0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsV0FBVztBQUNiO0FBRUE7RUFDRSxZQUFZO0VBQ1osV0FBVztFQUNYLFlBQVk7RUFDWixjQUFjO0VBQ2QsbUJBQW1CO0FBQ3JCO0FBQ0E7RUFDRSxXQUFXO0VBQ1gsWUFBWTtFQUNaLHNCQUFzQjtFQUN0QixvQkFBaUI7S0FBakIsaUJBQWlCO0VBQ2pCLDBCQUF1QjtLQUF2Qix1QkFBdUI7QUFDekI7QUFDQTtFQUNFLG1CQUFZO1VBQVosWUFBWTtBQUNkO0FBQ0E7RUFDRSxtQkFBbUI7RUFDbkIsZUFBZTtFQUNmLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UsbUJBQW1CO0VBQ25CLHdCQUF3QjtFQUN4QixlQUFlO0FBQ2pCO0FBQ0E7RUFDRSxjQUFjO0VBQ2Qsa0JBQWtCO0FBQ3BCO0FBRUE7RUFDRSxpQkFBaUI7QUFDbkI7QUFFQTtFQUNFLHFCQUFxQjtBQUN2QjtBQUVBO0VBQ0UsY0FBYztBQUNoQjtBQUVBO0VBQ0UsY0FBYztBQUNoQjtBQUVBO0VBQ0UsY0FBYztBQUNoQiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9jaGF0LW1lc3NhZ2UvY2hhdC1tZXNzYWdlLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyIHtcbiAgd2lkdGg6IDEwMCU7XG4gIG92ZXJmbG93LXg6IGhpZGRlbjtcbn1cbi5tZXNzYWdlIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1mbG93OiByb3cgbm93cmFwO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBwYWRkaW5nOiA1cHggNXB4O1xuICB3aWR0aDogMTAwJTtcbiAgd29yZC13cmFwIDogYnJlYWstd29yZDtcbiAgb3ZlcmZsb3ctd3JhcDpicmVhay13b3JkO1xuICBib3JkZXItYm90dG9tOjFweCBkb3R0ZWQgIzk5OTtcbn1cblxuLmRpcmVjdC1tZXNzYWdlIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzU1NTtcbiAgY29sb3I6ICNDQ0M7XG59XG5cbi5tZXNzYWdlIC5pbWFnZSB7XG4gIHBhZGRpbmc6IDBweDtcbiAgd2lkdGg6IDUwcHg7XG4gIGhlaWdodDogNTBweDtcbiAgZmxleC1zaHJpbms6IDA7XG4gIHZlcnRpY2FsLWFsaWduOiB0b3A7XG59XG4ubWVzc2FnZSAuaW1hZ2UgaW1nIHtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbiAgb2JqZWN0LWZpdDogY292ZXI7XG4gIG9iamVjdC1wb3NpdGlvbjogNTAlIDAlO1xufVxuLm1lc3NhZ2UgLmJvZHkge1xuICBmbGV4LWdyb3c6IDE7XG59XG4ubWVzc2FnZSAudGl0bGUge1xuICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xuICBmb250LXNpemU6IDE0cHg7XG4gIHBhZGRpbmctbGVmdDogMTJweDtcbn1cbi5tZXNzYWdlIC50ZXh0IHtcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcbiAgcGFkZGluZzogMnB4IDEycHggMCAxMnB4O1xuICBmb250LXNpemU6IDE0cHg7XG59XG4ubWVzc2FnZSAudGlwIHtcbiAgZm9udC1zaXplOiA4cHg7XG4gIHBhZGRpbmctbGVmdDogMTJweDtcbn1cblxuLm1zZy1uYW1lIHtcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG59XG5cbi5tc2ctdGV4dCB7XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn1cblxuLmRpY2Vib3QtbWVzc2FnZSAubXNnLW5hbWUge1xuICBmb250LXNpemU6IDhweDtcbn1cblxuLmRpY2Vib3QtbWVzc2FnZSAubXNnLXRleHQge1xuICAvKmNvbG9yOiMyMkY7Ki9cbn1cblxuLmRpcmVjdC1tZXNzYWdlLmRpY2Vib3QtbWVzc2FnZSAubXNnLXRleHQge1xuICAvKmNvbG9yOiNDQ0Y7Ki9cbn1cbiJdfQ== */");

/***/ }),

/***/ "./src/app/component/chat-message/chat-message.component.ts":
/*!******************************************************************!*\
  !*** ./src/app/component/chat-message/chat-message.component.ts ***!
  \******************************************************************/
/*! exports provided: ChatMessageComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatMessageComponent", function() { return ChatMessageComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/animations */ "./node_modules/@angular/animations/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");




var ChatMessageComponent = /** @class */ (function () {
    function ChatMessageComponent() {
        this.onInit = new _angular_core__WEBPACK_IMPORTED_MODULE_2__["EventEmitter"]();
        this.imageFile = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_3__["ImageFile"].Empty;
    }
    ChatMessageComponent.prototype.ngOnInit = function () {
        var file = this.chatMessage.image;
        if (file)
            this.imageFile = file;
    };
    ChatMessageComponent.prototype.ngAfterViewInit = function () {
        this.onInit.emit();
    };
    ChatMessageComponent.prototype.discloseMessage = function () {
        this.chatMessage.tag = this.chatMessage.tag.replace('secret', '');
    };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], ChatMessageComponent.prototype, "chatMessage", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Output"])()
    ], ChatMessageComponent.prototype, "onInit", void 0);
    ChatMessageComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
            selector: 'chat-message',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./chat-message.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-message/chat-message.component.html")).default,
            animations: [
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('flyInOut', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('void => *', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('200ms ease', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'translateX(100px)', opacity: '0', offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'translateX(0)', opacity: '1', offset: 1.0 })
                        ]))
                    ]),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => void', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])(100, Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'translateX(100%)' }))
                    ])
                ])
            ],
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectionStrategy"].Default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./chat-message.component.css */ "./src/app/component/chat-message/chat-message.component.css")).default]
        })
    ], ChatMessageComponent);
    return ChatMessageComponent;
}());



/***/ }),

/***/ "./src/app/component/chat-palette/chat-palette.component.css":
/*!*******************************************************************!*\
  !*** ./src/app/component/chat-palette/chat-palette.component.css ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".imagebox {\n  display: inline-block;\n  width: 50px;\n  height: 50px;\n  max-width: 50px;\n  max-height: 50px;\n  vertical-align: top;\n  text-align: center;\n}\n.image{\n  width: 100%;\n  height: 100%;\n  vertical-align: bottom;\n  -o-object-fit: cover;\n     object-fit: cover;\n  -o-object-position: 50% 0%;\n     object-position: 50% 0%;\n}\n.table {\n  box-sizing: border-box;\n  padding : 5px;\n  display: table;\n  width: 100%;\n}\n.table .table-cell {\n  display: table-cell;\n}\n.edit-info {\n  width: 100%;\n  text-align: center;\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n.palette {\n/*.input {*/\n  box-sizing: border-box;\n  font-family: -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", Verdana, Meiryo, sans-serif;\n  width: 100%;\n  height: 100%;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.chat-input {\n  font-family: Arial;\n  font-size: 13px;\n\n  width: calc(100% - 100px);\n  height: calc(1em + 4px);\n  min-height: calc(1em + 7px);\n  max-height: calc(6em + 7px);\n  resize: none;\n  overflow: auto;\n\n  padding: 1px;\n  margin: 5px;\n\n  word-break: break-all;\n  vertical-align: bottom;\n}\n.flex-container {\n  display: -webkit-box;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n          flex-direction: column;\n  height: 100%;\n}\n.chat-tab {\n  padding : 0 5px 5px 5px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.chat-tab label {\n  display: inline-block;\n  position: relative;\n}\n.chat-tab input[type=\"radio\"] {\n  display: none;\n}\n.chat-tab input[type=\"radio\"] + div {\n  display: inline-block;\n  vertical-align: middle;\n  outline: 0;\n  font-size: 8px;\n  background-color: transparent;\n  color: #444; \n  border: solid 1px #555;\n  padding: 2px 8px;\n  margin: 2px;\n  border-radius: 100px;\n  cursor: pointer;\n}\n.chat-tab input[type=\"radio\"] + div:hover {\n  background-color: #888;\n  color: #eee;\n  border: solid 1px #555;\n}\n.chat-tab input[type=\"radio\"]:checked + div {\n  background: #555;\n  color: #CCC;\n}\n.badge {\n  position: absolute;\n  top: -4px;\n  right: 0;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2NoYXQtcGFsZXR0ZS9jaGF0LXBhbGV0dGUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHFCQUFxQjtFQUNyQixXQUFXO0VBQ1gsWUFBWTtFQUNaLGVBQWU7RUFDZixnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UsV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsb0JBQWlCO0tBQWpCLGlCQUFpQjtFQUNqQiwwQkFBdUI7S0FBdkIsdUJBQXVCO0FBQ3pCO0FBQ0E7RUFDRSxzQkFBc0I7RUFDdEIsYUFBYTtFQUNiLGNBQWM7RUFDZCxXQUFXO0FBQ2I7QUFDQTtFQUNFLG1CQUFtQjtBQUNyQjtBQUNBO0VBQ0UsV0FBVztFQUNYLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsdUNBQXVDO0FBQ3pDO0FBQ0E7QUFDQSxXQUFXO0VBQ1Qsc0JBQXNCO0VBQ3RCLDZGQUE2RjtFQUM3RixXQUFXO0VBQ1gsWUFBWTtBQUNkO0FBQ0E7RUFDRSxzQkFBc0I7RUFDdEIsV0FBVztBQUNiO0FBQ0E7RUFDRSxrQkFBa0I7RUFDbEIsZUFBZTs7RUFFZix5QkFBeUI7RUFDekIsdUJBQXVCO0VBQ3ZCLDJCQUEyQjtFQUMzQiwyQkFBMkI7RUFDM0IsWUFBWTtFQUNaLGNBQWM7O0VBRWQsWUFBWTtFQUNaLFdBQVc7O0VBRVgscUJBQXFCO0VBQ3JCLHNCQUFzQjtBQUN4QjtBQUVBO0VBQ0Usb0JBQWE7RUFBYixhQUFhO0VBQ2IsNEJBQXNCO0VBQXRCLDZCQUFzQjtVQUF0QixzQkFBc0I7RUFDdEIsWUFBWTtBQUNkO0FBRUE7RUFDRSx1QkFBdUI7RUFDdkIseUJBQWlCO0tBQWpCLHNCQUFpQjtNQUFqQixxQkFBaUI7VUFBakIsaUJBQWlCO0FBQ25CO0FBRUE7RUFDRSxxQkFBcUI7RUFDckIsa0JBQWtCO0FBQ3BCO0FBRUE7RUFDRSxhQUFhO0FBQ2Y7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQixzQkFBc0I7RUFDdEIsVUFBVTtFQUNWLGNBQWM7RUFDZCw2QkFBNkI7RUFDN0IsV0FBVztFQUNYLHNCQUFzQjtFQUN0QixnQkFBZ0I7RUFDaEIsV0FBVztFQUNYLG9CQUFvQjtFQUNwQixlQUFlO0FBQ2pCO0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsV0FBVztFQUNYLHNCQUFzQjtBQUN4QjtBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFdBQVc7QUFDYjtBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFNBQVM7RUFDVCxRQUFRO0FBQ1YiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvY2hhdC1wYWxldHRlL2NoYXQtcGFsZXR0ZS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmltYWdlYm94IHtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICB3aWR0aDogNTBweDtcbiAgaGVpZ2h0OiA1MHB4O1xuICBtYXgtd2lkdGg6IDUwcHg7XG4gIG1heC1oZWlnaHQ6IDUwcHg7XG4gIHZlcnRpY2FsLWFsaWduOiB0b3A7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cbi5pbWFnZXtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbiAgb2JqZWN0LWZpdDogY292ZXI7XG4gIG9iamVjdC1wb3NpdGlvbjogNTAlIDAlO1xufVxuLnRhYmxlIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgcGFkZGluZyA6IDVweDtcbiAgZGlzcGxheTogdGFibGU7XG4gIHdpZHRoOiAxMDAlO1xufVxuLnRhYmxlIC50YWJsZS1jZWxsIHtcbiAgZGlzcGxheTogdGFibGUtY2VsbDtcbn1cbi5lZGl0LWluZm8ge1xuICB3aWR0aDogMTAwJTtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBjb2xvcjogI0NDQztcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDMwLCAwLjgpO1xufVxuLnBhbGV0dGUge1xuLyouaW5wdXQgeyovXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsIFwiSGVsdmV0aWNhIE5ldWVcIiwgVmVyZGFuYSwgTWVpcnlvLCBzYW5zLXNlcmlmO1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xufVxuLmRpcmVjdC1tZXNzYWdlIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzU1NTtcbiAgY29sb3I6ICNDQ0M7XG59XG4uY2hhdC1pbnB1dCB7XG4gIGZvbnQtZmFtaWx5OiBBcmlhbDtcbiAgZm9udC1zaXplOiAxM3B4O1xuXG4gIHdpZHRoOiBjYWxjKDEwMCUgLSAxMDBweCk7XG4gIGhlaWdodDogY2FsYygxZW0gKyA0cHgpO1xuICBtaW4taGVpZ2h0OiBjYWxjKDFlbSArIDdweCk7XG4gIG1heC1oZWlnaHQ6IGNhbGMoNmVtICsgN3B4KTtcbiAgcmVzaXplOiBub25lO1xuICBvdmVyZmxvdzogYXV0bztcblxuICBwYWRkaW5nOiAxcHg7XG4gIG1hcmdpbjogNXB4O1xuXG4gIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcbiAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbn1cblxuLmZsZXgtY29udGFpbmVyIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgaGVpZ2h0OiAxMDAlO1xufVxuXG4uY2hhdC10YWIge1xuICBwYWRkaW5nIDogMCA1cHggNXB4IDVweDtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG59XG5cbi5jaGF0LXRhYiBsYWJlbCB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xufVxuXG4uY2hhdC10YWIgaW5wdXRbdHlwZT1cInJhZGlvXCJdIHtcbiAgZGlzcGxheTogbm9uZTtcbn1cblxuLmNoYXQtdGFiIGlucHV0W3R5cGU9XCJyYWRpb1wiXSArIGRpdiB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgb3V0bGluZTogMDtcbiAgZm9udC1zaXplOiA4cHg7XG4gIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuICBjb2xvcjogIzQ0NDsgXG4gIGJvcmRlcjogc29saWQgMXB4ICM1NTU7XG4gIHBhZGRpbmc6IDJweCA4cHg7XG4gIG1hcmdpbjogMnB4O1xuICBib3JkZXItcmFkaXVzOiAxMDBweDtcbiAgY3Vyc29yOiBwb2ludGVyO1xufVxuXG4uY2hhdC10YWIgaW5wdXRbdHlwZT1cInJhZGlvXCJdICsgZGl2OmhvdmVyIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzg4ODtcbiAgY29sb3I6ICNlZWU7XG4gIGJvcmRlcjogc29saWQgMXB4ICM1NTU7XG59XG5cbi5jaGF0LXRhYiBpbnB1dFt0eXBlPVwicmFkaW9cIl06Y2hlY2tlZCArIGRpdiB7XG4gIGJhY2tncm91bmQ6ICM1NTU7XG4gIGNvbG9yOiAjQ0NDO1xufVxuXG4uYmFkZ2Uge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogLTRweDtcbiAgcmlnaHQ6IDA7XG59Il19 */");

/***/ }),

/***/ "./src/app/component/chat-palette/chat-palette.component.ts":
/*!******************************************************************!*\
  !*** ./src/app/component/chat-palette/chat-palette.component.ts ***!
  \******************************************************************/
/*! exports provided: ChatPaletteComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatPaletteComponent", function() { return ChatPaletteComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system/network/peer-context */ "./src/app/class/core/system/network/peer-context.ts");
/* harmony import */ var _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/dice-bot */ "./src/app/class/dice-bot.ts");
/* harmony import */ var _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/game-character */ "./src/app/class/game-character.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! component/text-view/text-view.component */ "./src/app/component/text-view/text-view.component.ts");
/* harmony import */ var service_chat_message_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/chat-message.service */ "./src/app/service/chat-message.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");












var ChatPaletteComponent = /** @class */ (function () {
    function ChatPaletteComponent(chatMessageService, panelService, pointerDeviceService) {
        this.chatMessageService = chatMessageService;
        this.panelService = panelService;
        this.pointerDeviceService = pointerDeviceService;
        this.character = null;
        this.sendTo = '';
        this._gameType = '';
        this.chatTabidentifier = '';
        this.text = '';
        this.isEdit = false;
        this.editPalette = '';
        this.shouldUpdateCharacterList = true;
        this._gameCharacters = [];
        this.writingEventInterval = null;
        this.previousWritingLength = 0;
        this.doubleClickTimer = null;
    }
    Object.defineProperty(ChatPaletteComponent.prototype, "palette", {
        get: function () { return this.character.chatPalette; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatPaletteComponent.prototype, "isDirect", {
        get: function () { return this.sendTo != null && this.sendTo.length ? true : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatPaletteComponent.prototype, "gameType", {
        get: function () { return this._gameType; },
        set: function (gameType) {
            this._gameType = gameType;
            if (this.character.chatPalette)
                this.character.chatPalette.dicebot = gameType;
        },
        enumerable: true,
        configurable: true
    });
    ;
    ;
    Object.defineProperty(ChatPaletteComponent.prototype, "gameCharacters", {
        get: function () {
            var _this = this;
            if (this.shouldUpdateCharacterList) {
                this.shouldUpdateCharacterList = false;
                this._gameCharacters = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance
                    .getObjects(_udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"])
                    .filter(function (character) { return _this.allowsChat(character); });
            }
            return this._gameCharacters;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatPaletteComponent.prototype, "diceBotInfos", {
        get: function () { return _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__["DiceBot"].diceBotInfos; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatPaletteComponent.prototype, "chatTab", {
        get: function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(this.chatTabidentifier); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatPaletteComponent.prototype, "myPeer", {
        get: function () { return _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"].myCursor; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatPaletteComponent.prototype, "otherPeers", {
        get: function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.getObjects(_udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"]); },
        enumerable: true,
        configurable: true
    });
    ChatPaletteComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.panelService.title = this.character.name + ' のチャットパレット';
        this.chatTabidentifier = this.chatMessageService.chatTabs ? this.chatMessageService.chatTabs[0].identifier : '';
        this.gameType = this.character.chatPalette ? this.character.chatPalette.dicebot : '';
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            if (event.data.aliasName !== _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"].aliasName)
                return;
            _this.shouldUpdateCharacterList = true;
            if (_this.character && !_this.allowsChat(_this.character)) {
                if (0 < _this.gameCharacters.length) {
                    _this.onSelectedCharacter(_this.gameCharacters[0].identifier);
                }
                else {
                    _this.panelService.close();
                }
            }
        })
            .on('DELETE_GAME_OBJECT', -1000, function (event) {
            if (_this.character && _this.character.identifier === event.data.identifier) {
                _this.panelService.close();
            }
            if (_this.chatTabidentifier === event.data.identifier) {
                _this.chatTabidentifier = _this.chatMessageService.chatTabs ? _this.chatMessageService.chatTabs[0].identifier : '';
            }
        })
            .on('DISCONNECT_PEER', function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(_this.sendTo);
            if (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"] && object.peerId === event.data.peer) {
                _this.sendTo = '';
            }
        });
    };
    ChatPaletteComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].unregister(this);
        if (this.isEdit)
            this.toggleEditMode();
    };
    ChatPaletteComponent.prototype.updatePanelTitle = function () {
        this.panelService.title = this.character.name + ' のチャットパレット';
    };
    ChatPaletteComponent.prototype.onSelectedCharacter = function (identifier) {
        if (this.isEdit)
            this.toggleEditMode();
        var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(identifier);
        if (object instanceof _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"])
            this.character = object;
        this.updatePanelTitle();
    };
    ChatPaletteComponent.prototype.selectPalette = function (line) {
        this.text = line;
        var textArea = this.textAreaElementRef.nativeElement;
        textArea.value = this.text;
    };
    ChatPaletteComponent.prototype.clickPalette = function (line) {
        var _this = this;
        if (this.doubleClickTimer && this.text === line) {
            clearTimeout(this.doubleClickTimer);
            this.doubleClickTimer = null;
            this.sendChat(null);
        }
        else {
            this.text = line;
            var textArea = this.textAreaElementRef.nativeElement;
            textArea.value = this.text;
            this.doubleClickTimer = setTimeout(function () { _this.doubleClickTimer = null; }, 400);
        }
    };
    ChatPaletteComponent.prototype.onChangeGameType = function (gameType) {
        console.log('onChangeGameType ready');
        _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__["DiceBot"].getHelpMessage(this.gameType).then(function (help) {
            console.log('onChangeGameType done\n' + help);
        });
    };
    ChatPaletteComponent.prototype.showDicebotHelp = function () {
        var _this = this;
        _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__["DiceBot"].getHelpMessage(this.gameType).then(function (help) {
            var e_1, _a;
            var gameName = 'ダイスボット';
            try {
                for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](_udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__["DiceBot"].diceBotInfos), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var diceBotInfo = _c.value;
                    if (diceBotInfo.script === _this.gameType) {
                        gameName = 'ダイスボット<' + diceBotInfo.game + '＞';
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            gameName += 'の説明';
            var coordinate = _this.pointerDeviceService.pointers[0];
            var option = { left: coordinate.x, top: coordinate.y, width: 600, height: 500 };
            var textView = _this.panelService.open(component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_8__["TextViewComponent"], option);
            textView.title = gameName;
            textView.text =
                '【ダイスボット】チャットにダイス用の文字を入力するとダイスロールが可能\n'
                    + '入力例）２ｄ６＋１　攻撃！\n'
                    + '出力例）2d6+1　攻撃！\n'
                    + '　　　　  diceBot: (2d6) → 7\n'
                    + '上記のようにダイス文字の後ろに空白を入れて発言する事も可能。\n'
                    + '以下、使用例\n'
                    + '　3D6+1>=9 ：3d6+1で目標値9以上かの判定\n'
                    + '　1D100<=50 ：D100で50％目標の下方ロールの例\n'
                    + '　3U6[5] ：3d6のダイス目が5以上の場合に振り足しして合計する(上方無限)\n'
                    + '　3B6 ：3d6のダイス目をバラバラのまま出力する（合計しない）\n'
                    + '　10B6>=4 ：10d6を振り4以上のダイス目の個数を数える\n'
                    + '　(8/2)D(4+6)<=(5*3)：個数・ダイス・達成値には四則演算も使用可能\n'
                    + '　C(10-4*3/2+2)：C(計算式）で計算だけの実行も可能\n'
                    + '　choice[a,b,c]：列挙した要素から一つを選択表示。ランダム攻撃対象決定などに\n'
                    + '　S3d6 ： 各コマンドの先頭に「S」を付けると他人結果の見えないシークレットロール\n'
                    + '　3d6/2 ： ダイス出目を割り算（切り捨て）。切り上げは /2U、四捨五入は /2R。\n'
                    + '　D66 ： D66ダイス。順序はゲームに依存。D66N：そのまま、D66S：昇順。\n'
                    + '===================================\n'
                    + help;
            console.log('onChangeGameType done');
        });
    };
    ChatPaletteComponent.prototype.sendChat = function (event) {
        if (event)
            event.preventDefault();
        if (!this.text.length)
            return;
        if (event && event.keyCode !== 13)
            return;
        if (this.chatTab) {
            var text = this.palette.evaluate(this.text, this.character.rootDataElement);
            this.chatMessageService.sendMessage(this.chatTab, text, this.gameType, this.character.identifier, this.sendTo);
        }
        this.text = '';
        this.previousWritingLength = this.text.length;
        var textArea = this.textAreaElementRef.nativeElement;
        textArea.value = '';
        this.resetPletteSelect();
        this.calcFitHeight();
    };
    ChatPaletteComponent.prototype.resetPletteSelect = function () {
        if (!this.chatPletteElementRef.nativeElement)
            return;
        this.chatPletteElementRef.nativeElement.selectedIndex = -1;
    };
    ChatPaletteComponent.prototype.toggleEditMode = function () {
        this.isEdit = this.isEdit ? false : true;
        if (this.isEdit) {
            this.editPalette = this.palette.value + '';
        }
        else {
            this.palette.setPalette(this.editPalette);
        }
    };
    ChatPaletteComponent.prototype.onInput = function () {
        var _this = this;
        if (this.writingEventInterval === null && this.previousWritingLength <= this.text.length) {
            var sendTo = null;
            if (this.isDirect) {
                var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(this.sendTo);
                if (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"]) {
                    var peer = _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_4__["PeerContext"].create(object.peerId);
                    if (peer)
                        sendTo = peer.id;
                }
            }
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].call('WRITING_A_MESSAGE', this.chatTabidentifier, sendTo);
            this.writingEventInterval = setTimeout(function () {
                _this.writingEventInterval = null;
            }, 200);
        }
        this.previousWritingLength = this.text.length;
        this.calcFitHeight();
    };
    ChatPaletteComponent.prototype.calcFitHeight = function () {
        var textArea = this.textAreaElementRef.nativeElement;
        textArea.style.height = '';
        if (textArea.scrollHeight >= textArea.offsetHeight) {
            textArea.style.height = textArea.scrollHeight + 'px';
        }
    };
    ChatPaletteComponent.prototype.allowsChat = function (gameCharacter) {
        var e_2, _a;
        switch (gameCharacter.location.name) {
            case 'table':
            case this.myPeer.peerId:
                return true;
            case 'graveyard':
                return false;
            default:
                try {
                    for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](_udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerContexts), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var conn = _c.value;
                        if (conn.isOpen && gameCharacter.location.name === conn.fullstring) {
                            return false;
                        }
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                return true;
        }
    };
    ChatPaletteComponent.ctorParameters = function () { return [
        { type: service_chat_message_service__WEBPACK_IMPORTED_MODULE_9__["ChatMessageService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_10__["PanelService"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_11__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('textArea', { static: true })
    ], ChatPaletteComponent.prototype, "textAreaElementRef", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('chatPlette', { static: false })
    ], ChatPaletteComponent.prototype, "chatPletteElementRef", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], ChatPaletteComponent.prototype, "character", void 0);
    ChatPaletteComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'chat-palette',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./chat-palette.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-palette/chat-palette.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./chat-palette.component.css */ "./src/app/component/chat-palette/chat-palette.component.css")).default]
        })
    ], ChatPaletteComponent);
    return ChatPaletteComponent;
}());



/***/ }),

/***/ "./src/app/component/chat-tab-setting/chat-tab-setting.component.css":
/*!***************************************************************************!*\
  !*** ./src/app/component/chat-tab-setting/chat-tab-setting.component.css ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".flex-container { /* Safari */\n  display: -webkit-box;\n  display: flex; /* Safari */\n  -webkit-box-orient:  horizontal;\n  -webkit-box-direction:  normal;\n          flex-flow:  row wrap; /* Safari */\n  -webkit-box-pack: start;\n          justify-content: flex-start; /* Safari */\n  -webkit-box-align: stretch;\n          align-items: stretch;\n\n}\n.flex-item {\n  margin: 5px; /* Safari */\n  -webkit-box-flex: 1;\n          flex: 1 0 auto;\n  box-sizing: border-box; /* Safari */\n  flex-grow: 1;\n  max-width: 100%;\n}\n.no-grow{ /* Safari */\n  -webkit-box-flex: 0;\n          flex-grow: 0;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2NoYXQtdGFiLXNldHRpbmcvY2hhdC10YWItc2V0dGluZy5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLGtCQUN5QixXQUFXO0VBQ2xDLG9CQUFhO0VBQWIsYUFBYSxFQUVnQixXQUFXO0VBQ3hDLCtCQUFvQjtFQUFwQiw4QkFBb0I7VUFBcEIsb0JBQW9CLEVBRWlCLFdBQVc7RUFDaEQsdUJBQTJCO1VBQTNCLDJCQUEyQixFQUVHLFdBQVc7RUFDekMsMEJBQW9CO1VBQXBCLG9CQUFvQjs7QUFFdEI7QUFDQTtFQUNFLFdBQVcsRUFDYSxXQUFXO0VBQ25DLG1CQUFjO1VBQWQsY0FBYztFQUNkLHNCQUFzQixFQUNBLFdBQVc7RUFDakMsWUFBWTtFQUNaLGVBQWU7QUFDakI7QUFFQSxVQUN3QixXQUFXO0VBQ2pDLG1CQUFZO1VBQVosWUFBWTtBQUNkIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2NoYXQtdGFiLXNldHRpbmcvY2hhdC10YWItc2V0dGluZy5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmZsZXgtY29udGFpbmVyIHtcbiAgZGlzcGxheTogLXdlYmtpdC1mbGV4OyAvKiBTYWZhcmkgKi9cbiAgZGlzcGxheTogZmxleDtcblxuICAtd2Via2l0LWZsZXgtZmxvdzogcm93IHdyYXA7IC8qIFNhZmFyaSAqL1xuICBmbGV4LWZsb3c6ICByb3cgd3JhcDtcblxuICAtd2Via2l0LWp1c3RpZnktY29udGVudDogZmxleC1zdGFydDsgLyogU2FmYXJpICovXG4gIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcblxuICAtd2Via2l0LWFsaWduLWl0ZW1zOiBzdHJldGNoOyAvKiBTYWZhcmkgKi9cbiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7XG5cbn1cbi5mbGV4LWl0ZW0ge1xuICBtYXJnaW46IDVweDtcbiAgLXdlYmtpdC1mbGV4OiAxIDAgYXV0bzsgLyogU2FmYXJpICovXG4gIGZsZXg6IDEgMCBhdXRvO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAtd2Via2l0LWZsZXgtZ3JvdzogMTsgLyogU2FmYXJpICovXG4gIGZsZXgtZ3JvdzogMTtcbiAgbWF4LXdpZHRoOiAxMDAlO1xufVxuXG4ubm8tZ3Jvd3tcbiAgLXdlYmtpdC1mbGV4LWdyb3c6IDA7IC8qIFNhZmFyaSAqL1xuICBmbGV4LWdyb3c6IDA7XG59Il19 */");

/***/ }),

/***/ "./src/app/component/chat-tab-setting/chat-tab-setting.component.ts":
/*!**************************************************************************!*\
  !*** ./src/app/component/chat-tab-setting/chat-tab-setting.component.ts ***!
  \**************************************************************************/
/*! exports provided: ChatTabSettingComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatTabSettingComponent", function() { return ChatTabSettingComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_chat_tab__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/chat-tab */ "./src/app/class/chat-tab.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_chat_message_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! service/chat-message.service */ "./src/app/service/chat-message.service.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_save_data_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/save-data.service */ "./src/app/service/save-data.service.ts");










var ChatTabSettingComponent = /** @class */ (function () {
    function ChatTabSettingComponent(modalService, panelService, chatMessageService, saveDataService) {
        this.modalService = modalService;
        this.panelService = panelService;
        this.chatMessageService = chatMessageService;
        this.saveDataService = saveDataService;
        this.selectedTab = null;
        this.selectedTabXml = '';
    }
    Object.defineProperty(ChatTabSettingComponent.prototype, "tabName", {
        get: function () { return this.selectedTab.name; },
        set: function (tabName) { if (this.isEditable)
            this.selectedTab.name = tabName; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatTabSettingComponent.prototype, "chatTabs", {
        get: function () { return this.chatMessageService.chatTabs; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatTabSettingComponent.prototype, "isEmpty", {
        get: function () { return this.chatMessageService.chatTabs.length < 1; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatTabSettingComponent.prototype, "isDeleted", {
        get: function () { return this.selectedTab ? _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.get(this.selectedTab.identifier) == null : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatTabSettingComponent.prototype, "isEditable", {
        get: function () { return !this.isEmpty && !this.isDeleted; },
        enumerable: true,
        configurable: true
    });
    ChatTabSettingComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.modalService.title = this.panelService.title = 'チャットタブ設定';
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].register(this)
            .on('DELETE_GAME_OBJECT', 1000, function (event) {
            if (!_this.selectedTab || event.data.identifier !== _this.selectedTab.identifier)
                return;
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.get(event.data.identifier);
            if (object !== null) {
                _this.selectedTabXml = object.toXml();
            }
        });
    };
    ChatTabSettingComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].unregister(this);
    };
    ChatTabSettingComponent.prototype.onChangeSelectTab = function (identifier) {
        this.selectedTab = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.get(identifier);
        this.selectedTabXml = '';
    };
    ChatTabSettingComponent.prototype.create = function () {
        var chatTab = new _udonarium_chat_tab__WEBPACK_IMPORTED_MODULE_2__["ChatTab"]();
        chatTab.name = 'タブ';
        chatTab.initialize();
    };
    ChatTabSettingComponent.prototype.save = function () {
        if (!this.selectedTab)
            return;
        var fileName = 'chat_' + this.selectedTab.name;
        this.saveDataService.saveGameObject(this.selectedTab, fileName);
    };
    ChatTabSettingComponent.prototype.delete = function () {
        if (!this.isEmpty && this.selectedTab) {
            this.selectedTabXml = this.selectedTab.toXml();
            this.selectedTab.destroy();
        }
    };
    ChatTabSettingComponent.prototype.restore = function () {
        if (this.selectedTab && this.selectedTabXml) {
            var restoreTable = _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_3__["ObjectSerializer"].instance.parseXml(this.selectedTabXml);
            this.selectedTabXml = '';
        }
    };
    ChatTabSettingComponent.ctorParameters = function () { return [
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_7__["ModalService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_8__["PanelService"] },
        { type: service_chat_message_service__WEBPACK_IMPORTED_MODULE_6__["ChatMessageService"] },
        { type: service_save_data_service__WEBPACK_IMPORTED_MODULE_9__["SaveDataService"] }
    ]; };
    ChatTabSettingComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-chat-tab-setting',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./chat-tab-setting.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-tab-setting/chat-tab-setting.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./chat-tab-setting.component.css */ "./src/app/component/chat-tab-setting/chat-tab-setting.component.css")).default]
        })
    ], ChatTabSettingComponent);
    return ChatTabSettingComponent;
}());



/***/ }),

/***/ "./src/app/component/chat-tab/chat-tab.component.css":
/*!***********************************************************!*\
  !*** ./src/app/component/chat-tab/chat-tab.component.css ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9jaGF0LXRhYi9jaGF0LXRhYi5jb21wb25lbnQuY3NzIn0= */");

/***/ }),

/***/ "./src/app/component/chat-tab/chat-tab.component.ts":
/*!**********************************************************!*\
  !*** ./src/app/component/chat-tab/chat-tab.component.ts ***!
  \**********************************************************/
/*! exports provided: ChatTabComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatTabComponent", function() { return ChatTabComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_chat_message__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/chat-message */ "./src/app/class/chat-message.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_chat_message_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! service/chat-message.service */ "./src/app/service/chat-message.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");







var DEFAULT_MESSAGE_LENGTH = 200;
var ChatTabComponent = /** @class */ (function () {
    function ChatTabComponent(ngZone, changeDetector, chatMessageService, panelService) {
        var _this = this;
        this.ngZone = ngZone;
        this.changeDetector = changeDetector;
        this.chatMessageService = chatMessageService;
        this.panelService = panelService;
        this.maxMessages = 0;
        this.preScrollBottom = -1;
        this.sampleMessages = [
            { from: 'System', timestamp: 0, imageIdentifier: '', tag: '', name: 'チュートリアル', text: 'サーバーを使用しないTRPGオンセツールです。参加者同士で接続し、コマや画像ファイルなどを同期します。' },
            { from: 'System', timestamp: 0, imageIdentifier: '', tag: '', name: 'チュートリアル', text: '全てのデータが各参加者のブラウザ内にあるため、ルームの状態を次回に持ち越したい場合は、必ず「保存」を実行してセーブデータ（zip）を生成してください。保存したzipの読み込みはブラウザ画面へのファイルドロップで行えます。' },
            { from: 'System', to: '???', timestamp: 0, imageIdentifier: '', tag: '', name: 'チュートリアル > プレイヤー', text: 'ダイレクトメッセージ（秘密会話）はセーブデータに記録されません。' },
            { from: 'System', to: '???', timestamp: 0, imageIdentifier: '', tag: '', name: 'チュートリアル > プレイヤー', text: 'また、過去のダイレクトメッセージはあなたのIDが更新されると同じルーム内であっても見えなくなります。注意してください。' },
            { from: 'System', timestamp: 0, imageIdentifier: '', tag: '', name: 'チュートリアル', text: '動作推奨環境はデスクトップChromeです。今のところ、スマホからだと上手く操作できません。' },
            { from: 'System', timestamp: 0, imageIdentifier: '', tag: '', name: 'チュートリアル', text: 'チュートリアルは以上です。このチュートリアルは最初のチャットを入力すると非表示になります。' },
        ];
        this.oldestTimestamp = 0;
        this.needUpdate = true;
        this._chatMessages = [];
        this.callbackOnScroll = function (e) { return _this.onScroll(e); };
        this.onAddMessage = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
    }
    Object.defineProperty(ChatTabComponent.prototype, "chatMessages", {
        get: function () {
            if (!this.chatTab)
                return [];
            if (this.needUpdate) {
                var chatMessages = this.chatTab.chatMessages;
                var length_1 = chatMessages.length;
                this._chatMessages = length_1 <= this.maxMessages
                    ? chatMessages
                    : chatMessages.slice(length_1 - this.maxMessages);
                this.oldestTimestamp = 0 < this._chatMessages.length ? this._chatMessages[0].timestamp : 0;
                this.needUpdate = false;
            }
            return this._chatMessages;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatTabComponent.prototype, "hasMany", {
        get: function () {
            if (!this.chatTab)
                return false;
            return this.maxMessages < this.chatTab.chatMessages.length;
        },
        enumerable: true,
        configurable: true
    });
    ;
    ChatTabComponent.prototype.ngOnInit = function () {
        var e_1, _a;
        var _this = this;
        var messages = [];
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.sampleMessages), _c = _b.next(); !_c.done; _c = _b.next()) {
                var context = _c.value;
                var message = new _udonarium_chat_message__WEBPACK_IMPORTED_MODULE_2__["ChatMessage"]();
                for (var key in context) {
                    if (key === 'identifier')
                        continue;
                    if (key === 'tabIdentifier')
                        continue;
                    if (key === 'text') {
                        message.value = context[key];
                        continue;
                    }
                    if (context[key] == null || context[key] === '')
                        continue;
                    message.setAttribute(key, context[key]);
                }
                messages.push(message);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.sampleMessages = messages;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('MESSAGE_ADDED', function (event) {
            var message = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(event.data.messageIdentifier);
            if (!message || message.parent !== _this.chatTab)
                return;
            var time = _this.chatMessageService.getTime();
            if (!_this.needUpdate && _this.oldestTimestamp < message.timestamp)
                _this.changeDetector.markForCheck();
            _this.needUpdate = true;
            if (time - (1000 * 60 * 3) < message.timestamp) {
                var top_1 = _this.panelService.scrollablePanel.scrollHeight - _this.panelService.scrollablePanel.clientHeight;
                if (_this.panelService.scrollablePanel.scrollTop < top_1 - 150) {
                    _this.maxMessages += 1;
                }
            }
            else {
                _this.maxMessages = 3;
                clearInterval(_this.asyncMessagesInitializeTimer);
                _this.asyncMessagesInitializeTimer = setInterval(function () {
                    clearInterval(_this.asyncMessagesInitializeTimer);
                    _this.ngZone.run(function () { return _this.resetMessages(); });
                }, 2000);
            }
        })
            .on('UPDATE_GAME_OBJECT', function (event) {
            var message = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(event.data.identifier);
            if (message && message instanceof _udonarium_chat_message__WEBPACK_IMPORTED_MODULE_2__["ChatMessage"] && _this.oldestTimestamp <= message.timestamp && _this.chatTab.contains(message))
                _this.changeDetector.markForCheck();
        });
    };
    ChatTabComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            setTimeout(function () { return _this.panelService.scrollablePanel.addEventListener('scroll', _this.callbackOnScroll, false); });
        });
    };
    ChatTabComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
        this.panelService.scrollablePanel.removeEventListener('scroll', this.callbackOnScroll, false);
    };
    ChatTabComponent.prototype.ngOnChanges = function () {
        this.resetMessages();
    };
    ChatTabComponent.prototype.ngAfterViewChecked = function () {
        if (0 <= this.preScrollBottom) {
            this.panelService.scrollablePanel.scrollTop = this.panelService.scrollablePanel.scrollHeight - this.preScrollBottom;
            this.preScrollBottom = -1;
        }
    };
    ChatTabComponent.prototype.moreMessages = function (length) {
        if (length === void 0) { length = 100; }
        if (!this.hasMany)
            return;
        this.maxMessages += length;
        var maxLength = this.chatTab.chatMessages.length;
        if (this.chatTab && maxLength < this.maxMessages)
            this.maxMessages = maxLength;
        this.changeDetector.markForCheck();
        this.needUpdate = true;
        this.preScrollBottom = this.panelService.scrollablePanel.scrollHeight - this.panelService.scrollablePanel.scrollTop;
    };
    ChatTabComponent.prototype.onMessageInit = function () {
        this.onAddMessage.emit();
    };
    ChatTabComponent.prototype.resetMessages = function () {
        var _this = this;
        this.needUpdate = true;
        this.maxMessages = 10;
        clearInterval(this.asyncMessagesInitializeTimer);
        var length = DEFAULT_MESSAGE_LENGTH;
        this.asyncMessagesInitializeTimer = setInterval(function () {
            if (_this.hasMany && 0 < length) {
                length -= 10;
                _this.moreMessages(10);
            }
            else {
                clearInterval(_this.asyncMessagesInitializeTimer);
            }
        }, 0);
    };
    ChatTabComponent.prototype.trackByChatMessage = function (index, message) {
        return message.identifier;
    };
    ChatTabComponent.prototype.onScroll = function (e) {
        if (this.hasMany && this.panelService.scrollablePanel.scrollTop <= 200) {
            this.moreMessages(8);
            this.ngZone.run(function () { });
        }
        else if (this.chatTab.hasUnread) {
            var top_2 = this.panelService.scrollablePanel.scrollHeight - this.panelService.scrollablePanel.clientHeight;
            if (top_2 - 100 <= this.panelService.scrollablePanel.scrollTop) {
                this.chatTab.markForRead();
                this.ngZone.run(function () { });
            }
        }
    };
    ChatTabComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
        { type: service_chat_message_service__WEBPACK_IMPORTED_MODULE_5__["ChatMessageService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_6__["PanelService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], ChatTabComponent.prototype, "chatTab", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])()
    ], ChatTabComponent.prototype, "onAddMessage", void 0);
    ChatTabComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'chat-tab',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./chat-tab.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-tab/chat-tab.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./chat-tab.component.css */ "./src/app/component/chat-tab/chat-tab.component.css")).default]
        })
    ], ChatTabComponent);
    return ChatTabComponent;
}());



/***/ }),

/***/ "./src/app/component/chat-window/chat-window.component.css":
/*!*****************************************************************!*\
  !*** ./src/app/component/chat-window/chat-window.component.css ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".loop-anime {\n  -webkit-animation: anime1 1.3s infinite ease-in-out;\n  animation: anime1 1.3s infinite ease-in-out;\n}\n.component {\n  min-height: 100%;\n  display: -webkit-box;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n          flex-direction: column;\n  -webkit-box-pack: justify;\n          justify-content: space-between;\n  align-content: space-between;\n}\n.imagebox {\n  display: inline-block;\n  width: 50px;\n  height: 50px;\n  max-width: 50px;\n  max-height: 50px;\n  vertical-align: top;\n  text-align: center;\n}\n.image{\n  width: 100%;\n  height: 100%;\n  vertical-align: bottom;\n  -o-object-fit: cover;\n     object-fit: cover;\n  -o-object-position: 50% 0%;\n     object-position: 50% 0%;\n}\n.sticky-bottom {\n  position: -webkit-sticky;\n  position: sticky;\n  bottom : 0;\n  width: 100%;\n  background-color: rgba(240,218,189, 0.8);\n  border-top:1px dotted #666;\n  margin-bottom: 0;\n}\n.table {\n  box-sizing: border-box;\n  padding : 5px;\n  /*position : fixed;*/\n  /*bottom : 0;*/\n  display: table;\n  /*width: calc(100% - 30px);*/\n  width: 100%;\n}\n.table .table-cell {\n  display: table-cell;\n}\n.message .body {\n  display: table-cell;\n}\n.chat-input {\n  font-family: Arial;\n  font-size: 13px;\n\n  width: calc(100% - 100px);\n  height: calc(1em + 4px);\n  min-height: calc(1em + 7px);\n  max-height: calc(6em + 7px);\n  resize: none;\n  overflow: auto;\n\n  padding: 1px;\n  margin: 5px;\n\n  word-break: break-all;\n  vertical-align: bottom;\n}\n.writing-info {\n  font-size: 8px;\n  height: 1.3em;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.chat-tab {\n  padding : 5px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.chat-tab label {\n  display: inline-block;\n  position: relative;\n}\n.chat-tab input[type=\"radio\"] {\n  display: none;\n}\n.chat-tab input[type=\"radio\"] + div {\n  display: inline-block;\n  vertical-align: middle;\n  outline: 0;\n  font-size: 12px;\n  background-color: transparent;\n  color: #444; \n  border: solid 1px #555;\n  padding: 2px 8px;\n  margin: 2px;\n  border-radius: 100px;\n  cursor: pointer;\n}\n.chat-tab input[type=\"radio\"] + div:hover {\n  background-color: #888;\n  color: #eee;\n  border: solid 1px #555;\n}\n.chat-tab input[type=\"radio\"]:checked + div {\n  background: #555;\n  color: #CCC;\n}\n.badge {\n  position: absolute;\n  top: -4px;\n  right: 0;\n}\n.tab-setting {\n  background-color: transparent;\n  color: #444; \n  border: solid 1px #555;\n  padding: 2px 4px;\n  border-radius: 5px;\n  cursor: pointer;\n}\n.tab-setting:hover {\n  background-color: #888;\n  color: #eee;\n  border: solid 1px #555;\n}\n.small-font {\n  font-size: 12px;\n  vertical-align: middle;\n}\n.material-icons {\n  vertical-align: middle;\n  font-size: 1.0rem;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2NoYXQtd2luZG93L2NoYXQtd2luZG93LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxtREFBbUQ7RUFDbkQsMkNBQTJDO0FBQzdDO0FBQ0E7RUFDRSxnQkFBZ0I7RUFDaEIsb0JBQWE7RUFBYixhQUFhO0VBQ2IsNEJBQXNCO0VBQXRCLDZCQUFzQjtVQUF0QixzQkFBc0I7RUFDdEIseUJBQThCO1VBQTlCLDhCQUE4QjtFQUM5Qiw0QkFBNEI7QUFDOUI7QUFDQTtFQUNFLHFCQUFxQjtFQUNyQixXQUFXO0VBQ1gsWUFBWTtFQUNaLGVBQWU7RUFDZixnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UsV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsb0JBQWlCO0tBQWpCLGlCQUFpQjtFQUNqQiwwQkFBdUI7S0FBdkIsdUJBQXVCO0FBQ3pCO0FBQ0E7RUFDRSx3QkFBZ0I7RUFBaEIsZ0JBQWdCO0VBQ2hCLFVBQVU7RUFDVixXQUFXO0VBQ1gsd0NBQXdDO0VBQ3hDLDBCQUEwQjtFQUMxQixnQkFBZ0I7QUFDbEI7QUFDQTtFQUNFLHNCQUFzQjtFQUN0QixhQUFhO0VBQ2Isb0JBQW9CO0VBQ3BCLGNBQWM7RUFDZCxjQUFjO0VBQ2QsNEJBQTRCO0VBQzVCLFdBQVc7QUFDYjtBQUNBO0VBQ0UsbUJBQW1CO0FBQ3JCO0FBQ0E7RUFDRSxtQkFBbUI7QUFDckI7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixlQUFlOztFQUVmLHlCQUF5QjtFQUN6Qix1QkFBdUI7RUFDdkIsMkJBQTJCO0VBQzNCLDJCQUEyQjtFQUMzQixZQUFZO0VBQ1osY0FBYzs7RUFFZCxZQUFZO0VBQ1osV0FBVzs7RUFFWCxxQkFBcUI7RUFDckIsc0JBQXNCO0FBQ3hCO0FBRUE7RUFDRSxjQUFjO0VBQ2QsYUFBYTtBQUNmO0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsV0FBVztBQUNiO0FBRUE7RUFDRSxhQUFhO0VBQ2IseUJBQWlCO0tBQWpCLHNCQUFpQjtNQUFqQixxQkFBaUI7VUFBakIsaUJBQWlCO0FBQ25CO0FBRUE7RUFDRSxxQkFBcUI7RUFDckIsa0JBQWtCO0FBQ3BCO0FBRUE7RUFDRSxhQUFhO0FBQ2Y7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQixzQkFBc0I7RUFDdEIsVUFBVTtFQUNWLGVBQWU7RUFDZiw2QkFBNkI7RUFDN0IsV0FBVztFQUNYLHNCQUFzQjtFQUN0QixnQkFBZ0I7RUFDaEIsV0FBVztFQUNYLG9CQUFvQjtFQUNwQixlQUFlO0FBQ2pCO0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsV0FBVztFQUNYLHNCQUFzQjtBQUN4QjtBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFdBQVc7QUFDYjtBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFNBQVM7RUFDVCxRQUFRO0FBQ1Y7QUFFQTtFQUNFLDZCQUE2QjtFQUM3QixXQUFXO0VBQ1gsc0JBQXNCO0VBQ3RCLGdCQUFnQjtFQUNoQixrQkFBa0I7RUFDbEIsZUFBZTtBQUNqQjtBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLFdBQVc7RUFDWCxzQkFBc0I7QUFDeEI7QUFFQTtFQUNFLGVBQWU7RUFDZixzQkFBc0I7QUFDeEI7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QixpQkFBaUI7QUFDbkIiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvY2hhdC13aW5kb3cvY2hhdC13aW5kb3cuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5sb29wLWFuaW1lIHtcbiAgLXdlYmtpdC1hbmltYXRpb246IGFuaW1lMSAxLjNzIGluZmluaXRlIGVhc2UtaW4tb3V0O1xuICBhbmltYXRpb246IGFuaW1lMSAxLjNzIGluZmluaXRlIGVhc2UtaW4tb3V0O1xufVxuLmNvbXBvbmVudCB7XG4gIG1pbi1oZWlnaHQ6IDEwMCU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgYWxpZ24tY29udGVudDogc3BhY2UtYmV0d2Vlbjtcbn1cbi5pbWFnZWJveCB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgd2lkdGg6IDUwcHg7XG4gIGhlaWdodDogNTBweDtcbiAgbWF4LXdpZHRoOiA1MHB4O1xuICBtYXgtaGVpZ2h0OiA1MHB4O1xuICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG4uaW1hZ2V7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG4gIG9iamVjdC1maXQ6IGNvdmVyO1xuICBvYmplY3QtcG9zaXRpb246IDUwJSAwJTtcbn1cbi5zdGlja3ktYm90dG9tIHtcbiAgcG9zaXRpb246IHN0aWNreTtcbiAgYm90dG9tIDogMDtcbiAgd2lkdGg6IDEwMCU7XG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjQwLDIxOCwxODksIDAuOCk7XG4gIGJvcmRlci10b3A6MXB4IGRvdHRlZCAjNjY2O1xuICBtYXJnaW4tYm90dG9tOiAwO1xufVxuLnRhYmxlIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgcGFkZGluZyA6IDVweDtcbiAgLypwb3NpdGlvbiA6IGZpeGVkOyovXG4gIC8qYm90dG9tIDogMDsqL1xuICBkaXNwbGF5OiB0YWJsZTtcbiAgLyp3aWR0aDogY2FsYygxMDAlIC0gMzBweCk7Ki9cbiAgd2lkdGg6IDEwMCU7XG59XG4udGFibGUgLnRhYmxlLWNlbGwge1xuICBkaXNwbGF5OiB0YWJsZS1jZWxsO1xufVxuLm1lc3NhZ2UgLmJvZHkge1xuICBkaXNwbGF5OiB0YWJsZS1jZWxsO1xufVxuXG4uY2hhdC1pbnB1dCB7XG4gIGZvbnQtZmFtaWx5OiBBcmlhbDtcbiAgZm9udC1zaXplOiAxM3B4O1xuXG4gIHdpZHRoOiBjYWxjKDEwMCUgLSAxMDBweCk7XG4gIGhlaWdodDogY2FsYygxZW0gKyA0cHgpO1xuICBtaW4taGVpZ2h0OiBjYWxjKDFlbSArIDdweCk7XG4gIG1heC1oZWlnaHQ6IGNhbGMoNmVtICsgN3B4KTtcbiAgcmVzaXplOiBub25lO1xuICBvdmVyZmxvdzogYXV0bztcblxuICBwYWRkaW5nOiAxcHg7XG4gIG1hcmdpbjogNXB4O1xuXG4gIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcbiAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbn1cblxuLndyaXRpbmctaW5mbyB7XG4gIGZvbnQtc2l6ZTogOHB4O1xuICBoZWlnaHQ6IDEuM2VtO1xufVxuXG4uZGlyZWN0LW1lc3NhZ2Uge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNTU1O1xuICBjb2xvcjogI0NDQztcbn1cblxuLmNoYXQtdGFiIHtcbiAgcGFkZGluZyA6IDVweDtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG59XG5cbi5jaGF0LXRhYiBsYWJlbCB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xufVxuXG4uY2hhdC10YWIgaW5wdXRbdHlwZT1cInJhZGlvXCJdIHtcbiAgZGlzcGxheTogbm9uZTtcbn1cblxuLmNoYXQtdGFiIGlucHV0W3R5cGU9XCJyYWRpb1wiXSArIGRpdiB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgb3V0bGluZTogMDtcbiAgZm9udC1zaXplOiAxMnB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcbiAgY29sb3I6ICM0NDQ7IFxuICBib3JkZXI6IHNvbGlkIDFweCAjNTU1O1xuICBwYWRkaW5nOiAycHggOHB4O1xuICBtYXJnaW46IDJweDtcbiAgYm9yZGVyLXJhZGl1czogMTAwcHg7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuLmNoYXQtdGFiIGlucHV0W3R5cGU9XCJyYWRpb1wiXSArIGRpdjpob3ZlciB7XG4gIGJhY2tncm91bmQtY29sb3I6ICM4ODg7XG4gIGNvbG9yOiAjZWVlO1xuICBib3JkZXI6IHNvbGlkIDFweCAjNTU1O1xufVxuXG4uY2hhdC10YWIgaW5wdXRbdHlwZT1cInJhZGlvXCJdOmNoZWNrZWQgKyBkaXYge1xuICBiYWNrZ3JvdW5kOiAjNTU1O1xuICBjb2xvcjogI0NDQztcbn1cblxuLmJhZGdlIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IC00cHg7XG4gIHJpZ2h0OiAwO1xufVxuXG4udGFiLXNldHRpbmcge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcbiAgY29sb3I6ICM0NDQ7IFxuICBib3JkZXI6IHNvbGlkIDFweCAjNTU1O1xuICBwYWRkaW5nOiAycHggNHB4O1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuLnRhYi1zZXR0aW5nOmhvdmVyIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzg4ODtcbiAgY29sb3I6ICNlZWU7XG4gIGJvcmRlcjogc29saWQgMXB4ICM1NTU7XG59XG5cbi5zbWFsbC1mb250IHtcbiAgZm9udC1zaXplOiAxMnB4O1xuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xufVxuXG4ubWF0ZXJpYWwtaWNvbnMge1xuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICBmb250LXNpemU6IDEuMHJlbTtcbn1cbiJdfQ== */");

/***/ }),

/***/ "./src/app/component/chat-window/chat-window.component.ts":
/*!****************************************************************!*\
  !*** ./src/app/component/chat-window/chat-window.component.ts ***!
  \****************************************************************/
/*! exports provided: ChatWindowComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatWindowComponent", function() { return ChatWindowComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system/network/peer-context */ "./src/app/class/core/system/network/peer-context.ts");
/* harmony import */ var _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/dice-bot */ "./src/app/class/dice-bot.ts");
/* harmony import */ var _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/game-character */ "./src/app/class/game-character.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var component_chat_tab_setting_chat_tab_setting_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! component/chat-tab-setting/chat-tab-setting.component */ "./src/app/component/chat-tab-setting/chat-tab-setting.component.ts");
/* harmony import */ var component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! component/text-view/text-view.component */ "./src/app/component/text-view/text-view.component.ts");
/* harmony import */ var service_chat_message_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/chat-message.service */ "./src/app/service/chat-message.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");













var ChatWindowComponent = /** @class */ (function () {
    function ChatWindowComponent(ngZone, chatMessageService, panelService, pointerDeviceService) {
        this.ngZone = ngZone;
        this.chatMessageService = chatMessageService;
        this.panelService = panelService;
        this.pointerDeviceService = pointerDeviceService;
        this.sender = 'Guest';
        this.text = '';
        this.sendTo = '';
        this.gameHelp = '';
        this.shouldUpdateCharacterList = true;
        this._gameCharacters = [];
        this.gameCharacter = null;
        this._chatTabidentifier = '';
        this.maxLogLength = 1000;
        this.isAutoScroll = true;
        this.scrollToBottomTimer = null;
        this.writingEventInterval = null;
        this.previousWritingLength = 0;
        this.writingPeers = new Map();
        this.writingPeerNames = [];
    }
    Object.defineProperty(ChatWindowComponent.prototype, "isDirect", {
        get: function () { return this.sendTo != null && this.sendTo.length ? true : false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatWindowComponent.prototype, "gameType", {
        get: function () { return this.chatMessageService.gameType; },
        set: function (gameType) { this.chatMessageService.gameType = gameType; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatWindowComponent.prototype, "gameCharacters", {
        get: function () {
            var _this = this;
            if (this.shouldUpdateCharacterList) {
                this.shouldUpdateCharacterList = false;
                this._gameCharacters = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance
                    .getObjects(_udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"])
                    .filter(function (character) { return _this.allowsChat(character); });
            }
            return this._gameCharacters;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatWindowComponent.prototype, "chatTabidentifier", {
        get: function () { return this._chatTabidentifier; },
        set: function (chatTabidentifier) {
            var hasChanged = this._chatTabidentifier !== chatTabidentifier;
            this._chatTabidentifier = chatTabidentifier;
            this.updatePanelTitle();
            if (hasChanged) {
                this.scrollToBottom(true);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatWindowComponent.prototype, "chatTab", {
        get: function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(this.chatTabidentifier); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatWindowComponent.prototype, "diceBotInfos", {
        get: function () { return _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__["DiceBot"].diceBotInfos; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatWindowComponent.prototype, "myPeer", {
        get: function () { return _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"].myCursor; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ChatWindowComponent.prototype, "otherPeers", {
        get: function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.getObjects(_udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"]); },
        enumerable: true,
        configurable: true
    });
    ChatWindowComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.sender = this.myPeer.identifier;
        this._chatTabidentifier = 0 < this.chatMessageService.chatTabs.length ? this.chatMessageService.chatTabs[0].identifier : '';
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].register(this)
            .on('MESSAGE_ADDED', function (event) {
            if (event.data.tabIdentifier !== _this.chatTabidentifier)
                return;
            var message = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(event.data.messageIdentifier);
            if (message && message.isSendFromSelf) {
                _this.isAutoScroll = true;
            }
            else {
                _this.checkAutoScroll();
            }
            if (_this.isAutoScroll && _this.chatTab)
                _this.chatTab.markForRead();
            var sendFrom = message ? message.from : '?';
            if (_this.writingPeers.has(sendFrom)) {
                clearTimeout(_this.writingPeers.get(sendFrom));
                _this.writingPeers.delete(sendFrom);
                _this.updateWritingPeerNames();
            }
        })
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            if (event.data.aliasName !== _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"].aliasName)
                return;
            _this.shouldUpdateCharacterList = true;
            if (_this.gameCharacter && !_this.allowsChat(_this.gameCharacter)) {
                _this.gameCharacter = null;
                _this.sender = _this.myPeer.identifier;
            }
        })
            .on('DISCONNECT_PEER', function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(_this.sendTo);
            if (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"] && object.peerId === event.data.peer) {
                _this.sendTo = '';
            }
        })
            .on('WRITING_A_MESSAGE', function (event) {
            if (event.isSendFromSelf || event.data !== _this.chatTabidentifier)
                return;
            _this.ngZone.run(function () {
                if (_this.writingPeers.has(event.sendFrom))
                    clearTimeout(_this.writingPeers.get(event.sendFrom));
                _this.writingPeers.set(event.sendFrom, setTimeout(function () {
                    _this.writingPeers.delete(event.sendFrom);
                    _this.updateWritingPeerNames();
                }, 2000));
                _this.updateWritingPeerNames();
            });
        });
        this.updatePanelTitle();
    };
    ChatWindowComponent.prototype.ngAfterViewInit = function () {
        this.scrollToBottom(true);
    };
    ChatWindowComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].unregister(this);
    };
    ChatWindowComponent.prototype.updateWritingPeerNames = function () {
        this.writingPeerNames = Array.from(this.writingPeers.keys()).map(function (peerId) {
            var peer = _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"].find(peerId);
            return peer ? peer.name : '';
        });
    };
    // @TODO やり方はもう少し考えた方がいいい
    ChatWindowComponent.prototype.scrollToBottom = function (isForce) {
        var _this = this;
        if (isForce === void 0) { isForce = false; }
        if (isForce)
            this.isAutoScroll = true;
        if (this.scrollToBottomTimer != null || !this.isAutoScroll)
            return;
        this.scrollToBottomTimer = setTimeout(function () {
            if (_this.chatTab)
                _this.chatTab.markForRead();
            _this.scrollToBottomTimer = null;
            _this.isAutoScroll = false;
            if (_this.panelService.scrollablePanel)
                _this.panelService.scrollablePanel.scrollTop = _this.panelService.scrollablePanel.scrollHeight;
        }, 0);
    };
    // @TODO
    ChatWindowComponent.prototype.checkAutoScroll = function () {
        if (!this.panelService.scrollablePanel)
            return;
        var top = this.panelService.scrollablePanel.scrollHeight - this.panelService.scrollablePanel.clientHeight;
        if (top - 150 <= this.panelService.scrollablePanel.scrollTop) {
            this.isAutoScroll = true;
        }
        else {
            this.isAutoScroll = false;
        }
    };
    ChatWindowComponent.prototype.updatePanelTitle = function () {
        if (this.chatTab) {
            this.panelService.title = 'チャットウィンドウ - ' + this.chatTab.name;
        }
        else {
            this.panelService.title = 'チャットウィンドウ';
        }
    };
    ChatWindowComponent.prototype.onSelectedTab = function (identifier) {
        this.updatePanelTitle();
    };
    ChatWindowComponent.prototype.onSelectedCharacter = function (identifier) {
        var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(identifier);
        if (object instanceof _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"]) {
            this.gameCharacter = object;
        }
        else {
            this.gameCharacter = null;
        }
        this.sender = identifier;
    };
    ChatWindowComponent.prototype.onChangeGameType = function (gameType) {
        console.log('onChangeGameType ready');
        _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__["DiceBot"].getHelpMessage(this.gameType).then(function (help) {
            console.log('onChangeGameType done\n' + help);
        });
    };
    ChatWindowComponent.prototype.showDicebotHelp = function () {
        var _this = this;
        _udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__["DiceBot"].getHelpMessage(this.gameType).then(function (help) {
            var e_1, _a;
            _this.gameHelp = help;
            var gameName = 'ダイスボット';
            try {
                for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](_udonarium_dice_bot__WEBPACK_IMPORTED_MODULE_5__["DiceBot"].diceBotInfos), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var diceBotInfo = _c.value;
                    if (diceBotInfo.script === _this.gameType) {
                        gameName = 'ダイスボット<' + diceBotInfo.game + '＞';
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            gameName += 'の説明';
            var coordinate = _this.pointerDeviceService.pointers[0];
            var option = { left: coordinate.x, top: coordinate.y, width: 600, height: 500 };
            var textView = _this.panelService.open(component_text_view_text_view_component__WEBPACK_IMPORTED_MODULE_9__["TextViewComponent"], option);
            textView.title = gameName;
            textView.text =
                '【ダイスボット】チャットにダイス用の文字を入力するとダイスロールが可能\n'
                    + '入力例）２ｄ６＋１　攻撃！\n'
                    + '出力例）2d6+1　攻撃！\n'
                    + '　　　　  diceBot: (2d6) → 7\n'
                    + '上記のようにダイス文字の後ろに空白を入れて発言する事も可能。\n'
                    + '以下、使用例\n'
                    + '　3D6+1>=9 ：3d6+1で目標値9以上かの判定\n'
                    + '　1D100<=50 ：D100で50％目標の下方ロールの例\n'
                    + '　3U6[5] ：3d6のダイス目が5以上の場合に振り足しして合計する(上方無限)\n'
                    + '　3B6 ：3d6のダイス目をバラバラのまま出力する（合計しない）\n'
                    + '　10B6>=4 ：10d6を振り4以上のダイス目の個数を数える\n'
                    + '　(8/2)D(4+6)<=(5*3)：個数・ダイス・達成値には四則演算も使用可能\n'
                    + '　C(10-4*3/2+2)：C(計算式）で計算だけの実行も可能\n'
                    + '　choice[a,b,c]：列挙した要素から一つを選択表示。ランダム攻撃対象決定などに\n'
                    + '　S3d6 ： 各コマンドの先頭に「S」を付けると他人結果の見えないシークレットロール\n'
                    + '　3d6/2 ： ダイス出目を割り算（切り捨て）。切り上げは /2U、四捨五入は /2R。\n'
                    + '　D66 ： D66ダイス。順序はゲームに依存。D66N：そのまま、D66S：昇順。\n'
                    + '===================================\n'
                    + _this.gameHelp;
        });
    };
    ChatWindowComponent.prototype.sendChat = function (event) {
        if (event)
            event.preventDefault();
        if (!this.text.length)
            return;
        if (event && event.keyCode !== 13)
            return;
        if (!this.sender.length)
            this.sender = this.myPeer.identifier;
        if (this.chatTab) {
            this.chatMessageService.sendMessage(this.chatTab, this.text, this.gameType, this.sender, this.sendTo);
        }
        this.text = '';
        this.previousWritingLength = this.text.length;
        var textArea = this.textAreaElementRef.nativeElement;
        textArea.value = '';
        this.calcFitHeight();
    };
    ChatWindowComponent.prototype.showTabSetting = function () {
        var coordinate = this.pointerDeviceService.pointers[0];
        var option = { left: coordinate.x - 250, top: coordinate.y - 175, width: 500, height: 350 };
        var component = this.panelService.open(component_chat_tab_setting_chat_tab_setting_component__WEBPACK_IMPORTED_MODULE_8__["ChatTabSettingComponent"], option);
        component.selectedTab = this.chatTab;
    };
    ChatWindowComponent.prototype.onInput = function () {
        var _this = this;
        if (this.writingEventInterval === null && this.previousWritingLength <= this.text.length) {
            var sendTo = null;
            if (this.isDirect) {
                var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(this.sendTo);
                if (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"]) {
                    var peer = _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_4__["PeerContext"].create(object.peerId);
                    if (peer)
                        sendTo = peer.id;
                }
            }
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].call('WRITING_A_MESSAGE', this.chatTabidentifier, sendTo);
            this.writingEventInterval = setTimeout(function () {
                _this.writingEventInterval = null;
            }, 200);
        }
        this.previousWritingLength = this.text.length;
        this.calcFitHeight();
    };
    ChatWindowComponent.prototype.calcFitHeight = function () {
        var textArea = this.textAreaElementRef.nativeElement;
        textArea.style.height = '';
        if (textArea.scrollHeight >= textArea.offsetHeight) {
            textArea.style.height = textArea.scrollHeight + 'px';
        }
    };
    ChatWindowComponent.prototype.allowsChat = function (gameCharacter) {
        var e_2, _a;
        switch (gameCharacter.location.name) {
            case 'table':
            case this.myPeer.peerId:
                return true;
            case 'graveyard':
                return false;
            default:
                try {
                    for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](_udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerContexts), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var conn = _c.value;
                        if (conn.isOpen && gameCharacter.location.name === conn.fullstring) {
                            return false;
                        }
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                return true;
        }
    };
    ChatWindowComponent.prototype.trackByChatTab = function (index, chatTab) {
        return chatTab.identifier;
    };
    ChatWindowComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: service_chat_message_service__WEBPACK_IMPORTED_MODULE_10__["ChatMessageService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_11__["PanelService"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_12__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('textArea', { static: true })
    ], ChatWindowComponent.prototype, "textAreaElementRef", void 0);
    ChatWindowComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'chat-window',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./chat-window.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/chat-window/chat-window.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./chat-window.component.css */ "./src/app/component/chat-window/chat-window.component.css")).default]
        })
    ], ChatWindowComponent);
    return ChatWindowComponent;
}());



/***/ }),

/***/ "./src/app/component/context-menu/context-menu.component.css":
/*!*******************************************************************!*\
  !*** ./src/app/component/context-menu/context-menu.component.css ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".component {\n  box-sizing: border-box;\n  overflow: visible;\n  position: absolute;\n\n  background: linear-gradient(-30deg, rgba(240,218,189, 0.9), rgba(255, 244, 232, 0.9));\n  border: solid 1px #999;\n  padding: 0px;\n\n  white-space: nowrap;\n\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n\n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n  z-index: 9900;\n}\n.submenu-panel {\n  position: absolute;\n  left: calc(100% - 4px);\n  top: -16px;\n}\n.pointer-events-none {\n  pointer-events: none;\n}\n.is-max-limit {\n  max-height: 100%;\n  max-width: 100%;\n}\n.title{\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  max-width: 18em;\n  font-size: 12px;\n  text-align: center;\n  padding: 4px 16px;\n  margin: 0 2px;\n  color: #444;\n  border-bottom: 1px solid #AAA;\n}\n.menu-title {\n  display: inline-block;\n}\nhr.separator {\n  margin: 0.1em -12px;\n  height: 1px;\n  border: 0;\n  background-color: #AAA;\n}\n.sub-menu-arrow {\n  display: inline-block;\n  position: absolute;\n  top: 2px;\n  bottom: 0;\n  right: 1px;\n}\nul {\n  list-style: none;\n  padding: 2px 0;\n  margin: 0;\n}\nul > li {\n  position: relative;\n  cursor: -moz-default;\n  cursor: -webkit-default;\n  cursor: default;\n\n  padding: 2px 20px;\n  font-size: 12px;\n  color: #444;\n}\nul > li.hasHighlight:hover {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2NvbnRleHQtbWVudS9jb250ZXh0LW1lbnUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHNCQUFzQjtFQUN0QixpQkFBaUI7RUFDakIsa0JBQWtCOztFQUVsQixxRkFBcUY7RUFDckYsc0JBQXNCO0VBQ3RCLFlBQVk7O0VBRVosbUJBQW1COztFQUVuQixzQkFBc0I7RUFDdEIseUJBQXlCO0VBQ3pCLHFCQUFpQjtNQUFqQixpQkFBaUI7O0VBRWpCLG9CQUFvQjtFQUNwQix1QkFBdUI7RUFDdkIsYUFBYTtBQUNmO0FBQ0E7RUFDRSxrQkFBa0I7RUFDbEIsc0JBQXNCO0VBQ3RCLFVBQVU7QUFDWjtBQUNBO0VBQ0Usb0JBQW9CO0FBQ3RCO0FBQ0E7RUFDRSxnQkFBZ0I7RUFDaEIsZUFBZTtBQUNqQjtBQUNBO0VBQ0UsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtFQUNuQix1QkFBdUI7RUFDdkIsZUFBZTtFQUNmLGVBQWU7RUFDZixrQkFBa0I7RUFDbEIsaUJBQWlCO0VBQ2pCLGFBQWE7RUFDYixXQUFXO0VBQ1gsNkJBQTZCO0FBQy9CO0FBQ0E7RUFDRSxxQkFBcUI7QUFDdkI7QUFDQTtFQUNFLG1CQUFtQjtFQUNuQixXQUFXO0VBQ1gsU0FBUztFQUNULHNCQUFzQjtBQUN4QjtBQUNBO0VBQ0UscUJBQXFCO0VBQ3JCLGtCQUFrQjtFQUNsQixRQUFRO0VBQ1IsU0FBUztFQUNULFVBQVU7QUFDWjtBQUNBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGNBQWM7RUFDZCxTQUFTO0FBQ1g7QUFDQTtFQUNFLGtCQUFrQjtFQUNsQixvQkFBb0I7RUFDcEIsdUJBQXVCO0VBQ3ZCLGVBQWU7O0VBRWYsaUJBQWlCO0VBQ2pCLGVBQWU7RUFDZixXQUFXO0FBQ2I7QUFDQTtFQUNFLFdBQVc7RUFDWCx1Q0FBdUM7QUFDekMiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvY29udGV4dC1tZW51L2NvbnRleHQtbWVudS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNvbXBvbmVudCB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIG92ZXJmbG93OiB2aXNpYmxlO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KC0zMGRlZywgcmdiYSgyNDAsMjE4LDE4OSwgMC45KSwgcmdiYSgyNTUsIDI0NCwgMjMyLCAwLjkpKTtcbiAgYm9yZGVyOiBzb2xpZCAxcHggIzk5OTtcbiAgcGFkZGluZzogMHB4O1xuXG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG5cbiAgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG5cbiAgLW1vei11c2VyLWRyYWc6IG5vbmU7XG4gIC13ZWJraXQtdXNlci1kcmFnOiBub25lO1xuICB6LWluZGV4OiA5OTAwO1xufVxuLnN1Ym1lbnUtcGFuZWwge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGxlZnQ6IGNhbGMoMTAwJSAtIDRweCk7XG4gIHRvcDogLTE2cHg7XG59XG4ucG9pbnRlci1ldmVudHMtbm9uZSB7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xufVxuLmlzLW1heC1saW1pdCB7XG4gIG1heC1oZWlnaHQ6IDEwMCU7XG4gIG1heC13aWR0aDogMTAwJTtcbn1cbi50aXRsZXtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gIG1heC13aWR0aDogMThlbTtcbiAgZm9udC1zaXplOiAxMnB4O1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIHBhZGRpbmc6IDRweCAxNnB4O1xuICBtYXJnaW46IDAgMnB4O1xuICBjb2xvcjogIzQ0NDtcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNBQUE7XG59XG4ubWVudS10aXRsZSB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbn1cbmhyLnNlcGFyYXRvciB7XG4gIG1hcmdpbjogMC4xZW0gLTEycHg7XG4gIGhlaWdodDogMXB4O1xuICBib3JkZXI6IDA7XG4gIGJhY2tncm91bmQtY29sb3I6ICNBQUE7XG59XG4uc3ViLW1lbnUtYXJyb3cge1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAycHg7XG4gIGJvdHRvbTogMDtcbiAgcmlnaHQ6IDFweDtcbn1cbnVsIHtcbiAgbGlzdC1zdHlsZTogbm9uZTtcbiAgcGFkZGluZzogMnB4IDA7XG4gIG1hcmdpbjogMDtcbn1cbnVsID4gbGkge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIGN1cnNvcjogLW1vei1kZWZhdWx0O1xuICBjdXJzb3I6IC13ZWJraXQtZGVmYXVsdDtcbiAgY3Vyc29yOiBkZWZhdWx0O1xuXG4gIHBhZGRpbmc6IDJweCAyMHB4O1xuICBmb250LXNpemU6IDEycHg7XG4gIGNvbG9yOiAjNDQ0O1xufVxudWwgPiBsaS5oYXNIaWdobGlnaHQ6aG92ZXIge1xuICBjb2xvcjogI0NDQztcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDMwLCAwLjgpO1xufSJdfQ== */");

/***/ }),

/***/ "./src/app/component/context-menu/context-menu.component.ts":
/*!******************************************************************!*\
  !*** ./src/app/component/context-menu/context-menu.component.ts ***!
  \******************************************************************/
/*! exports provided: ContextMenuComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContextMenuComponent", function() { return ContextMenuComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");




var ContextMenuComponent = /** @class */ (function () {
    function ContextMenuComponent(elementRef, contextMenuService, pointerDeviceService) {
        var _this = this;
        this.elementRef = elementRef;
        this.contextMenuService = contextMenuService;
        this.pointerDeviceService = pointerDeviceService;
        this.title = '';
        this.actions = [];
        this.isSubmenu = false;
        this.callbackOnOutsideClick = function (e) { return _this.onOutsideClick(e); };
    }
    Object.defineProperty(ContextMenuComponent.prototype, "isPointerDragging", {
        get: function () { return this.pointerDeviceService.isDragging; },
        enumerable: true,
        configurable: true
    });
    ContextMenuComponent.prototype.ngOnInit = function () {
        if (!this.isSubmenu) {
            this.title = this.contextMenuService.title;
            this.actions = this.contextMenuService.actions;
        }
    };
    ContextMenuComponent.prototype.ngAfterViewInit = function () {
        if (!this.isSubmenu) {
            this.adjustPositionRoot();
            document.addEventListener('touchstart', this.callbackOnOutsideClick, true);
            document.addEventListener('mousedown', this.callbackOnOutsideClick, true);
        }
        else {
            this.adjustPositionSub();
        }
    };
    ContextMenuComponent.prototype.ngOnDestroy = function () {
        document.removeEventListener('touchstart', this.callbackOnOutsideClick, true);
        document.removeEventListener('mousedown', this.callbackOnOutsideClick, true);
    };
    ContextMenuComponent.prototype.onOutsideClick = function (event) {
        if (this.rootElementRef.nativeElement.contains(event.target) === false) {
            this.close();
        }
    };
    ContextMenuComponent.prototype.onContextMenu = function (e) {
        e.stopPropagation();
        e.preventDefault();
    };
    ContextMenuComponent.prototype.adjustPositionRoot = function () {
        var panel = this.rootElementRef.nativeElement;
        panel.style.left = this.contextMenuService.position.x + 'px';
        panel.style.top = this.contextMenuService.position.y + 'px';
        var panelBox = panel.getBoundingClientRect();
        var diffLeft = 0;
        var diffTop = 0;
        if (window.innerWidth < panelBox.right + diffLeft) {
            diffLeft += window.innerWidth - (panelBox.right + diffLeft);
        }
        if (panelBox.left + diffLeft < 0) {
            diffLeft += 0 - (panelBox.left + diffLeft);
        }
        if (window.innerHeight < panelBox.bottom + diffTop) {
            diffTop += window.innerHeight - (panelBox.bottom + diffTop);
        }
        if (panelBox.top + diffTop < 0) {
            diffTop += 0 - (panelBox.top + diffTop);
        }
        panel.style.left = panel.offsetLeft + diffLeft + 'px';
        panel.style.top = panel.offsetTop + diffTop + 'px';
    };
    ContextMenuComponent.prototype.adjustPositionSub = function () {
        var parent = this.elementRef.nativeElement.parentElement;
        var submenu = this.rootElementRef.nativeElement;
        var parentBox = parent.getBoundingClientRect();
        var submenuBox = submenu.getBoundingClientRect();
        var diffLeft = 0;
        var diffTop = 0;
        if (window.innerWidth < submenuBox.right + diffLeft) {
            diffLeft -= parentBox.width + submenuBox.width;
            diffLeft += 8;
        }
        if (submenuBox.left + diffLeft < 0) {
            diffLeft += 0 - (submenuBox.left + diffLeft);
        }
        if (window.innerHeight < submenuBox.bottom + diffTop) {
            diffTop += window.innerHeight - (submenuBox.bottom + diffTop);
        }
        if (submenuBox.top + diffTop < 0) {
            diffTop += 0 - (submenuBox.top + diffTop);
        }
        submenu.style.left = submenu.offsetLeft + diffLeft + 'px';
        submenu.style.top = submenu.offsetTop + diffTop + 'px';
    };
    ContextMenuComponent.prototype.doAction = function (action) {
        this.showSubMenu(action);
        if (action.action != null) {
            action.action();
            this.close();
        }
    };
    ContextMenuComponent.prototype.showSubMenu = function (action) {
        var _this = this;
        this.hideSubMenu();
        clearTimeout(this.showSubMenuTimer);
        if (action.subActions == null || action.subActions.length < 1)
            return;
        this.showSubMenuTimer = setTimeout(function () {
            _this.parentMenu = action;
            _this.subMenu = action.subActions;
            clearTimeout(_this.hideSubMenuTimer);
        }, 250);
    };
    ContextMenuComponent.prototype.hideSubMenu = function () {
        var _this = this;
        clearTimeout(this.hideSubMenuTimer);
        this.hideSubMenuTimer = setTimeout(function () {
            _this.subMenu = null;
        }, 1200);
    };
    ContextMenuComponent.prototype.close = function () {
        if (this.contextMenuService)
            this.contextMenuService.close();
    };
    ContextMenuComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_2__["ContextMenuService"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_3__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('root', { static: true })
    ], ContextMenuComponent.prototype, "rootElementRef", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], ContextMenuComponent.prototype, "title", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], ContextMenuComponent.prototype, "actions", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], ContextMenuComponent.prototype, "isSubmenu", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('contextmenu', ['$event'])
    ], ContextMenuComponent.prototype, "onContextMenu", null);
    ContextMenuComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'context-menu',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./context-menu.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/context-menu/context-menu.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./context-menu.component.css */ "./src/app/component/context-menu/context-menu.component.css")).default]
        })
    ], ContextMenuComponent);
    return ContextMenuComponent;
}());

service_context_menu_service__WEBPACK_IMPORTED_MODULE_2__["ContextMenuService"].UIPanelComponentClass = ContextMenuComponent;


/***/ }),

/***/ "./src/app/component/dice-symbol/dice-symbol.component.css":
/*!*****************************************************************!*\
  !*** ./src/app/component/dice-symbol/dice-symbol.component.css ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".is-grab {\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n\n.is-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.is-3d {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n\n.is-transition {\n  -webkit-transition: -webkit-transform 132ms linear;\n  transition: -webkit-transform 132ms linear;\n  transition: transform 132ms linear;\n  transition: transform 132ms linear, -webkit-transform 132ms linear;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n\n.is-pointer-events-auto {\n  pointer-events: auto;\n}\n\n.component {\n  position: absolute;\n  height: 50px;\n  width: 50px;\n\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n}\n\n.component-content {\n  width: 100%;\n  height: 100%;\n}\n\n.pedestal-grab {\n  z-index: -1;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  position: absolute;\n  top: -22px;\n  left: -6px;\n  height: calc(100% + 44px);\n  width: calc(100% + 12px);\n  cursor: default;\n  border-radius: 37px;\n}\n\n.pedestal-grab-border {\n  pointer-events: none;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  border-top: solid 28px #999;\n  border-left: solid 12px #999;\n  border-right: solid 12px #CCC;\n  border-bottom: solid 28px #CCC;\n  border-radius: 22px;\n}\n\n.pedestal-inner {\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n  border: solid 6px rgb(216, 139, 75);\n  border-radius: 5px;\n}\n\n.is-gray-border {\n  border-color: #999;\n}\n\n.pedestal-outer {\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n  border: solid 2px #212121;\n  border-radius: 5px;\n}\n\n.upright-transform {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  -webkit-transform: rotateX(-90deg) translateY(-50%);\n          transform: rotateX(-90deg) translateY(-50%);\n}\n\n.is-fit-width {\n  height: auto;\n  width: 100%;\n}\n\n.fill-frame {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n\n.image {\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n\n  width: 100%;\n  height: auto;\n  vertical-align: bottom;\n}\n\n.is-black-mask {\n  -webkit-filter: brightness(0);\n          filter: brightness(0);\n }\n\n.is-harf-black-mask {\n  -webkit-filter: brightness(0.5);\n          filter: brightness(0.5);\n }\n\n.name-tag {\n  box-sizing: border-box;\n  font-size: 15px;\n  padding: 3px 9px;\n  border-radius: 6px;\n  position: absolute;\n  top: -30px;\n}\n\n.owner-tag {\n  box-sizing: border-box;\n  font-size: 12px;\n  padding: 3px 9px;\n  border-radius: 6px;\n  position: absolute;\n  top: -55px;\n}\n\n.rotate-frame {\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n\n.rotate-inner {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n\n  width: 100%;\n  height: auto;\n}\n\n.is-nowrap {\n  white-space: nowrap;\n}\n\n.is-black-background {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n\n.fornt-tag {\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n}\n\n.back-tag {\n  position: absolute;\n  top: 3px;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  -webkit-transform: rotateY(-180deg);\n          transform: rotateY(-180deg);\n}\n\n.has-length-limit {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  max-width: 18em;\n}\n\n.rotate-grab-icon {\n  position: absolute;\n  width: 28px;\n  height: 28px;\n  box-sizing: border-box;\n  cursor: -moz-default;\n  cursor: -webkit-default;\n  cursor: default;\n  z-index: 1;\n  padding: 2px;\n  background-color: #CCCCCC;\n  border-radius: 100%;\n  color: #444;\n  font-size: 8px;\n}\n\n.of-top {\n  top: -42px;\n}\n\n.of-bottom {\n  bottom: -30px;\n}\n\n.of-front {\n  position: absolute;\n  width: 24px;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  margin: auto;\n  color: #444;\n}\n\n.of-back {\n  position: absolute;\n  width: 24px;\n  top: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n  color: #444;\n}\n\n.rotate-grab {\n  opacity: 0;\n}\n\n.component:hover .rotate-grab {\n  opacity: 0.5;\n}\n\n.component:active .rotate-grab {\n  opacity: 0;\n}\n\n.component .rotate-grab:hover, .component .rotate-grab:active {\n  opacity: 1;\n}\n\n.material-icons {\n  display: none;\n}\n\n.component:hover .material-icons, .component:active .material-icons {\n  display: inline;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2RpY2Utc3ltYm9sL2RpY2Utc3ltYm9sLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFRSxvQkFBb0I7RUFDcEIsWUFBWTtBQUNkOztBQUVBO0VBRUUsd0JBQXdCO0VBQ3hCLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLG9DQUFvQztFQUNwQyw0QkFBNEI7QUFDOUI7O0FBRUE7RUFDRSxrREFBa0Q7RUFDbEQsMENBQWtDO0VBQWxDLGtDQUFrQztFQUFsQyxrRUFBa0M7QUFDcEM7O0FBRUE7RUFDRSxvQkFBb0I7QUFDdEI7O0FBRUE7RUFDRSxvQkFBb0I7QUFDdEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsWUFBWTtFQUNaLFdBQVc7O0VBRVgsc0JBQXNCO0VBQ3RCLHlCQUF5QjtFQUN6QixxQkFBaUI7TUFBakIsaUJBQWlCO0VBQ2pCLG9CQUFvQjtFQUNwQix1QkFBdUI7QUFDekI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsWUFBWTtBQUNkOztBQUVBO0VBQ0UsV0FBVztFQUNYLG1DQUEyQjtVQUEzQiwyQkFBMkI7RUFDM0Isa0JBQWtCO0VBQ2xCLFVBQVU7RUFDVixVQUFVO0VBQ1YseUJBQXlCO0VBQ3pCLHdCQUF3QjtFQUN4QixlQUFlO0VBQ2YsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0Usb0JBQW9CO0VBQ3BCLFdBQVc7RUFDWCxZQUFZO0VBQ1osc0JBQXNCO0VBQ3RCLDJCQUEyQjtFQUMzQiw0QkFBNEI7RUFDNUIsNkJBQTZCO0VBQzdCLDhCQUE4QjtFQUM5QixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxtQ0FBMkI7VUFBM0IsMkJBQTJCO0VBQzNCLGtCQUFrQjtFQUNsQixZQUFZO0VBQ1osV0FBVztFQUNYLHNCQUFzQjtFQUN0QixtQ0FBbUM7RUFDbkMsa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsbUNBQTJCO1VBQTNCLDJCQUEyQjtFQUMzQixrQkFBa0I7RUFDbEIsWUFBWTtFQUNaLFdBQVc7RUFDWCxzQkFBc0I7RUFDdEIseUJBQXlCO0VBQ3pCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsT0FBTztFQUNQLFFBQVE7RUFDUixtREFBMkM7VUFBM0MsMkNBQTJDO0FBQzdDOztBQUVBO0VBQ0UsWUFBWTtFQUNaLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsT0FBTztFQUNQLFFBQVE7QUFDVjs7QUFFQTtFQUNFLFNBQVM7RUFDVCxPQUFPO0VBQ1AsUUFBUTtFQUNSLFlBQVk7O0VBRVosV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSw2QkFBcUI7VUFBckIscUJBQXFCO0NBQ3RCOztBQUVBO0VBQ0MsK0JBQXVCO1VBQXZCLHVCQUF1QjtDQUN4Qjs7QUFFRDtFQUNFLHNCQUFzQjtFQUN0QixlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtFQUNsQixrQkFBa0I7RUFDbEIsVUFBVTtBQUNaOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLGVBQWU7RUFDZixnQkFBZ0I7RUFDaEIsa0JBQWtCO0VBQ2xCLGtCQUFrQjtFQUNsQixVQUFVO0FBQ1o7O0FBRUE7RUFDRSxTQUFTO0VBQ1QsT0FBTztFQUNQLFFBQVE7QUFDVjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsT0FBTztFQUNQLFFBQVE7O0VBRVIsV0FBVztFQUNYLFlBQVk7QUFDZDs7QUFFQTtFQUNFLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCx1Q0FBdUM7QUFDekM7O0FBRUE7RUFDRSxtQ0FBMkI7VUFBM0IsMkJBQTJCO0FBQzdCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFFBQVE7RUFDUixtQ0FBMkI7VUFBM0IsMkJBQTJCO0VBQzNCLG1DQUEyQjtVQUEzQiwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLHVCQUF1QjtFQUN2QixlQUFlO0FBQ2pCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFdBQVc7RUFDWCxZQUFZO0VBQ1osc0JBQXNCO0VBQ3RCLG9CQUFvQjtFQUNwQix1QkFBdUI7RUFDdkIsZUFBZTtFQUNmLFVBQVU7RUFDVixZQUFZO0VBQ1oseUJBQXlCO0VBQ3pCLG1CQUFtQjtFQUNuQixXQUFXO0VBQ1gsY0FBYztBQUNoQjs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsT0FBTztFQUNQLFFBQVE7RUFDUixTQUFTO0VBQ1QsWUFBWTtFQUNaLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsTUFBTTtFQUNOLE9BQU87RUFDUCxRQUFRO0VBQ1IsWUFBWTtFQUNaLFdBQVc7QUFDYjs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFFQTtFQUNFLFlBQVk7QUFDZDs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTtFQUNFLGVBQWU7QUFDakIiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZGljZS1zeW1ib2wvZGljZS1zeW1ib2wuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5pcy1ncmFiIHtcbiAgY3Vyc29yOiAtbW96LWdyYWI7XG4gIGN1cnNvcjogLXdlYmtpdC1ncmFiO1xuICBjdXJzb3I6IGdyYWI7XG59XG5cbi5pcy1ncmFiYmluZyB7XG4gIGN1cnNvcjogLW1vei1ncmFiYmluZztcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWJiaW5nO1xuICBjdXJzb3I6IGdyYWJiaW5nO1xufVxuXG4uaXMtM2Qge1xuICAtd2Via2l0LXRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7XG4gIHRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7XG59XG5cbi5pcy10cmFuc2l0aW9uIHtcbiAgLXdlYmtpdC10cmFuc2l0aW9uOiAtd2Via2l0LXRyYW5zZm9ybSAxMzJtcyBsaW5lYXI7XG4gIHRyYW5zaXRpb246IHRyYW5zZm9ybSAxMzJtcyBsaW5lYXI7XG59XG5cbi5pcy1wb2ludGVyLWV2ZW50cy1ub25lIHtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG59XG5cbi5pcy1wb2ludGVyLWV2ZW50cy1hdXRvIHtcbiAgcG9pbnRlci1ldmVudHM6IGF1dG87XG59XG5cbi5jb21wb25lbnQge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGhlaWdodDogNTBweDtcbiAgd2lkdGg6IDUwcHg7XG5cbiAgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gIC1tb3otdXNlci1kcmFnOiBub25lO1xuICAtd2Via2l0LXVzZXItZHJhZzogbm9uZTtcbn1cblxuLmNvbXBvbmVudC1jb250ZW50IHtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbn1cblxuLnBlZGVzdGFsLWdyYWIge1xuICB6LWluZGV4OiAtMTtcbiAgYmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogLTIycHg7XG4gIGxlZnQ6IC02cHg7XG4gIGhlaWdodDogY2FsYygxMDAlICsgNDRweCk7XG4gIHdpZHRoOiBjYWxjKDEwMCUgKyAxMnB4KTtcbiAgY3Vyc29yOiBkZWZhdWx0O1xuICBib3JkZXItcmFkaXVzOiAzN3B4O1xufVxuXG4ucGVkZXN0YWwtZ3JhYi1ib3JkZXIge1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyLXRvcDogc29saWQgMjhweCAjOTk5O1xuICBib3JkZXItbGVmdDogc29saWQgMTJweCAjOTk5O1xuICBib3JkZXItcmlnaHQ6IHNvbGlkIDEycHggI0NDQztcbiAgYm9yZGVyLWJvdHRvbTogc29saWQgMjhweCAjQ0NDO1xuICBib3JkZXItcmFkaXVzOiAyMnB4O1xufVxuXG4ucGVkZXN0YWwtaW5uZXIge1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCA2cHggcmdiKDIxNiwgMTM5LCA3NSk7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbn1cblxuLmlzLWdyYXktYm9yZGVyIHtcbiAgYm9yZGVyLWNvbG9yOiAjOTk5O1xufVxuXG4ucGVkZXN0YWwtb3V0ZXIge1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCAycHggIzIxMjEyMTtcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xufVxuXG4udXByaWdodC10cmFuc2Zvcm0ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIHRyYW5zZm9ybTogcm90YXRlWCgtOTBkZWcpIHRyYW5zbGF0ZVkoLTUwJSk7XG59XG5cbi5pcy1maXQtd2lkdGgge1xuICBoZWlnaHQ6IGF1dG87XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4uZmlsbC1mcmFtZSB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgYm90dG9tOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbn1cblxuLmltYWdlIHtcbiAgYm90dG9tOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgbWFyZ2luOiBhdXRvO1xuXG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IGF1dG87XG4gIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG59XG5cbi5pcy1ibGFjay1tYXNrIHtcbiAgZmlsdGVyOiBicmlnaHRuZXNzKDApO1xuIH1cblxuIC5pcy1oYXJmLWJsYWNrLW1hc2sge1xuICBmaWx0ZXI6IGJyaWdodG5lc3MoMC41KTtcbiB9XG5cbi5uYW1lLXRhZyB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGZvbnQtc2l6ZTogMTVweDtcbiAgcGFkZGluZzogM3B4IDlweDtcbiAgYm9yZGVyLXJhZGl1czogNnB4O1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogLTMwcHg7XG59XG5cbi5vd25lci10YWcge1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBmb250LXNpemU6IDEycHg7XG4gIHBhZGRpbmc6IDNweCA5cHg7XG4gIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IC01NXB4O1xufVxuXG4ucm90YXRlLWZyYW1lIHtcbiAgYm90dG9tOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbn1cblxuLnJvdGF0ZS1pbm5lciB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgYm90dG9tOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcblxuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiBhdXRvO1xufVxuXG4uaXMtbm93cmFwIHtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbn1cblxuLmlzLWJsYWNrLWJhY2tncm91bmQge1xuICBjb2xvcjogI0NDQztcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDMwLCAwLjgpO1xufVxuXG4uZm9ybnQtdGFnIHtcbiAgYmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuO1xufVxuXG4uYmFjay10YWcge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogM3B4O1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG4gIHRyYW5zZm9ybTogcm90YXRlWSgtMTgwZGVnKTtcbn1cblxuLmhhcy1sZW5ndGgtbGltaXQge1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgbWF4LXdpZHRoOiAxOGVtO1xufVxuXG4ucm90YXRlLWdyYWItaWNvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDI4cHg7XG4gIGhlaWdodDogMjhweDtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgY3Vyc29yOiAtbW96LWRlZmF1bHQ7XG4gIGN1cnNvcjogLXdlYmtpdC1kZWZhdWx0O1xuICBjdXJzb3I6IGRlZmF1bHQ7XG4gIHotaW5kZXg6IDE7XG4gIHBhZGRpbmc6IDJweDtcbiAgYmFja2dyb3VuZC1jb2xvcjogI0NDQ0NDQztcbiAgYm9yZGVyLXJhZGl1czogMTAwJTtcbiAgY29sb3I6ICM0NDQ7XG4gIGZvbnQtc2l6ZTogOHB4O1xufVxuXG4ub2YtdG9wIHtcbiAgdG9wOiAtNDJweDtcbn1cblxuLm9mLWJvdHRvbSB7XG4gIGJvdHRvbTogLTMwcHg7XG59XG5cbi5vZi1mcm9udCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDI0cHg7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG4gIG1hcmdpbjogYXV0bztcbiAgY29sb3I6ICM0NDQ7XG59XG5cbi5vZi1iYWNrIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB3aWR0aDogMjRweDtcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgbWFyZ2luOiBhdXRvO1xuICBjb2xvcjogIzQ0NDtcbn1cblxuLnJvdGF0ZS1ncmFiIHtcbiAgb3BhY2l0eTogMDtcbn1cblxuLmNvbXBvbmVudDpob3ZlciAucm90YXRlLWdyYWIge1xuICBvcGFjaXR5OiAwLjU7XG59XG5cbi5jb21wb25lbnQ6YWN0aXZlIC5yb3RhdGUtZ3JhYiB7XG4gIG9wYWNpdHk6IDA7XG59XG5cbi5jb21wb25lbnQgLnJvdGF0ZS1ncmFiOmhvdmVyLCAuY29tcG9uZW50IC5yb3RhdGUtZ3JhYjphY3RpdmUge1xuICBvcGFjaXR5OiAxO1xufVxuXG4ubWF0ZXJpYWwtaWNvbnMge1xuICBkaXNwbGF5OiBub25lO1xufVxuXG4uY29tcG9uZW50OmhvdmVyIC5tYXRlcmlhbC1pY29ucywgLmNvbXBvbmVudDphY3RpdmUgLm1hdGVyaWFsLWljb25zIHtcbiAgZGlzcGxheTogaW5saW5lO1xufSJdfQ== */");

/***/ }),

/***/ "./src/app/component/dice-symbol/dice-symbol.component.ts":
/*!****************************************************************!*\
  !*** ./src/app/component/dice-symbol/dice-symbol.component.ts ***!
  \****************************************************************/
/*! exports provided: DiceSymbolComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiceSymbolComponent", function() { return DiceSymbolComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/animations */ "./node_modules/@angular/animations/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var directive_input_handler__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! directive/input-handler */ "./src/app/directive/input-handler.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");














var DiceSymbolComponent = /** @class */ (function () {
    function DiceSymbolComponent(ngZone, panelService, contextMenuService, elementRef, changeDetector, pointerDeviceService) {
        this.ngZone = ngZone;
        this.panelService = panelService;
        this.contextMenuService = contextMenuService;
        this.elementRef = elementRef;
        this.changeDetector = changeDetector;
        this.pointerDeviceService = pointerDeviceService;
        this.diceSymbol = null;
        this.is3D = false;
        this.animeState = 'inactive';
        this.iconHiddenTimer = null;
        this.emptyImage = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_3__["ImageFile"].Empty;
        this.gridSize = 50;
        this.movableOption = {};
        this.rotableOption = {};
        this.doubleClickTimer = null;
        this.doubleClickPoint = { x: 0, y: 0 };
        this.input = null;
    }
    Object.defineProperty(DiceSymbolComponent.prototype, "face", {
        get: function () { return this.diceSymbol.face; },
        set: function (face) { this.diceSymbol.face = face; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "owner", {
        get: function () { return this.diceSymbol.owner; },
        set: function (owner) { this.diceSymbol.owner = owner; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "rotate", {
        get: function () { return this.diceSymbol.rotate; },
        set: function (rotate) { this.diceSymbol.rotate = rotate; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "name", {
        get: function () { return this.diceSymbol.name; },
        set: function (name) { this.diceSymbol.name = name; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "size", {
        get: function () { return this.adjustMinBounds(this.diceSymbol.size); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "faces", {
        get: function () { return this.diceSymbol.faces; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "imageFile", {
        get: function () {
            var image = this.diceSymbol.imageFile;
            return image ? image : this.emptyImage;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "isMine", {
        get: function () { return this.diceSymbol.isMine; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "hasOwner", {
        get: function () { return this.diceSymbol.hasOwner; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "ownerName", {
        get: function () { return this.diceSymbol.ownerName; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "isVisible", {
        get: function () { return this.diceSymbol.isVisible; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DiceSymbolComponent.prototype, "isIconHidden", {
        get: function () { return this.iconHiddenTimer != null; },
        enumerable: true,
        configurable: true
    });
    ;
    DiceSymbolComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].register(this)
            .on('ROLL_DICE_SYNBOL', -1000, function (event) {
            if (event.data.identifier === _this.diceSymbol.identifier) {
                _this.ngZone.run(function () {
                    _this.animeState = 'inactive';
                    _this.changeDetector.markForCheck();
                    setTimeout(function () { _this.animeState = 'active'; _this.changeDetector.markForCheck(); });
                });
            }
        })
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.diceSymbol || !object)
                return;
            if ((_this.diceSymbol === object)
                || (object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_4__["ObjectNode"] && _this.diceSymbol.contains(object))
                || (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"] && object.peerId === _this.diceSymbol.owner)) {
                _this.changeDetector.markForCheck();
            }
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('UPDATE_FILE_RESOURE', -1000, function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('DISCONNECT_PEER', function (event) {
            if (_this.diceSymbol.owner === event.data.peer)
                _this.changeDetector.markForCheck();
        });
        this.movableOption = {
            tabletopObject: this.diceSymbol,
            transformCssOffset: 'translateZ(1.0px)',
            colideLayers: ['terrain']
        };
        this.rotableOption = {
            tabletopObject: this.diceSymbol
        };
    };
    DiceSymbolComponent.prototype.ngAfterViewInit = function () {
        this.input = new directive_input_handler__WEBPACK_IMPORTED_MODULE_10__["InputHandler"](this.elementRef.nativeElement);
        this.input.onStart = this.onInputStart.bind(this);
    };
    DiceSymbolComponent.prototype.ngOnDestroy = function () {
        this.input.destroy();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].unregister(this);
    };
    DiceSymbolComponent.prototype.onDragstart = function (e) {
        e.stopPropagation();
        e.preventDefault();
    };
    DiceSymbolComponent.prototype.animationShuffleDone = function (event) {
        this.animeState = 'inactive';
        this.changeDetector.markForCheck();
    };
    DiceSymbolComponent.prototype.onInputStart = function (e) {
        this.input.cancel();
        this.onDoubleClick(e);
        if (e instanceof MouseEvent)
            this.startIconHiddenTimer();
    };
    DiceSymbolComponent.prototype.onDoubleClick = function (e) {
        var _this = this;
        if (!this.doubleClickTimer) {
            this.doubleClickTimer = setTimeout(function () {
                clearTimeout(_this.doubleClickTimer);
                _this.doubleClickTimer = null;
            }, 300);
            this.doubleClickPoint = this.input.pointer;
            return;
        }
        clearTimeout(this.doubleClickTimer);
        this.doubleClickTimer = null;
        var distance = Math.pow((this.doubleClickPoint.x - this.input.pointer.x), 2) + Math.pow((this.doubleClickPoint.y - this.input.pointer.y), 2);
        if (distance < Math.pow(10, 2)) {
            if (this.isVisible)
                this.diceRoll();
        }
    };
    DiceSymbolComponent.prototype.onContextMenu = function (e) {
        var _this = this;
        e.stopPropagation();
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        var position = this.pointerDeviceService.pointers[0];
        var actions = [];
        if (this.isVisible) {
            actions.push({
                name: 'ダイスを振る', action: function () {
                    _this.diceRoll();
                }
            });
        }
        actions.push(service_context_menu_service__WEBPACK_IMPORTED_MODULE_11__["ContextMenuSeparator"]);
        if (this.isMine || this.hasOwner) {
            actions.push({
                name: 'ダイスを公開', action: function () {
                    _this.owner = '';
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].unlock);
                }
            });
        }
        if (!this.isMine) {
            actions.push({
                name: '自分だけ見る', action: function () {
                    _this.owner = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["Network"].peerId;
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].lock);
                }
            });
        }
        if (this.isVisible) {
            var subActions_1 = [];
            this.faces.forEach(function (face) {
                subActions_1.push({
                    name: "" + face, action: function () {
                        _this.face = face;
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].dicePut);
                    }
                });
            });
            actions.push({ name: "\u30C0\u30A4\u30B9\u76EE\u3092\u8A2D\u5B9A", action: null, subActions: subActions_1 });
        }
        actions.push(service_context_menu_service__WEBPACK_IMPORTED_MODULE_11__["ContextMenuSeparator"]);
        actions.push({ name: '詳細を表示', action: function () { _this.showDetail(_this.diceSymbol); } });
        actions.push({
            name: 'コピーを作る', action: function () {
                var cloneObject = _this.diceSymbol.clone();
                cloneObject.location.x += _this.gridSize;
                cloneObject.location.y += _this.gridSize;
                cloneObject.update();
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].dicePut);
            }
        });
        actions.push({
            name: '削除する', action: function () {
                _this.diceSymbol.destroy();
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].sweep);
            }
        });
        this.contextMenuService.open(position, actions, this.name);
    };
    DiceSymbolComponent.prototype.onMove = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].dicePick);
    };
    DiceSymbolComponent.prototype.onMoved = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].dicePut);
    };
    DiceSymbolComponent.prototype.diceRoll = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].call('ROLL_DICE_SYNBOL', { identifier: this.diceSymbol.identifier });
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_8__["PresetSound"].diceRoll1);
        return this.diceSymbol.diceRoll();
    };
    DiceSymbolComponent.prototype.showDetail = function (gameObject) {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: gameObject.identifier, className: gameObject.aliasName });
        var coordinate = this.pointerDeviceService.pointers[0];
        var title = 'ダイスシンボル設定';
        if (gameObject.name.length)
            title += ' - ' + gameObject.name;
        var option = { title: title, left: coordinate.x - 300, top: coordinate.y - 300, width: 600, height: 600 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_9__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    DiceSymbolComponent.prototype.startIconHiddenTimer = function () {
        var _this = this;
        clearTimeout(this.iconHiddenTimer);
        this.iconHiddenTimer = setTimeout(function () {
            _this.iconHiddenTimer = null;
            _this.changeDetector.markForCheck();
        }, 300);
        this.changeDetector.markForCheck();
    };
    DiceSymbolComponent.prototype.adjustMinBounds = function (value, min) {
        if (min === void 0) { min = 0; }
        return value < min ? min : value;
    };
    DiceSymbolComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_2__["NgZone"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_12__["PanelService"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_11__["ContextMenuService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ElementRef"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectorRef"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_13__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], DiceSymbolComponent.prototype, "diceSymbol", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], DiceSymbolComponent.prototype, "is3D", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["HostListener"])('dragstart', ['$event'])
    ], DiceSymbolComponent.prototype, "onDragstart", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["HostListener"])('contextmenu', ['$event'])
    ], DiceSymbolComponent.prototype, "onContextMenu", null);
    DiceSymbolComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
            selector: 'dice-symbol',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./dice-symbol.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/dice-symbol/dice-symbol.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectionStrategy"].OnPush,
            animations: [
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('diceRoll', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => active', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('800ms ease', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0.8, 0.8, 0.8) rotateZ(0deg)', offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.2, 1.2, 1.2) rotateZ(360deg)', offset: 0.5 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0.75, 0.75, 0.75) rotateZ(520deg)', offset: 0.75 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.125, 1.125, 1.125) rotateZ(630deg)', offset: 0.875 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.0, 1.0, 1.0) rotateZ(720deg)', offset: 1.0 })
                        ]))
                    ])
                ]),
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('bounceInOut', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('void => *', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('600ms ease', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0, 0, 0)', offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.5, 1.5, 1.5)', offset: 0.5 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0.75, 0.75, 0.75)', offset: 0.75 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.125, 1.125, 1.125)', offset: 0.875 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.0, 1.0, 1.0)', offset: 1.0 })
                        ]))
                    ]),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => void', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])(100, Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0, 0, 0)' }))
                    ])
                ])
            ],
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./dice-symbol.component.css */ "./src/app/component/dice-symbol/dice-symbol.component.css")).default]
        })
    ], DiceSymbolComponent);
    return DiceSymbolComponent;
}());



/***/ }),

/***/ "./src/app/component/file-selecter/file-selecter.component.css":
/*!*********************************************************************!*\
  !*** ./src/app/component/file-selecter/file-selecter.component.css ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".image {\n  font-size: 0;\n}\n\n.image  img {\n  vertical-align: bottom;\n}\n\n.empty {\n  line-height: 120px;\n  vertical-align: middle;\n}\n\n.empty button {\n  height: 100px;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2ZpbGUtc2VsZWN0ZXIvZmlsZS1zZWxlY3Rlci5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsWUFBWTtBQUNkOztBQUVBO0VBQ0Usc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLGFBQWE7QUFDZiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9maWxlLXNlbGVjdGVyL2ZpbGUtc2VsZWN0ZXIuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5pbWFnZSB7XG4gIGZvbnQtc2l6ZTogMDtcbn1cblxuLmltYWdlICBpbWcge1xuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xufVxuXG4uZW1wdHkge1xuICBsaW5lLWhlaWdodDogMTIwcHg7XG4gIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XG59XG5cbi5lbXB0eSBidXR0b24ge1xuICBoZWlnaHQ6IDEwMHB4O1xufVxuIl19 */");

/***/ }),

/***/ "./src/app/component/file-selecter/file-selecter.component.ts":
/*!********************************************************************!*\
  !*** ./src/app/component/file-selecter/file-selecter.component.ts ***!
  \********************************************************************/
/*! exports provided: FileSelecterComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileSelecterComponent", function() { return FileSelecterComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");







var FileSelecterComponent = /** @class */ (function () {
    function FileSelecterComponent(changeDetector, panelService, modalService) {
        this.changeDetector = changeDetector;
        this.panelService = panelService;
        this.modalService = modalService;
        this.isAllowedEmpty = false;
        this.isAllowedEmpty = this.modalService.option && this.modalService.option.isAllowedEmpty ? true : false;
    }
    Object.defineProperty(FileSelecterComponent.prototype, "images", {
        get: function () { return _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__["ImageStorage"].instance.images; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSelecterComponent.prototype, "empty", {
        get: function () { return _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].Empty; },
        enumerable: true,
        configurable: true
    });
    FileSelecterComponent.prototype.ngOnInit = function () {
        this.modalService.title = this.panelService.title = 'ファイル一覧';
    };
    FileSelecterComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this).on('SYNCHRONIZE_FILE_LIST', function (event) {
            if (event.isSendFromSelf) {
                _this.changeDetector.markForCheck();
            }
        });
    };
    FileSelecterComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    FileSelecterComponent.prototype.onSelectedFile = function (file) {
        console.log('onSelectedFile', file);
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].call('SELECT_FILE', { fileIdentifier: file.identifier }, _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId);
        this.modalService.resolve(file.identifier);
    };
    FileSelecterComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_6__["PanelService"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_5__["ModalService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], FileSelecterComponent.prototype, "isAllowedEmpty", void 0);
    FileSelecterComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'file-selector',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./file-selecter.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/file-selecter/file-selecter.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./file-selecter.component.css */ "./src/app/component/file-selecter/file-selecter.component.css")).default]
        })
    ], FileSelecterComponent);
    return FileSelecterComponent;
}());



/***/ }),

/***/ "./src/app/component/file-storage/file-storage.component.css":
/*!*******************************************************************!*\
  !*** ./src/app/component/file-storage/file-storage.component.css ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".drop-zone {\n  border: 2px dashed #555;\n  border-radius: 5px;\n  padding: 25px;\n  text-align: center;\n  font: 24px bold 'Vollkorn';\n  color: #444;\n  cursor: pointer;\n}\n\n.large-font {\n  font-size: 64px;\n}\n\n.small-font {\n  font-size: 12px;\n}\n\n.image {\n  font-size: 0;\n}\n\n.image img {\n  vertical-align: bottom;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2ZpbGUtc3RvcmFnZS9maWxlLXN0b3JhZ2UuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHVCQUF1QjtFQUd2QixrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLGtCQUFrQjtFQUNsQiwwQkFBMEI7RUFDMUIsV0FBVztFQUNYLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLFlBQVk7QUFDZDs7QUFFQTtFQUNFLHNCQUFzQjtBQUN4QiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9maWxlLXN0b3JhZ2UvZmlsZS1zdG9yYWdlLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuZHJvcC16b25lIHtcbiAgYm9yZGVyOiAycHggZGFzaGVkICM1NTU7XG4gIC1tb3otYm9yZGVyLXJhZGl1czogNXB4O1xuICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xuICBwYWRkaW5nOiAyNXB4O1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIGZvbnQ6IDI0cHggYm9sZCAnVm9sbGtvcm4nO1xuICBjb2xvcjogIzQ0NDtcbiAgY3Vyc29yOiBwb2ludGVyO1xufVxuXG4ubGFyZ2UtZm9udCB7XG4gIGZvbnQtc2l6ZTogNjRweDtcbn1cblxuLnNtYWxsLWZvbnQge1xuICBmb250LXNpemU6IDEycHg7XG59XG5cbi5pbWFnZSB7XG4gIGZvbnQtc2l6ZTogMDtcbn1cblxuLmltYWdlIGltZyB7XG4gIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG59Il19 */");

/***/ }),

/***/ "./src/app/component/file-storage/file-storage.component.ts":
/*!******************************************************************!*\
  !*** ./src/app/component/file-storage/file-storage.component.ts ***!
  \******************************************************************/
/*! exports provided: FileStorageComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileStorageComponent", function() { return FileStorageComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/file-storage/file-archiver */ "./src/app/class/core/file-storage/file-archiver.ts");
/* harmony import */ var _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");






var FileStorageComponent = /** @class */ (function () {
    function FileStorageComponent(changeDetector, panelService) {
        this.changeDetector = changeDetector;
        this.panelService = panelService;
        this.fileStorageService = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__["ImageStorage"].instance;
    }
    FileStorageComponent.prototype.ngOnInit = function () {
        this.panelService.title = 'ファイル一覧';
    };
    FileStorageComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this).on('SYNCHRONIZE_FILE_LIST', function (event) {
            if (event.isSendFromSelf) {
                _this.changeDetector.markForCheck();
            }
        });
    };
    FileStorageComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    FileStorageComponent.prototype.handleFileSelect = function (event) {
        var files = event.target.files;
        if (files.length)
            _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_2__["FileArchiver"].instance.load(files);
    };
    FileStorageComponent.prototype.onSelectedFile = function (file) {
        console.log('onSelectedFile', file);
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].call('SELECT_FILE', { fileIdentifier: file.identifier }, _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId);
    };
    FileStorageComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_5__["PanelService"] }
    ]; };
    FileStorageComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'file-storage',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./file-storage.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/file-storage/file-storage.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./file-storage.component.css */ "./src/app/component/file-storage/file-storage.component.css")).default]
        })
    ], FileStorageComponent);
    return FileStorageComponent;
}());



/***/ }),

/***/ "./src/app/component/game-character-generator/game-character-generator.component.css":
/*!*******************************************************************************************!*\
  !*** ./src/app/component/game-character-generator/game-character-generator.component.css ***!
  \*******************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9nYW1lLWNoYXJhY3Rlci1nZW5lcmF0b3IvZ2FtZS1jaGFyYWN0ZXItZ2VuZXJhdG9yLmNvbXBvbmVudC5jc3MifQ== */");

/***/ }),

/***/ "./src/app/component/game-character-generator/game-character-generator.component.ts":
/*!******************************************************************************************!*\
  !*** ./src/app/component/game-character-generator/game-character-generator.component.ts ***!
  \******************************************************************************************/
/*! exports provided: GameCharacterGeneratorComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameCharacterGeneratorComponent", function() { return GameCharacterGeneratorComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_game_character__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/game-character */ "./src/app/class/game-character.ts");
/* harmony import */ var _udonarium_game_table_mask__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @udonarium/game-table-mask */ "./src/app/class/game-table-mask.ts");
/* harmony import */ var component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! component/file-selecter/file-selecter.component */ "./src/app/component/file-selecter/file-selecter.component.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");












var GameCharacterGeneratorComponent = /** @class */ (function () {
    function GameCharacterGeneratorComponent(viewContainerRef, modalService, panelService) {
        this.viewContainerRef = viewContainerRef;
        this.modalService = modalService;
        this.panelService = panelService;
        this.name = "ゲームキャラクター";
        this.size = 1;
        this.xml = '';
        this.minSize = 1;
        this.maxSize = 20;
        this.tableBackgroundImage = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].createEmpty('null');
    }
    GameCharacterGeneratorComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.panelService.title = 'キャラクタージェネレーター';
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].register(this)
            .on('SELECT_FILE', function (event) {
            console.log('SELECT_FILE GameCharacterGeneratorComponent ' + event.data.fileIdentifier);
            var fileIdentifier = event.data.fileIdentifier;
            var file = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__["ImageStorage"].instance.get(fileIdentifier);
            if (file)
                _this.tableBackgroundImage = file;
        });
    };
    GameCharacterGeneratorComponent.prototype.ngAfterViewInit = function () { };
    GameCharacterGeneratorComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].unregister(this);
    };
    GameCharacterGeneratorComponent.prototype.createGameCharacter = function () {
        _udonarium_game_character__WEBPACK_IMPORTED_MODULE_7__["GameCharacter"].create(this.name, this.size, this.tableBackgroundImage.identifier);
    };
    GameCharacterGeneratorComponent.prototype.createGameTableMask = function () {
        var viewTable = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get('tableSelecter').viewTable;
        if (!viewTable)
            return;
        var tableMask = _udonarium_game_table_mask__WEBPACK_IMPORTED_MODULE_8__["GameTableMask"].create('マップマスク', 5, 5, 100);
        viewTable.appendChild(tableMask);
    };
    GameCharacterGeneratorComponent.prototype.createGameCharacterForXML = function (xml) {
        _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_4__["ObjectSerializer"].instance.parseXml(xml);
    };
    GameCharacterGeneratorComponent.prototype.openModal = function () {
        this.modalService.open(component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_9__["FileSelecterComponent"]);
    };
    GameCharacterGeneratorComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewContainerRef"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_10__["ModalService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_11__["PanelService"] }
    ]; };
    GameCharacterGeneratorComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'game-character-generator',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./game-character-generator.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character-generator/game-character-generator.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./game-character-generator.component.css */ "./src/app/component/game-character-generator/game-character-generator.component.css")).default]
        })
    ], GameCharacterGeneratorComponent);
    return GameCharacterGeneratorComponent;
}());



/***/ }),

/***/ "./src/app/component/game-character-sheet/game-character-sheet.component.css":
/*!***********************************************************************************!*\
  !*** ./src/app/component/game-character-sheet/game-character-sheet.component.css ***!
  \***********************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".main-image-box {\n  /* position: absolute;\n  top: 0px;\n  left: 0;\n  */\n  width: 250px;\n  height: 250px;\n}\n.main-image {\n  width: 250px;\n}\n.table {\n  display:table;\n  width :100%;\n  box-sizing: border-box;\n  /*border:1px solid #FFFF00;*/\n}\n.table-row {\n  display:table-row;\n  box-sizing: border-box;\n}\n.table-row > div {\n  display:table-cell;\n  border:1px solid #FFF;\n  vertical-align: top;\n  box-sizing: border-box;\n}\n.box {\n  display: inline-block;\n  margin: 5px;\n  /*border:1px solid #FFF;*/\n  box-sizing: border-box;\n}\n.flex-container { /* Safari */\n  display: -webkit-box;\n  display: flex; /* Safari */\n  -webkit-box-orient:  horizontal;\n  -webkit-box-direction:  normal;\n          flex-flow:  row wrap; /* Safari */\n  -webkit-box-pack: start;\n          justify-content: flex-start; /* Safari */\n  -webkit-box-align: stretch;\n          align-items: stretch;\n\n  /*min-width: 250px;*/\n}\n.flex-item {\n  margin: 5px 0px;\n  padding: 10px; /* Safari */\n  -webkit-box-flex: 1;\n          flex: 1 0 auto;\n  /*border: 1px solid #999;*/\n  box-sizing: border-box;\n  min-width: 25px;\n\n  background-color: rgba(234,201,157, 0.8);\n  background-color: rgba(240,218,189, 0.8);\n  color: #444;\n\n  /*\n  border-top: 1px solid #444;\n  border-bottom: 1px solid #444;\n  */\n\n  /*\n  background-color: rgba(70, 70, 70, 0.8);\n  color: #CCC;\n  */\n\n}\n.flex-item input, .flex-item button, .flex-item textarea, .flex-item select {\n  /*color: #555;*/\n  color: #CCC;\n}\ninput {\n  /*color: #555;*/\n  color: #CCC;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2dhbWUtY2hhcmFjdGVyLXNoZWV0L2dhbWUtY2hhcmFjdGVyLXNoZWV0LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRTs7O0dBR0M7RUFDRCxZQUFZO0VBQ1osYUFBYTtBQUNmO0FBQ0E7RUFDRSxZQUFZO0FBQ2Q7QUFFQTtFQUNFLGFBQWE7RUFDYixXQUFXO0VBQ1gsc0JBQXNCO0VBQ3RCLDRCQUE0QjtBQUM5QjtBQUNBO0VBQ0UsaUJBQWlCO0VBQ2pCLHNCQUFzQjtBQUN4QjtBQUNBO0VBQ0Usa0JBQWtCO0VBQ2xCLHFCQUFxQjtFQUNyQixtQkFBbUI7RUFDbkIsc0JBQXNCO0FBQ3hCO0FBQ0E7RUFDRSxxQkFBcUI7RUFDckIsV0FBVztFQUNYLHlCQUF5QjtFQUN6QixzQkFBc0I7QUFDeEI7QUFDQSxrQkFDeUIsV0FBVztFQUNsQyxvQkFBYTtFQUFiLGFBQWEsRUFFZ0IsV0FBVztFQUN4QywrQkFBb0I7RUFBcEIsOEJBQW9CO1VBQXBCLG9CQUFvQixFQUVpQixXQUFXO0VBQ2hELHVCQUEyQjtVQUEzQiwyQkFBMkIsRUFFRyxXQUFXO0VBQ3pDLDBCQUFvQjtVQUFwQixvQkFBb0I7O0VBRXBCLG9CQUFvQjtBQUN0QjtBQUNBO0VBQ0UsZUFBZTtFQUNmLGFBQWEsRUFDVyxXQUFXO0VBQ25DLG1CQUFjO1VBQWQsY0FBYztFQUNkLDBCQUEwQjtFQUMxQixzQkFBc0I7RUFDdEIsZUFBZTs7RUFFZix3Q0FBd0M7RUFDeEMsd0NBQXdDO0VBQ3hDLFdBQVc7O0VBRVg7OztHQUdDOztFQUVEOzs7R0FHQzs7QUFFSDtBQUNBO0VBQ0UsZUFBZTtFQUNmLFdBQVc7QUFDYjtBQUNBO0VBQ0UsZUFBZTtFQUNmLFdBQVc7QUFDYiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9nYW1lLWNoYXJhY3Rlci1zaGVldC9nYW1lLWNoYXJhY3Rlci1zaGVldC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLm1haW4taW1hZ2UtYm94IHtcbiAgLyogcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDBweDtcbiAgbGVmdDogMDtcbiAgKi9cbiAgd2lkdGg6IDI1MHB4O1xuICBoZWlnaHQ6IDI1MHB4O1xufVxuLm1haW4taW1hZ2Uge1xuICB3aWR0aDogMjUwcHg7XG59XG5cbi50YWJsZSB7XG4gIGRpc3BsYXk6dGFibGU7XG4gIHdpZHRoIDoxMDAlO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAvKmJvcmRlcjoxcHggc29saWQgI0ZGRkYwMDsqL1xufVxuLnRhYmxlLXJvdyB7XG4gIGRpc3BsYXk6dGFibGUtcm93O1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xufVxuLnRhYmxlLXJvdyA+IGRpdiB7XG4gIGRpc3BsYXk6dGFibGUtY2VsbDtcbiAgYm9yZGVyOjFweCBzb2xpZCAjRkZGO1xuICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xufVxuLmJveCB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgbWFyZ2luOiA1cHg7XG4gIC8qYm9yZGVyOjFweCBzb2xpZCAjRkZGOyovXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG59XG4uZmxleC1jb250YWluZXIge1xuICBkaXNwbGF5OiAtd2Via2l0LWZsZXg7IC8qIFNhZmFyaSAqL1xuICBkaXNwbGF5OiBmbGV4O1xuXG4gIC13ZWJraXQtZmxleC1mbG93OiByb3cgd3JhcDsgLyogU2FmYXJpICovXG4gIGZsZXgtZmxvdzogIHJvdyB3cmFwO1xuXG4gIC13ZWJraXQtanVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0OyAvKiBTYWZhcmkgKi9cbiAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0O1xuXG4gIC13ZWJraXQtYWxpZ24taXRlbXM6IHN0cmV0Y2g7IC8qIFNhZmFyaSAqL1xuICBhbGlnbi1pdGVtczogc3RyZXRjaDtcblxuICAvKm1pbi13aWR0aDogMjUwcHg7Ki9cbn1cbi5mbGV4LWl0ZW0ge1xuICBtYXJnaW46IDVweCAwcHg7XG4gIHBhZGRpbmc6IDEwcHg7XG4gIC13ZWJraXQtZmxleDogMSAwIGF1dG87IC8qIFNhZmFyaSAqL1xuICBmbGV4OiAxIDAgYXV0bztcbiAgLypib3JkZXI6IDFweCBzb2xpZCAjOTk5OyovXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIG1pbi13aWR0aDogMjVweDtcblxuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDIzNCwyMDEsMTU3LCAwLjgpO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI0MCwyMTgsMTg5LCAwLjgpO1xuICBjb2xvcjogIzQ0NDtcblxuICAvKlxuICBib3JkZXItdG9wOiAxcHggc29saWQgIzQ0NDtcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICM0NDQ7XG4gICovXG5cbiAgLypcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg3MCwgNzAsIDcwLCAwLjgpO1xuICBjb2xvcjogI0NDQztcbiAgKi9cblxufVxuLmZsZXgtaXRlbSBpbnB1dCwgLmZsZXgtaXRlbSBidXR0b24sIC5mbGV4LWl0ZW0gdGV4dGFyZWEsIC5mbGV4LWl0ZW0gc2VsZWN0IHtcbiAgLypjb2xvcjogIzU1NTsqL1xuICBjb2xvcjogI0NDQztcbn1cbmlucHV0IHtcbiAgLypjb2xvcjogIzU1NTsqL1xuICBjb2xvcjogI0NDQztcbn0iXX0= */");

/***/ }),

/***/ "./src/app/component/game-character-sheet/game-character-sheet.component.ts":
/*!**********************************************************************************!*\
  !*** ./src/app/component/game-character-sheet/game-character-sheet.component.ts ***!
  \**********************************************************************************/
/*! exports provided: GameCharacterSheetComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameCharacterSheetComponent", function() { return GameCharacterSheetComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_data_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! component/file-selecter/file-selecter.component */ "./src/app/component/file-selecter/file-selecter.component.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_save_data_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! service/save-data.service */ "./src/app/service/save-data.service.ts");









var GameCharacterSheetComponent = /** @class */ (function () {
    function GameCharacterSheetComponent(saveDataService, panelService, modalService) {
        this.saveDataService = saveDataService;
        this.panelService = panelService;
        this.modalService = modalService;
        this.tabletopObject = null;
        this.isEdit = false;
        this.networkService = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"];
    }
    GameCharacterSheetComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
            .on('DELETE_GAME_OBJECT', -1000, function (event) {
            if (_this.tabletopObject && _this.tabletopObject.identifier === event.data.identifier) {
                _this.panelService.close();
            }
        });
    };
    GameCharacterSheetComponent.prototype.ngAfterViewInit = function () {
    };
    GameCharacterSheetComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(this);
    };
    GameCharacterSheetComponent.prototype.toggleEditMode = function () {
        this.isEdit = this.isEdit ? false : true;
    };
    GameCharacterSheetComponent.prototype.addDataElement = function () {
        if (this.tabletopObject.detailDataElement) {
            var title = _udonarium_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('見出し', '', {});
            var tag = _udonarium_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('タグ', '', {});
            title.appendChild(tag);
            this.tabletopObject.detailDataElement.appendChild(title);
        }
    };
    GameCharacterSheetComponent.prototype.clone = function () {
        var cloneObject = this.tabletopObject.clone();
        cloneObject.location.x += 50;
        cloneObject.location.y += 50;
        if (this.tabletopObject.parent)
            this.tabletopObject.parent.appendChild(cloneObject);
        cloneObject.update();
        switch (this.tabletopObject.aliasName) {
            case 'terrain':
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["PresetSound"].blockPut);
                cloneObject.isLocked = false;
                break;
            case 'card':
            case 'card-stack':
                cloneObject.owner = '';
                cloneObject.toTopmost();
            case 'table-mask':
                cloneObject.isLock = false;
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["PresetSound"].cardPut);
                break;
            case 'text-note':
                cloneObject.toTopmost();
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["PresetSound"].cardPut);
                break;
            case 'dice-symbol':
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["PresetSound"].dicePut);
            default:
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_4__["PresetSound"].piecePut);
                break;
        }
    };
    GameCharacterSheetComponent.prototype.saveToXML = function () {
        if (!this.tabletopObject)
            return;
        var element = this.tabletopObject.getElement('name', this.tabletopObject.commonDataElement);
        var objectName = element ? element.value : '';
        this.saveDataService.saveGameObject(this.tabletopObject, 'xml_' + objectName);
    };
    GameCharacterSheetComponent.prototype.setLocation = function (locationName) {
        this.tabletopObject.setLocation(locationName);
    };
    GameCharacterSheetComponent.prototype.openModal = function (name, isAllowedEmpty) {
        var _this = this;
        if (name === void 0) { name = ''; }
        if (isAllowedEmpty === void 0) { isAllowedEmpty = false; }
        this.modalService.open(component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_5__["FileSelecterComponent"], { isAllowedEmpty: isAllowedEmpty }).then(function (value) {
            if (!_this.tabletopObject || !_this.tabletopObject.imageDataElement || !value)
                return;
            var element = _this.tabletopObject.imageDataElement.getFirstElementByName(name);
            if (!element)
                return;
            element.value = value;
        });
    };
    GameCharacterSheetComponent.ctorParameters = function () { return [
        { type: service_save_data_service__WEBPACK_IMPORTED_MODULE_8__["SaveDataService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_7__["PanelService"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_6__["ModalService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], GameCharacterSheetComponent.prototype, "tabletopObject", void 0);
    GameCharacterSheetComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'game-character-sheet',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./game-character-sheet.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character-sheet/game-character-sheet.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./game-character-sheet.component.css */ "./src/app/component/game-character-sheet/game-character-sheet.component.css")).default]
        })
    ], GameCharacterSheetComponent);
    return GameCharacterSheetComponent;
}());



/***/ }),

/***/ "./src/app/component/game-character/game-character.component.css":
/*!***********************************************************************!*\
  !*** ./src/app/component/game-character/game-character.component.css ***!
  \***********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".is-grab {\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n\n.is-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.is-3d {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n\n.is-transition {\n  -webkit-transition: -webkit-transform 132ms linear;\n  transition: -webkit-transform 132ms linear;\n  transition: transform 132ms linear;\n  transition: transform 132ms linear, -webkit-transform 132ms linear;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n\n.is-pointer-events-auto {\n  pointer-events: auto;\n}\n\n.component {\n  position: absolute;\n  height: 50px;\n  width: 50px;\n\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n}\n\n.component-content {\n  width: 100%;\n  height: 100%;\n}\n\n.pedestal-grab {\n  z-index: -1;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  position: absolute;\n  top: -22px;\n  left: -6px;\n  height: calc(100% + 44px);\n  width: calc(100% + 12px);\n  cursor: default;\n  border-radius: 37px;\n}\n\n.pedestal-grab-border {\n  pointer-events: none;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  border-top: solid 28px #999;\n  border-left: solid 12px #999;\n  border-right: solid 12px #CCC;\n  border-bottom: solid 28px #CCC;\n  border-radius: 37px;\n}\n\n.pedestal-inner {\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n  border: solid 6px #FFCC80;\n  border-radius: 25px;\n}\n\n.pedestal-outer {\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n  border: solid 2px #212121;\n  border-radius: 25px;\n}\n\n.upright-transform {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  -webkit-transform: rotateX(-90deg) translateY(-50%);\n          transform: rotateX(-90deg) translateY(-50%);\n}\n\n.is-fit-width {\n  height: auto;\n  width: 100%;\n}\n\n.fill-frame {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n\n.image {\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n\n  width: 100%;\n  height: auto;\n  vertical-align: bottom;\n}\n\n.name-tag {\n  box-sizing: border-box;\n  font-size: 15px;\n  padding: 3px 9px;\n  border-radius: 24px;\n  position: absolute;\n  top: -30px;\n}\n\n.rotate-frame {\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n\n.rotate-inner {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n\n  width: 100%;\n  height: auto;\n}\n\n.is-nowrap {\n  white-space: nowrap;\n}\n\n.is-black-background {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n\n.fornt-tag {\n -webkit-backface-visibility: hidden;\n         backface-visibility: hidden;\n}\n\n.back-tag {\n  position: absolute;\n  top: 3px;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  -webkit-transform: rotateY(-180deg);\n          transform: rotateY(-180deg);\n}\n\n.has-length-limit {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  max-width: 24em;\n}\n\n.rotate-grab-icon {\n  position: absolute;\n  width: 28px;\n  height: 28px;\n  box-sizing: border-box;\n  cursor: -moz-default;\n  cursor: -webkit-default;\n  cursor: default;\n  z-index: 1;\n  padding: 2px;\n  background-color: #CCCCCC;\n  border-radius: 100%;\n  color: #444;\n  font-size: 8px;\n}\n\n.of-top {\n  top: -42px;\n}\n\n.of-bottom {\n  bottom: -30px;\n}\n\n.of-front {\n  position: absolute;\n  width: 24px;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  margin: auto;\n  color: #444;\n}\n\n.of-back {\n  position: absolute;\n  width: 24px;\n  top: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n  color: #444;\n}\n\n.rotate-grab {\n  opacity: 0;\n}\n\n.component:hover .rotate-grab {\n  opacity: 0.5;\n}\n\n.component:active .rotate-grab {\n  opacity: 0;\n}\n\n.component .rotate-grab:hover, .component .rotate-grab:active {\n  opacity: 1;\n}\n\n.material-icons {\n  display: none;\n}\n\n.component:hover .material-icons, .component:active .material-icons {\n  display: inline;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2dhbWUtY2hhcmFjdGVyL2dhbWUtY2hhcmFjdGVyLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFRSxvQkFBb0I7RUFDcEIsWUFBWTtBQUNkOztBQUVBO0VBRUUsd0JBQXdCO0VBQ3hCLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLG9DQUFvQztFQUNwQyw0QkFBNEI7QUFDOUI7O0FBRUE7RUFDRSxrREFBa0Q7RUFDbEQsMENBQWtDO0VBQWxDLGtDQUFrQztFQUFsQyxrRUFBa0M7QUFDcEM7O0FBRUE7RUFDRSxvQkFBb0I7QUFDdEI7O0FBRUE7RUFDRSxvQkFBb0I7QUFDdEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsWUFBWTtFQUNaLFdBQVc7O0VBRVgsc0JBQXNCO0VBQ3RCLHlCQUF5QjtFQUN6QixxQkFBaUI7TUFBakIsaUJBQWlCO0VBQ2pCLG9CQUFvQjtFQUNwQix1QkFBdUI7QUFDekI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsWUFBWTtBQUNkOztBQUVBO0VBQ0UsV0FBVztFQUNYLG1DQUEyQjtVQUEzQiwyQkFBMkI7RUFDM0Isa0JBQWtCO0VBQ2xCLFVBQVU7RUFDVixVQUFVO0VBQ1YseUJBQXlCO0VBQ3pCLHdCQUF3QjtFQUN4QixlQUFlO0VBQ2YsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0Usb0JBQW9CO0VBQ3BCLFdBQVc7RUFDWCxZQUFZO0VBQ1osc0JBQXNCO0VBQ3RCLDJCQUEyQjtFQUMzQiw0QkFBNEI7RUFDNUIsNkJBQTZCO0VBQzdCLDhCQUE4QjtFQUM5QixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxtQ0FBMkI7VUFBM0IsMkJBQTJCO0VBQzNCLGtCQUFrQjtFQUNsQixZQUFZO0VBQ1osV0FBVztFQUNYLHNCQUFzQjtFQUN0Qix5QkFBeUI7RUFDekIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsbUNBQTJCO1VBQTNCLDJCQUEyQjtFQUMzQixrQkFBa0I7RUFDbEIsWUFBWTtFQUNaLFdBQVc7RUFDWCxzQkFBc0I7RUFDdEIseUJBQXlCO0VBQ3pCLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsT0FBTztFQUNQLFFBQVE7RUFDUixtREFBMkM7VUFBM0MsMkNBQTJDO0FBQzdDOztBQUVBO0VBQ0UsWUFBWTtFQUNaLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsT0FBTztFQUNQLFFBQVE7QUFDVjs7QUFFQTtFQUNFLFNBQVM7RUFDVCxPQUFPO0VBQ1AsUUFBUTtFQUNSLFlBQVk7O0VBRVosV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsZUFBZTtFQUNmLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsa0JBQWtCO0VBQ2xCLFVBQVU7QUFDWjs7QUFFQTtFQUNFLFNBQVM7RUFDVCxPQUFPO0VBQ1AsUUFBUTtBQUNWOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFNBQVM7RUFDVCxPQUFPO0VBQ1AsUUFBUTs7RUFFUixXQUFXO0VBQ1gsWUFBWTtBQUNkOztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsV0FBVztFQUNYLHVDQUF1QztBQUN6Qzs7QUFFQTtDQUNDLG1DQUEyQjtTQUEzQiwyQkFBMkI7QUFDNUI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsUUFBUTtFQUNSLG1DQUEyQjtVQUEzQiwyQkFBMkI7RUFDM0IsbUNBQTJCO1VBQTNCLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsdUJBQXVCO0VBQ3ZCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsb0JBQW9CO0VBQ3BCLHVCQUF1QjtFQUN2QixlQUFlO0VBQ2YsVUFBVTtFQUNWLFlBQVk7RUFDWix5QkFBeUI7RUFDekIsbUJBQW1CO0VBQ25CLFdBQVc7RUFDWCxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsVUFBVTtBQUNaOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFdBQVc7RUFDWCxPQUFPO0VBQ1AsUUFBUTtFQUNSLFNBQVM7RUFDVCxZQUFZO0VBQ1osV0FBVztBQUNiOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFdBQVc7RUFDWCxNQUFNO0VBQ04sT0FBTztFQUNQLFFBQVE7RUFDUixZQUFZO0VBQ1osV0FBVztBQUNiOztBQUVBO0VBQ0UsVUFBVTtBQUNaOztBQUVBO0VBQ0UsWUFBWTtBQUNkOztBQUVBO0VBQ0UsVUFBVTtBQUNaOztBQUVBO0VBQ0UsVUFBVTtBQUNaOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsZUFBZTtBQUNqQiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9nYW1lLWNoYXJhY3Rlci9nYW1lLWNoYXJhY3Rlci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmlzLWdyYWIge1xuICBjdXJzb3I6IC1tb3otZ3JhYjtcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWI7XG4gIGN1cnNvcjogZ3JhYjtcbn1cblxuLmlzLWdyYWJiaW5nIHtcbiAgY3Vyc29yOiAtbW96LWdyYWJiaW5nO1xuICBjdXJzb3I6IC13ZWJraXQtZ3JhYmJpbmc7XG4gIGN1cnNvcjogZ3JhYmJpbmc7XG59XG5cbi5pcy0zZCB7XG4gIC13ZWJraXQtdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDtcbiAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDtcbn1cblxuLmlzLXRyYW5zaXRpb24ge1xuICAtd2Via2l0LXRyYW5zaXRpb246IC13ZWJraXQtdHJhbnNmb3JtIDEzMm1zIGxpbmVhcjtcbiAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDEzMm1zIGxpbmVhcjtcbn1cblxuLmlzLXBvaW50ZXItZXZlbnRzLW5vbmUge1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbn1cblxuLmlzLXBvaW50ZXItZXZlbnRzLWF1dG8ge1xuICBwb2ludGVyLWV2ZW50czogYXV0bztcbn1cblxuLmNvbXBvbmVudCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgaGVpZ2h0OiA1MHB4O1xuICB3aWR0aDogNTBweDtcblxuICAtbW96LXVzZXItc2VsZWN0OiBub25lO1xuICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lO1xuICB1c2VyLXNlbGVjdDogbm9uZTtcbiAgLW1vei11c2VyLWRyYWc6IG5vbmU7XG4gIC13ZWJraXQtdXNlci1kcmFnOiBub25lO1xufVxuXG4uY29tcG9uZW50LWNvbnRlbnQge1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xufVxuXG4ucGVkZXN0YWwtZ3JhYiB7XG4gIHotaW5kZXg6IC0xO1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAtMjJweDtcbiAgbGVmdDogLTZweDtcbiAgaGVpZ2h0OiBjYWxjKDEwMCUgKyA0NHB4KTtcbiAgd2lkdGg6IGNhbGMoMTAwJSArIDEycHgpO1xuICBjdXJzb3I6IGRlZmF1bHQ7XG4gIGJvcmRlci1yYWRpdXM6IDM3cHg7XG59XG5cbi5wZWRlc3RhbC1ncmFiLWJvcmRlciB7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBib3JkZXItdG9wOiBzb2xpZCAyOHB4ICM5OTk7XG4gIGJvcmRlci1sZWZ0OiBzb2xpZCAxMnB4ICM5OTk7XG4gIGJvcmRlci1yaWdodDogc29saWQgMTJweCAjQ0NDO1xuICBib3JkZXItYm90dG9tOiBzb2xpZCAyOHB4ICNDQ0M7XG4gIGJvcmRlci1yYWRpdXM6IDM3cHg7XG59XG5cbi5wZWRlc3RhbC1pbm5lciB7XG4gIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHdpZHRoOiAxMDAlO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBib3JkZXI6IHNvbGlkIDZweCAjRkZDQzgwO1xuICBib3JkZXItcmFkaXVzOiAyNXB4O1xufVxuXG4ucGVkZXN0YWwtb3V0ZXIge1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCAycHggIzIxMjEyMTtcbiAgYm9yZGVyLXJhZGl1czogMjVweDtcbn1cblxuLnVwcmlnaHQtdHJhbnNmb3JtIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBib3R0b206IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICB0cmFuc2Zvcm06IHJvdGF0ZVgoLTkwZGVnKSB0cmFuc2xhdGVZKC01MCUpO1xufVxuXG4uaXMtZml0LXdpZHRoIHtcbiAgaGVpZ2h0OiBhdXRvO1xuICB3aWR0aDogMTAwJTtcbn1cblxuLmZpbGwtZnJhbWUge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG59XG5cbi5pbWFnZSB7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIG1hcmdpbjogYXV0bztcblxuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiBhdXRvO1xuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xufVxuXG4ubmFtZS10YWcge1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBmb250LXNpemU6IDE1cHg7XG4gIHBhZGRpbmc6IDNweCA5cHg7XG4gIGJvcmRlci1yYWRpdXM6IDI0cHg7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAtMzBweDtcbn1cblxuLnJvdGF0ZS1mcmFtZSB7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG59XG5cbi5yb3RhdGUtaW5uZXIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG5cbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogYXV0bztcbn1cblxuLmlzLW5vd3JhcCB7XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG5cbi5pcy1ibGFjay1iYWNrZ3JvdW5kIHtcbiAgY29sb3I6ICNDQ0M7XG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMzAsIDMwLCAzMCwgMC44KTtcbn1cblxuLmZvcm50LXRhZyB7XG4gYmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuO1xufVxuXG4uYmFjay10YWcge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogM3B4O1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG4gIHRyYW5zZm9ybTogcm90YXRlWSgtMTgwZGVnKTtcbn1cblxuLmhhcy1sZW5ndGgtbGltaXQge1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgbWF4LXdpZHRoOiAyNGVtO1xufVxuXG4ucm90YXRlLWdyYWItaWNvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDI4cHg7XG4gIGhlaWdodDogMjhweDtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgY3Vyc29yOiAtbW96LWRlZmF1bHQ7XG4gIGN1cnNvcjogLXdlYmtpdC1kZWZhdWx0O1xuICBjdXJzb3I6IGRlZmF1bHQ7XG4gIHotaW5kZXg6IDE7XG4gIHBhZGRpbmc6IDJweDtcbiAgYmFja2dyb3VuZC1jb2xvcjogI0NDQ0NDQztcbiAgYm9yZGVyLXJhZGl1czogMTAwJTtcbiAgY29sb3I6ICM0NDQ7XG4gIGZvbnQtc2l6ZTogOHB4O1xufVxuXG4ub2YtdG9wIHtcbiAgdG9wOiAtNDJweDtcbn1cblxuLm9mLWJvdHRvbSB7XG4gIGJvdHRvbTogLTMwcHg7XG59XG5cbi5vZi1mcm9udCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDI0cHg7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG4gIG1hcmdpbjogYXV0bztcbiAgY29sb3I6ICM0NDQ7XG59XG5cbi5vZi1iYWNrIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB3aWR0aDogMjRweDtcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgbWFyZ2luOiBhdXRvO1xuICBjb2xvcjogIzQ0NDtcbn1cblxuLnJvdGF0ZS1ncmFiIHtcbiAgb3BhY2l0eTogMDtcbn1cblxuLmNvbXBvbmVudDpob3ZlciAucm90YXRlLWdyYWIge1xuICBvcGFjaXR5OiAwLjU7XG59XG5cbi5jb21wb25lbnQ6YWN0aXZlIC5yb3RhdGUtZ3JhYiB7XG4gIG9wYWNpdHk6IDA7XG59XG5cbi5jb21wb25lbnQgLnJvdGF0ZS1ncmFiOmhvdmVyLCAuY29tcG9uZW50IC5yb3RhdGUtZ3JhYjphY3RpdmUge1xuICBvcGFjaXR5OiAxO1xufVxuXG4ubWF0ZXJpYWwtaWNvbnMge1xuICBkaXNwbGF5OiBub25lO1xufVxuXG4uY29tcG9uZW50OmhvdmVyIC5tYXRlcmlhbC1pY29ucywgLmNvbXBvbmVudDphY3RpdmUgLm1hdGVyaWFsLWljb25zIHtcbiAgZGlzcGxheTogaW5saW5lO1xufVxuIl19 */");

/***/ }),

/***/ "./src/app/component/game-character/game-character.component.ts":
/*!**********************************************************************!*\
  !*** ./src/app/component/game-character/game-character.component.ts ***!
  \**********************************************************************/
/*! exports provided: GameCharacterComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameCharacterComponent", function() { return GameCharacterComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/animations */ "./node_modules/@angular/animations/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_chat_palette_chat_palette_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! component/chat-palette/chat-palette.component */ "./src/app/component/chat-palette/chat-palette.component.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");












var GameCharacterComponent = /** @class */ (function () {
    function GameCharacterComponent(contextMenuService, panelService, changeDetector, pointerDeviceService) {
        this.contextMenuService = contextMenuService;
        this.panelService = panelService;
        this.changeDetector = changeDetector;
        this.pointerDeviceService = pointerDeviceService;
        this.gameCharacter = null;
        this.is3D = false;
        this.gridSize = 50;
        this.movableOption = {};
        this.rotableOption = {};
    }
    Object.defineProperty(GameCharacterComponent.prototype, "name", {
        get: function () { return this.gameCharacter.name; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameCharacterComponent.prototype, "size", {
        get: function () { return this.adjustMinBounds(this.gameCharacter.size); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameCharacterComponent.prototype, "imageFile", {
        get: function () { return this.gameCharacter.imageFile; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameCharacterComponent.prototype, "rotate", {
        get: function () { return this.gameCharacter.rotate; },
        set: function (rotate) { this.gameCharacter.rotate = rotate; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameCharacterComponent.prototype, "roll", {
        get: function () { return this.gameCharacter.roll; },
        set: function (roll) { this.gameCharacter.roll = roll; },
        enumerable: true,
        configurable: true
    });
    GameCharacterComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.gameCharacter || !object)
                return;
            if (_this.gameCharacter === object || (object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__["ObjectNode"] && _this.gameCharacter.contains(object))) {
                _this.changeDetector.markForCheck();
            }
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('UPDATE_FILE_RESOURE', -1000, function (event) {
            _this.changeDetector.markForCheck();
        });
        this.movableOption = {
            tabletopObject: this.gameCharacter,
            transformCssOffset: 'translateZ(1.0px)',
            colideLayers: ['terrain']
        };
        this.rotableOption = {
            tabletopObject: this.gameCharacter
        };
    };
    GameCharacterComponent.prototype.ngAfterViewInit = function () { };
    GameCharacterComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].unregister(this);
    };
    GameCharacterComponent.prototype.onDragstart = function (e) {
        console.log('Dragstart Cancel !!!!');
        e.stopPropagation();
        e.preventDefault();
    };
    GameCharacterComponent.prototype.onContextMenu = function (e) {
        var _this = this;
        e.stopPropagation();
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        var position = this.pointerDeviceService.pointers[0];
        this.contextMenuService.open(position, [
            { name: '詳細を表示', action: function () { _this.showDetail(_this.gameCharacter); } },
            { name: 'チャットパレットを表示', action: function () { _this.showChatPalette(_this.gameCharacter); } },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuSeparator"],
            {
                name: '共有イベントリに移動', action: function () {
                    _this.gameCharacter.setLocation('common');
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["PresetSound"].piecePut);
                }
            },
            {
                name: '個人イベントリに移動', action: function () {
                    _this.gameCharacter.setLocation(_udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__["Network"].peerId);
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["PresetSound"].piecePut);
                }
            },
            {
                name: '墓場に移動', action: function () {
                    _this.gameCharacter.setLocation('graveyard');
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["PresetSound"].sweep);
                }
            },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuSeparator"],
            {
                name: 'コピーを作る', action: function () {
                    var cloneObject = _this.gameCharacter.clone();
                    cloneObject.location.x += _this.gridSize;
                    cloneObject.location.y += _this.gridSize;
                    cloneObject.update();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["PresetSound"].piecePut);
                }
            },
        ], this.name);
    };
    GameCharacterComponent.prototype.onMove = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["PresetSound"].piecePick);
    };
    GameCharacterComponent.prototype.onMoved = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_6__["PresetSound"].piecePut);
    };
    GameCharacterComponent.prototype.adjustMinBounds = function (value, min) {
        if (min === void 0) { min = 0; }
        return value < min ? min : value;
    };
    GameCharacterComponent.prototype.showDetail = function (gameObject) {
        var coordinate = this.pointerDeviceService.pointers[0];
        var title = 'キャラクターシート';
        if (gameObject.name.length)
            title += ' - ' + gameObject.name;
        var option = { title: title, left: coordinate.x - 400, top: coordinate.y - 300, width: 800, height: 600 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_8__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    GameCharacterComponent.prototype.showChatPalette = function (gameObject) {
        var coordinate = this.pointerDeviceService.pointers[0];
        var option = { left: coordinate.x - 250, top: coordinate.y - 175, width: 615, height: 350 };
        var component = this.panelService.open(component_chat_palette_chat_palette_component__WEBPACK_IMPORTED_MODULE_7__["ChatPaletteComponent"], option);
        component.character = gameObject;
    };
    GameCharacterComponent.ctorParameters = function () { return [
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_10__["PanelService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectorRef"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_11__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], GameCharacterComponent.prototype, "gameCharacter", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], GameCharacterComponent.prototype, "is3D", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["HostListener"])('dragstart', ['$event'])
    ], GameCharacterComponent.prototype, "onDragstart", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["HostListener"])('contextmenu', ['$event'])
    ], GameCharacterComponent.prototype, "onContextMenu", null);
    GameCharacterComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
            selector: 'game-character',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./game-character.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-character/game-character.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectionStrategy"].OnPush,
            animations: [
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('bounceInOut', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('void => *', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('600ms ease', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0, 0, 0)', offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.5, 1.5, 1.5)', offset: 0.5 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0.75, 0.75, 0.75)', offset: 0.75 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.125, 1.125, 1.125)', offset: 0.875 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(1.0, 1.0, 1.0)', offset: 1.0 })
                        ]))
                    ]),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => void', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])(100, Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale3d(0, 0, 0)' }))
                    ])
                ])
            ],
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./game-character.component.css */ "./src/app/component/game-character/game-character.component.css")).default]
        })
    ], GameCharacterComponent);
    return GameCharacterComponent;
}());



/***/ }),

/***/ "./src/app/component/game-data-element/game-data-element.component.css":
/*!*****************************************************************************!*\
  !*** ./src/app/component/game-data-element/game-data-element.component.css ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".game-data-element{\n  margin-left: 10px;\n}\n.table {\n  display:table; \n  /*padding-left: 10px;*/\n  /*border:1px solid #FF0000;*/\n  width :100%;\n  box-sizing: border-box;\n\n}\n.table-row {\n  padding-top: 10px;\n  display:table-row;\n  /*border:5px solid #00FF00;*/\n  /*border-bottom:1px dotted #888;*/\n  /*width :100%;*/\n  box-sizing: border-box;\n  }\n.table-cell {\n  display:table-cell;\n  vertical-align: bottom;\n  padding: 0.5em 0.0em 0.1em 0.5em;\n  /*border:1px solid #0000FF;*/\n  border-bottom:1px dotted #888;\n  box-sizing: border-box;\n}\n.table-cell_solid {\n  width :10px;\n  white-space: nowrap;\n}\n.table-cell_inner-table {\n  display:table-cell;\n  vertical-align: bottom;\n  padding: 0.2em 0.0em 0.1em 0.5em;\n  border: none;\n  /*border-bottom:1px solid #0ff;*/\n  box-sizing: border-box;\n}\n.table-cell_inner-table-title {\n  border-bottom: 1px solid #444;\n  border-left: 8px solid #444;\n  padding-left:8px;\n}\n.box {\n  display: inline-block;\n  margin: 10px;\n  /*border:1px solid #FFF;*/\n}\n.hidden-spacer {\n  visibility: hidden;\n  height: 0;\n  /*background: #0FF;*/\n  max-width : 20em;\n  overflow: hidden;\n  padding: 0 3px;\n  box-sizing: border-box;\n}\ninput, button, textarea, select{\n/*.input {*/\n  background: none;\n  border: none;\n  border-radius: 2px;\n  outline: none;\n\n  color: #444;\n  font-family: Cambria, Georgia;\n  font-size: 1.0em;\n  padding: 2px;\n  box-sizing: border-box;\n}\ninput:hover, textarea:hover, select:hover  {\n  background: #EEE;\n}\ninput:focus, textarea:focus, select:focus  {\n  background: #FFF;\n}\nbutton i {\n  font-size: 1.0rem;\n}\nbutton:hover  {\n  background: #444;\n  color: #CCC;\n}\n.table-cell button{\n  font-size: 0.5rem;\n}\ninput[type='range'] {\n  --slider-track-color: transparent; /* #ccc */\n  --slider-fill-color: #555; /*#777 */\n  --slider-border-color: #777;\n  --slider-height: 0.8em;\n  --slider-thumb-size: 1.0em;\n  --range: calc(var(--max) - var(--min));\n  --ratio: calc((var(--val) - var(--min))/var(--range));\n  --sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));\n  margin: 0;\n  padding: 0;\n  background: transparent;\n  font: 1em/1 arial, sans-serif;\n  outline: 0;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n}\ninput[type='range'], input[type='range']::-webkit-slider-thumb {\n  -webkit-appearance: none;\n}\ninput[type='range']::-webkit-slider-runnable-track {\n  box-sizing: border-box;\n  border-top: solid 1px var(--slider-border-color);\n  border-bottom: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\ninput[type='range']::-webkit-slider-runnable-track {\n  background: -webkit-gradient(linear, left top, left bottom, from(var(--slider-fill-color)), to(var(--slider-fill-color))) 0/var(--sx) 100% no-repeat var(--slider-track-color);\n  background: linear-gradient(var(--slider-fill-color), var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);\n  cursor: pointer;\n}\ninput[type='range']::-moz-range-track {\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\ninput[type='range']::-ms-track {\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\ninput[type='range']::-moz-range-progress {\n  height: var(--slider-height);\n  background: var(--slider-fill-color);\n  border-radius: var(--slider-height);\n}\ninput[type='range']::-ms-fill-lower {\n  height: var(--slider-height);\n  background: var(--slider-fill-color);\n  border-radius: var(--slider-height);\n}\ninput[type='range']::-webkit-slider-thumb {\n  margin-top: calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px  var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\ninput[type='range']::-moz-range-thumb {\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px  var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\ninput[type='range']::-ms-thumb {\n  margin-top: 0;\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px  var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\ninput[type='range']::-ms-tooltip {\n  display: none;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2dhbWUtZGF0YS1lbGVtZW50L2dhbWUtZGF0YS1lbGVtZW50LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxpQkFBaUI7QUFDbkI7QUFDQTtFQUNFLGFBQWE7RUFDYixzQkFBc0I7RUFDdEIsNEJBQTRCO0VBQzVCLFdBQVc7RUFDWCxzQkFBc0I7O0FBRXhCO0FBQ0E7RUFDRSxpQkFBaUI7RUFDakIsaUJBQWlCO0VBQ2pCLDRCQUE0QjtFQUM1QixpQ0FBaUM7RUFDakMsZUFBZTtFQUNmLHNCQUFzQjtFQUN0QjtBQUNGO0VBQ0Usa0JBQWtCO0VBQ2xCLHNCQUFzQjtFQUN0QixnQ0FBZ0M7RUFDaEMsNEJBQTRCO0VBQzVCLDZCQUE2QjtFQUM3QixzQkFBc0I7QUFDeEI7QUFDQTtFQUNFLFdBQVc7RUFDWCxtQkFBbUI7QUFDckI7QUFDQTtFQUNFLGtCQUFrQjtFQUNsQixzQkFBc0I7RUFDdEIsZ0NBQWdDO0VBQ2hDLFlBQVk7RUFDWixnQ0FBZ0M7RUFDaEMsc0JBQXNCO0FBQ3hCO0FBQ0E7RUFDRSw2QkFBNkI7RUFDN0IsMkJBQTJCO0VBQzNCLGdCQUFnQjtBQUNsQjtBQUNBO0VBQ0UscUJBQXFCO0VBQ3JCLFlBQVk7RUFDWix5QkFBeUI7QUFDM0I7QUFDQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1Qsb0JBQW9CO0VBQ3BCLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsY0FBYztFQUNkLHNCQUFzQjtBQUN4QjtBQUVBO0FBQ0EsV0FBVztFQUNULGdCQUFnQjtFQUNoQixZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLGFBQWE7O0VBRWIsV0FBVztFQUNYLDZCQUE2QjtFQUM3QixnQkFBZ0I7RUFDaEIsWUFBWTtFQUNaLHNCQUFzQjtBQUN4QjtBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCO0FBQ0E7RUFDRSxnQkFBZ0I7QUFDbEI7QUFDQTtFQUNFLGlCQUFpQjtBQUNuQjtBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFdBQVc7QUFDYjtBQUVBO0VBQ0UsaUJBQWlCO0FBQ25CO0FBRUE7RUFDRSxpQ0FBaUMsRUFBRSxTQUFTO0VBQzVDLHlCQUF5QixFQUFFLFFBQVE7RUFDbkMsMkJBQTJCO0VBQzNCLHNCQUFzQjtFQUN0QiwwQkFBMEI7RUFDMUIsc0NBQXNDO0VBQ3RDLHFEQUFxRDtFQUNyRCx3RkFBd0Y7RUFDeEYsU0FBUztFQUNULFVBQVU7RUFDVix1QkFBdUI7RUFDdkIsNkJBQTZCO0VBQzdCLFVBQVU7RUFDVix3QkFBZ0I7S0FBaEIscUJBQWdCO1VBQWhCLGdCQUFnQjtBQUNsQjtBQUVBO0VBQ0Usd0JBQXdCO0FBQzFCO0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsZ0RBQWdEO0VBQ2hELG1EQUFtRDtFQUNuRCxtQ0FBbUM7RUFDbkMsNEJBQTRCO0VBQzVCLHFDQUFxQztBQUN2QztBQUVBO0VBQ0UsOEtBQW9JO0VBQXBJLG9JQUFvSTtFQUNwSSxlQUFlO0FBQ2pCO0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsNENBQTRDO0VBQzVDLG1DQUFtQztFQUNuQyw0QkFBNEI7RUFDNUIscUNBQXFDO0FBQ3ZDO0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsNENBQTRDO0VBQzVDLG1DQUFtQztFQUNuQyw0QkFBNEI7RUFDNUIscUNBQXFDO0FBQ3ZDO0FBRUE7RUFDRSw0QkFBNEI7RUFDNUIsb0NBQW9DO0VBQ3BDLG1DQUFtQztBQUNyQztBQUVBO0VBQ0UsNEJBQTRCO0VBQzVCLG9DQUFvQztFQUNwQyxtQ0FBbUM7QUFDckM7QUFFQTtFQUNFLDZFQUE2RTtFQUM3RSwrQkFBK0I7RUFDL0IsZ0NBQWdDO0VBQ2hDLHNCQUFzQjtFQUN0Qiw2Q0FBNkM7RUFDN0Msa0JBQWtCO0VBQ2xCLGdCQUFnQjtFQUNoQixlQUFlO0FBQ2pCO0FBRUE7RUFDRSwrQkFBK0I7RUFDL0IsZ0NBQWdDO0VBQ2hDLHNCQUFzQjtFQUN0Qiw2Q0FBNkM7RUFDN0Msa0JBQWtCO0VBQ2xCLGdCQUFnQjtFQUNoQixlQUFlO0FBQ2pCO0FBRUE7RUFDRSxhQUFhO0VBQ2IsK0JBQStCO0VBQy9CLGdDQUFnQztFQUNoQyxzQkFBc0I7RUFDdEIsNkNBQTZDO0VBQzdDLGtCQUFrQjtFQUNsQixnQkFBZ0I7RUFDaEIsZUFBZTtBQUNqQjtBQUVBO0VBQ0UsYUFBYTtBQUNmIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2dhbWUtZGF0YS1lbGVtZW50L2dhbWUtZGF0YS1lbGVtZW50LmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuZ2FtZS1kYXRhLWVsZW1lbnR7XG4gIG1hcmdpbi1sZWZ0OiAxMHB4O1xufVxuLnRhYmxlIHtcbiAgZGlzcGxheTp0YWJsZTsgXG4gIC8qcGFkZGluZy1sZWZ0OiAxMHB4OyovXG4gIC8qYm9yZGVyOjFweCBzb2xpZCAjRkYwMDAwOyovXG4gIHdpZHRoIDoxMDAlO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuXG59XG4udGFibGUtcm93IHtcbiAgcGFkZGluZy10b3A6IDEwcHg7XG4gIGRpc3BsYXk6dGFibGUtcm93O1xuICAvKmJvcmRlcjo1cHggc29saWQgIzAwRkYwMDsqL1xuICAvKmJvcmRlci1ib3R0b206MXB4IGRvdHRlZCAjODg4OyovXG4gIC8qd2lkdGggOjEwMCU7Ki9cbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgfVxuLnRhYmxlLWNlbGwge1xuICBkaXNwbGF5OnRhYmxlLWNlbGw7XG4gIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG4gIHBhZGRpbmc6IDAuNWVtIDAuMGVtIDAuMWVtIDAuNWVtO1xuICAvKmJvcmRlcjoxcHggc29saWQgIzAwMDBGRjsqL1xuICBib3JkZXItYm90dG9tOjFweCBkb3R0ZWQgIzg4ODtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbn1cbi50YWJsZS1jZWxsX3NvbGlkIHtcbiAgd2lkdGggOjEwcHg7XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG4udGFibGUtY2VsbF9pbm5lci10YWJsZSB7XG4gIGRpc3BsYXk6dGFibGUtY2VsbDtcbiAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbiAgcGFkZGluZzogMC4yZW0gMC4wZW0gMC4xZW0gMC41ZW07XG4gIGJvcmRlcjogbm9uZTtcbiAgLypib3JkZXItYm90dG9tOjFweCBzb2xpZCAjMGZmOyovXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG59XG4udGFibGUtY2VsbF9pbm5lci10YWJsZS10aXRsZSB7XG4gIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjNDQ0O1xuICBib3JkZXItbGVmdDogOHB4IHNvbGlkICM0NDQ7XG4gIHBhZGRpbmctbGVmdDo4cHg7XG59XG4uYm94IHtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICBtYXJnaW46IDEwcHg7XG4gIC8qYm9yZGVyOjFweCBzb2xpZCAjRkZGOyovXG59XG4uaGlkZGVuLXNwYWNlciB7XG4gIHZpc2liaWxpdHk6IGhpZGRlbjtcbiAgaGVpZ2h0OiAwO1xuICAvKmJhY2tncm91bmQ6ICMwRkY7Ki9cbiAgbWF4LXdpZHRoIDogMjBlbTtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgcGFkZGluZzogMCAzcHg7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG59XG5cbmlucHV0LCBidXR0b24sIHRleHRhcmVhLCBzZWxlY3R7XG4vKi5pbnB1dCB7Ki9cbiAgYmFja2dyb3VuZDogbm9uZTtcbiAgYm9yZGVyOiBub25lO1xuICBib3JkZXItcmFkaXVzOiAycHg7XG4gIG91dGxpbmU6IG5vbmU7XG5cbiAgY29sb3I6ICM0NDQ7XG4gIGZvbnQtZmFtaWx5OiBDYW1icmlhLCBHZW9yZ2lhO1xuICBmb250LXNpemU6IDEuMGVtO1xuICBwYWRkaW5nOiAycHg7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG59XG5cbmlucHV0OmhvdmVyLCB0ZXh0YXJlYTpob3Zlciwgc2VsZWN0OmhvdmVyICB7XG4gIGJhY2tncm91bmQ6ICNFRUU7XG59XG5pbnB1dDpmb2N1cywgdGV4dGFyZWE6Zm9jdXMsIHNlbGVjdDpmb2N1cyAge1xuICBiYWNrZ3JvdW5kOiAjRkZGO1xufVxuYnV0dG9uIGkge1xuICBmb250LXNpemU6IDEuMHJlbTtcbn1cblxuYnV0dG9uOmhvdmVyICB7XG4gIGJhY2tncm91bmQ6ICM0NDQ7XG4gIGNvbG9yOiAjQ0NDO1xufVxuXG4udGFibGUtY2VsbCBidXR0b257XG4gIGZvbnQtc2l6ZTogMC41cmVtO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddIHtcbiAgLS1zbGlkZXItdHJhY2stY29sb3I6IHRyYW5zcGFyZW50OyAvKiAjY2NjICovXG4gIC0tc2xpZGVyLWZpbGwtY29sb3I6ICM1NTU7IC8qIzc3NyAqL1xuICAtLXNsaWRlci1ib3JkZXItY29sb3I6ICM3Nzc7XG4gIC0tc2xpZGVyLWhlaWdodDogMC44ZW07XG4gIC0tc2xpZGVyLXRodW1iLXNpemU6IDEuMGVtO1xuICAtLXJhbmdlOiBjYWxjKHZhcigtLW1heCkgLSB2YXIoLS1taW4pKTtcbiAgLS1yYXRpbzogY2FsYygodmFyKC0tdmFsKSAtIHZhcigtLW1pbikpL3ZhcigtLXJhbmdlKSk7XG4gIC0tc3g6IGNhbGMoLjUqdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpICsgdmFyKC0tcmF0aW8pKigxMDAlIC0gdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpKSk7XG4gIG1hcmdpbjogMDtcbiAgcGFkZGluZzogMDtcbiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gIGZvbnQ6IDFlbS8xIGFyaWFsLCBzYW5zLXNlcmlmO1xuICBvdXRsaW5lOiAwO1xuICBhcHBlYXJhbmNlOiBub25lO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddLCBpbnB1dFt0eXBlPSdyYW5nZSddOjotd2Via2l0LXNsaWRlci10aHVtYiB7XG4gIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LXdlYmtpdC1zbGlkZXItcnVubmFibGUtdHJhY2sge1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBib3JkZXItdG9wOiBzb2xpZCAxcHggdmFyKC0tc2xpZGVyLWJvcmRlci1jb2xvcik7XG4gIGJvcmRlci1ib3R0b206IHNvbGlkIDFweCB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLXJhZGl1czogdmFyKC0tc2xpZGVyLWhlaWdodCk7XG4gIGhlaWdodDogdmFyKC0tc2xpZGVyLWhlaWdodCk7XG4gIGJhY2tncm91bmQ6IHZhcigtLXNsaWRlci10cmFjay1jb2xvcik7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi13ZWJraXQtc2xpZGVyLXJ1bm5hYmxlLXRyYWNrIHtcbiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KHZhcigtLXNsaWRlci1maWxsLWNvbG9yKSwgdmFyKC0tc2xpZGVyLWZpbGwtY29sb3IpKSAwL3ZhcigtLXN4KSAxMDAlIG5vLXJlcGVhdCB2YXIoLS1zbGlkZXItdHJhY2stY29sb3IpO1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi1tb3otcmFuZ2UtdHJhY2sge1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBib3JkZXI6IHNvbGlkIDFweCB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLXJhZGl1czogdmFyKC0tc2xpZGVyLWhlaWdodCk7XG4gIGhlaWdodDogdmFyKC0tc2xpZGVyLWhlaWdodCk7XG4gIGJhY2tncm91bmQ6IHZhcigtLXNsaWRlci10cmFjay1jb2xvcik7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi1tcy10cmFjayB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlcjogc29saWQgMXB4IHZhcigtLXNsaWRlci1ib3JkZXItY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgYmFja2dyb3VuZDogdmFyKC0tc2xpZGVyLXRyYWNrLWNvbG9yKTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1vei1yYW5nZS1wcm9ncmVzcyB7XG4gIGhlaWdodDogdmFyKC0tc2xpZGVyLWhlaWdodCk7XG4gIGJhY2tncm91bmQ6IHZhcigtLXNsaWRlci1maWxsLWNvbG9yKTtcbiAgYm9yZGVyLXJhZGl1czogdmFyKC0tc2xpZGVyLWhlaWdodCk7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi1tcy1maWxsLWxvd2VyIHtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgYmFja2dyb3VuZDogdmFyKC0tc2xpZGVyLWZpbGwtY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LXdlYmtpdC1zbGlkZXItdGh1bWIge1xuICBtYXJnaW4tdG9wOiBjYWxjKCh2YXIoLS1zbGlkZXItaGVpZ2h0KSAtIHZhcigtLXNsaWRlci10aHVtYi1zaXplKSkgLyAyIC0gMXB4KTtcbiAgd2lkdGg6IHZhcigtLXNsaWRlci10aHVtYi1zaXplKTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSk7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlcjogc29saWQgMXB4ICB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLXJhZGl1czogMmVtO1xuICBiYWNrZ3JvdW5kOiAjZGRkO1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi1tb3otcmFuZ2UtdGh1bWIge1xuICB3aWR0aDogdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpO1xuICBoZWlnaHQ6IHZhcigtLXNsaWRlci10aHVtYi1zaXplKTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCAxcHggIHZhcigtLXNsaWRlci1ib3JkZXItY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiAyZW07XG4gIGJhY2tncm91bmQ6ICNkZGQ7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1zLXRodW1iIHtcbiAgbWFyZ2luLXRvcDogMDtcbiAgd2lkdGg6IHZhcigtLXNsaWRlci10aHVtYi1zaXplKTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSk7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlcjogc29saWQgMXB4ICB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLXJhZGl1czogMmVtO1xuICBiYWNrZ3JvdW5kOiAjZGRkO1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi1tcy10b29sdGlwIHtcbiAgZGlzcGxheTogbm9uZTtcbn1cbiJdfQ== */");

/***/ }),

/***/ "./src/app/component/game-data-element/game-data-element.component.ts":
/*!****************************************************************************!*\
  !*** ./src/app/component/game-data-element/game-data-element.component.ts ***!
  \****************************************************************************/
/*! exports provided: GameDataElementComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameDataElementComponent", function() { return GameDataElementComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_data_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/data-element */ "./src/app/class/data-element.ts");




var GameDataElementComponent = /** @class */ (function () {
    function GameDataElementComponent(changeDetector) {
        this.changeDetector = changeDetector;
        this.gameDataElement = null;
        this.isEdit = false;
        this.isTagLocked = false;
        this.isValueLocked = false;
        this._name = '';
        this._value = 0;
        this._currentValue = 0;
        this.updateTimer = null;
    }
    Object.defineProperty(GameDataElementComponent.prototype, "name", {
        get: function () { return this._name; },
        set: function (name) { this._name = name; this.setUpdateTimer(); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameDataElementComponent.prototype, "value", {
        get: function () { return this._value; },
        set: function (value) { this._value = value; this.setUpdateTimer(); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameDataElementComponent.prototype, "currentValue", {
        get: function () { return this._currentValue; },
        set: function (currentValue) { this._currentValue = currentValue; this.setUpdateTimer(); },
        enumerable: true,
        configurable: true
    });
    GameDataElementComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.gameDataElement)
            this.setValues(this.gameDataElement);
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            if (_this.gameDataElement && event.data.identifier === _this.gameDataElement.identifier) {
                _this.setValues(_this.gameDataElement);
                _this.changeDetector.markForCheck();
            }
        })
            .on('DELETE_GAME_OBJECT', -1000, function (event) {
            if (_this.gameDataElement && _this.gameDataElement.identifier === event.data.identifier) {
                _this.changeDetector.markForCheck();
            }
        });
    };
    GameDataElementComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(this);
    };
    GameDataElementComponent.prototype.ngAfterViewInit = function () {
    };
    GameDataElementComponent.prototype.addElement = function () {
        this.gameDataElement.appendChild(_udonarium_data_element__WEBPACK_IMPORTED_MODULE_3__["DataElement"].create('タグ', '', {}));
    };
    GameDataElementComponent.prototype.deleteElement = function () {
        this.gameDataElement.destroy();
    };
    GameDataElementComponent.prototype.upElement = function () {
        var parentElement = this.gameDataElement.parent;
        var index = parentElement.children.indexOf(this.gameDataElement);
        if (0 < index) {
            var prevElement = parentElement.children[index - 1];
            parentElement.insertBefore(this.gameDataElement, prevElement);
        }
    };
    GameDataElementComponent.prototype.downElement = function () {
        var parentElement = this.gameDataElement.parent;
        var index = parentElement.children.indexOf(this.gameDataElement);
        if (index < parentElement.children.length - 1) {
            var nextElement = parentElement.children[index + 1];
            parentElement.insertBefore(nextElement, this.gameDataElement);
        }
    };
    GameDataElementComponent.prototype.setElementType = function (type) {
        this.gameDataElement.setAttribute('type', type);
    };
    GameDataElementComponent.prototype.setValues = function (object) {
        this._name = object.name;
        this._currentValue = object.currentValue;
        this._value = object.value;
    };
    GameDataElementComponent.prototype.setUpdateTimer = function () {
        var _this = this;
        clearTimeout(this.updateTimer);
        this.updateTimer = setTimeout(function () {
            if (_this.gameDataElement.name !== _this.name)
                _this.gameDataElement.name = _this.name;
            if (_this.gameDataElement.currentValue !== _this.currentValue)
                _this.gameDataElement.currentValue = _this.currentValue;
            if (_this.gameDataElement.value !== _this.value)
                _this.gameDataElement.value = _this.value;
            _this.updateTimer = null;
        }, 66);
    };
    GameDataElementComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], GameDataElementComponent.prototype, "gameDataElement", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], GameDataElementComponent.prototype, "isEdit", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], GameDataElementComponent.prototype, "isTagLocked", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], GameDataElementComponent.prototype, "isValueLocked", void 0);
    GameDataElementComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'game-data-element, [game-data-element]',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./game-data-element.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-data-element/game-data-element.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./game-data-element.component.css */ "./src/app/component/game-data-element/game-data-element.component.css")).default]
        })
    ], GameDataElementComponent);
    return GameDataElementComponent;
}());



/***/ }),

/***/ "./src/app/component/game-object-inventory/game-object-inventory.component.css":
/*!*************************************************************************************!*\
  !*** ./src/app/component/game-object-inventory/game-object-inventory.component.css ***!
  \*************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".component {\n  width: 100%;\n}\n\n.box {\n  border: transparent 2px solid;\n  border-left: transparent 6px solid;\n  margin-top: 2px;\n  padding: 2px;\n  padding-bottom: 3px;\n  box-sizing: border-box;\n\n  border-bottom: 1px dotted #666;\n}\n\n.selected {\n  padding: 2px;\n  border: 2px dotted #666;\n  border-left: 6px solid #444;\n}\n\n.hidden-spacer {\n  visibility: hidden;\n  height: 0;\n  font-size: 1.0em;\n  min-width:1em; \n  max-width : 12em;\n  overflow: hidden;\n  padding: 0 2px;\n  box-sizing: border-box;\n  white-space: nowrap;\n}\n\n.input {\n  background: none;\n  border: none;\n  border-radius: 2px;\n  outline: none;\n  color: #444;\n  padding: 2px;\n  box-sizing: border-box;\n}\n\n.input:hover {\n  background: #EEE;\n}\n\n.input:focus {\n  background: #FFF;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\ninput[type=number]:hover, input[type=number]:focus {\n  -moz-appearance: number-input;\n}\n\ninput[type='range'] {\n  --slider-track-color: transparent; /* #ccc */\n  --slider-fill-color: #555; /*#777 */\n  --slider-border-color: #777;\n  --slider-height: 0.8em;\n  --slider-thumb-size: 1.0em;\n  --range: calc(var(--max) - var(--min));\n  --ratio: calc((var(--val) - var(--min))/var(--range));\n  --sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));\n  margin: 0;\n  padding: 0;\n  background: transparent;\n  font: 1em/1 arial, sans-serif;\n  outline: 0;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n}\n\ninput[type='range'], input[type='range']::-webkit-slider-thumb {\n  -webkit-appearance: none;\n}\n\ninput[type='range']::-webkit-slider-runnable-track {\n  box-sizing: border-box;\n  border-top: solid 1px var(--slider-border-color);\n  border-bottom: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\n\ninput[type='range']::-webkit-slider-runnable-track {\n  background: -webkit-gradient(linear, left top, left bottom, from(var(--slider-fill-color)), to(var(--slider-fill-color))) 0/var(--sx) 100% no-repeat var(--slider-track-color);\n  background: linear-gradient(var(--slider-fill-color), var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);\n  cursor: pointer;\n}\n\ninput[type='range']::-moz-range-track {\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\n\ninput[type='range']::-ms-track {\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\n\ninput[type='range']::-moz-range-progress {\n  height: var(--slider-height);\n  background: var(--slider-fill-color);\n  border-radius: var(--slider-height);\n}\n\ninput[type='range']::-ms-fill-lower {\n  height: var(--slider-height);\n  background: var(--slider-fill-color);\n  border-radius: var(--slider-height);\n}\n\ninput[type='range']::-webkit-slider-thumb {\n  margin-top: calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\n\ninput[type='range']::-moz-range-thumb {\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\n\ninput[type='range']::-ms-thumb {\n  margin-top: 0;\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px  var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\n\ninput[type='range']::-ms-tooltip {\n  display: none;\n}\n\n.tab {\n  padding : 5px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.tab {\n  padding : 0px;\n  border: solid 1px #555;\n  border-radius: 0.3em;\n  overflow: hidden;\n\n  display: -webkit-box;\n\n  display: flex;\n  -webkit-box-orient:  horizontal;\n  -webkit-box-direction:  normal;\n          flex-flow:  row nowrap;\n  justify-content: space-around;\n  -webkit-box-align: stretch;\n          align-items: stretch;\n\n  text-align: center;\n\n  margin: 0px; \n  max-width: 500px;\n\n  background-color: rgba(240,218,189, 0.9);\n}\n\n.tab label {\n  display: inline-block;\n  -webkit-box-flex: 1;\n          flex: 1 0 auto;\n  flex-grow: 1;\n}\n\n.tab label:hover {\n  background-color: #888;\n  color: #eee;\n  border-color: #555;\n}\n\n.tab label:checked {\n  background: #555;\n  color: #CCC;\n}\n\n.tab input[type=\"radio\"] {\n  display: none;\n}\n\n.tab input[type=\"radio\"] + div {\n  vertical-align: middle;\n  outline: 0;\n  font-size: 0.6em;\n  background-color: transparent;\n  color: #444; \n  \n  box-sizing: border-box;\n\n  margin: 0px; \n  padding: 2px 8px;\n\n  cursor: pointer;\n}\n\n.tab input[type=\"radio\"] + div:hover {\n  background-color: #888;\n  color: #eee;\n  border-color: #555;\n}\n\n.tab input[type=\"radio\"]:checked + div {\n  background: #555;\n  color: #CCC;\n}\n\n.is-sticky-top {\n  position: -webkit-sticky;\n  position: sticky;\n  top : 0;\n}\n\n.tab-setting {\n  background-color: transparent;\n  color: #444; \n  border: solid 1px #555;\n  padding: 2px 8px;\n  border-radius: 5px;\n  cursor: pointer;\n}\n\n.tab-setting:hover {\n  background-color: #888;\n  color: #eee;\n  border: solid 1px #555;\n}\n\n.small-font {\n  font-size: 12px;\n  vertical-align: middle;\n}\n\n.material-icons {\n  vertical-align: middle;\n  font-size: 1.0rem;\n}\n\n.table-cell {\n  display: table-cell;\n}\n\n.image-box {\n  padding: 0px;\n  width: 32px;\n  height: 32px;\n  display: table-cell;\n  vertical-align: top;\n}\n\n.image-box img{\n  width: 100%;\n  height: 100%;\n  vertical-align: bottom;\n  -o-object-fit: cover;\n     object-fit: cover;\n  -o-object-position: 50% 0%;\n     object-position: 50% 0%;\n}\n\n.inventory-object {\n  font-size: 14px;\n  display: inline-block;\n  vertical-align: text-top;\n}\n\n.object-name {\n  font-size: 0.8em;\n  font-weight: bold;\n  padding: 0 0.25em;\n}\n\n.object-tags-box {\n  display: table;\n  table-layout: fixed;\n}\n\n.object-tag {\n  display: inline-block;\n  padding: 0 0.25em;\n  vertical-align: middle;\n}\n\n.resource-tag {\n  text-align: center;\n  vertical-align: bottom;\n  overflow: hidden;\n  white-space: nowrap;\n}\n\n.resource-value {\n  font-weight: bold;\n  width: 4em;\n  text-align: right;\n  font-family: inherit;\n}\n\n.tag-name {\n  font-size: 0.8em;\n  text-align: left;\n  vertical-align: bottom;\n  min-width:1em;\n  max-width: 12em;\n  overflow: hidden;\n  white-space: nowrap;\n}\n\n.tag-value-box{\n  display: table-cell;\n  width: 10px;\n}\n\n.tag-value {\n  font-size: 1.0em;\n  font-weight: bold;\n  width: 100%;\n  min-width: 1em;\n  max-width: 12em;\n  text-align: center;\n  font-family: inherit;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2dhbWUtb2JqZWN0LWludmVudG9yeS9nYW1lLW9iamVjdC1pbnZlbnRvcnkuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQVc7QUFDYjs7QUFFQTtFQUNFLDZCQUE2QjtFQUM3QixrQ0FBa0M7RUFDbEMsZUFBZTtFQUNmLFlBQVk7RUFDWixtQkFBbUI7RUFDbkIsc0JBQXNCOztFQUV0Qiw4QkFBOEI7QUFDaEM7O0FBQ0E7RUFDRSxZQUFZO0VBQ1osdUJBQXVCO0VBQ3ZCLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsZ0JBQWdCO0VBQ2hCLGFBQWE7RUFDYixnQkFBZ0I7RUFDaEIsZ0JBQWdCO0VBQ2hCLGNBQWM7RUFDZCxzQkFBc0I7RUFDdEIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFlBQVk7RUFDWixrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLFdBQVc7RUFDWCxZQUFZO0VBQ1osc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsMEJBQTBCO0FBQzVCOztBQUVBO0VBQ0UsNkJBQTZCO0FBQy9COztBQUVBO0VBQ0UsaUNBQWlDLEVBQUUsU0FBUztFQUM1Qyx5QkFBeUIsRUFBRSxRQUFRO0VBQ25DLDJCQUEyQjtFQUMzQixzQkFBc0I7RUFDdEIsMEJBQTBCO0VBQzFCLHNDQUFzQztFQUN0QyxxREFBcUQ7RUFDckQsd0ZBQXdGO0VBQ3hGLFNBQVM7RUFDVCxVQUFVO0VBQ1YsdUJBQXVCO0VBQ3ZCLDZCQUE2QjtFQUM3QixVQUFVO0VBQ1Ysd0JBQWdCO0tBQWhCLHFCQUFnQjtVQUFoQixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsZ0RBQWdEO0VBQ2hELG1EQUFtRDtFQUNuRCxtQ0FBbUM7RUFDbkMsNEJBQTRCO0VBQzVCLHFDQUFxQztBQUN2Qzs7QUFFQTtFQUNFLDhLQUFvSTtFQUFwSSxvSUFBb0k7RUFDcEksZUFBZTtBQUNqQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0Qiw0Q0FBNEM7RUFDNUMsbUNBQW1DO0VBQ25DLDRCQUE0QjtFQUM1QixxQ0FBcUM7QUFDdkM7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsNENBQTRDO0VBQzVDLG1DQUFtQztFQUNuQyw0QkFBNEI7RUFDNUIscUNBQXFDO0FBQ3ZDOztBQUVBO0VBQ0UsNEJBQTRCO0VBQzVCLG9DQUFvQztFQUNwQyxtQ0FBbUM7QUFDckM7O0FBRUE7RUFDRSw0QkFBNEI7RUFDNUIsb0NBQW9DO0VBQ3BDLG1DQUFtQztBQUNyQzs7QUFFQTtFQUNFLDZFQUE2RTtFQUM3RSwrQkFBK0I7RUFDL0IsZ0NBQWdDO0VBQ2hDLHNCQUFzQjtFQUN0Qiw0Q0FBNEM7RUFDNUMsa0JBQWtCO0VBQ2xCLGdCQUFnQjtFQUNoQixlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsK0JBQStCO0VBQy9CLGdDQUFnQztFQUNoQyxzQkFBc0I7RUFDdEIsNENBQTRDO0VBQzVDLGtCQUFrQjtFQUNsQixnQkFBZ0I7RUFDaEIsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLGFBQWE7RUFDYiwrQkFBK0I7RUFDL0IsZ0NBQWdDO0VBQ2hDLHNCQUFzQjtFQUN0Qiw2Q0FBNkM7RUFDN0Msa0JBQWtCO0VBQ2xCLGdCQUFnQjtFQUNoQixlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsYUFBYTtFQUNiLHlCQUFpQjtLQUFqQixzQkFBaUI7TUFBakIscUJBQWlCO1VBQWpCLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLGFBQWE7RUFDYixzQkFBc0I7RUFDdEIsb0JBQW9CO0VBQ3BCLGdCQUFnQjs7RUFFaEIsb0JBQWE7O0VBQWIsYUFBYTtFQUNiLCtCQUFzQjtFQUF0Qiw4QkFBc0I7VUFBdEIsc0JBQXNCO0VBQ3RCLDZCQUE2QjtFQUM3QiwwQkFBb0I7VUFBcEIsb0JBQW9COztFQUVwQixrQkFBa0I7O0VBRWxCLFdBQVc7RUFDWCxnQkFBZ0I7O0VBRWhCLHdDQUF3QztBQUMxQzs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQixtQkFBYztVQUFkLGNBQWM7RUFDZCxZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsV0FBVztFQUNYLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxhQUFhO0FBQ2Y7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsVUFBVTtFQUNWLGdCQUFnQjtFQUNoQiw2QkFBNkI7RUFDN0IsV0FBVzs7RUFFWCxzQkFBc0I7O0VBRXRCLFdBQVc7RUFDWCxnQkFBZ0I7O0VBRWhCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsV0FBVztFQUNYLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSx3QkFBZ0I7RUFBaEIsZ0JBQWdCO0VBQ2hCLE9BQU87QUFDVDs7QUFFQTtFQUNFLDZCQUE2QjtFQUM3QixXQUFXO0VBQ1gsc0JBQXNCO0VBQ3RCLGdCQUFnQjtFQUNoQixrQkFBa0I7RUFDbEIsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QixXQUFXO0VBQ1gsc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsZUFBZTtFQUNmLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QixpQkFBaUI7QUFDbkI7O0FBRUE7RUFDRSxtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxZQUFZO0VBQ1osV0FBVztFQUNYLFlBQVk7RUFDWixtQkFBbUI7RUFDbkIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsb0JBQWlCO0tBQWpCLGlCQUFpQjtFQUNqQiwwQkFBdUI7S0FBdkIsdUJBQXVCO0FBQ3pCOztBQUVBO0VBQ0UsZUFBZTtFQUNmLHFCQUFxQjtFQUNyQix3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxxQkFBcUI7RUFDckIsaUJBQWlCO0VBQ2pCLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixzQkFBc0I7RUFDdEIsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixVQUFVO0VBQ1YsaUJBQWlCO0VBQ2pCLG9CQUFvQjtBQUN0Qjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsc0JBQXNCO0VBQ3RCLGFBQWE7RUFDYixlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLG1CQUFtQjtFQUNuQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLFdBQVc7RUFDWCxjQUFjO0VBQ2QsZUFBZTtFQUNmLGtCQUFrQjtFQUNsQixvQkFBb0I7QUFDdEIiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZ2FtZS1vYmplY3QtaW52ZW50b3J5L2dhbWUtb2JqZWN0LWludmVudG9yeS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNvbXBvbmVudCB7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4uYm94IHtcbiAgYm9yZGVyOiB0cmFuc3BhcmVudCAycHggc29saWQ7XG4gIGJvcmRlci1sZWZ0OiB0cmFuc3BhcmVudCA2cHggc29saWQ7XG4gIG1hcmdpbi10b3A6IDJweDtcbiAgcGFkZGluZzogMnB4O1xuICBwYWRkaW5nLWJvdHRvbTogM3B4O1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuXG4gIGJvcmRlci1ib3R0b206IDFweCBkb3R0ZWQgIzY2Njtcbn1cbi5zZWxlY3RlZCB7XG4gIHBhZGRpbmc6IDJweDtcbiAgYm9yZGVyOiAycHggZG90dGVkICM2NjY7XG4gIGJvcmRlci1sZWZ0OiA2cHggc29saWQgIzQ0NDtcbn1cblxuLmhpZGRlbi1zcGFjZXIge1xuICB2aXNpYmlsaXR5OiBoaWRkZW47XG4gIGhlaWdodDogMDtcbiAgZm9udC1zaXplOiAxLjBlbTtcbiAgbWluLXdpZHRoOjFlbTsgXG4gIG1heC13aWR0aCA6IDEyZW07XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHBhZGRpbmc6IDAgMnB4O1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xufVxuXG4uaW5wdXQge1xuICBiYWNrZ3JvdW5kOiBub25lO1xuICBib3JkZXI6IG5vbmU7XG4gIGJvcmRlci1yYWRpdXM6IDJweDtcbiAgb3V0bGluZTogbm9uZTtcbiAgY29sb3I6ICM0NDQ7XG4gIHBhZGRpbmc6IDJweDtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbn1cblxuLmlucHV0OmhvdmVyIHtcbiAgYmFja2dyb3VuZDogI0VFRTtcbn1cblxuLmlucHV0OmZvY3VzIHtcbiAgYmFja2dyb3VuZDogI0ZGRjtcbn1cblxuaW5wdXRbdHlwZT1udW1iZXJdIHtcbiAgLW1vei1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7XG59XG5cbmlucHV0W3R5cGU9bnVtYmVyXTpob3ZlciwgaW5wdXRbdHlwZT1udW1iZXJdOmZvY3VzIHtcbiAgLW1vei1hcHBlYXJhbmNlOiBudW1iZXItaW5wdXQ7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ10ge1xuICAtLXNsaWRlci10cmFjay1jb2xvcjogdHJhbnNwYXJlbnQ7IC8qICNjY2MgKi9cbiAgLS1zbGlkZXItZmlsbC1jb2xvcjogIzU1NTsgLyojNzc3ICovXG4gIC0tc2xpZGVyLWJvcmRlci1jb2xvcjogIzc3NztcbiAgLS1zbGlkZXItaGVpZ2h0OiAwLjhlbTtcbiAgLS1zbGlkZXItdGh1bWItc2l6ZTogMS4wZW07XG4gIC0tcmFuZ2U6IGNhbGModmFyKC0tbWF4KSAtIHZhcigtLW1pbikpO1xuICAtLXJhdGlvOiBjYWxjKCh2YXIoLS12YWwpIC0gdmFyKC0tbWluKSkvdmFyKC0tcmFuZ2UpKTtcbiAgLS1zeDogY2FsYyguNSp2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSkgKyB2YXIoLS1yYXRpbykqKDEwMCUgLSB2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSkpKTtcbiAgbWFyZ2luOiAwO1xuICBwYWRkaW5nOiAwO1xuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgZm9udDogMWVtLzEgYXJpYWwsIHNhbnMtc2VyaWY7XG4gIG91dGxpbmU6IDA7XG4gIGFwcGVhcmFuY2U6IG5vbmU7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ10sIGlucHV0W3R5cGU9J3JhbmdlJ106Oi13ZWJraXQtc2xpZGVyLXRodW1iIHtcbiAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddOjotd2Via2l0LXNsaWRlci1ydW5uYWJsZS10cmFjayB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlci10b3A6IHNvbGlkIDFweCB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLWJvdHRvbTogc29saWQgMXB4IHZhcigtLXNsaWRlci1ib3JkZXItY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgYmFja2dyb3VuZDogdmFyKC0tc2xpZGVyLXRyYWNrLWNvbG9yKTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LXdlYmtpdC1zbGlkZXItcnVubmFibGUtdHJhY2sge1xuICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodmFyKC0tc2xpZGVyLWZpbGwtY29sb3IpLCB2YXIoLS1zbGlkZXItZmlsbC1jb2xvcikpIDAvdmFyKC0tc3gpIDEwMCUgbm8tcmVwZWF0IHZhcigtLXNsaWRlci10cmFjay1jb2xvcik7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1vei1yYW5nZS10cmFjayB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlcjogc29saWQgMXB4IHZhcigtLXNsaWRlci1ib3JkZXItY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgYmFja2dyb3VuZDogdmFyKC0tc2xpZGVyLXRyYWNrLWNvbG9yKTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1zLXRyYWNrIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCAxcHggdmFyKC0tc2xpZGVyLWJvcmRlci1jb2xvcik7XG4gIGJvcmRlci1yYWRpdXM6IHZhcigtLXNsaWRlci1oZWlnaHQpO1xuICBoZWlnaHQ6IHZhcigtLXNsaWRlci1oZWlnaHQpO1xuICBiYWNrZ3JvdW5kOiB2YXIoLS1zbGlkZXItdHJhY2stY29sb3IpO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddOjotbW96LXJhbmdlLXByb2dyZXNzIHtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgYmFja2dyb3VuZDogdmFyKC0tc2xpZGVyLWZpbGwtY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1zLWZpbGwtbG93ZXIge1xuICBoZWlnaHQ6IHZhcigtLXNsaWRlci1oZWlnaHQpO1xuICBiYWNrZ3JvdW5kOiB2YXIoLS1zbGlkZXItZmlsbC1jb2xvcik7XG4gIGJvcmRlci1yYWRpdXM6IHZhcigtLXNsaWRlci1oZWlnaHQpO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddOjotd2Via2l0LXNsaWRlci10aHVtYiB7XG4gIG1hcmdpbi10b3A6IGNhbGMoKHZhcigtLXNsaWRlci1oZWlnaHQpIC0gdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpKSAvIDIgLSAxcHgpO1xuICB3aWR0aDogdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpO1xuICBoZWlnaHQ6IHZhcigtLXNsaWRlci10aHVtYi1zaXplKTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCAxcHggdmFyKC0tc2xpZGVyLWJvcmRlci1jb2xvcik7XG4gIGJvcmRlci1yYWRpdXM6IDJlbTtcbiAgYmFja2dyb3VuZDogI2RkZDtcbiAgY3Vyc29yOiBwb2ludGVyO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddOjotbW96LXJhbmdlLXRodW1iIHtcbiAgd2lkdGg6IHZhcigtLXNsaWRlci10aHVtYi1zaXplKTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSk7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlcjogc29saWQgMXB4IHZhcigtLXNsaWRlci1ib3JkZXItY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiAyZW07XG4gIGJhY2tncm91bmQ6ICNkZGQ7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1zLXRodW1iIHtcbiAgbWFyZ2luLXRvcDogMDtcbiAgd2lkdGg6IHZhcigtLXNsaWRlci10aHVtYi1zaXplKTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSk7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlcjogc29saWQgMXB4ICB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLXJhZGl1czogMmVtO1xuICBiYWNrZ3JvdW5kOiAjZGRkO1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi1tcy10b29sdGlwIHtcbiAgZGlzcGxheTogbm9uZTtcbn1cblxuLnRhYiB7XG4gIHBhZGRpbmcgOiA1cHg7XG4gIHVzZXItc2VsZWN0OiBub25lO1xufVxuXG4udGFiIHtcbiAgcGFkZGluZyA6IDBweDtcbiAgYm9yZGVyOiBzb2xpZCAxcHggIzU1NTtcbiAgYm9yZGVyLXJhZGl1czogMC4zZW07XG4gIG92ZXJmbG93OiBoaWRkZW47XG5cbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1mbG93OiAgcm93IG5vd3JhcDtcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4gIGFsaWduLWl0ZW1zOiBzdHJldGNoO1xuXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcblxuICBtYXJnaW46IDBweDsgXG4gIG1heC13aWR0aDogNTAwcHg7XG5cbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNDAsMjE4LDE4OSwgMC45KTtcbn1cblxuLnRhYiBsYWJlbCB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgZmxleDogMSAwIGF1dG87XG4gIGZsZXgtZ3JvdzogMTtcbn1cblxuLnRhYiBsYWJlbDpob3ZlciB7XG4gIGJhY2tncm91bmQtY29sb3I6ICM4ODg7XG4gIGNvbG9yOiAjZWVlO1xuICBib3JkZXItY29sb3I6ICM1NTU7XG59XG5cbi50YWIgbGFiZWw6Y2hlY2tlZCB7XG4gIGJhY2tncm91bmQ6ICM1NTU7XG4gIGNvbG9yOiAjQ0NDO1xufVxuXG4udGFiIGlucHV0W3R5cGU9XCJyYWRpb1wiXSB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG5cbi50YWIgaW5wdXRbdHlwZT1cInJhZGlvXCJdICsgZGl2IHtcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgb3V0bGluZTogMDtcbiAgZm9udC1zaXplOiAwLjZlbTtcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XG4gIGNvbG9yOiAjNDQ0OyBcbiAgXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG5cbiAgbWFyZ2luOiAwcHg7IFxuICBwYWRkaW5nOiAycHggOHB4O1xuXG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuLnRhYiBpbnB1dFt0eXBlPVwicmFkaW9cIl0gKyBkaXY6aG92ZXIge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjODg4O1xuICBjb2xvcjogI2VlZTtcbiAgYm9yZGVyLWNvbG9yOiAjNTU1O1xufVxuXG4udGFiIGlucHV0W3R5cGU9XCJyYWRpb1wiXTpjaGVja2VkICsgZGl2IHtcbiAgYmFja2dyb3VuZDogIzU1NTtcbiAgY29sb3I6ICNDQ0M7XG59XG5cbi5pcy1zdGlja3ktdG9wIHtcbiAgcG9zaXRpb246IHN0aWNreTtcbiAgdG9wIDogMDtcbn1cblxuLnRhYi1zZXR0aW5nIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XG4gIGNvbG9yOiAjNDQ0OyBcbiAgYm9yZGVyOiBzb2xpZCAxcHggIzU1NTtcbiAgcGFkZGluZzogMnB4IDhweDtcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbi50YWItc2V0dGluZzpob3ZlciB7XG4gIGJhY2tncm91bmQtY29sb3I6ICM4ODg7XG4gIGNvbG9yOiAjZWVlO1xuICBib3JkZXI6IHNvbGlkIDFweCAjNTU1O1xufVxuXG4uc21hbGwtZm9udCB7XG4gIGZvbnQtc2l6ZTogMTJweDtcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbn1cblxuLm1hdGVyaWFsLWljb25zIHtcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgZm9udC1zaXplOiAxLjByZW07XG59XG5cbi50YWJsZS1jZWxsIHtcbiAgZGlzcGxheTogdGFibGUtY2VsbDtcbn1cblxuLmltYWdlLWJveCB7XG4gIHBhZGRpbmc6IDBweDtcbiAgd2lkdGg6IDMycHg7XG4gIGhlaWdodDogMzJweDtcbiAgZGlzcGxheTogdGFibGUtY2VsbDtcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcbn1cblxuLmltYWdlLWJveCBpbWd7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG4gIG9iamVjdC1maXQ6IGNvdmVyO1xuICBvYmplY3QtcG9zaXRpb246IDUwJSAwJTtcbn1cblxuLmludmVudG9yeS1vYmplY3Qge1xuICBmb250LXNpemU6IDE0cHg7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgdmVydGljYWwtYWxpZ246IHRleHQtdG9wO1xufVxuXG4ub2JqZWN0LW5hbWUge1xuICBmb250LXNpemU6IDAuOGVtO1xuICBmb250LXdlaWdodDogYm9sZDtcbiAgcGFkZGluZzogMCAwLjI1ZW07XG59XG5cbi5vYmplY3QtdGFncy1ib3gge1xuICBkaXNwbGF5OiB0YWJsZTtcbiAgdGFibGUtbGF5b3V0OiBmaXhlZDtcbn1cblxuLm9iamVjdC10YWcge1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIHBhZGRpbmc6IDAgMC4yNWVtO1xuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xufVxuXG4ucmVzb3VyY2UtdGFnIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xufVxuXG4ucmVzb3VyY2UtdmFsdWUge1xuICBmb250LXdlaWdodDogYm9sZDtcbiAgd2lkdGg6IDRlbTtcbiAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gIGZvbnQtZmFtaWx5OiBpbmhlcml0O1xufVxuXG4udGFnLW5hbWUge1xuICBmb250LXNpemU6IDAuOGVtO1xuICB0ZXh0LWFsaWduOiBsZWZ0O1xuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xuICBtaW4td2lkdGg6MWVtO1xuICBtYXgtd2lkdGg6IDEyZW07XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG5cbi50YWctdmFsdWUtYm94e1xuICBkaXNwbGF5OiB0YWJsZS1jZWxsO1xuICB3aWR0aDogMTBweDtcbn1cblxuLnRhZy12YWx1ZSB7XG4gIGZvbnQtc2l6ZTogMS4wZW07XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICB3aWR0aDogMTAwJTtcbiAgbWluLXdpZHRoOiAxZW07XG4gIG1heC13aWR0aDogMTJlbTtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBmb250LWZhbWlseTogaW5oZXJpdDtcbn0iXX0= */");

/***/ }),

/***/ "./src/app/component/game-object-inventory/game-object-inventory.component.ts":
/*!************************************************************************************!*\
  !*** ./src/app/component/game-object-inventory/game-object-inventory.component.ts ***!
  \************************************************************************************/
/*! exports provided: GameObjectInventoryComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameObjectInventoryComponent", function() { return GameObjectInventoryComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/data-summary-setting */ "./src/app/class/data-summary-setting.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var _udonarium_tabletop_object__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/tabletop-object */ "./src/app/class/tabletop-object.ts");
/* harmony import */ var component_chat_palette_chat_palette_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! component/chat-palette/chat-palette.component */ "./src/app/component/chat-palette/chat-palette.component.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_game_object_inventory_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/game-object-inventory.service */ "./src/app/service/game-object-inventory.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");













var GameObjectInventoryComponent = /** @class */ (function () {
    function GameObjectInventoryComponent(changeDetector, panelService, inventoryService, contextMenuService, pointerDeviceService) {
        this.changeDetector = changeDetector;
        this.panelService = panelService;
        this.inventoryService = inventoryService;
        this.contextMenuService = contextMenuService;
        this.pointerDeviceService = pointerDeviceService;
        this.inventoryTypes = ['table', 'common', 'graveyard'];
        this.selectTab = 'table';
        this.selectedIdentifier = '';
        this.isEdit = false;
    }
    Object.defineProperty(GameObjectInventoryComponent.prototype, "sortTag", {
        get: function () { return this.inventoryService.sortTag; },
        set: function (sortTag) { this.inventoryService.sortTag = sortTag; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryComponent.prototype, "sortOrder", {
        get: function () { return this.inventoryService.sortOrder; },
        set: function (sortOrder) { this.inventoryService.sortOrder = sortOrder; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryComponent.prototype, "dataTag", {
        get: function () { return this.inventoryService.dataTag; },
        set: function (dataTag) { this.inventoryService.dataTag = dataTag; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryComponent.prototype, "dataTags", {
        get: function () { return this.inventoryService.dataTags; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryComponent.prototype, "sortOrderName", {
        get: function () { return this.sortOrder === _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_4__["SortOrder"].ASC ? '昇順' : '降順'; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryComponent.prototype, "newLineString", {
        get: function () { return this.inventoryService.newLineString; },
        enumerable: true,
        configurable: true
    });
    GameObjectInventoryComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.panelService.title = 'インベントリ';
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].register(this)
            .on('SELECT_TABLETOP_OBJECT', -1000, function (event) {
            if (_udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(event.data.identifier) instanceof _udonarium_tabletop_object__WEBPACK_IMPORTED_MODULE_6__["TabletopObject"]) {
                _this.selectedIdentifier = event.data.identifier;
                _this.changeDetector.markForCheck();
            }
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            if (event.isSendFromSelf)
                _this.changeDetector.markForCheck();
        })
            .on('UPDATE_INVENTORY', function (event) {
            if (event.isSendFromSelf)
                _this.changeDetector.markForCheck();
        })
            .on('OPEN_NETWORK', function (event) {
            _this.inventoryTypes = ['table', 'common', _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId, 'graveyard'];
            if (!_this.inventoryTypes.includes(_this.selectTab)) {
                _this.selectTab = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId;
            }
        });
        this.inventoryTypes = ['table', 'common', _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId, 'graveyard'];
    };
    GameObjectInventoryComponent.prototype.ngAfterViewInit = function () {
    };
    GameObjectInventoryComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].unregister(this);
    };
    GameObjectInventoryComponent.prototype.getTabTitle = function (inventoryType) {
        switch (inventoryType) {
            case 'table':
                return 'テーブル';
            case _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId:
                return '個人';
            case 'graveyard':
                return '墓場';
            default:
                return '共有';
        }
    };
    GameObjectInventoryComponent.prototype.getInventory = function (inventoryType) {
        switch (inventoryType) {
            case 'table':
                return this.inventoryService.tableInventory;
            case _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId:
                return this.inventoryService.privateInventory;
            case 'graveyard':
                return this.inventoryService.graveyardInventory;
            default:
                return this.inventoryService.commonInventory;
        }
    };
    GameObjectInventoryComponent.prototype.getGameObjects = function (inventoryType) {
        return this.getInventory(inventoryType).tabletopObjects;
    };
    GameObjectInventoryComponent.prototype.getInventoryTags = function (gameObject) {
        return this.getInventory(gameObject.location.name).dataElementMap.get(gameObject.identifier);
    };
    GameObjectInventoryComponent.prototype.onContextMenu = function (e, gameObject) {
        var e_1, _a;
        var _this = this;
        if (document.activeElement instanceof HTMLInputElement && document.activeElement.getAttribute('type') !== 'range')
            return;
        e.stopPropagation();
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        this.selectGameObject(gameObject);
        var position = this.pointerDeviceService.pointers[0];
        var actions = [];
        actions.push({ name: '詳細を表示', action: function () { _this.showDetail(gameObject); } });
        if (gameObject.location.name !== 'graveyard') {
            actions.push({ name: 'チャットパレットを表示', action: function () { _this.showChatPalette(gameObject); } });
        }
        actions.push(service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuSeparator"]);
        var locations = [
            { name: 'table', alias: 'テーブルに移動' },
            { name: 'common', alias: '共有イベントリに移動' },
            { name: _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId, alias: '個人イベントリに移動' },
            { name: 'graveyard', alias: '墓場に移動' }
        ];
        var _loop_1 = function (location_1) {
            if (gameObject.location.name === location_1.name)
                return "continue";
            actions.push({
                name: location_1.alias, action: function () {
                    gameObject.setLocation(location_1.name);
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].piecePut);
                }
            });
        };
        try {
            for (var locations_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](locations), locations_1_1 = locations_1.next(); !locations_1_1.done; locations_1_1 = locations_1.next()) {
                var location_1 = locations_1_1.value;
                _loop_1(location_1);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (locations_1_1 && !locations_1_1.done && (_a = locations_1.return)) _a.call(locations_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        if (gameObject.location.name === 'graveyard') {
            actions.push({
                name: '削除する', action: function () {
                    _this.deleteGameObject(gameObject);
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].sweep);
                }
            });
        }
        actions.push(service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuSeparator"]);
        actions.push({
            name: 'コピーを作る', action: function () {
                _this.cloneGameObject(gameObject);
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].piecePut);
            }
        });
        this.contextMenuService.open(position, actions, gameObject.name);
    };
    GameObjectInventoryComponent.prototype.toggleEdit = function () {
        this.isEdit = !this.isEdit;
    };
    GameObjectInventoryComponent.prototype.cleanInventory = function () {
        var e_2, _a;
        var tabTitle = this.getTabTitle(this.selectTab);
        var gameObjects = this.getGameObjects(this.selectTab);
        if (!confirm(tabTitle + "\u306B\u5B58\u5728\u3059\u308B" + gameObjects.length + "\u500B\u306E\u8981\u7D20\u3092\u5B8C\u5168\u306B\u524A\u9664\u3057\u307E\u3059\u304B\uFF1F"))
            return;
        try {
            for (var gameObjects_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](gameObjects), gameObjects_1_1 = gameObjects_1.next(); !gameObjects_1_1.done; gameObjects_1_1 = gameObjects_1.next()) {
                var gameObject = gameObjects_1_1.value;
                this.deleteGameObject(gameObject);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (gameObjects_1_1 && !gameObjects_1_1.done && (_a = gameObjects_1.return)) _a.call(gameObjects_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].sweep);
    };
    GameObjectInventoryComponent.prototype.cloneGameObject = function (gameObject) {
        gameObject.clone();
    };
    GameObjectInventoryComponent.prototype.showDetail = function (gameObject) {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: gameObject.identifier, className: gameObject.aliasName });
        var coordinate = this.pointerDeviceService.pointers[0];
        var title = 'キャラクターシート';
        if (gameObject.name.length)
            title += ' - ' + gameObject.name;
        var option = { title: title, left: coordinate.x - 800, top: coordinate.y - 300, width: 800, height: 600 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_8__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    GameObjectInventoryComponent.prototype.showChatPalette = function (gameObject) {
        var coordinate = this.pointerDeviceService.pointers[0];
        var option = { left: coordinate.x - 250, top: coordinate.y - 175, width: 615, height: 350 };
        var component = this.panelService.open(component_chat_palette_chat_palette_component__WEBPACK_IMPORTED_MODULE_7__["ChatPaletteComponent"], option);
        component.character = gameObject;
    };
    GameObjectInventoryComponent.prototype.selectGameObject = function (gameObject) {
        var aliasName = gameObject.aliasName;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: gameObject.identifier, className: gameObject.aliasName });
    };
    GameObjectInventoryComponent.prototype.deleteGameObject = function (gameObject) {
        gameObject.destroy();
        this.changeDetector.markForCheck();
    };
    GameObjectInventoryComponent.prototype.trackByGameObject = function (index, gameObject) {
        return gameObject ? gameObject.identifier : index;
    };
    GameObjectInventoryComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_11__["PanelService"] },
        { type: service_game_object_inventory_service__WEBPACK_IMPORTED_MODULE_10__["GameObjectInventoryService"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuService"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_12__["PointerDeviceService"] }
    ]; };
    GameObjectInventoryComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'game-object-inventory',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./game-object-inventory.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-object-inventory/game-object-inventory.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./game-object-inventory.component.css */ "./src/app/component/game-object-inventory/game-object-inventory.component.css")).default]
        })
    ], GameObjectInventoryComponent);
    return GameObjectInventoryComponent;
}());



/***/ }),

/***/ "./src/app/component/game-table-mask/game-table-mask.component.css":
/*!*************************************************************************!*\
  !*** ./src/app/component/game-table-mask/game-table-mask.component.css ***!
  \*************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".is-grab {\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n\n.is-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.is-transition {\n  -webkit-transition: -webkit-transform 132ms linear;\n  transition: -webkit-transform 132ms linear;\n  transition: transform 132ms linear;\n  transition: transform 132ms linear, -webkit-transform 132ms linear;\n}\n\n.component {\n  position: absolute;\n  height: 50px;\n  width: 50px;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  \n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n}\n\n.image {\n  display: block;\n}\n\n.lock-icon {\n  background-color: #CCCCCC;\n  border-radius: 100%;\n  color: #444;\n  width: 25px;\n  height: 25px;\n}\n\n.is-center {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n}\n\n.border {\n  box-sizing: border-box;\n  border: solid 2px #CCCCCC;\n}\n\n.is-fit-full {\n  height: 100%;\n  width: 100%;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2dhbWUtdGFibGUtbWFzay9nYW1lLXRhYmxlLW1hc2suY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVFLG9CQUFvQjtFQUNwQixZQUFZO0FBQ2Q7O0FBRUE7RUFFRSx3QkFBd0I7RUFDeEIsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0Usa0RBQWtEO0VBQ2xELDBDQUFrQztFQUFsQyxrQ0FBa0M7RUFBbEMsa0VBQWtDO0FBQ3BDOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFlBQVk7RUFDWixXQUFXO0VBQ1gsbUNBQTJCO1VBQTNCLDJCQUEyQjtFQUMzQixzQkFBc0I7RUFDdEIseUJBQXlCO0VBQ3pCLHFCQUFpQjtNQUFqQixpQkFBaUI7O0VBRWpCLG9CQUFvQjtFQUNwQix1QkFBdUI7QUFDekI7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLG1CQUFtQjtFQUNuQixXQUFXO0VBQ1gsV0FBVztFQUNYLFlBQVk7QUFDZDs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixNQUFNO0VBQ04sU0FBUztFQUNULE9BQU87RUFDUCxRQUFRO0VBQ1IsWUFBWTtBQUNkOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLHlCQUF5QjtBQUMzQjs7QUFFQTtFQUNFLFlBQVk7RUFDWixXQUFXO0FBQ2IiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZ2FtZS10YWJsZS1tYXNrL2dhbWUtdGFibGUtbWFzay5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmlzLWdyYWIge1xuICBjdXJzb3I6IC1tb3otZ3JhYjtcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWI7XG4gIGN1cnNvcjogZ3JhYjtcbn1cblxuLmlzLWdyYWJiaW5nIHtcbiAgY3Vyc29yOiAtbW96LWdyYWJiaW5nO1xuICBjdXJzb3I6IC13ZWJraXQtZ3JhYmJpbmc7XG4gIGN1cnNvcjogZ3JhYmJpbmc7XG59XG5cbi5pcy10cmFuc2l0aW9uIHtcbiAgLXdlYmtpdC10cmFuc2l0aW9uOiAtd2Via2l0LXRyYW5zZm9ybSAxMzJtcyBsaW5lYXI7XG4gIHRyYW5zaXRpb246IHRyYW5zZm9ybSAxMzJtcyBsaW5lYXI7XG59XG5cbi5jb21wb25lbnQge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGhlaWdodDogNTBweDtcbiAgd2lkdGg6IDUwcHg7XG4gIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjtcbiAgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gIFxuICAtbW96LXVzZXItZHJhZzogbm9uZTtcbiAgLXdlYmtpdC11c2VyLWRyYWc6IG5vbmU7XG59XG5cbi5pbWFnZSB7XG4gIGRpc3BsYXk6IGJsb2NrO1xufVxuXG4ubG9jay1pY29uIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI0NDQ0NDQztcbiAgYm9yZGVyLXJhZGl1czogMTAwJTtcbiAgY29sb3I6ICM0NDQ7XG4gIHdpZHRoOiAyNXB4O1xuICBoZWlnaHQ6IDI1cHg7XG59XG5cbi5pcy1jZW50ZXIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMDtcbiAgYm90dG9tOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgbWFyZ2luOiBhdXRvO1xufVxuXG4uYm9yZGVyIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCAycHggI0NDQ0NDQztcbn1cblxuLmlzLWZpdC1mdWxsIHtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbn1cbiJdfQ== */");

/***/ }),

/***/ "./src/app/component/game-table-mask/game-table-mask.component.ts":
/*!************************************************************************!*\
  !*** ./src/app/component/game-table-mask/game-table-mask.component.ts ***!
  \************************************************************************/
/*! exports provided: GameTableMaskComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameTableMaskComponent", function() { return GameTableMaskComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var directive_input_handler__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! directive/input-handler */ "./src/app/directive/input-handler.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_tabletop_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/tabletop.service */ "./src/app/service/tabletop.service.ts");












var GameTableMaskComponent = /** @class */ (function () {
    function GameTableMaskComponent(tabletopService, contextMenuService, elementRef, panelService, changeDetector, pointerDeviceService) {
        this.tabletopService = tabletopService;
        this.contextMenuService = contextMenuService;
        this.elementRef = elementRef;
        this.panelService = panelService;
        this.changeDetector = changeDetector;
        this.pointerDeviceService = pointerDeviceService;
        this.gameTableMask = null;
        this.is3D = false;
        this.gridSize = 50;
        this.movableOption = {};
        this.input = null;
    }
    Object.defineProperty(GameTableMaskComponent.prototype, "name", {
        get: function () { return this.gameTableMask.name; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableMaskComponent.prototype, "width", {
        get: function () { return this.adjustMinBounds(this.gameTableMask.width); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableMaskComponent.prototype, "height", {
        get: function () { return this.adjustMinBounds(this.gameTableMask.height); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableMaskComponent.prototype, "opacity", {
        get: function () { return this.gameTableMask.opacity; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableMaskComponent.prototype, "imageFile", {
        get: function () { return this.gameTableMask.imageFile; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableMaskComponent.prototype, "isLock", {
        get: function () { return this.gameTableMask.isLock; },
        set: function (isLock) { this.gameTableMask.isLock = isLock; },
        enumerable: true,
        configurable: true
    });
    GameTableMaskComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.gameTableMask || !object)
                return;
            if (_this.gameTableMask === object || (object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__["ObjectNode"] && _this.gameTableMask.contains(object))) {
                _this.changeDetector.markForCheck();
            }
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('UPDATE_FILE_RESOURE', -1000, function (event) {
            _this.changeDetector.markForCheck();
        });
        this.movableOption = {
            tabletopObject: this.gameTableMask,
            transformCssOffset: 'translateZ(0.15px)',
            colideLayers: ['terrain']
        };
    };
    GameTableMaskComponent.prototype.ngAfterViewInit = function () {
        this.input = new directive_input_handler__WEBPACK_IMPORTED_MODULE_7__["InputHandler"](this.elementRef.nativeElement);
        this.input.onStart = this.onInputStart.bind(this);
    };
    GameTableMaskComponent.prototype.ngOnDestroy = function () {
        this.input.destroy();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    GameTableMaskComponent.prototype.onDragstart = function (e) {
        e.stopPropagation();
        e.preventDefault();
    };
    GameTableMaskComponent.prototype.onInputStart = function (e) {
        this.input.cancel();
        // TODO:もっと良い方法考える
        if (this.isLock) {
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].trigger('DRAG_LOCKED_OBJECT', {});
        }
    };
    GameTableMaskComponent.prototype.onContextMenu = function (e) {
        var _this = this;
        e.stopPropagation();
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        var menuPosition = this.pointerDeviceService.pointers[0];
        var objectPosition = this.tabletopService.calcTabletopLocalCoordinate();
        this.contextMenuService.open(menuPosition, [
            (this.isLock
                ? {
                    name: '固定解除', action: function () {
                        _this.isLock = false;
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].unlock);
                    }
                }
                : {
                    name: '固定する', action: function () {
                        _this.isLock = true;
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].lock);
                    }
                }),
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_8__["ContextMenuSeparator"],
            { name: 'マップマスクを編集', action: function () { _this.showDetail(_this.gameTableMask); } },
            {
                name: 'コピーを作る', action: function () {
                    var cloneObject = _this.gameTableMask.clone();
                    console.log('コピー', cloneObject);
                    cloneObject.location.x += _this.gridSize;
                    cloneObject.location.y += _this.gridSize;
                    cloneObject.isLock = false;
                    if (_this.gameTableMask.parent)
                        _this.gameTableMask.parent.appendChild(cloneObject);
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].cardPut);
                }
            },
            {
                name: '削除する', action: function () {
                    _this.gameTableMask.destroy();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].sweep);
                }
            },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_8__["ContextMenuSeparator"],
            { name: 'オブジェクト作成', action: null, subActions: this.tabletopService.getContextMenuActionsForCreateObject(objectPosition) }
        ], this.name);
    };
    GameTableMaskComponent.prototype.onMove = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].cardPick);
    };
    GameTableMaskComponent.prototype.onMoved = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].cardPut);
    };
    GameTableMaskComponent.prototype.adjustMinBounds = function (value, min) {
        if (min === void 0) { min = 0; }
        return value < min ? min : value;
    };
    GameTableMaskComponent.prototype.showDetail = function (gameObject) {
        var coordinate = this.pointerDeviceService.pointers[0];
        var title = 'マップマスク設定';
        if (gameObject.name.length)
            title += ' - ' + gameObject.name;
        var option = { title: title, left: coordinate.x - 200, top: coordinate.y - 150, width: 400, height: 300 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_6__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    GameTableMaskComponent.ctorParameters = function () { return [
        { type: service_tabletop_service__WEBPACK_IMPORTED_MODULE_11__["TabletopService"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_8__["ContextMenuService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_9__["PanelService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_10__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], GameTableMaskComponent.prototype, "gameTableMask", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], GameTableMaskComponent.prototype, "is3D", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('dragstart', ['$event'])
    ], GameTableMaskComponent.prototype, "onDragstart", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('contextmenu', ['$event'])
    ], GameTableMaskComponent.prototype, "onContextMenu", null);
    GameTableMaskComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'game-table-mask',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./game-table-mask.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table-mask/game-table-mask.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./game-table-mask.component.css */ "./src/app/component/game-table-mask/game-table-mask.component.css")).default]
        })
    ], GameTableMaskComponent);
    return GameTableMaskComponent;
}());



/***/ }),

/***/ "./src/app/component/game-table-setting/game-table-setting.component.css":
/*!*******************************************************************************!*\
  !*** ./src/app/component/game-table-setting/game-table-setting.component.css ***!
  \*******************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".flex-container { /* Safari */\n  display: -webkit-box;\n  display: flex; /* Safari */\n  -webkit-box-orient:  horizontal;\n  -webkit-box-direction:  normal;\n          flex-flow:  row wrap; /* Safari */\n  -webkit-box-pack: start;\n          justify-content: flex-start; /* Safari */\n  -webkit-box-align: stretch;\n          align-items: stretch;\n\n}\n.flex-item {\n  margin: 5px; /* Safari */\n  -webkit-box-flex: 1;\n          flex: 1 0 auto;\n  box-sizing: border-box; /* Safari */\n  flex-grow: 1;\n  max-width: 100%;\n}\n.no-grow{ /* Safari */\n  -webkit-box-flex: 0;\n          flex-grow: 0;\n}\n.images-select {\n  display: -webkit-box;\n  display: flex;\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2dhbWUtdGFibGUtc2V0dGluZy9nYW1lLXRhYmxlLXNldHRpbmcuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxrQkFDeUIsV0FBVztFQUNsQyxvQkFBYTtFQUFiLGFBQWEsRUFFZ0IsV0FBVztFQUN4QywrQkFBb0I7RUFBcEIsOEJBQW9CO1VBQXBCLG9CQUFvQixFQUVpQixXQUFXO0VBQ2hELHVCQUEyQjtVQUEzQiwyQkFBMkIsRUFFRyxXQUFXO0VBQ3pDLDBCQUFvQjtVQUFwQixvQkFBb0I7O0FBRXRCO0FBQ0E7RUFDRSxXQUFXLEVBQ2EsV0FBVztFQUNuQyxtQkFBYztVQUFkLGNBQWM7RUFDZCxzQkFBc0IsRUFDQSxXQUFXO0VBQ2pDLFlBQVk7RUFDWixlQUFlO0FBQ2pCO0FBRUEsVUFDd0IsV0FBVztFQUNqQyxtQkFBWTtVQUFaLFlBQVk7QUFDZDtBQUVBO0VBQ0Usb0JBQWE7RUFBYixhQUFhO0FBQ2YiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZ2FtZS10YWJsZS1zZXR0aW5nL2dhbWUtdGFibGUtc2V0dGluZy5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmZsZXgtY29udGFpbmVyIHtcbiAgZGlzcGxheTogLXdlYmtpdC1mbGV4OyAvKiBTYWZhcmkgKi9cbiAgZGlzcGxheTogZmxleDtcblxuICAtd2Via2l0LWZsZXgtZmxvdzogcm93IHdyYXA7IC8qIFNhZmFyaSAqL1xuICBmbGV4LWZsb3c6ICByb3cgd3JhcDtcblxuICAtd2Via2l0LWp1c3RpZnktY29udGVudDogZmxleC1zdGFydDsgLyogU2FmYXJpICovXG4gIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcblxuICAtd2Via2l0LWFsaWduLWl0ZW1zOiBzdHJldGNoOyAvKiBTYWZhcmkgKi9cbiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7XG5cbn1cbi5mbGV4LWl0ZW0ge1xuICBtYXJnaW46IDVweDtcbiAgLXdlYmtpdC1mbGV4OiAxIDAgYXV0bzsgLyogU2FmYXJpICovXG4gIGZsZXg6IDEgMCBhdXRvO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAtd2Via2l0LWZsZXgtZ3JvdzogMTsgLyogU2FmYXJpICovXG4gIGZsZXgtZ3JvdzogMTtcbiAgbWF4LXdpZHRoOiAxMDAlO1xufVxuXG4ubm8tZ3Jvd3tcbiAgLXdlYmtpdC1mbGV4LWdyb3c6IDA7IC8qIFNhZmFyaSAqL1xuICBmbGV4LWdyb3c6IDA7XG59XG5cbi5pbWFnZXMtc2VsZWN0IHtcbiAgZGlzcGxheTogZmxleDtcbn1cbiJdfQ== */");

/***/ }),

/***/ "./src/app/component/game-table-setting/game-table-setting.component.ts":
/*!******************************************************************************!*\
  !*** ./src/app/component/game-table-setting/game-table-setting.component.ts ***!
  \******************************************************************************/
/*! exports provided: GameTableSettingComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameTableSettingComponent", function() { return GameTableSettingComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_game_table__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/game-table */ "./src/app/class/game-table.ts");
/* harmony import */ var component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! component/file-selecter/file-selecter.component */ "./src/app/component/file-selecter/file-selecter.component.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_save_data_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/save-data.service */ "./src/app/service/save-data.service.ts");












var GameTableSettingComponent = /** @class */ (function () {
    function GameTableSettingComponent(modalService, saveDataService, panelService) {
        this.modalService = modalService;
        this.saveDataService = saveDataService;
        this.panelService = panelService;
        this.minSize = 1;
        this.maxSize = 100;
        this.selectedTable = null;
        this.selectedTableXml = '';
    }
    Object.defineProperty(GameTableSettingComponent.prototype, "tableBackgroundImage", {
        get: function () {
            if (!this.selectedTable)
                return _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].Empty;
            var file = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__["ImageStorage"].instance.get(this.selectedTable.imageIdentifier);
            return file ? file : _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].Empty;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableDistanceviewImage", {
        get: function () {
            if (!this.selectedTable)
                return _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].Empty;
            var file = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__["ImageStorage"].instance.get(this.selectedTable.backgroundImageIdentifier);
            return file ? file : _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].Empty;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableName", {
        get: function () { return this.selectedTable.name; },
        set: function (tableName) { if (this.isEditable)
            this.selectedTable.name = tableName; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableWidth", {
        get: function () { return this.selectedTable.width; },
        set: function (tableWidth) { if (this.isEditable)
            this.selectedTable.width = tableWidth; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableHeight", {
        get: function () { return this.selectedTable.height; },
        set: function (tableHeight) { if (this.isEditable)
            this.selectedTable.height = tableHeight; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableGridColor", {
        get: function () { return this.selectedTable.gridColor; },
        set: function (tableGridColor) { if (this.isEditable)
            this.selectedTable.gridColor = tableGridColor; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableGridShow", {
        get: function () { return this.tableSelecter.gridShow; },
        set: function (tableGridShow) {
            this.tableSelecter.gridShow = tableGridShow;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableGridSnap", {
        get: function () { return this.tableSelecter.gridSnap; },
        set: function (tableGridSnap) {
            this.tableSelecter.gridSnap = tableGridSnap;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableGridType", {
        get: function () { return this.selectedTable.gridType; },
        set: function (gridType) { if (this.isEditable)
            this.selectedTable.gridType = Number(gridType); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableDistanceviewFilter", {
        get: function () { return this.selectedTable.backgroundFilterType; },
        set: function (filterType) { if (this.isEditable)
            this.selectedTable.backgroundFilterType = filterType; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "tableSelecter", {
        get: function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get('tableSelecter'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "isEmpty", {
        get: function () { return this.tableSelecter ? (this.tableSelecter.viewTable ? false : true) : true; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "isDeleted", {
        get: function () {
            if (!this.selectedTable)
                return true;
            return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(this.selectedTable.identifier) == null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableSettingComponent.prototype, "isEditable", {
        get: function () {
            return !this.isEmpty && !this.isDeleted;
        },
        enumerable: true,
        configurable: true
    });
    GameTableSettingComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.modalService.title = this.panelService.title = 'テーブル設定';
        this.selectedTable = this.tableSelecter.viewTable;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].register(this)
            .on('DELETE_GAME_OBJECT', 1000, function (event) {
            if (!_this.selectedTable || event.data.identifier !== _this.selectedTable.identifier)
                return;
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(event.data.identifier);
            if (object !== null) {
                _this.selectedTableXml = object.toXml();
            }
        });
    };
    GameTableSettingComponent.prototype.ngAfterViewInit = function () { };
    GameTableSettingComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].unregister(this);
    };
    GameTableSettingComponent.prototype.selectGameTable = function (identifier) {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].call('SELECT_GAME_TABLE', { identifier: identifier }, _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["Network"].peerId);
        this.selectedTable = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get(identifier);
        this.selectedTableXml = '';
    };
    GameTableSettingComponent.prototype.getGameTables = function () {
        return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.getObjects(_udonarium_game_table__WEBPACK_IMPORTED_MODULE_7__["GameTable"]);
    };
    GameTableSettingComponent.prototype.createGameTable = function () {
        var gameTable = new _udonarium_game_table__WEBPACK_IMPORTED_MODULE_7__["GameTable"]();
        gameTable.name = '白紙のテーブル';
        gameTable.imageIdentifier = 'testTableBackgroundImage_image';
        gameTable.initialize();
        this.selectGameTable(gameTable.identifier);
    };
    GameTableSettingComponent.prototype.save = function () {
        if (!this.selectedTable)
            return;
        this.selectedTable.selected = true;
        this.saveDataService.saveGameObject(this.selectedTable, 'map_' + this.selectedTable.name);
    };
    GameTableSettingComponent.prototype.delete = function () {
        if (!this.isEmpty && this.selectedTable) {
            this.selectedTableXml = this.selectedTable.toXml();
            this.selectedTable.destroy();
        }
    };
    GameTableSettingComponent.prototype.restore = function () {
        if (this.selectedTable && this.selectedTableXml) {
            var restoreTable = _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_4__["ObjectSerializer"].instance.parseXml(this.selectedTableXml);
            this.selectGameTable(restoreTable.identifier);
            this.selectedTableXml = '';
        }
    };
    GameTableSettingComponent.prototype.openBgImageModal = function () {
        var _this = this;
        if (this.isDeleted)
            return;
        this.modalService.open(component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_8__["FileSelecterComponent"]).then(function (value) {
            if (!_this.selectedTable || !value)
                return;
            _this.selectedTable.imageIdentifier = value;
        });
    };
    GameTableSettingComponent.prototype.openDistanceViewImageModal = function () {
        var _this = this;
        if (this.isDeleted)
            return;
        this.modalService.open(component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_8__["FileSelecterComponent"], { isAllowedEmpty: true }).then(function (value) {
            if (!_this.selectedTable || !value)
                return;
            _this.selectedTable.backgroundImageIdentifier = value;
        });
    };
    GameTableSettingComponent.ctorParameters = function () { return [
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_9__["ModalService"] },
        { type: service_save_data_service__WEBPACK_IMPORTED_MODULE_11__["SaveDataService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_10__["PanelService"] }
    ]; };
    GameTableSettingComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'game-table-setting',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./game-table-setting.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table-setting/game-table-setting.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./game-table-setting.component.css */ "./src/app/component/game-table-setting/game-table-setting.component.css")).default]
        })
    ], GameTableSettingComponent);
    return GameTableSettingComponent;
}());



/***/ }),

/***/ "./src/app/component/game-table/game-table.component.css":
/*!***************************************************************!*\
  !*** ./src/app/component/game-table/game-table.component.css ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".is-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.is-perspective {\n  -webkit-perspective: 1000px;\n  perspective: 1000px;\n}\n\n.is-fill {\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin: auto;\n}\n\n.is-3d {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  position: absolute;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n\n.component {\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n\n  touch-action: manipulation;\n\n  height: 100%;\n  width: 100%;\n\n  overflow: hidden;\n}\n\n.component-content {\n  height: 2000px;\n  width: 2000px;\n}\n\n.grid-canvas {\n  opacity: 0.0;\n  -webkit-transform: translateZ(0.15px);\n          transform: translateZ(0.15px);\n  -webkit-transition: 0.3s ease-out;\n  transition: 0.3s ease-out;\n\n  -webkit-backface-visibility: hidden;\n\n          backface-visibility: hidden;\n}\n\n.game-table {\n  height: 100%;\n  width: 100%;\n}\n\n.table-image {\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  background-repeat: no-repeat;\n  background-size: 100% 100%;\n}\n\n.background-image {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin: -5px;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-size: cover;\n}\n\n.background-image.is-filter {\n  will-change: filter;\n}\n\n.background-image.is-filter.white {\n  -webkit-filter: blur(5px) contrast(1);\n          filter: blur(5px) contrast(1);\n}\n\n.background-image.is-filter.black {\n  -webkit-filter: blur(5px) contrast(1);\n          filter: blur(5px) contrast(1);\n}\n\n.background-image.is-filter::after {\n  display: block;\n  content: '';\n  width: 100%;\n  height: 100%;\n}\n\n.background-image.is-filter.white::after {\n  background-color: hsl(0, 0%, 97%);\n  -webkit-filter: opacity(0.2);\n          filter: opacity(0.2);\n}\n\n.background-image.is-filter.black::after {\n  background-color: hsl(0, 0%, 10%);\n  -webkit-filter: opacity(0.3);\n          filter: opacity(0.3);\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2dhbWUtdGFibGUvZ2FtZS10YWJsZS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUUsd0JBQXdCO0VBQ3hCLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLDJCQUEyQjtFQUMzQixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxjQUFjO0VBQ2Qsa0JBQWtCO0VBQ2xCLE1BQU07RUFDTixPQUFPO0VBQ1AsU0FBUztFQUNULFFBQVE7RUFDUixZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxvQ0FBb0M7RUFDcEMsNEJBQTRCO0VBQzVCLG1DQUEyQjtVQUEzQiwyQkFBMkI7RUFDM0Isa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLHlCQUF5QjtFQUN6QixxQkFBaUI7TUFBakIsaUJBQWlCO0VBQ2pCLG9CQUFvQjtFQUNwQix1QkFBdUI7O0VBRXZCLDBCQUEwQjs7RUFFMUIsWUFBWTtFQUNaLFdBQVc7O0VBRVgsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsY0FBYztFQUNkLGFBQWE7QUFDZjs7QUFFQTtFQUNFLFlBQVk7RUFDWixxQ0FBNkI7VUFBN0IsNkJBQTZCO0VBQzdCLGlDQUFpQztFQUdqQyx5QkFBeUI7O0VBRXpCLG1DQUEyQjs7VUFBM0IsMkJBQTJCO0FBQzdCOztBQUVBO0VBQ0UsWUFBWTtFQUNaLFdBQVc7QUFDYjs7QUFFQTtFQUNFLG1DQUEyQjtVQUEzQiwyQkFBMkI7RUFDM0Isa0JBQWtCO0VBQ2xCLFlBQVk7RUFDWixXQUFXO0VBQ1gsNEJBQTRCO0VBQzVCLDBCQUEwQjtBQUM1Qjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixNQUFNO0VBQ04sT0FBTztFQUNQLFNBQVM7RUFDVCxRQUFRO0VBQ1IsWUFBWTtFQUNaLDRCQUE0QjtFQUM1QiwyQkFBMkI7RUFDM0Isc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UscUNBQTZCO1VBQTdCLDZCQUE2QjtBQUMvQjs7QUFFQTtFQUNFLHFDQUE2QjtVQUE3Qiw2QkFBNkI7QUFDL0I7O0FBRUE7RUFDRSxjQUFjO0VBQ2QsV0FBVztFQUNYLFdBQVc7RUFDWCxZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxpQ0FBaUM7RUFDakMsNEJBQW9CO1VBQXBCLG9CQUFvQjtBQUN0Qjs7QUFFQTtFQUNFLGlDQUFpQztFQUNqQyw0QkFBb0I7VUFBcEIsb0JBQW9CO0FBQ3RCIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2dhbWUtdGFibGUvZ2FtZS10YWJsZS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmlzLWdyYWJiaW5nIHtcbiAgY3Vyc29yOiAtbW96LWdyYWJiaW5nO1xuICBjdXJzb3I6IC13ZWJraXQtZ3JhYmJpbmc7XG4gIGN1cnNvcjogZ3JhYmJpbmc7XG59XG5cbi5pcy1wZXJzcGVjdGl2ZSB7XG4gIC13ZWJraXQtcGVyc3BlY3RpdmU6IDEwMDBweDtcbiAgcGVyc3BlY3RpdmU6IDEwMDBweDtcbn1cblxuLmlzLWZpbGwge1xuICBkaXNwbGF5OiBibG9jaztcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgcmlnaHQ6IDA7XG4gIG1hcmdpbjogYXV0bztcbn1cblxuLmlzLTNkIHtcbiAgLXdlYmtpdC10cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkO1xuICB0cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkO1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbn1cblxuLmlzLXBvaW50ZXItZXZlbnRzLW5vbmUge1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbn1cblxuLmNvbXBvbmVudCB7XG4gIC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7XG4gIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7XG4gIHVzZXItc2VsZWN0OiBub25lO1xuICAtbW96LXVzZXItZHJhZzogbm9uZTtcbiAgLXdlYmtpdC11c2VyLWRyYWc6IG5vbmU7XG5cbiAgdG91Y2gtYWN0aW9uOiBtYW5pcHVsYXRpb247XG5cbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcblxuICBvdmVyZmxvdzogaGlkZGVuO1xufVxuXG4uY29tcG9uZW50LWNvbnRlbnQge1xuICBoZWlnaHQ6IDIwMDBweDtcbiAgd2lkdGg6IDIwMDBweDtcbn1cblxuLmdyaWQtY2FudmFzIHtcbiAgb3BhY2l0eTogMC4wO1xuICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVooMC4xNXB4KTtcbiAgLXdlYmtpdC10cmFuc2l0aW9uOiAwLjNzIGVhc2Utb3V0O1xuICAtbW96LXRyYW5zaXRpb246IDAuM3MgZWFzZS1vdXQ7XG4gIC1vLXRyYW5zaXRpb246IDAuM3MgZWFzZS1vdXQ7XG4gIHRyYW5zaXRpb246IDAuM3MgZWFzZS1vdXQ7XG5cbiAgYmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuO1xufVxuXG4uZ2FtZS10YWJsZSB7XG4gIGhlaWdodDogMTAwJTtcbiAgd2lkdGg6IDEwMCU7XG59XG5cbi50YWJsZS1pbWFnZSB7XG4gIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHdpZHRoOiAxMDAlO1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXNpemU6IDEwMCUgMTAwJTtcbn1cblxuLmJhY2tncm91bmQtaW1hZ2Uge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgYm90dG9tOiAwO1xuICByaWdodDogMDtcbiAgbWFyZ2luOiAtNXB4O1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7XG4gIGJhY2tncm91bmQtc2l6ZTogY292ZXI7XG59XG5cbi5iYWNrZ3JvdW5kLWltYWdlLmlzLWZpbHRlciB7XG4gIHdpbGwtY2hhbmdlOiBmaWx0ZXI7XG59XG5cbi5iYWNrZ3JvdW5kLWltYWdlLmlzLWZpbHRlci53aGl0ZSB7XG4gIGZpbHRlcjogYmx1cig1cHgpIGNvbnRyYXN0KDEpO1xufVxuXG4uYmFja2dyb3VuZC1pbWFnZS5pcy1maWx0ZXIuYmxhY2sge1xuICBmaWx0ZXI6IGJsdXIoNXB4KSBjb250cmFzdCgxKTtcbn1cblxuLmJhY2tncm91bmQtaW1hZ2UuaXMtZmlsdGVyOjphZnRlciB7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICBjb250ZW50OiAnJztcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbn1cblxuLmJhY2tncm91bmQtaW1hZ2UuaXMtZmlsdGVyLndoaXRlOjphZnRlciB7XG4gIGJhY2tncm91bmQtY29sb3I6IGhzbCgwLCAwJSwgOTclKTtcbiAgZmlsdGVyOiBvcGFjaXR5KDAuMik7XG59XG5cbi5iYWNrZ3JvdW5kLWltYWdlLmlzLWZpbHRlci5ibGFjazo6YWZ0ZXIge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiBoc2woMCwgMCUsIDEwJSk7XG4gIGZpbHRlcjogb3BhY2l0eSgwLjMpO1xufVxuIl19 */");

/***/ }),

/***/ "./src/app/component/game-table/game-table.component.ts":
/*!**************************************************************!*\
  !*** ./src/app/component/game-table/game-table.component.ts ***!
  \**************************************************************/
/*! exports provided: GameTableComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameTableComponent", function() { return GameTableComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_game_table__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/game-table */ "./src/app/class/game-table.ts");
/* harmony import */ var component_game_table_setting_game_table_setting_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! component/game-table-setting/game-table-setting.component */ "./src/app/component/game-table-setting/game-table-setting.component.ts");
/* harmony import */ var directive_input_handler__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! directive/input-handler */ "./src/app/directive/input-handler.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_tabletop_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/tabletop.service */ "./src/app/service/tabletop.service.ts");












var GameTableComponent = /** @class */ (function () {
    function GameTableComponent(ngZone, contextMenuService, elementRef, pointerDeviceService, tabletopService, modalService) {
        this.ngZone = ngZone;
        this.contextMenuService = contextMenuService;
        this.elementRef = elementRef;
        this.pointerDeviceService = pointerDeviceService;
        this.tabletopService = tabletopService;
        this.modalService = modalService;
        this.isTransformMode = false;
        this.currentPositionX = 0;
        this.currentPositionY = 0;
        this.viewPotisonX = 100;
        this.viewPotisonY = 0;
        this.viewPotisonZ = 0;
        this.viewRotateX = 50;
        this.viewRotateY = 0;
        this.viewRotateZ = 10;
        this.buttonCode = 0;
        this.input = null;
        this.hammer = null;
        this.deltaHammerDeltaX = 0;
        this.deltaHammerDeltaY = 1.0;
        this.deltaHammerScale = 1.0;
        this.deltaHammerRotation = 0;
        this.prevHammerDeltaX = 0;
        this.prevHammerDeltaY = 0;
        this.prevHammerScale = 0;
        this.prevHammerRotation = 0;
        this.tappedPanTimer = null;
        this.tappedPanCenter = { x: 0, y: 0 };
    }
    Object.defineProperty(GameTableComponent.prototype, "tableSelecter", {
        get: function () { return this.tabletopService.tableSelecter; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "currentTable", {
        get: function () { return this.tabletopService.currentTable; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "tableImage", {
        get: function () {
            var file = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__["ImageStorage"].instance.get(this.currentTable.imageIdentifier);
            return file ? file : _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].Empty;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "backgroundImage", {
        get: function () {
            var file = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_3__["ImageStorage"].instance.get(this.currentTable.backgroundImageIdentifier);
            return file ? file : _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_2__["ImageFile"].Empty;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "backgroundFilterType", {
        get: function () {
            return this.currentTable.backgroundFilterType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "isPointerDragging", {
        get: function () { return this.pointerDeviceService.isDragging; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "characters", {
        get: function () { return this.tabletopService.characters; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "tableMasks", {
        get: function () { return this.tabletopService.tableMasks; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "cards", {
        get: function () { return this.tabletopService.cards; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "cardStacks", {
        get: function () { return this.tabletopService.cardStacks; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "terrains", {
        get: function () { return this.tabletopService.terrains; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "textNotes", {
        get: function () { return this.tabletopService.textNotes; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "diceSymbols", {
        get: function () { return this.tabletopService.diceSymbols; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameTableComponent.prototype, "peerCursors", {
        get: function () { return this.tabletopService.peerCursors; },
        enumerable: true,
        configurable: true
    });
    GameTableComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            if (event.data.identifier !== _this.currentTable.identifier && event.data.identifier !== _this.tableSelecter.identifier)
                return;
            console.log('UPDATE_GAME_OBJECT GameTableComponent ' + _this.currentTable.identifier);
            _this.setGameTableGrid(_this.currentTable.width, _this.currentTable.height, _this.currentTable.gridSize, _this.currentTable.gridType, _this.currentTable.gridColor);
        })
            .on('DRAG_LOCKED_OBJECT', function (event) {
            _this.isTransformMode = true;
            _this.pointerDeviceService.isDragging = false;
            var opacity = _this.tableSelecter.gridShow ? 1.0 : 0.0;
            _this.gridCanvas.nativeElement.style.opacity = opacity + '';
        });
        this.tabletopService.makeDefaultTable();
        this.tabletopService.makeDefaultTabletopObjects();
    };
    GameTableComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            _this.input = new directive_input_handler__WEBPACK_IMPORTED_MODULE_7__["InputHandler"](_this.elementRef.nativeElement, { capture: true });
            _this.initializeHammer();
        });
        this.input.onStart = this.onInputStart.bind(this);
        this.input.onMove = this.onInputMove.bind(this);
        this.input.onEnd = this.onInputEnd.bind(this);
        this.setGameTableGrid(this.currentTable.width, this.currentTable.height, this.currentTable.gridSize, this.currentTable.gridType, this.currentTable.gridColor);
        this.setTransform(0, 0, 0, 0, 0, 0);
        this.tabletopService.dragAreaElement = this.gameObjects.nativeElement;
    };
    GameTableComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
        this.input.destroy();
        this.hammer.destroy();
    };
    GameTableComponent.prototype.initializeHammer = function () {
        var _this = this;
        this.hammer = new Hammer.Manager(this.rootElementRef.nativeElement, { inputClass: Hammer.TouchInput });
        var tap = new Hammer.Tap();
        var pan1p = new Hammer.Pan({ event: 'pan1p', pointers: 1, threshold: 0 });
        var pan2p = new Hammer.Pan({ event: 'pan2p', pointers: 2, threshold: 0 });
        var pinch = new Hammer.Pinch();
        var rotate = new Hammer.Rotate();
        pan1p.recognizeWith(pan2p);
        pan1p.recognizeWith(rotate);
        pan1p.recognizeWith(pinch);
        pan2p.recognizeWith(pinch);
        pan2p.recognizeWith(rotate);
        pinch.recognizeWith(rotate);
        this.hammer.add([tap, pan1p, pan2p, pinch, rotate]);
        this.hammer.on('hammer.input', this.onHammer.bind(this));
        this.hammer.on('tap', this.onTap.bind(this));
        this.hammer.on('pan1pstart', this.onTappedPanStart.bind(this));
        this.hammer.on('pan1pmove', this.onTappedPanMove.bind(this));
        this.hammer.on('pan1pend', this.onTappedPanEnd.bind(this));
        this.hammer.on('pan1pcancel', this.onTappedPanEnd.bind(this));
        this.hammer.on('pan2pmove', this.onPanMove.bind(this));
        this.hammer.on('pinchmove', this.onPinchMove.bind(this));
        this.hammer.on('rotatemove', this.onRotateMove.bind(this));
        // iOS で contextmenu が発火しない問題へのworkaround.
        var ua = window.navigator.userAgent.toLowerCase();
        var isiOS = ua.indexOf('iphone') > -1 || ua.indexOf('ipad') > -1 || ua.indexOf('macintosh') > -1 && 'ontouchend' in document;
        if (!isiOS)
            return;
        this.hammer.add(new Hammer.Press({ time: 251 }));
        this.hammer.on('press', function (ev) {
            var event = new MouseEvent('contextmenu', {
                bubbles: true,
                cancelable: true,
                clientX: ev.center.x,
                clientY: ev.center.y,
            });
            _this.ngZone.run(function () { return ev.srcEvent.target.dispatchEvent(event); });
        });
    };
    GameTableComponent.prototype.onHammer = function (ev) {
        if (ev.isFirst) {
            this.deltaHammerScale = ev.scale;
            this.deltaHammerRotation = ev.rotation;
            this.deltaHammerDeltaX = ev.deltaX;
            this.deltaHammerDeltaY = ev.deltaY;
        }
        else {
            this.deltaHammerScale = ev.scale - this.prevHammerScale;
            this.deltaHammerRotation = ev.rotation - this.prevHammerRotation;
            this.deltaHammerDeltaX = ev.deltaX - this.prevHammerDeltaX;
            this.deltaHammerDeltaY = ev.deltaY - this.prevHammerDeltaY;
        }
        this.prevHammerScale = ev.scale;
        this.prevHammerRotation = ev.rotation;
        this.prevHammerDeltaX = ev.deltaX;
        this.prevHammerDeltaY = ev.deltaY;
        if (this.tappedPanTimer == null || ev.eventType != Hammer.INPUT_START)
            return;
        var distance = Math.pow((this.tappedPanCenter.x - ev.center.x), 2) + Math.pow((this.tappedPanCenter.y - ev.center.y), 2);
        if (Math.pow(50, 2) < distance) {
            clearTimeout(this.tappedPanTimer);
            this.tappedPanTimer = null;
        }
    };
    GameTableComponent.prototype.onTap = function (ev) {
        var _this = this;
        this.cancelInput();
        this.tappedPanCenter = ev.center;
        this.tappedPanTimer = setTimeout(function () { _this.tappedPanTimer = null; }, 400);
    };
    GameTableComponent.prototype.onTappedPanStart = function (ev) {
        if (this.tappedPanTimer == null)
            return;
        clearTimeout(this.tappedPanTimer);
        this.cancelInput();
    };
    GameTableComponent.prototype.onTappedPanEnd = function (ev) {
        clearTimeout(this.tappedPanTimer);
        this.tappedPanTimer = null;
    };
    GameTableComponent.prototype.onTappedPanMove = function (ev) {
        var _this = this;
        if (this.tappedPanTimer == null) {
            if (!this.isTransformMode || this.input.isGrabbing)
                return;
            var transformX = 0;
            var transformY = 0;
            var transformZ = 0;
            var scale = (1000 + Math.abs(this.viewPotisonZ)) / 1000;
            transformX = this.deltaHammerDeltaX * scale;
            transformY = this.deltaHammerDeltaY * scale;
            if (!this.pointerDeviceService.isAllowedToOpenContextMenu && this.contextMenuService.isShow) {
                this.ngZone.run(function () { _this.contextMenuService.close(); });
            }
            this.setTransform(transformX, transformY, transformZ, 0, 0, 0);
        }
        else {
            clearTimeout(this.tappedPanTimer);
            this.cancelInput();
            var scale = this.deltaHammerDeltaY;
            var transformZ = scale * 7.5;
            if (750 < transformZ + this.viewPotisonZ)
                transformZ += 750 - (transformZ + this.viewPotisonZ);
            this.setTransform(0, 0, transformZ, 0, 0, 0);
        }
    };
    GameTableComponent.prototype.onPanMove = function (ev) {
        clearTimeout(this.tappedPanTimer);
        this.tappedPanTimer = null;
        this.cancelInput();
        var rotateX = -this.deltaHammerDeltaY / window.innerHeight * 100;
        if (80 < rotateX + this.viewRotateX)
            rotateX += 80 - (rotateX + this.viewRotateX);
        if (rotateX + this.viewRotateX < 0)
            rotateX += 0 - (rotateX + this.viewRotateX);
        this.setTransform(0, 0, 0, rotateX, 0, 0);
    };
    GameTableComponent.prototype.onPinchMove = function (ev) {
        clearTimeout(this.tappedPanTimer);
        this.tappedPanTimer = null;
        this.cancelInput();
        var transformZ = this.deltaHammerScale * 500;
        if (750 < transformZ + this.viewPotisonZ)
            transformZ += 750 - (transformZ + this.viewPotisonZ);
        this.setTransform(0, 0, transformZ, 0, 0, 0);
    };
    GameTableComponent.prototype.onRotateMove = function (ev) {
        clearTimeout(this.tappedPanTimer);
        this.tappedPanTimer = null;
        this.cancelInput();
        var rotateZ = this.deltaHammerRotation;
        this.setTransform(0, 0, 0, 0, 0, rotateZ);
    };
    GameTableComponent.prototype.onInputStart = function (e) {
        this.currentPositionX = this.input.pointer.x;
        this.currentPositionY = this.input.pointer.y;
        if (e.target.contains(this.gameObjects.nativeElement) || e.button === 1 || e.button === 2) {
            this.isTransformMode = true;
        }
        else {
            this.isTransformMode = false;
            this.pointerDeviceService.isDragging = true;
            this.gridCanvas.nativeElement.style.opacity = 1.0 + '';
        }
        this.buttonCode = e.button;
        if (!document.activeElement.contains(e.target)) {
            this.removeSelectionRanges();
            this.removeFocus();
        }
    };
    GameTableComponent.prototype.onInputEnd = function (e) {
        this.cancelInput();
    };
    GameTableComponent.prototype.onInputMove = function (e) {
        var _this = this;
        if (!this.isTransformMode || this.tappedPanTimer != null)
            return;
        var x = this.input.pointer.x;
        var y = this.input.pointer.y;
        var deltaX = x - this.currentPositionX;
        var deltaY = y - this.currentPositionY;
        var transformX = 0;
        var transformY = 0;
        var transformZ = 0;
        var rotateX = 0;
        var rotateY = 0;
        var rotateZ = 0;
        if (this.buttonCode === 2) {
            rotateZ = -deltaX / 5;
            rotateX = -deltaY / 5;
        }
        else {
            var scale = (1000 + Math.abs(this.viewPotisonZ)) / 1000;
            transformX = deltaX * scale;
            transformY = deltaY * scale;
        }
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu && this.contextMenuService.isShow) {
            this.ngZone.run(function () { _this.contextMenuService.close(); });
        }
        this.currentPositionX = x;
        this.currentPositionY = y;
        this.setTransform(transformX, transformY, transformZ, rotateX, rotateY, rotateZ);
    };
    GameTableComponent.prototype.cancelInput = function () {
        this.input.cancel();
        this.pointerDeviceService.isDragging = false;
        var opacity = this.tableSelecter.gridShow ? 1.0 : 0.0;
        this.gridCanvas.nativeElement.style.opacity = opacity + '';
    };
    GameTableComponent.prototype.onWheel = function (e) {
        var transformX = 0;
        var transformY = 0;
        var transformZ = 0;
        var rotateX = 0;
        var rotateY = 0;
        var rotateZ = 0;
        if (e.deltaY < 0) {
            transformZ = 150;
        }
        else if (0 < e.deltaY) {
            transformZ = -150;
        }
        this.setTransform(transformX, transformY, transformZ, rotateX, rotateY, rotateZ);
    };
    GameTableComponent.prototype.onKeydown = function (e) {
        if (document.body !== document.activeElement)
            return;
        var transformX = 0;
        var transformY = 0;
        var transformZ = 0;
        var rotateX = 0;
        var rotateY = 0;
        var rotateZ = 0;
        if (e.keyCode === 37) { //←
            if (e.shiftKey) {
                rotateZ = -2;
            }
            else {
                transformX = 10;
            }
        }
        if (e.keyCode === 38) { //↑
            if (e.shiftKey) {
                rotateX = -2;
            }
            else {
                transformY = 10;
            }
        }
        if (e.keyCode === 39) { //→
            if (e.shiftKey) {
                rotateZ = 2;
            }
            else {
                transformX = -10;
            }
        }
        if (e.keyCode === 40) { //↓
            if (e.shiftKey) {
                rotateX = 2;
            }
            else {
                transformY = -10;
            }
        }
        this.setTransform(transformX, transformY, transformZ, rotateX, rotateY, rotateZ);
    };
    GameTableComponent.prototype.onContextMenu = function (e) {
        var _this = this;
        if (!document.activeElement.contains(this.gameObjects.nativeElement))
            return;
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        var menuPosition = this.pointerDeviceService.pointers[0];
        var objectPosition = this.tabletopService.calcTabletopLocalCoordinate();
        var menuActions = [];
        Array.prototype.push.apply(menuActions, this.tabletopService.getContextMenuActionsForCreateObject(objectPosition));
        menuActions.push(service_context_menu_service__WEBPACK_IMPORTED_MODULE_8__["ContextMenuSeparator"]);
        menuActions.push({
            name: 'テーブル設定', action: function () {
                _this.modalService.open(component_game_table_setting_game_table_setting_component__WEBPACK_IMPORTED_MODULE_6__["GameTableSettingComponent"]);
            }
        });
        this.contextMenuService.open(menuPosition, menuActions, this.currentTable.name);
    };
    GameTableComponent.prototype.setTransform = function (transformX, transformY, transformZ, rotateX, rotateY, rotateZ) {
        this.viewRotateX += rotateX;
        this.viewRotateY += rotateY;
        this.viewRotateZ += rotateZ;
        this.viewPotisonX += transformX;
        this.viewPotisonY += transformY;
        this.viewPotisonZ += transformZ;
        this.gameTable.nativeElement.style.transform = 'translateZ(' + this.viewPotisonZ + 'px) translateY(' + this.viewPotisonY + 'px) translateX(' + this.viewPotisonX + 'px) rotateY(' + this.viewRotateY + 'deg) rotateX(' + this.viewRotateX + 'deg) rotateZ(' + this.viewRotateZ + 'deg) ';
    };
    GameTableComponent.prototype.setGameTableGrid = function (width, height, gridSize, gridType, gridColor) {
        if (gridSize === void 0) { gridSize = 50; }
        if (gridType === void 0) { gridType = _udonarium_game_table__WEBPACK_IMPORTED_MODULE_5__["GridType"].SQUARE; }
        if (gridColor === void 0) { gridColor = '#000000e6'; }
        this.gameTable.nativeElement.style.width = width * gridSize + 'px';
        this.gameTable.nativeElement.style.height = height * gridSize + 'px';
        var canvasElement = this.gridCanvas.nativeElement;
        canvasElement.width = width * gridSize;
        canvasElement.height = height * gridSize;
        var context = canvasElement.getContext('2d');
        context.strokeStyle = gridColor;
        context.fillStyle = context.strokeStyle;
        context.lineWidth = 1;
        // 座標描画用font設定
        var fontSize = Math.floor(gridSize / 5);
        context.font = 'bold ' + fontSize + 'px sans-serif';
        context.textBaseline = 'top';
        context.textAlign = 'center';
        var gx; // グリッド用Rect描画開始位置(x)
        var gy; // 同上(y)
        var calcGridPosition;
        switch (gridType) {
            case _udonarium_game_table__WEBPACK_IMPORTED_MODULE_5__["GridType"].HEX_VERTICAL: // ヘクス縦揃え
                calcGridPosition = function (w, h) {
                    if ((w % 2) === 1) {
                        gx = w * gridSize;
                        gy = h * gridSize;
                    }
                    else {
                        gx = w * gridSize;
                        gy = h * gridSize + (gridSize / 2);
                    }
                };
                break;
            case _udonarium_game_table__WEBPACK_IMPORTED_MODULE_5__["GridType"].HEX_HORIZONTAL: // ヘクス横揃え(どどんとふ互換)
                calcGridPosition = function (w, h) {
                    if ((h % 2) === 1) {
                        gx = w * gridSize;
                        gy = h * gridSize;
                    }
                    else {
                        gx = w * gridSize + (gridSize / 2);
                        gy = h * gridSize;
                    }
                };
                break;
            default: // スクエア(default)
                calcGridPosition = function (w, h) {
                    gx = w * gridSize;
                    gy = h * gridSize;
                };
                break;
        }
        for (var h = 0; h <= height; h++) {
            for (var w = 0; w <= width; w++) {
                calcGridPosition(w, h);
                context.beginPath();
                context.strokeRect(gx, gy, gridSize, gridSize);
                context.fillText((w + 1).toString() + '-' + (h + 1).toString(), gx + (gridSize / 2), gy + (gridSize / 2));
            }
        }
        var opacity = this.tableSelecter.gridShow ? 1.0 : 0.0;
        this.gridCanvas.nativeElement.style.opacity = opacity + '';
    };
    GameTableComponent.prototype.removeSelectionRanges = function () {
        var selection = window.getSelection();
        if (!selection.isCollapsed) {
            selection.removeAllRanges();
        }
    };
    GameTableComponent.prototype.removeFocus = function () {
        if (document.activeElement instanceof HTMLElement) {
            document.activeElement.blur();
        }
    };
    GameTableComponent.prototype.trackByGameObject = function (index, gameObject) {
        return gameObject.identifier;
    };
    GameTableComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_8__["ContextMenuService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_10__["PointerDeviceService"] },
        { type: service_tabletop_service__WEBPACK_IMPORTED_MODULE_11__["TabletopService"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_9__["ModalService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('root', { static: true })
    ], GameTableComponent.prototype, "rootElementRef", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('gameTable', { static: true })
    ], GameTableComponent.prototype, "gameTable", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('gameObjects', { static: true })
    ], GameTableComponent.prototype, "gameObjects", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('gridCanvas', { static: true })
    ], GameTableComponent.prototype, "gridCanvas", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('wheel', ['$event'])
    ], GameTableComponent.prototype, "onWheel", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('document:keydown', ['$event'])
    ], GameTableComponent.prototype, "onKeydown", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('contextmenu', ['$event'])
    ], GameTableComponent.prototype, "onContextMenu", null);
    GameTableComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'game-table',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./game-table.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/game-table/game-table.component.html")).default,
            providers: [
                service_tabletop_service__WEBPACK_IMPORTED_MODULE_11__["TabletopService"],
            ],
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./game-table.component.css */ "./src/app/component/game-table/game-table.component.css")).default]
        })
    ], GameTableComponent);
    return GameTableComponent;
}());



/***/ }),

/***/ "./src/app/component/jukebox/jukebox.component.css":
/*!*********************************************************!*\
  !*** ./src/app/component/jukebox/jukebox.component.css ***!
  \*********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".drop-zone {\n  border: 2px dashed #555;\n  border-radius: 5px;\n  padding: 25px;\n  text-align: center;\n  font: 24px bold 'Vollkorn';\n  color: #444;\n  cursor: pointer;\n}\n\n.large-font {\n  font-size: 64px;\n}\n\n.small-font {\n  font-size: 12px;\n}\n\n.box {\n  border-bottom:1px dotted #888;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2p1a2Vib3gvanVrZWJveC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsdUJBQXVCO0VBR3ZCLGtCQUFrQjtFQUNsQixhQUFhO0VBQ2Isa0JBQWtCO0VBQ2xCLDBCQUEwQjtFQUMxQixXQUFXO0VBQ1gsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsNkJBQTZCO0FBQy9CIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2p1a2Vib3gvanVrZWJveC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmRyb3Atem9uZSB7XG4gIGJvcmRlcjogMnB4IGRhc2hlZCAjNTU1O1xuICAtbW96LWJvcmRlci1yYWRpdXM6IDVweDtcbiAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgcGFkZGluZzogMjVweDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBmb250OiAyNHB4IGJvbGQgJ1ZvbGxrb3JuJztcbiAgY29sb3I6ICM0NDQ7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuLmxhcmdlLWZvbnQge1xuICBmb250LXNpemU6IDY0cHg7XG59XG5cbi5zbWFsbC1mb250IHtcbiAgZm9udC1zaXplOiAxMnB4O1xufVxuXG4uYm94IHtcbiAgYm9yZGVyLWJvdHRvbToxcHggZG90dGVkICM4ODg7XG59Il19 */");

/***/ }),

/***/ "./src/app/component/jukebox/jukebox.component.ts":
/*!********************************************************!*\
  !*** ./src/app/component/jukebox/jukebox.component.ts ***!
  \********************************************************/
/*! exports provided: JukeboxComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JukeboxComponent", function() { return JukeboxComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/file-storage/audio-player */ "./src/app/class/core/file-storage/audio-player.ts");
/* harmony import */ var _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/audio-storage */ "./src/app/class/core/file-storage/audio-storage.ts");
/* harmony import */ var _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/file-storage/file-archiver */ "./src/app/class/core/file-storage/file-archiver.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");









var JukeboxComponent = /** @class */ (function () {
    function JukeboxComponent(modalService, panelService, ngZone) {
        this.modalService = modalService;
        this.panelService = panelService;
        this.ngZone = ngZone;
        this.auditionPlayer = new _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_2__["AudioPlayer"]();
        this.lazyUpdateTimer = null;
    }
    Object.defineProperty(JukeboxComponent.prototype, "volume", {
        get: function () { return _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_2__["AudioPlayer"].volume; },
        set: function (volume) { _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_2__["AudioPlayer"].volume = volume; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(JukeboxComponent.prototype, "auditionVolume", {
        get: function () { return _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_2__["AudioPlayer"].auditionVolume; },
        set: function (auditionVolume) { _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_2__["AudioPlayer"].auditionVolume = auditionVolume; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(JukeboxComponent.prototype, "audios", {
        get: function () { return _udonarium_core_file_storage_audio_storage__WEBPACK_IMPORTED_MODULE_3__["AudioStorage"].instance.audios.filter(function (audio) { return !audio.isHidden; }); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(JukeboxComponent.prototype, "jukebox", {
        get: function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_5__["ObjectStore"].instance.get('Jukebox'); },
        enumerable: true,
        configurable: true
    });
    JukeboxComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.modalService.title = this.panelService.title = 'ジュークボックス';
        this.auditionPlayer.volumeType = _udonarium_core_file_storage_audio_player__WEBPACK_IMPORTED_MODULE_2__["VolumeType"].AUDITION;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].register(this)
            .on('*', function (event) {
            if (event.eventName.startsWith('FILE_'))
                _this.lazyNgZoneUpdate();
        });
    };
    JukeboxComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_6__["EventSystem"].unregister(this);
        this.stop();
    };
    JukeboxComponent.prototype.play = function (audio) {
        this.auditionPlayer.play(audio);
    };
    JukeboxComponent.prototype.stop = function () {
        this.auditionPlayer.stop();
    };
    JukeboxComponent.prototype.playBGM = function (audio) {
        this.jukebox.play(audio.identifier, true);
    };
    JukeboxComponent.prototype.stopBGM = function (audio) {
        if (this.jukebox.audio === audio)
            this.jukebox.stop();
    };
    JukeboxComponent.prototype.handleFileSelect = function (event) {
        var files = event.target.files;
        if (files.length)
            _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_4__["FileArchiver"].instance.load(files);
    };
    JukeboxComponent.prototype.lazyNgZoneUpdate = function () {
        var _this = this;
        if (this.lazyUpdateTimer !== null)
            return;
        this.lazyUpdateTimer = setTimeout(function () {
            _this.lazyUpdateTimer = null;
            _this.ngZone.run(function () { });
        }, 100);
    };
    JukeboxComponent.ctorParameters = function () { return [
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_7__["ModalService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_8__["PanelService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] }
    ]; };
    JukeboxComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-jukebox',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./jukebox.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/jukebox/jukebox.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./jukebox.component.css */ "./src/app/component/jukebox/jukebox.component.css")).default]
        })
    ], JukeboxComponent);
    return JukeboxComponent;
}());



/***/ }),

/***/ "./src/app/component/lobby/lobby.component.css":
/*!*****************************************************!*\
  !*** ./src/app/component/lobby/lobby.component.css ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".box {\n  border-bottom:1px dotted #888;\n}\n.image {\n  padding: 0px;\n  width: 64px;\n  height: 64px;\n  display: inline-block;\n  vertical-align: top;\n}\n.contain {\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2xvYmJ5L2xvYmJ5LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSw2QkFBNkI7QUFDL0I7QUFDQTtFQUNFLFlBQVk7RUFDWixXQUFXO0VBQ1gsWUFBWTtFQUNaLHFCQUFxQjtFQUNyQixtQkFBbUI7QUFDckI7QUFFQTtFQUNFLGtDQUFrQztFQUNsQyw0QkFBNEI7RUFDNUIsd0JBQXdCO0FBQzFCIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2xvYmJ5L2xvYmJ5LmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuYm94IHtcbiAgYm9yZGVyLWJvdHRvbToxcHggZG90dGVkICM4ODg7XG59XG4uaW1hZ2Uge1xuICBwYWRkaW5nOiAwcHg7XG4gIHdpZHRoOiA2NHB4O1xuICBoZWlnaHQ6IDY0cHg7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcbn1cblxuLmNvbnRhaW4ge1xuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXIgY2VudGVyO1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XG59Il19 */");

/***/ }),

/***/ "./src/app/component/lobby/lobby.component.ts":
/*!****************************************************!*\
  !*** ./src/app/component/lobby/lobby.component.ts ***!
  \****************************************************/
/*! exports provided: LobbyComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LobbyComponent", function() { return LobbyComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/system/network/peer-context */ "./src/app/class/core/system/network/peer-context.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var component_password_check_password_check_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! component/password-check/password-check.component */ "./src/app/component/password-check/password-check.component.ts");
/* harmony import */ var component_room_setting_room_setting_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! component/room-setting/room-setting.component */ "./src/app/component/room-setting/room-setting.component.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");










var LobbyComponent = /** @class */ (function () {
    function LobbyComponent(panelService, modalService) {
        this.panelService = panelService;
        this.modalService = modalService;
        this.rooms = [];
        this.isReloading = false;
        this.help = '「一覧を更新」ボタンを押すと接続可能なルーム一覧を表示します。';
    }
    Object.defineProperty(LobbyComponent.prototype, "currentRoom", {
        get: function () { return _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.room; },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(LobbyComponent.prototype, "peerId", {
        get: function () { return _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LobbyComponent.prototype, "isConnected", {
        get: function () {
            return _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerIds.length <= 1 ? false : true;
        },
        enumerable: true,
        configurable: true
    });
    LobbyComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.changeTitle();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('OPEN_NETWORK', function (event) {
            _this.changeTitle();
        })
            .on('CONNECT_PEER', function (event) {
            _this.changeTitle();
        });
        this.reload();
    };
    LobbyComponent.prototype.changeTitle = function () {
        this.modalService.title = this.panelService.title = 'ロビー';
        if (_udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.roomName.length) {
            this.modalService.title = this.panelService.title = '＜' + _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.roomName + '/' + _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.room + '＞';
        }
    };
    LobbyComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    LobbyComponent.prototype.reload = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var peersOfroom, peerIds, peerIds_1, peerIds_1_1, id, context, alias, alias;
            var e_1, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        this.isReloading = true;
                        this.help = '検索中...';
                        this.rooms = [];
                        peersOfroom = {};
                        return [4 /*yield*/, _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].listAllPeers()];
                    case 1:
                        peerIds = _b.sent();
                        try {
                            for (peerIds_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](peerIds), peerIds_1_1 = peerIds_1.next(); !peerIds_1_1.done; peerIds_1_1 = peerIds_1.next()) {
                                id = peerIds_1_1.value;
                                context = new _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_3__["PeerContext"](id);
                                if (context.isRoom) {
                                    alias = context.room + context.roomName;
                                    if (!(alias in peersOfroom)) {
                                        peersOfroom[alias] = [];
                                    }
                                    peersOfroom[alias].push(context);
                                }
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (peerIds_1_1 && !peerIds_1_1.done && (_a = peerIds_1.return)) _a.call(peerIds_1);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        for (alias in peersOfroom) {
                            this.rooms.push({ alias: alias, roomName: peersOfroom[alias][0].roomName, peers: peersOfroom[alias] });
                        }
                        this.rooms.sort(function (a, b) {
                            if (a.alias < b.alias)
                                return -1;
                            if (a.alias > b.alias)
                                return 1;
                            return 0;
                        });
                        this.help = '接続可能なルームが見つかりませんでした。「新しいルームを作成する」で新規ルームを作成できます。';
                        this.isReloading = false;
                        return [2 /*return*/];
                }
            });
        });
    };
    LobbyComponent.prototype.connect = function (peerContexts) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var context, input, peerId, triedPeer;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        context = peerContexts[0];
                        if (!context.password.length) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.modalService.open(component_password_check_password_check_component__WEBPACK_IMPORTED_MODULE_6__["PasswordCheckComponent"], { password: context.password })];
                    case 1:
                        input = _a.sent();
                        if (input !== context.password)
                            return [2 /*return*/];
                        _a.label = 2;
                    case 2:
                        peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext ? _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.id : _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_3__["PeerContext"].generateId();
                        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].open(peerId, context.room, context.roomName, context.password);
                        _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__["PeerCursor"].myCursor.peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId;
                        triedPeer = [];
                        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(triedPeer)
                            .on('OPEN_NETWORK', function (event) {
                            var e_2, _a;
                            console.log('LobbyComponent OPEN_PEER', event.data.peer);
                            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(triedPeer);
                            _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.clearDeleteHistory();
                            try {
                                for (var peerContexts_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](peerContexts), peerContexts_1_1 = peerContexts_1.next(); !peerContexts_1_1.done; peerContexts_1_1 = peerContexts_1.next()) {
                                    var peer = peerContexts_1_1.value;
                                    _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].connect(peer.fullstring);
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (peerContexts_1_1 && !peerContexts_1_1.done && (_a = peerContexts_1.return)) _a.call(peerContexts_1);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(triedPeer)
                                .on('CONNECT_PEER', function (event) {
                                console.log('接続成功！', event.data.peer);
                                triedPeer.push(event.data.peer);
                                console.log('接続成功 ' + triedPeer.length + '/' + peerContexts.length);
                                if (peerContexts.length <= triedPeer.length) {
                                    _this.resetNetwork();
                                    _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(triedPeer);
                                }
                            })
                                .on('DISCONNECT_PEER', function (event) {
                                console.warn('接続失敗', event.data.peer);
                                triedPeer.push(event.data.peer);
                                console.warn('接続失敗 ' + triedPeer.length + '/' + peerContexts.length);
                                if (peerContexts.length <= triedPeer.length) {
                                    _this.resetNetwork();
                                    _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(triedPeer);
                                }
                            });
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    LobbyComponent.prototype.resetNetwork = function () {
        if (_udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContexts.length < 1) {
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].open();
            _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__["PeerCursor"].myCursor.peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId;
        }
    };
    LobbyComponent.prototype.showRoomSetting = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.modalService.open(component_room_setting_room_setting_component__WEBPACK_IMPORTED_MODULE_7__["RoomSettingComponent"], { width: 700, height: 400, left: 0, top: 400 })];
                    case 1:
                        _a.sent();
                        this.reload();
                        this.help = '「一覧を更新」ボタンを押すと接続可能なルーム一覧を表示します。';
                        return [2 /*return*/];
                }
            });
        });
    };
    LobbyComponent.ctorParameters = function () { return [
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_9__["PanelService"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_8__["ModalService"] }
    ]; };
    LobbyComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'lobby',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./lobby.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/lobby/lobby.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./lobby.component.css */ "./src/app/component/lobby/lobby.component.css")).default]
        })
    ], LobbyComponent);
    return LobbyComponent;
}());



/***/ }),

/***/ "./src/app/component/modal/modal.component.css":
/*!*****************************************************!*\
  !*** ./src/app/component/modal/modal.component.css ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".component {\n  box-sizing: border-box;\n  position: absolute;\n  top :0;\n  bottom :0;\n  left :0;\n  right :0;\n  z-index: 9999;\n\n  display: -webkit-box;\n\n  display: flex;\n  -webkit-box-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n          justify-content: center;\n\n  -ms-scroll-chaining: none;\n\n      overscroll-behavior: contain;\n  -webkit-overflow-scrolling: touch;\n}\n\n.modal-background {\n  box-sizing: border-box;\n  position: absolute;\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.3);\n  top :0;\n  bottom :0;\n  left :0;\n  right :0;\n  z-index: -1;\n}\n\n.modal-panel {\n  box-sizing: border-box;\n  overflow: hidden;\n\n  color: #444;\n  background: linear-gradient(-30deg, rgba(240,218,189, 0.9), rgba(255, 244, 232, 0.9));\n  border:solid 1px #999;\n\n  height: auto;\n  max-height: calc(100% - 10px);\n  width: 800px;\n  max-width: 100%;\n}\n\n.title{\n  position: relative;\n  overflow: hidden;\n  white-space: nowrap;\n  box-sizing: border-box;\n  font-size: 12px;\n  height: 25px;\n  padding: 2px 5px;\n  width: 100%;\n  background-color: #CCC;\n  color: #444;\n}\n\n.title-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.title button {\n  background: none;\n  border: none;\n  border-radius: 0;\n  outline: none;\n  color: #444;\n}\n\n.header, .content, footer{\n  padding: 10px;\n}\n\n.scrollable-panel {\n  box-sizing: border-box;\n  overflow: auto;\n  max-height: calc(100vh - 41px);\n  width: 100%;\n  padding: 8px;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L21vZGFsL21vZGFsLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxzQkFBc0I7RUFDdEIsa0JBQWtCO0VBQ2xCLE1BQU07RUFDTixTQUFTO0VBQ1QsT0FBTztFQUNQLFFBQVE7RUFDUixhQUFhOztFQUViLG9CQUFhOztFQUFiLGFBQWE7RUFDYix5QkFBbUI7VUFBbkIsbUJBQW1CO0VBQ25CLHdCQUF1QjtVQUF2Qix1QkFBdUI7O0VBRXZCLHlCQUE0Qjs7TUFBNUIsNEJBQTRCO0VBQzVCLGlDQUFpQztBQUNuQzs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QixrQkFBa0I7RUFDbEIsV0FBVztFQUNYLHVDQUF1QztFQUN2QyxNQUFNO0VBQ04sU0FBUztFQUNULE9BQU87RUFDUCxRQUFRO0VBQ1IsV0FBVztBQUNiOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLGdCQUFnQjs7RUFFaEIsV0FBVztFQUNYLHFGQUFxRjtFQUNyRixxQkFBcUI7O0VBRXJCLFlBQVk7RUFDWiw2QkFBNkI7RUFDN0IsWUFBWTtFQUNaLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtFQUNuQixzQkFBc0I7RUFDdEIsZUFBZTtFQUNmLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsV0FBVztFQUNYLHNCQUFzQjtFQUN0QixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsUUFBUTtFQUNSLE1BQU07QUFDUjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixZQUFZO0VBQ1osZ0JBQWdCO0VBQ2hCLGFBQWE7RUFDYixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxhQUFhO0FBQ2Y7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsY0FBYztFQUNkLDhCQUE4QjtFQUM5QixXQUFXO0VBQ1gsWUFBWTtBQUNkIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L21vZGFsL21vZGFsLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29tcG9uZW50IHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3AgOjA7XG4gIGJvdHRvbSA6MDtcbiAgbGVmdCA6MDtcbiAgcmlnaHQgOjA7XG4gIHotaW5kZXg6IDk5OTk7XG5cbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cbiAgb3ZlcnNjcm9sbC1iZWhhdmlvcjogY29udGFpbjtcbiAgLXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6IHRvdWNoO1xufVxuXG4ubW9kYWwtYmFja2dyb3VuZCB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgY29sb3I6ICNDQ0M7XG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMzAsIDMwLCAzMCwgMC4zKTtcbiAgdG9wIDowO1xuICBib3R0b20gOjA7XG4gIGxlZnQgOjA7XG4gIHJpZ2h0IDowO1xuICB6LWluZGV4OiAtMTtcbn1cblxuLm1vZGFsLXBhbmVsIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICBjb2xvcjogIzQ0NDtcbiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KC0zMGRlZywgcmdiYSgyNDAsMjE4LDE4OSwgMC45KSwgcmdiYSgyNTUsIDI0NCwgMjMyLCAwLjkpKTtcbiAgYm9yZGVyOnNvbGlkIDFweCAjOTk5O1xuXG4gIGhlaWdodDogYXV0bztcbiAgbWF4LWhlaWdodDogY2FsYygxMDAlIC0gMTBweCk7XG4gIHdpZHRoOiA4MDBweDtcbiAgbWF4LXdpZHRoOiAxMDAlO1xufVxuXG4udGl0bGV7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgZm9udC1zaXplOiAxMnB4O1xuICBoZWlnaHQ6IDI1cHg7XG4gIHBhZGRpbmc6IDJweCA1cHg7XG4gIHdpZHRoOiAxMDAlO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjQ0NDO1xuICBjb2xvcjogIzQ0NDtcbn1cblxuLnRpdGxlLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgcmlnaHQ6IDA7XG4gIHRvcDogMDtcbn1cblxuLnRpdGxlIGJ1dHRvbiB7XG4gIGJhY2tncm91bmQ6IG5vbmU7XG4gIGJvcmRlcjogbm9uZTtcbiAgYm9yZGVyLXJhZGl1czogMDtcbiAgb3V0bGluZTogbm9uZTtcbiAgY29sb3I6ICM0NDQ7XG59XG5cbi5oZWFkZXIsIC5jb250ZW50LCBmb290ZXJ7XG4gIHBhZGRpbmc6IDEwcHg7XG59XG5cbi5zY3JvbGxhYmxlLXBhbmVsIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgb3ZlcmZsb3c6IGF1dG87XG4gIG1heC1oZWlnaHQ6IGNhbGMoMTAwdmggLSA0MXB4KTtcbiAgd2lkdGg6IDEwMCU7XG4gIHBhZGRpbmc6IDhweDtcbn0iXX0= */");

/***/ }),

/***/ "./src/app/component/modal/modal.component.ts":
/*!****************************************************!*\
  !*** ./src/app/component/modal/modal.component.ts ***!
  \****************************************************/
/*! exports provided: ModalComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModalComponent", function() { return ModalComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/animations */ "./node_modules/@angular/animations/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");




var ModalComponent = /** @class */ (function () {
    function ModalComponent(modalService) {
        this.modalService = modalService;
    }
    ModalComponent.prototype.clickBackground = function (event) {
        if (event.target === event.currentTarget)
            this.resolve();
    };
    ModalComponent.prototype.resolve = function () {
        this.modalService.resolve(null);
    };
    ModalComponent.prototype.reject = function () {
        this.modalService.reject();
    };
    ModalComponent.ctorParameters = function () { return [
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_3__["ModalService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ViewChild"])('content', { read: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ViewContainerRef"], static: true })
    ], ModalComponent.prototype, "content", void 0);
    ModalComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
            selector: 'modal',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./modal.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/modal/modal.component.html")).default,
            animations: [
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('flyInOut', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('void => *', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('100ms ease-out', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale(0.8, 0.8)', opacity: '0', offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale(1.0, 1.0)', opacity: '1.0', offset: 1.0 })
                        ]))
                    ]),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => void', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])(100, Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale(0, 0)' }))
                    ])
                ]),
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('bgInOut', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["state"])('in', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ 'background-color': 'rgba(30, 30, 30, 0.4)' })),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('void => *', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ 'background-color': 'rgba(30, 30, 30, 0.0)' }), Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])(200)
                    ]),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => void', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])(200, Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ 'background-color': 'rgba(30, 30, 30, 0.0)' }))
                    ])
                ]),
            ],
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./modal.component.css */ "./src/app/component/modal/modal.component.css")).default]
        })
    ], ModalComponent);
    return ModalComponent;
}());

service_modal_service__WEBPACK_IMPORTED_MODULE_3__["ModalService"].ModalComponentClass = ModalComponent;


/***/ }),

/***/ "./src/app/component/network-indicator/network-indicator.component.css":
/*!*****************************************************************************!*\
  !*** ./src/app/component/network-indicator/network-indicator.component.css ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".sk-cube-grid {\n  font-size: 8px;\n  color: #444;\n  height: 100%;\n  width: 100%;\n  background-color: rgba(247, 247, 247, 0.6);\n}\n\n.sk-cube {\n  background-color: #555;\n}\n\n.sk-title {\n  padding: 2px 0;\n  background-color: rgba(247, 247, 247, 0.6);\n}\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L25ldHdvcmstaW5kaWNhdG9yL25ldHdvcmstaW5kaWNhdG9yLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxjQUFjO0VBQ2QsV0FBVztFQUNYLFlBQVk7RUFDWixXQUFXO0VBQ1gsMENBQTBDO0FBQzVDOztBQUVBO0VBQ0Usc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsY0FBYztFQUNkLDBDQUEwQztBQUM1QyIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9uZXR3b3JrLWluZGljYXRvci9uZXR3b3JrLWluZGljYXRvci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnNrLWN1YmUtZ3JpZCB7XG4gIGZvbnQtc2l6ZTogOHB4O1xuICBjb2xvcjogIzQ0NDtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNDcsIDI0NywgMjQ3LCAwLjYpO1xufVxuXG4uc2stY3ViZSB7XG4gIGJhY2tncm91bmQtY29sb3I6ICM1NTU7XG59XG5cbi5zay10aXRsZSB7XG4gIHBhZGRpbmc6IDJweCAwO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI0NywgMjQ3LCAyNDcsIDAuNik7XG59XG4iXX0= */");

/***/ }),

/***/ "./src/app/component/network-indicator/network-indicator.component.ts":
/*!****************************************************************************!*\
  !*** ./src/app/component/network-indicator/network-indicator.component.ts ***!
  \****************************************************************************/
/*! exports provided: NetworkIndicatorComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NetworkIndicatorComponent", function() { return NetworkIndicatorComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");



var NetworkIndicatorComponent = /** @class */ (function () {
    function NetworkIndicatorComponent(elementRef) {
        this.elementRef = elementRef;
        this.timer = null;
        this.needRepeat = false;
    }
    NetworkIndicatorComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        var repeatFunc = function () {
            if (_this.needRepeat) {
                _this.timer = setTimeout(repeatFunc, 650);
                _this.needRepeat = false;
            }
            else {
                _this.timer = null;
                _this.elementRef.nativeElement.style.display = 'none';
            }
        };
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
            .on('*', function (event) {
            if (_this.needRepeat || _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].bandwidthUsage < 3 * 1024)
                return;
            if (_this.timer === null) {
                _this.elementRef.nativeElement.style.display = 'block';
                _this.timer = setTimeout(repeatFunc, 650);
            }
            else {
                _this.needRepeat = true;
            }
        });
    };
    NetworkIndicatorComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(this);
    };
    NetworkIndicatorComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] }
    ]; };
    NetworkIndicatorComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'network-indicator',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./network-indicator.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/network-indicator/network-indicator.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./network-indicator.component.css */ "./src/app/component/network-indicator/network-indicator.component.css")).default]
        })
    ], NetworkIndicatorComponent);
    return NetworkIndicatorComponent;
}());



/***/ }),

/***/ "./src/app/component/overview-panel/overview-panel.component.css":
/*!***********************************************************************!*\
  !*** ./src/app/component/overview-panel/overview-panel.component.css ***!
  \***********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".component {\n  position: absolute;\n  max-height: 100%;\n  max-width: 100%;\n  box-sizing: border-box;\n  overflow: visible;\n  color: #444;\n  z-index: 9000;\n  -ms-scroll-chaining: none;\n      overscroll-behavior: contain;\n  -webkit-overflow-scrolling: touch;\n}\n\n.component-content {\n  font-size: 12px;\n}\n\n.is-large-size {\n  max-width: 350px;\n}\n\n.is-middle-size {\n  max-width: 270px;\n}\n\n.is-small-size {\n  max-width: 250px;\n}\n\n.is-middle-size .grid-container-root {\n  width: 270px;\n}\n\n.is-small-size .grid-container-root {\n  width: 250px;\n}\n\n.component-background {\n  background: linear-gradient(-30deg, rgba(240,218,189, 0.9), rgba(255, 244, 232, 0.9));\n  border-bottom: solid 1px #999;\n}\n\n.component-title {\n  color: #ccc;\n  font-size: 1em;\n  text-align: right;\n  vertical-align: middle; \n  height: 32px;\n  line-height: 32px; \n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  padding: 0 1em;\n}\n\n.title-background {\n  background-color: #555;\n  border-top: solid 1px #999;\n  border-left: solid 1px #999;\n  border-right: solid 1px #999;\n}\n\n.component-owner {\n  font-size: 0.8em;\n  padding: 10px;\n  color: #ccc;\n  vertical-align: middle; \n  overflow: hidden;\n  text-align: right;\n  padding: 2px 1em;\n  max-width: 100%;\n  box-sizing: border-box;\n}\n\n.owner-tag {\n  width: -webkit-min-content;\n  width: -moz-min-content;\n  width: min-content;\n  max-width: 100%;\n  margin-left: auto;\n  margin-right: 0; \n  overflow: hidden;\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n  box-sizing: border-box;\n  padding: 3px 9px;\n  border-radius: 6px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n.card-image {\n  width: 250px;\n  max-height: 330px;\n  padding: 8px;\n  vertical-align: bottom;\n  -o-object-fit: contain;\n     object-fit: contain;\n  box-sizing: border-box;\n  background-color: rgba(204, 204, 204, 0.5);\n}\n\n.zoom-button {\n  position: absolute;\n  left : 8px;\n  bottom: -21px;\n  width: 42px;\n  height: 42px; \n  border-radius: 100px; \n  padding: 4px;\n}\n\n.zoom-button > .material-icons {\n  font-size: 24px;\n  vertical-align: bottom;\n}\n\n.position-right-bottom {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n}\n\n.image-view-background {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.3);\n  z-index: 9900;\n}\n\n.image-view-background .close-button {\n  position: absolute;\n  right: 16px;\n  top: 16px;\n}\n\n.image-view-background .close-button > .material-icons {\n  font-size: 36px;\n}\n\n.contain-image {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  padding: 16px;\n  vertical-align: bottom;\n  -o-object-fit: contain;\n     object-fit: contain;\n}\n\n.text-note-container {\n  width: 100%;\n  max-height: 400px; \n  padding: 0.5em 1.5em;\n  box-sizing: border-box;\n  overflow: hidden auto;\n  line-height: 1.8;\n  border-left: solid 1px #999;\n  border-right: solid 1px #999;\n}\n\n.character-image-box {\n  width: 100px;\n  max-height: 120px;\n  overflow: hidden;\n  vertical-align: bottom;\n  margin-left: 0.5em;\n  margin-bottom: -6px;\n  border-radius: 1em;\n  z-index: 1;\n}\n\n.character-image {\n  padding: 0;\n  width: 100%;\n  vertical-align: bottom;\n}\n\n.is-black-mask {\n  -webkit-filter: brightness(0);\n          filter: brightness(0);\n }\n\n.is-harf-black-mask {\n  -webkit-filter: brightness(0.5);\n          filter: brightness(0.5);\n }\n\n.character-grid-container {\n  display: grid;\n  grid-template-columns: -webkit-min-content auto;\n  grid-template-columns: min-content auto;\n  grid-template-rows: 1fr auto auto auto;\n}\n\n.title-bg-area {\n  grid-area: 3 / 1 / 4 / 3;\n}\n\n.title-area {\n  grid-area: 3 / 2 / 4 / 3;\n}\n\n.owner-name-area {\n  grid-area: 2 / 2 / 3 / 3;\n}\n\n.image-area {\n  grid-area: 1 / 1 / 4 / 2;\n}\n\n.void-area {\n  grid-area: 1 / 2 / 3 / 3;\n}\n\n.dataElm-area {\n  grid-area: 4 / 1 / 5 / 3;\n}\n\n.grid-container-root {\n  padding: 0.5em 1.2em;\n  max-height: 250px;\n  overflow: hidden auto;\n  box-sizing: border-box;\n  border-left: solid 1px #999;\n  border-right: solid 1px #999;\n}\n\n.grid-container {\n  display: grid;\n  grid-template-columns: 1fr fit-content(80%);\n}\n\n.grid-container > div {\n  box-sizing: border-box;\n  line-height: 24px;\n}\n\n.indetnt {\n  padding-left: 0.5em;\n}\n\n.section {\n  max-width: 100%;\n  grid-column: 1 / span 2;\n}\n\n.section-text {\n  font-size: 1.1em;\n  font-weight: bold;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n\n.note {\n  margin-left: 0.5em;\n  white-space: pre-wrap;\n  overflow-wrap: break-word;\n  font-size: 1em;\n  line-height: 1.8;\n}\n\n.textarea {\n  width: 100%;\n  height: 100%;\n  font: inherit;\n  font-size: inherit;\n  line-height: inherit;\n  background: none;\n  border: none;\n  border-radius: 2px;\n  outline: none;\n  color: #444;\n  padding: 0;\n  box-sizing: border-box;\n  resize: none;\n  overflow: hidden;\n}\n\n.textarea:hover {\n  background: #EEE;\n}\n\n.textarea:focus {\n  background: #FFF;\n}\n\n.tag {\n  padding-right: 1em;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n.value {\n  font-size: 1.2em;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  text-align: right;\n}\n\n.hidden-spacer {\n  visibility: hidden;\n  height: 0px;\n  min-width: 3em; \n  overflow: hidden;\n  white-space: pre-wrap;\n}\n\n.textarea-spacer {\n  visibility: hidden;\n  min-width: 3em; \n  height: auto;\n  min-height: 24px;\n  overflow: hidden;\n  white-space: pre-wrap;\n}\n\n.input {\n  width: 100%;\n  min-width: 3em; \n  text-align: right;\n  font: inherit;\n  font-size: inherit;\n  line-height: inherit;\n  background: none;\n  border: none;\n  border-radius: 2px;\n  outline: none;\n  color: #444;\n  padding: 0;\n  box-sizing: border-box;\n}\n\n.input:hover {\n  background: #EEE;\n}\n\n.input:focus {\n  background: #FFF;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\ninput[type=number]:hover, input[type=number]:focus {\n  -moz-appearance: number-input;\n}\n\n.border {\n  border-bottom: 1px dotted #888;\n}\n\n.separator {\n  padding: 2px 0 2px 0;\n  border-bottom: 1px solid #888;\n}\n\n.with-button-marign {\n  padding-left : 60px;\n}\n\n.is-fill {\n  position: absolute;\n  top: 0; \n  left: 0; \n  right: 0;\n  bottom: 0;\n}\n\n.is-bold {\n  font-weight: bold;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n\n.is-pointer-events-auto {\n  pointer-events: auto;\n}\n\n/**************** input-range ****************/\n\ninput[type='range'] {\n  --slider-track-color: transparent; /* #ccc */\n  --slider-fill-color: #555; /*#777 */\n  --slider-border-color: #777;\n  --slider-height: 0.8em;\n  --slider-thumb-size: 1.0em;\n  --range: calc(var(--max) - var(--min));\n  --ratio: calc((var(--val) - var(--min))/var(--range));\n  --sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));\n  margin: 0;\n  padding: 0;\n  background: transparent;\n  font: 1em/1 arial, sans-serif;\n  outline: 0;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n}\n\ninput[type='range'], input[type='range']::-webkit-slider-thumb {\n  -webkit-appearance: none;\n}\n\ninput[type='range']::-webkit-slider-runnable-track {\n  box-sizing: border-box;\n  border-top: solid 1px var(--slider-border-color);\n  border-bottom: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\n\ninput[type='range']::-webkit-slider-runnable-track {\n  background: -webkit-gradient(linear, left top, left bottom, from(var(--slider-fill-color)), to(var(--slider-fill-color))) 0/var(--sx) 100% no-repeat var(--slider-track-color);\n  background: linear-gradient(var(--slider-fill-color), var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);\n  cursor: pointer;\n}\n\ninput[type='range']::-moz-range-track {\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\n\ninput[type='range']::-ms-track {\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: var(--slider-height);\n  height: var(--slider-height);\n  background: var(--slider-track-color);\n}\n\ninput[type='range']::-moz-range-progress {\n  height: var(--slider-height);\n  background: var(--slider-fill-color);\n  border-radius: var(--slider-height);\n}\n\ninput[type='range']::-ms-fill-lower {\n  height: var(--slider-height);\n  background: var(--slider-fill-color);\n  border-radius: var(--slider-height);\n}\n\ninput[type='range']::-webkit-slider-thumb {\n  margin-top: calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px  var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\n\ninput[type='range']::-moz-range-thumb {\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\n\ninput[type='range']::-ms-thumb {\n  margin-top: 0;\n  width: var(--slider-thumb-size);\n  height: var(--slider-thumb-size);\n  box-sizing: border-box;\n  border: solid 1px var(--slider-border-color);\n  border-radius: 2em;\n  background: #ddd;\n  cursor: pointer;\n}\n\ninput[type='range']::-ms-tooltip {\n  display: none;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L292ZXJ2aWV3LXBhbmVsL292ZXJ2aWV3LXBhbmVsLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxrQkFBa0I7RUFDbEIsZ0JBQWdCO0VBQ2hCLGVBQWU7RUFDZixzQkFBc0I7RUFDdEIsaUJBQWlCO0VBQ2pCLFdBQVc7RUFDWCxhQUFhO0VBQ2IseUJBQTRCO01BQTVCLDRCQUE0QjtFQUM1QixpQ0FBaUM7QUFDbkM7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsWUFBWTtBQUNkOztBQUVBO0VBQ0UsWUFBWTtBQUNkOztBQUVBO0VBQ0UscUZBQXFGO0VBQ3JGLDZCQUE2QjtBQUMvQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxjQUFjO0VBQ2QsaUJBQWlCO0VBQ2pCLHNCQUFzQjtFQUN0QixZQUFZO0VBQ1osaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsdUJBQXVCO0VBQ3ZCLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsMEJBQTBCO0VBQzFCLDJCQUEyQjtFQUMzQiw0QkFBNEI7QUFDOUI7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsYUFBYTtFQUNiLFdBQVc7RUFDWCxzQkFBc0I7RUFDdEIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtFQUNqQixnQkFBZ0I7RUFDaEIsZUFBZTtFQUNmLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLDBCQUFrQjtFQUFsQix1QkFBa0I7RUFBbEIsa0JBQWtCO0VBQ2xCLGVBQWU7RUFDZixpQkFBaUI7RUFDakIsZUFBZTtFQUNmLGdCQUFnQjtFQUNoQixXQUFXO0VBQ1gsdUNBQXVDO0VBQ3ZDLHNCQUFzQjtFQUN0QixnQkFBZ0I7RUFDaEIsa0JBQWtCO0VBQ2xCLG1CQUFtQjtFQUNuQix1QkFBdUI7QUFDekI7O0FBRUE7RUFDRSxZQUFZO0VBQ1osaUJBQWlCO0VBQ2pCLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsc0JBQW1CO0tBQW5CLG1CQUFtQjtFQUNuQixzQkFBc0I7RUFDdEIsMENBQTBDO0FBQzVDOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFVBQVU7RUFDVixhQUFhO0VBQ2IsV0FBVztFQUNYLFlBQVk7RUFDWixvQkFBb0I7RUFDcEIsWUFBWTtBQUNkOztBQUVBO0VBQ0UsZUFBZTtFQUNmLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixRQUFRO0VBQ1IsU0FBUztBQUNYOztBQUVBO0VBQ0UsV0FBVztFQUNYLHVDQUF1QztFQUN2QyxhQUFhO0FBQ2Y7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsV0FBVztFQUNYLFNBQVM7QUFDWDs7QUFFQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsWUFBWTtFQUNaLHNCQUFzQjtFQUN0QixhQUFhO0VBQ2Isc0JBQXNCO0VBQ3RCLHNCQUFtQjtLQUFuQixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsaUJBQWlCO0VBQ2pCLG9CQUFvQjtFQUNwQixzQkFBc0I7RUFDdEIscUJBQXFCO0VBQ3JCLGdCQUFnQjtFQUNoQiwyQkFBMkI7RUFDM0IsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0UsWUFBWTtFQUNaLGlCQUFpQjtFQUNqQixnQkFBZ0I7RUFDaEIsc0JBQXNCO0VBQ3RCLGtCQUFrQjtFQUNsQixtQkFBbUI7RUFDbkIsa0JBQWtCO0VBQ2xCLFVBQVU7QUFDWjs7QUFFQTtFQUNFLFVBQVU7RUFDVixXQUFXO0VBQ1gsc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsNkJBQXFCO1VBQXJCLHFCQUFxQjtDQUN0Qjs7QUFFQTtFQUNDLCtCQUF1QjtVQUF2Qix1QkFBdUI7Q0FDeEI7O0FBRUQ7RUFDRSxhQUFhO0VBQ2IsK0NBQXVDO0VBQXZDLHVDQUF1QztFQUN2QyxzQ0FBc0M7QUFDeEM7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSxvQkFBb0I7RUFDcEIsaUJBQWlCO0VBQ2pCLHFCQUFxQjtFQUNyQixzQkFBc0I7RUFDdEIsMkJBQTJCO0VBQzNCLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLGFBQWE7RUFDYiwyQ0FBMkM7QUFDN0M7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsZUFBZTtFQUNmLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixpQkFBaUI7RUFDakIsbUJBQW1CO0VBQ25CLHVCQUF1QjtFQUN2QixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIscUJBQXFCO0VBQ3JCLHlCQUF5QjtFQUN6QixjQUFjO0VBQ2QsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsV0FBVztFQUNYLFlBQVk7RUFDWixhQUFhO0VBQ2Isa0JBQWtCO0VBQ2xCLG9CQUFvQjtFQUNwQixnQkFBZ0I7RUFDaEIsWUFBWTtFQUNaLGtCQUFrQjtFQUNsQixhQUFhO0VBQ2IsV0FBVztFQUNYLFVBQVU7RUFDVixzQkFBc0I7RUFDdEIsWUFBWTtFQUNaLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLHVCQUF1QjtFQUN2QixpQkFBaUI7QUFDbkI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsV0FBVztFQUNYLGNBQWM7RUFDZCxnQkFBZ0I7RUFDaEIscUJBQXFCO0FBQ3ZCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLGNBQWM7RUFDZCxZQUFZO0VBQ1osZ0JBQWdCO0VBQ2hCLGdCQUFnQjtFQUNoQixxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsY0FBYztFQUNkLGlCQUFpQjtFQUNqQixhQUFhO0VBQ2Isa0JBQWtCO0VBQ2xCLG9CQUFvQjtFQUNwQixnQkFBZ0I7RUFDaEIsWUFBWTtFQUNaLGtCQUFrQjtFQUNsQixhQUFhO0VBQ2IsV0FBVztFQUNYLFVBQVU7RUFDVixzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSwwQkFBMEI7QUFDNUI7O0FBRUE7RUFDRSw2QkFBNkI7QUFDL0I7O0FBRUE7RUFDRSw4QkFBOEI7QUFDaEM7O0FBRUE7RUFDRSxvQkFBb0I7RUFDcEIsNkJBQTZCO0FBQy9COztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLE1BQU07RUFDTixPQUFPO0VBQ1AsUUFBUTtFQUNSLFNBQVM7QUFDWDs7QUFFQTtFQUNFLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLG9CQUFvQjtBQUN0Qjs7QUFFQTtFQUNFLG9CQUFvQjtBQUN0Qjs7QUFFQSw4Q0FBOEM7O0FBRTlDO0VBQ0UsaUNBQWlDLEVBQUUsU0FBUztFQUM1Qyx5QkFBeUIsRUFBRSxRQUFRO0VBQ25DLDJCQUEyQjtFQUMzQixzQkFBc0I7RUFDdEIsMEJBQTBCO0VBQzFCLHNDQUFzQztFQUN0QyxxREFBcUQ7RUFDckQsd0ZBQXdGO0VBQ3hGLFNBQVM7RUFDVCxVQUFVO0VBQ1YsdUJBQXVCO0VBQ3ZCLDZCQUE2QjtFQUM3QixVQUFVO0VBQ1Ysd0JBQWdCO0tBQWhCLHFCQUFnQjtVQUFoQixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsZ0RBQWdEO0VBQ2hELG1EQUFtRDtFQUNuRCxtQ0FBbUM7RUFDbkMsNEJBQTRCO0VBQzVCLHFDQUFxQztBQUN2Qzs7QUFFQTtFQUNFLDhLQUFvSTtFQUFwSSxvSUFBb0k7RUFDcEksZUFBZTtBQUNqQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0Qiw0Q0FBNEM7RUFDNUMsbUNBQW1DO0VBQ25DLDRCQUE0QjtFQUM1QixxQ0FBcUM7QUFDdkM7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsNENBQTRDO0VBQzVDLG1DQUFtQztFQUNuQyw0QkFBNEI7RUFDNUIscUNBQXFDO0FBQ3ZDOztBQUVBO0VBQ0UsNEJBQTRCO0VBQzVCLG9DQUFvQztFQUNwQyxtQ0FBbUM7QUFDckM7O0FBRUE7RUFDRSw0QkFBNEI7RUFDNUIsb0NBQW9DO0VBQ3BDLG1DQUFtQztBQUNyQzs7QUFFQTtFQUNFLDZFQUE2RTtFQUM3RSwrQkFBK0I7RUFDL0IsZ0NBQWdDO0VBQ2hDLHNCQUFzQjtFQUN0Qiw2Q0FBNkM7RUFDN0Msa0JBQWtCO0VBQ2xCLGdCQUFnQjtFQUNoQixlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsK0JBQStCO0VBQy9CLGdDQUFnQztFQUNoQyxzQkFBc0I7RUFDdEIsNENBQTRDO0VBQzVDLGtCQUFrQjtFQUNsQixnQkFBZ0I7RUFDaEIsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLGFBQWE7RUFDYiwrQkFBK0I7RUFDL0IsZ0NBQWdDO0VBQ2hDLHNCQUFzQjtFQUN0Qiw0Q0FBNEM7RUFDNUMsa0JBQWtCO0VBQ2xCLGdCQUFnQjtFQUNoQixlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsYUFBYTtBQUNmIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L292ZXJ2aWV3LXBhbmVsL292ZXJ2aWV3LXBhbmVsLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29tcG9uZW50IHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBtYXgtaGVpZ2h0OiAxMDAlO1xuICBtYXgtd2lkdGg6IDEwMCU7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIG92ZXJmbG93OiB2aXNpYmxlO1xuICBjb2xvcjogIzQ0NDtcbiAgei1pbmRleDogOTAwMDtcbiAgb3ZlcnNjcm9sbC1iZWhhdmlvcjogY29udGFpbjtcbiAgLXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6IHRvdWNoO1xufVxuXG4uY29tcG9uZW50LWNvbnRlbnQge1xuICBmb250LXNpemU6IDEycHg7XG59XG5cbi5pcy1sYXJnZS1zaXplIHtcbiAgbWF4LXdpZHRoOiAzNTBweDtcbn1cblxuLmlzLW1pZGRsZS1zaXplIHtcbiAgbWF4LXdpZHRoOiAyNzBweDtcbn1cblxuLmlzLXNtYWxsLXNpemUge1xuICBtYXgtd2lkdGg6IDI1MHB4O1xufVxuXG4uaXMtbWlkZGxlLXNpemUgLmdyaWQtY29udGFpbmVyLXJvb3Qge1xuICB3aWR0aDogMjcwcHg7XG59XG5cbi5pcy1zbWFsbC1zaXplIC5ncmlkLWNvbnRhaW5lci1yb290IHtcbiAgd2lkdGg6IDI1MHB4O1xufVxuXG4uY29tcG9uZW50LWJhY2tncm91bmQge1xuICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoLTMwZGVnLCByZ2JhKDI0MCwyMTgsMTg5LCAwLjkpLCByZ2JhKDI1NSwgMjQ0LCAyMzIsIDAuOSkpO1xuICBib3JkZXItYm90dG9tOiBzb2xpZCAxcHggIzk5OTtcbn1cblxuLmNvbXBvbmVudC10aXRsZSB7XG4gIGNvbG9yOiAjY2NjO1xuICBmb250LXNpemU6IDFlbTtcbiAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IFxuICBoZWlnaHQ6IDMycHg7XG4gIGxpbmUtaGVpZ2h0OiAzMnB4OyBcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gIHBhZGRpbmc6IDAgMWVtO1xufVxuXG4udGl0bGUtYmFja2dyb3VuZCB7XG4gIGJhY2tncm91bmQtY29sb3I6ICM1NTU7XG4gIGJvcmRlci10b3A6IHNvbGlkIDFweCAjOTk5O1xuICBib3JkZXItbGVmdDogc29saWQgMXB4ICM5OTk7XG4gIGJvcmRlci1yaWdodDogc29saWQgMXB4ICM5OTk7XG59XG5cbi5jb21wb25lbnQtb3duZXIge1xuICBmb250LXNpemU6IDAuOGVtO1xuICBwYWRkaW5nOiAxMHB4O1xuICBjb2xvcjogI2NjYztcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsgXG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHRleHQtYWxpZ246IHJpZ2h0O1xuICBwYWRkaW5nOiAycHggMWVtO1xuICBtYXgtd2lkdGg6IDEwMCU7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG59XG5cbi5vd25lci10YWcge1xuICB3aWR0aDogbWluLWNvbnRlbnQ7XG4gIG1heC13aWR0aDogMTAwJTtcbiAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gIG1hcmdpbi1yaWdodDogMDsgXG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIGNvbG9yOiAjQ0NDO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDMwLCAzMCwgMzAsIDAuOCk7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIHBhZGRpbmc6IDNweCA5cHg7XG4gIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG59XG5cbi5jYXJkLWltYWdlIHtcbiAgd2lkdGg6IDI1MHB4O1xuICBtYXgtaGVpZ2h0OiAzMzBweDtcbiAgcGFkZGluZzogOHB4O1xuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xuICBvYmplY3QtZml0OiBjb250YWluO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDIwNCwgMjA0LCAyMDQsIDAuNSk7XG59XG5cbi56b29tLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgbGVmdCA6IDhweDtcbiAgYm90dG9tOiAtMjFweDtcbiAgd2lkdGg6IDQycHg7XG4gIGhlaWdodDogNDJweDsgXG4gIGJvcmRlci1yYWRpdXM6IDEwMHB4OyBcbiAgcGFkZGluZzogNHB4O1xufVxuXG4uem9vbS1idXR0b24gPiAubWF0ZXJpYWwtaWNvbnMge1xuICBmb250LXNpemU6IDI0cHg7XG4gIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG59XG5cbi5wb3NpdGlvbi1yaWdodC1ib3R0b20ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59XG5cbi5pbWFnZS12aWV3LWJhY2tncm91bmQge1xuICBjb2xvcjogI0NDQztcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDMwLCAwLjMpO1xuICB6LWluZGV4OiA5OTAwO1xufVxuXG4uaW1hZ2Utdmlldy1iYWNrZ3JvdW5kIC5jbG9zZS1idXR0b24ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHJpZ2h0OiAxNnB4O1xuICB0b3A6IDE2cHg7XG59XG5cbi5pbWFnZS12aWV3LWJhY2tncm91bmQgLmNsb3NlLWJ1dHRvbiA+IC5tYXRlcmlhbC1pY29ucyB7XG4gIGZvbnQtc2l6ZTogMzZweDtcbn1cblxuLmNvbnRhaW4taW1hZ2Uge1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBwYWRkaW5nOiAxNnB4O1xuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xuICBvYmplY3QtZml0OiBjb250YWluO1xufVxuXG4udGV4dC1ub3RlLWNvbnRhaW5lciB7XG4gIHdpZHRoOiAxMDAlO1xuICBtYXgtaGVpZ2h0OiA0MDBweDsgXG4gIHBhZGRpbmc6IDAuNWVtIDEuNWVtO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBvdmVyZmxvdzogaGlkZGVuIGF1dG87XG4gIGxpbmUtaGVpZ2h0OiAxLjg7XG4gIGJvcmRlci1sZWZ0OiBzb2xpZCAxcHggIzk5OTtcbiAgYm9yZGVyLXJpZ2h0OiBzb2xpZCAxcHggIzk5OTtcbn1cblxuLmNoYXJhY3Rlci1pbWFnZS1ib3gge1xuICB3aWR0aDogMTAwcHg7XG4gIG1heC1oZWlnaHQ6IDEyMHB4O1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xuICBtYXJnaW4tbGVmdDogMC41ZW07XG4gIG1hcmdpbi1ib3R0b206IC02cHg7XG4gIGJvcmRlci1yYWRpdXM6IDFlbTtcbiAgei1pbmRleDogMTtcbn1cblxuLmNoYXJhY3Rlci1pbWFnZSB7XG4gIHBhZGRpbmc6IDA7XG4gIHdpZHRoOiAxMDAlO1xuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xufVxuXG4uaXMtYmxhY2stbWFzayB7XG4gIGZpbHRlcjogYnJpZ2h0bmVzcygwKTtcbiB9XG5cbiAuaXMtaGFyZi1ibGFjay1tYXNrIHtcbiAgZmlsdGVyOiBicmlnaHRuZXNzKDAuNSk7XG4gfVxuXG4uY2hhcmFjdGVyLWdyaWQtY29udGFpbmVyIHtcbiAgZGlzcGxheTogZ3JpZDtcbiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiBtaW4tY29udGVudCBhdXRvO1xuICBncmlkLXRlbXBsYXRlLXJvd3M6IDFmciBhdXRvIGF1dG8gYXV0bztcbn1cblxuLnRpdGxlLWJnLWFyZWEge1xuICBncmlkLWFyZWE6IDMgLyAxIC8gNCAvIDM7XG59XG5cbi50aXRsZS1hcmVhIHtcbiAgZ3JpZC1hcmVhOiAzIC8gMiAvIDQgLyAzO1xufVxuXG4ub3duZXItbmFtZS1hcmVhIHtcbiAgZ3JpZC1hcmVhOiAyIC8gMiAvIDMgLyAzO1xufVxuXG4uaW1hZ2UtYXJlYSB7XG4gIGdyaWQtYXJlYTogMSAvIDEgLyA0IC8gMjtcbn1cblxuLnZvaWQtYXJlYSB7XG4gIGdyaWQtYXJlYTogMSAvIDIgLyAzIC8gMztcbn1cblxuLmRhdGFFbG0tYXJlYSB7XG4gIGdyaWQtYXJlYTogNCAvIDEgLyA1IC8gMztcbn1cblxuLmdyaWQtY29udGFpbmVyLXJvb3Qge1xuICBwYWRkaW5nOiAwLjVlbSAxLjJlbTtcbiAgbWF4LWhlaWdodDogMjUwcHg7XG4gIG92ZXJmbG93OiBoaWRkZW4gYXV0bztcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyLWxlZnQ6IHNvbGlkIDFweCAjOTk5O1xuICBib3JkZXItcmlnaHQ6IHNvbGlkIDFweCAjOTk5O1xufVxuXG4uZ3JpZC1jb250YWluZXIge1xuICBkaXNwbGF5OiBncmlkO1xuICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBmaXQtY29udGVudCg4MCUpO1xufVxuXG4uZ3JpZC1jb250YWluZXIgPiBkaXYge1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBsaW5lLWhlaWdodDogMjRweDtcbn1cblxuLmluZGV0bnQge1xuICBwYWRkaW5nLWxlZnQ6IDAuNWVtO1xufVxuXG4uc2VjdGlvbiB7XG4gIG1heC13aWR0aDogMTAwJTtcbiAgZ3JpZC1jb2x1bW46IDEgLyBzcGFuIDI7XG59XG5cbi5zZWN0aW9uLXRleHQge1xuICBmb250LXNpemU6IDEuMWVtO1xuICBmb250LXdlaWdodDogYm9sZDtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gIG92ZXJmbG93OiBoaWRkZW47XG59XG5cbi5ub3RlIHtcbiAgbWFyZ2luLWxlZnQ6IDAuNWVtO1xuICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7XG4gIG92ZXJmbG93LXdyYXA6IGJyZWFrLXdvcmQ7XG4gIGZvbnQtc2l6ZTogMWVtO1xuICBsaW5lLWhlaWdodDogMS44O1xufVxuXG4udGV4dGFyZWEge1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuICBmb250OiBpbmhlcml0O1xuICBmb250LXNpemU6IGluaGVyaXQ7XG4gIGxpbmUtaGVpZ2h0OiBpbmhlcml0O1xuICBiYWNrZ3JvdW5kOiBub25lO1xuICBib3JkZXI6IG5vbmU7XG4gIGJvcmRlci1yYWRpdXM6IDJweDtcbiAgb3V0bGluZTogbm9uZTtcbiAgY29sb3I6ICM0NDQ7XG4gIHBhZGRpbmc6IDA7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIHJlc2l6ZTogbm9uZTtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbn1cblxuLnRleHRhcmVhOmhvdmVyIHtcbiAgYmFja2dyb3VuZDogI0VFRTtcbn1cblxuLnRleHRhcmVhOmZvY3VzIHtcbiAgYmFja2dyb3VuZDogI0ZGRjtcbn1cblxuLnRhZyB7XG4gIHBhZGRpbmctcmlnaHQ6IDFlbTtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG59XG5cbi52YWx1ZSB7XG4gIGZvbnQtc2l6ZTogMS4yZW07XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuICB0ZXh0LWFsaWduOiByaWdodDtcbn1cblxuLmhpZGRlbi1zcGFjZXIge1xuICB2aXNpYmlsaXR5OiBoaWRkZW47XG4gIGhlaWdodDogMHB4O1xuICBtaW4td2lkdGg6IDNlbTsgXG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn1cblxuLnRleHRhcmVhLXNwYWNlciB7XG4gIHZpc2liaWxpdHk6IGhpZGRlbjtcbiAgbWluLXdpZHRoOiAzZW07IFxuICBoZWlnaHQ6IGF1dG87XG4gIG1pbi1oZWlnaHQ6IDI0cHg7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn1cblxuLmlucHV0IHtcbiAgd2lkdGg6IDEwMCU7XG4gIG1pbi13aWR0aDogM2VtOyBcbiAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gIGZvbnQ6IGluaGVyaXQ7XG4gIGZvbnQtc2l6ZTogaW5oZXJpdDtcbiAgbGluZS1oZWlnaHQ6IGluaGVyaXQ7XG4gIGJhY2tncm91bmQ6IG5vbmU7XG4gIGJvcmRlcjogbm9uZTtcbiAgYm9yZGVyLXJhZGl1czogMnB4O1xuICBvdXRsaW5lOiBub25lO1xuICBjb2xvcjogIzQ0NDtcbiAgcGFkZGluZzogMDtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbn1cblxuLmlucHV0OmhvdmVyIHtcbiAgYmFja2dyb3VuZDogI0VFRTtcbn1cblxuLmlucHV0OmZvY3VzIHtcbiAgYmFja2dyb3VuZDogI0ZGRjtcbn1cblxuaW5wdXRbdHlwZT1udW1iZXJdIHtcbiAgLW1vei1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7XG59XG5cbmlucHV0W3R5cGU9bnVtYmVyXTpob3ZlciwgaW5wdXRbdHlwZT1udW1iZXJdOmZvY3VzIHtcbiAgLW1vei1hcHBlYXJhbmNlOiBudW1iZXItaW5wdXQ7XG59XG5cbi5ib3JkZXIge1xuICBib3JkZXItYm90dG9tOiAxcHggZG90dGVkICM4ODg7XG59XG5cbi5zZXBhcmF0b3Ige1xuICBwYWRkaW5nOiAycHggMCAycHggMDtcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICM4ODg7XG59XG5cbi53aXRoLWJ1dHRvbi1tYXJpZ24ge1xuICBwYWRkaW5nLWxlZnQgOiA2MHB4O1xufVxuXG4uaXMtZmlsbCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAwOyBcbiAgbGVmdDogMDsgXG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59XG5cbi5pcy1ib2xkIHtcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG59XG5cbi5pcy1wb2ludGVyLWV2ZW50cy1ub25lIHtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG59XG5cbi5pcy1wb2ludGVyLWV2ZW50cy1hdXRvIHtcbiAgcG9pbnRlci1ldmVudHM6IGF1dG87XG59XG5cbi8qKioqKioqKioqKioqKioqIGlucHV0LXJhbmdlICoqKioqKioqKioqKioqKiovXG5cbmlucHV0W3R5cGU9J3JhbmdlJ10ge1xuICAtLXNsaWRlci10cmFjay1jb2xvcjogdHJhbnNwYXJlbnQ7IC8qICNjY2MgKi9cbiAgLS1zbGlkZXItZmlsbC1jb2xvcjogIzU1NTsgLyojNzc3ICovXG4gIC0tc2xpZGVyLWJvcmRlci1jb2xvcjogIzc3NztcbiAgLS1zbGlkZXItaGVpZ2h0OiAwLjhlbTtcbiAgLS1zbGlkZXItdGh1bWItc2l6ZTogMS4wZW07XG4gIC0tcmFuZ2U6IGNhbGModmFyKC0tbWF4KSAtIHZhcigtLW1pbikpO1xuICAtLXJhdGlvOiBjYWxjKCh2YXIoLS12YWwpIC0gdmFyKC0tbWluKSkvdmFyKC0tcmFuZ2UpKTtcbiAgLS1zeDogY2FsYyguNSp2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSkgKyB2YXIoLS1yYXRpbykqKDEwMCUgLSB2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSkpKTtcbiAgbWFyZ2luOiAwO1xuICBwYWRkaW5nOiAwO1xuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgZm9udDogMWVtLzEgYXJpYWwsIHNhbnMtc2VyaWY7XG4gIG91dGxpbmU6IDA7XG4gIGFwcGVhcmFuY2U6IG5vbmU7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ10sIGlucHV0W3R5cGU9J3JhbmdlJ106Oi13ZWJraXQtc2xpZGVyLXRodW1iIHtcbiAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddOjotd2Via2l0LXNsaWRlci1ydW5uYWJsZS10cmFjayB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlci10b3A6IHNvbGlkIDFweCB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLWJvdHRvbTogc29saWQgMXB4IHZhcigtLXNsaWRlci1ib3JkZXItY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgYmFja2dyb3VuZDogdmFyKC0tc2xpZGVyLXRyYWNrLWNvbG9yKTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LXdlYmtpdC1zbGlkZXItcnVubmFibGUtdHJhY2sge1xuICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodmFyKC0tc2xpZGVyLWZpbGwtY29sb3IpLCB2YXIoLS1zbGlkZXItZmlsbC1jb2xvcikpIDAvdmFyKC0tc3gpIDEwMCUgbm8tcmVwZWF0IHZhcigtLXNsaWRlci10cmFjay1jb2xvcik7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1vei1yYW5nZS10cmFjayB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlcjogc29saWQgMXB4IHZhcigtLXNsaWRlci1ib3JkZXItY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgYmFja2dyb3VuZDogdmFyKC0tc2xpZGVyLXRyYWNrLWNvbG9yKTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1zLXRyYWNrIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCAxcHggdmFyKC0tc2xpZGVyLWJvcmRlci1jb2xvcik7XG4gIGJvcmRlci1yYWRpdXM6IHZhcigtLXNsaWRlci1oZWlnaHQpO1xuICBoZWlnaHQ6IHZhcigtLXNsaWRlci1oZWlnaHQpO1xuICBiYWNrZ3JvdW5kOiB2YXIoLS1zbGlkZXItdHJhY2stY29sb3IpO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddOjotbW96LXJhbmdlLXByb2dyZXNzIHtcbiAgaGVpZ2h0OiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbiAgYmFja2dyb3VuZDogdmFyKC0tc2xpZGVyLWZpbGwtY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiB2YXIoLS1zbGlkZXItaGVpZ2h0KTtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1zLWZpbGwtbG93ZXIge1xuICBoZWlnaHQ6IHZhcigtLXNsaWRlci1oZWlnaHQpO1xuICBiYWNrZ3JvdW5kOiB2YXIoLS1zbGlkZXItZmlsbC1jb2xvcik7XG4gIGJvcmRlci1yYWRpdXM6IHZhcigtLXNsaWRlci1oZWlnaHQpO1xufVxuXG5pbnB1dFt0eXBlPSdyYW5nZSddOjotd2Via2l0LXNsaWRlci10aHVtYiB7XG4gIG1hcmdpbi10b3A6IGNhbGMoKHZhcigtLXNsaWRlci1oZWlnaHQpIC0gdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpKSAvIDIgLSAxcHgpO1xuICB3aWR0aDogdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpO1xuICBoZWlnaHQ6IHZhcigtLXNsaWRlci10aHVtYi1zaXplKTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm9yZGVyOiBzb2xpZCAxcHggIHZhcigtLXNsaWRlci1ib3JkZXItY29sb3IpO1xuICBib3JkZXItcmFkaXVzOiAyZW07XG4gIGJhY2tncm91bmQ6ICNkZGQ7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuaW5wdXRbdHlwZT0ncmFuZ2UnXTo6LW1vei1yYW5nZS10aHVtYiB7XG4gIHdpZHRoOiB2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSk7XG4gIGhlaWdodDogdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBib3JkZXI6IHNvbGlkIDFweCB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLXJhZGl1czogMmVtO1xuICBiYWNrZ3JvdW5kOiAjZGRkO1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi1tcy10aHVtYiB7XG4gIG1hcmdpbi10b3A6IDA7XG4gIHdpZHRoOiB2YXIoLS1zbGlkZXItdGh1bWItc2l6ZSk7XG4gIGhlaWdodDogdmFyKC0tc2xpZGVyLXRodW1iLXNpemUpO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBib3JkZXI6IHNvbGlkIDFweCB2YXIoLS1zbGlkZXItYm9yZGVyLWNvbG9yKTtcbiAgYm9yZGVyLXJhZGl1czogMmVtO1xuICBiYWNrZ3JvdW5kOiAjZGRkO1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbmlucHV0W3R5cGU9J3JhbmdlJ106Oi1tcy10b29sdGlwIHtcbiAgZGlzcGxheTogbm9uZTtcbn0iXX0= */");

/***/ }),

/***/ "./src/app/component/overview-panel/overview-panel.component.ts":
/*!**********************************************************************!*\
  !*** ./src/app/component/overview-panel/overview-panel.component.ts ***!
  \**********************************************************************/
/*! exports provided: OverviewPanelComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OverviewPanelComponent", function() { return OverviewPanelComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/animations */ "./node_modules/@angular/animations/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_game_object_inventory_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! service/game-object-inventory.service */ "./src/app/service/game-object-inventory.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");








var OverviewPanelComponent = /** @class */ (function () {
    function OverviewPanelComponent(inventoryService, changeDetector, pointerDeviceService) {
        this.inventoryService = inventoryService;
        this.changeDetector = changeDetector;
        this.pointerDeviceService = pointerDeviceService;
        this.tabletopObject = null;
        this.left = 0;
        this.top = 0;
        this.isOpenImageView = false;
    }
    Object.defineProperty(OverviewPanelComponent.prototype, "imageUrl", {
        get: function () { return this.tabletopObject && this.tabletopObject.imageFile ? this.tabletopObject.imageFile.url : ''; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OverviewPanelComponent.prototype, "hasImage", {
        get: function () { return 0 < this.imageUrl.length; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OverviewPanelComponent.prototype, "inventoryDataElms", {
        get: function () { return this.tabletopObject ? this.getInventoryTags(this.tabletopObject) : []; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OverviewPanelComponent.prototype, "dataElms", {
        get: function () { return this.tabletopObject && this.tabletopObject.detailDataElement ? this.tabletopObject.detailDataElement.children : []; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OverviewPanelComponent.prototype, "hasDataElms", {
        get: function () { return 0 < this.dataElms.length; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OverviewPanelComponent.prototype, "newLineString", {
        get: function () { return this.inventoryService.newLineString; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OverviewPanelComponent.prototype, "isPointerDragging", {
        get: function () { return this.pointerDeviceService.isDragging; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OverviewPanelComponent.prototype, "pointerEventsStyle", {
        get: function () { return { 'is-pointer-events-auto': !this.isPointerDragging, 'pointer-events-none': this.isPointerDragging }; },
        enumerable: true,
        configurable: true
    });
    OverviewPanelComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        this.initPanelPosition();
        setTimeout(function () {
            _this.adjustPositionRoot();
        }, 16);
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_4__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.tabletopObject || !object || !(object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_3__["ObjectNode"]))
                return;
            if (_this.tabletopObject === object || _this.tabletopObject.contains(object)) {
                _this.changeDetector.markForCheck();
            }
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('UPDATE_FILE_RESOURE', -1000, function (event) {
            _this.changeDetector.markForCheck();
        });
    };
    OverviewPanelComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_5__["EventSystem"].unregister(this);
    };
    OverviewPanelComponent.prototype.initPanelPosition = function () {
        var panel = this.draggablePanel.nativeElement;
        var outerWidth = panel.offsetWidth;
        var outerHeight = panel.offsetHeight;
        var offsetLeft = this.left + 100;
        var offsetTop = this.top - outerHeight - 50;
        var isCollideLeft = false;
        var isCollideTop = false;
        if (window.innerWidth < offsetLeft + outerWidth) {
            offsetLeft = window.innerWidth - outerWidth;
            isCollideLeft = true;
        }
        if (offsetTop <= 0) {
            offsetTop = 0;
            isCollideTop = true;
        }
        if (isCollideLeft) {
            offsetLeft = this.left - outerWidth - 100;
        }
        if (offsetLeft < 0)
            offsetLeft = 0;
        if (offsetTop < 0)
            offsetTop = 0;
        panel.style.left = offsetLeft + 'px';
        panel.style.top = offsetTop + 'px';
    };
    OverviewPanelComponent.prototype.adjustPositionRoot = function () {
        var panel = this.draggablePanel.nativeElement;
        var panelBox = panel.getBoundingClientRect();
        var diffLeft = 0;
        var diffTop = 0;
        if (window.innerWidth < panelBox.right + diffLeft) {
            diffLeft += window.innerWidth - (panelBox.right + diffLeft);
        }
        if (panelBox.left + diffLeft < 0) {
            diffLeft += 0 - (panelBox.left + diffLeft);
        }
        if (window.innerHeight < panelBox.bottom + diffTop) {
            diffTop += window.innerHeight - (panelBox.bottom + diffTop);
        }
        if (panelBox.top + diffTop < 0) {
            diffTop += 0 - (panelBox.top + diffTop);
        }
        panel.style.left = panel.offsetLeft + diffLeft + 'px';
        panel.style.top = panel.offsetTop + diffTop + 'px';
    };
    OverviewPanelComponent.prototype.chanageImageView = function (isOpen) {
        this.isOpenImageView = isOpen;
    };
    OverviewPanelComponent.prototype.getInventoryTags = function (gameObject) {
        return this.inventoryService.tableInventory.dataElementMap.get(gameObject.identifier);
    };
    OverviewPanelComponent.ctorParameters = function () { return [
        { type: service_game_object_inventory_service__WEBPACK_IMPORTED_MODULE_6__["GameObjectInventoryService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectorRef"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_7__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ViewChild"])('draggablePanel', { static: true })
    ], OverviewPanelComponent.prototype, "draggablePanel", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], OverviewPanelComponent.prototype, "tabletopObject", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], OverviewPanelComponent.prototype, "left", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], OverviewPanelComponent.prototype, "top", void 0);
    OverviewPanelComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
            selector: 'overview-panel',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./overview-panel.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/overview-panel/overview-panel.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ChangeDetectionStrategy"].OnPush,
            animations: [
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('fadeInOut', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('void => *', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('100ms ease-out', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ opacity: 0, offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ opacity: 1, offset: 1.0 })
                        ]))
                    ]),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => void', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('100ms ease-in', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ opacity: 1, offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ opacity: 0, offset: 1.0 })
                        ]))
                    ])
                ])
            ],
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./overview-panel.component.css */ "./src/app/component/overview-panel/overview-panel.component.css")).default]
        })
    ], OverviewPanelComponent);
    return OverviewPanelComponent;
}());



/***/ }),

/***/ "./src/app/component/password-check/password-check.component.css":
/*!***********************************************************************!*\
  !*** ./src/app/component/password-check/password-check.component.css ***!
  \***********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".box {\n  border-bottom:1px dotted #888;\n}\n.image {\n  padding: 0px;\n  width: 64px;\n  height: 64px;\n  display: inline-block;\n  vertical-align: top;\n}\n.contain {\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L3Bhc3N3b3JkLWNoZWNrL3Bhc3N3b3JkLWNoZWNrLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSw2QkFBNkI7QUFDL0I7QUFDQTtFQUNFLFlBQVk7RUFDWixXQUFXO0VBQ1gsWUFBWTtFQUNaLHFCQUFxQjtFQUNyQixtQkFBbUI7QUFDckI7QUFFQTtFQUNFLGtDQUFrQztFQUNsQyw0QkFBNEI7RUFDNUIsd0JBQXdCO0FBQzFCIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L3Bhc3N3b3JkLWNoZWNrL3Bhc3N3b3JkLWNoZWNrLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuYm94IHtcbiAgYm9yZGVyLWJvdHRvbToxcHggZG90dGVkICM4ODg7XG59XG4uaW1hZ2Uge1xuICBwYWRkaW5nOiAwcHg7XG4gIHdpZHRoOiA2NHB4O1xuICBoZWlnaHQ6IDY0cHg7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcbn1cblxuLmNvbnRhaW4ge1xuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXIgY2VudGVyO1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XG59Il19 */");

/***/ }),

/***/ "./src/app/component/password-check/password-check.component.ts":
/*!**********************************************************************!*\
  !*** ./src/app/component/password-check/password-check.component.ts ***!
  \**********************************************************************/
/*! exports provided: PasswordCheckComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PasswordCheckComponent", function() { return PasswordCheckComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");





var PasswordCheckComponent = /** @class */ (function () {
    function PasswordCheckComponent(panelService, modalService) {
        this.panelService = panelService;
        this.modalService = modalService;
        this.password = '';
        this.help = '';
        this.needPassword = '';
        this.needPassword = modalService.option.password ? modalService.option.password : '';
    }
    Object.defineProperty(PasswordCheckComponent.prototype, "peerId", {
        get: function () { return _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerId; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PasswordCheckComponent.prototype, "isConnected", {
        get: function () {
            return _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerIds.length <= 1 ? false : true;
        },
        enumerable: true,
        configurable: true
    });
    PasswordCheckComponent.prototype.ngOnInit = function () {
        this.modalService.title = this.panelService.title = 'パスワード';
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this);
    };
    PasswordCheckComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(this);
    };
    PasswordCheckComponent.prototype.onInputChange = function (value) {
        this.help = '';
    };
    PasswordCheckComponent.prototype.submit = function () {
        if (this.needPassword === this.password)
            this.modalService.resolve(this.password);
        this.help = 'パスワードが違います';
    };
    PasswordCheckComponent.ctorParameters = function () { return [
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_4__["PanelService"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_3__["ModalService"] }
    ]; };
    PasswordCheckComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'password-check',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./password-check.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/password-check/password-check.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./password-check.component.css */ "./src/app/component/password-check/password-check.component.css")).default]
        })
    ], PasswordCheckComponent);
    return PasswordCheckComponent;
}());



/***/ }),

/***/ "./src/app/component/peer-cursor/peer-cursor.component.css":
/*!*****************************************************************!*\
  !*** ./src/app/component/peer-cursor/peer-cursor.component.css ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".component {\n  position: absolute;\n  overflow: visible;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n}\n\n.is-transition {\n  -webkit-transition: opacity 0.5s ease-out, -webkit-transform 133ms linear;\n  transition: opacity 0.5s ease-out, -webkit-transform 133ms linear;\n  transition: transform 133ms linear, opacity 0.5s ease-out;\n  transition: transform 133ms linear, opacity 0.5s ease-out, -webkit-transform 133ms linear;\n}\n\n.peer-cursor {\n  height: 45px;\n  width: 45px;\n  position: absolute;\n  left: 0;\n  top: 0;\n  box-sizing: border-box;\n  border: solid 1px rgba(240, 218, 189);\n  border-radius: 50% 50% 5% 50%;\n  background-color: rgba(240, 218, 189, 0.9);\n  -webkit-transform-origin: 100% 100%;\n          transform-origin: 100% 100%;\n  -webkit-transform: translateX(-100%) translateY(-100%)  rotateX(-90deg) rotateZ(45deg);\n          transform: translateX(-100%) translateY(-100%)  rotateX(-90deg) rotateZ(45deg);\n}\n\n.icon {\n  overflow: visible;\n  height: 100%;\n  width: 100%;\n  border-radius: 100%;\n  background-position: top, center;\n  background-repeat: no-repeat;\n  background-size: cover;\n  -webkit-transform: rotateZ(-45deg) scale(0.85);\n          transform: rotateZ(-45deg) scale(0.85);\n}\n\n.name {\n  box-sizing: border-box;\n  font-size: 7px;\n  padding: 2px 5px;\n  border-radius: 14px;\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n\n.is-center {\n  position: absolute;\n  left: 50%;\n  top: -26px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n}\n\n.is-3d {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L3BlZXItY3Vyc29yL3BlZXItY3Vyc29yLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxrQkFBa0I7RUFDbEIsaUJBQWlCO0VBQ2pCLHNCQUFzQjtFQUN0Qix5QkFBeUI7RUFDekIscUJBQWlCO01BQWpCLGlCQUFpQjtFQUNqQixvQkFBb0I7RUFDcEIsdUJBQXVCO0FBQ3pCOztBQUVBO0VBQ0UseUVBQXlEO0VBQXpELGlFQUF5RDtFQUF6RCx5REFBeUQ7RUFBekQseUZBQXlEO0FBQzNEOztBQUVBO0VBQ0UsWUFBWTtFQUNaLFdBQVc7RUFDWCxrQkFBa0I7RUFDbEIsT0FBTztFQUNQLE1BQU07RUFDTixzQkFBc0I7RUFDdEIscUNBQXFDO0VBQ3JDLDZCQUE2QjtFQUM3QiwwQ0FBMEM7RUFDMUMsbUNBQTJCO1VBQTNCLDJCQUEyQjtFQUMzQixzRkFBOEU7VUFBOUUsOEVBQThFO0FBQ2hGOztBQUVBO0VBQ0UsaUJBQWlCO0VBQ2pCLFlBQVk7RUFDWixXQUFXO0VBQ1gsbUJBQW1CO0VBQ25CLGdDQUFnQztFQUNoQyw0QkFBNEI7RUFDNUIsc0JBQXNCO0VBQ3RCLDhDQUFzQztVQUF0QyxzQ0FBc0M7QUFDeEM7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsY0FBYztFQUNkLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsV0FBVztFQUNYLHVDQUF1QztBQUN6Qzs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsVUFBVTtFQUNWLG1DQUEyQjtVQUEzQiwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxvQ0FBb0M7RUFDcEMsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L3BlZXItY3Vyc29yL3BlZXItY3Vyc29yLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29tcG9uZW50IHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gIC1tb3otdXNlci1kcmFnOiBub25lO1xuICAtd2Via2l0LXVzZXItZHJhZzogbm9uZTtcbn1cblxuLmlzLXRyYW5zaXRpb24ge1xuICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMTMzbXMgbGluZWFyLCBvcGFjaXR5IDAuNXMgZWFzZS1vdXQ7XG59XG5cbi5wZWVyLWN1cnNvciB7XG4gIGhlaWdodDogNDVweDtcbiAgd2lkdGg6IDQ1cHg7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgbGVmdDogMDtcbiAgdG9wOiAwO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBib3JkZXI6IHNvbGlkIDFweCByZ2JhKDI0MCwgMjE4LCAxODkpO1xuICBib3JkZXItcmFkaXVzOiA1MCUgNTAlIDUlIDUwJTtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNDAsIDIxOCwgMTg5LCAwLjkpO1xuICB0cmFuc2Zvcm0tb3JpZ2luOiAxMDAlIDEwMCU7XG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMTAwJSkgdHJhbnNsYXRlWSgtMTAwJSkgIHJvdGF0ZVgoLTkwZGVnKSByb3RhdGVaKDQ1ZGVnKTtcbn1cblxuLmljb24ge1xuICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbiAgYm9yZGVyLXJhZGl1czogMTAwJTtcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogdG9wLCBjZW50ZXI7XG4gIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XG4gIGJhY2tncm91bmQtc2l6ZTogY292ZXI7XG4gIHRyYW5zZm9ybTogcm90YXRlWigtNDVkZWcpIHNjYWxlKDAuODUpO1xufVxuXG4ubmFtZSB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGZvbnQtc2l6ZTogN3B4O1xuICBwYWRkaW5nOiAycHggNXB4O1xuICBib3JkZXItcmFkaXVzOiAxNHB4O1xuICBjb2xvcjogI0NDQztcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDMwLCAwLjgpO1xufVxuXG4uaXMtY2VudGVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBsZWZ0OiA1MCU7XG4gIHRvcDogLTI2cHg7XG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTtcbn1cblxuLmlzLTNkIHtcbiAgLXdlYmtpdC10cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkO1xuICB0cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkO1xufVxuXG4uaXMtcG9pbnRlci1ldmVudHMtbm9uZSB7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xufSJdfQ== */");

/***/ }),

/***/ "./src/app/component/peer-cursor/peer-cursor.component.ts":
/*!****************************************************************!*\
  !*** ./src/app/component/peer-cursor/peer-cursor.component.ts ***!
  \****************************************************************/
/*! exports provided: PeerCursorComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PeerCursorComponent", function() { return PeerCursorComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_tabletop_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! service/tabletop.service */ "./src/app/service/tabletop.service.ts");






var PeerCursorComponent = /** @class */ (function () {
    function PeerCursorComponent(tabletopService, ngZone) {
        var _this = this;
        this.tabletopService = tabletopService;
        this.ngZone = ngZone;
        this.cursor = _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_3__["PeerCursor"].myCursor;
        this.cursorElement = null;
        this.opacityElement = null;
        this.fadeOutTimer = null;
        this.updateInterval = null;
        this.callcack = function (e) { return _this.onMouseMove(e); };
        this._x = 0;
        this._y = 0;
    }
    Object.defineProperty(PeerCursorComponent.prototype, "iconUrl", {
        get: function () { return this.cursor.image.url; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PeerCursorComponent.prototype, "name", {
        get: function () { return this.cursor.name; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PeerCursorComponent.prototype, "isMine", {
        get: function () { return this.cursor.isMine; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PeerCursorComponent.prototype, "delayMs", {
        get: function () {
            var maxDelay = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerIds.length * 16.6;
            return maxDelay < 100 ? 100 : maxDelay;
        },
        enumerable: true,
        configurable: true
    });
    PeerCursorComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (!this.isMine) {
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
                .on('CURSOR_MOVE', function (event) {
                if (event.sendFrom !== _this.cursor.peerId)
                    return;
                _this.tabletopService.addBatch(function () {
                    _this.stopTransition();
                    _this.setAnimatedTransition();
                    _this.setPosition(event.data[0], event.data[1], event.data[2]);
                    _this.resetFadeOut();
                }, _this);
            });
        }
    };
    PeerCursorComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        if (this.isMine) {
            this.ngZone.runOutsideAngular(function () {
                document.body.addEventListener('mousemove', _this.callcack);
                document.body.addEventListener('touchmove', _this.callcack);
            });
        }
        else {
            this.cursorElement = this.cursorElementRef.nativeElement;
            this.opacityElement = this.opacityElementRef.nativeElement;
            this.setAnimatedTransition();
            this.setPosition(0, 0, 0);
            this.resetFadeOut();
        }
    };
    PeerCursorComponent.prototype.ngOnDestroy = function () {
        document.body.removeEventListener('mousemove', this.callcack);
        document.body.removeEventListener('touchmove', this.callcack);
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(this);
        this.tabletopService.removeBatch(this);
    };
    PeerCursorComponent.prototype.onMouseMove = function (e) {
        var _this = this;
        var x = e.touches ? e.changedTouches[0].pageX : e.pageX;
        var y = e.touches ? e.changedTouches[0].pageY : e.pageY;
        if (x === this._x && y === this._y)
            return;
        this._x = x;
        this._y = y;
        this._target = e.target;
        if (!this.updateInterval) {
            this.updateInterval = setTimeout(function () {
                _this.updateInterval = null;
                _this.calcLocalCoordinate(_this._x, _this._y, _this._target);
            }, this.delayMs);
        }
    };
    PeerCursorComponent.prototype.calcLocalCoordinate = function (x, y, target) {
        if (!document.getElementById('app-table-layer').contains(target))
            return;
        var dragArea = document.getElementById('app-game-table');
        var coordinate = { x: x, y: y, z: 0 };
        if (target.contains(dragArea)) {
            coordinate = service_pointer_device_service__WEBPACK_IMPORTED_MODULE_4__["PointerDeviceService"].convertToLocal(coordinate, dragArea);
            coordinate.z = 0;
        }
        else {
            coordinate = service_pointer_device_service__WEBPACK_IMPORTED_MODULE_4__["PointerDeviceService"].convertLocalToLocal(coordinate, target, dragArea);
        }
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].call('CURSOR_MOVE', [coordinate.x, coordinate.y, coordinate.z]);
    };
    PeerCursorComponent.prototype.resetFadeOut = function () {
        var _this = this;
        this.opacityElement.style.opacity = '1.0';
        clearTimeout(this.fadeOutTimer);
        this.fadeOutTimer = setTimeout(function () {
            _this.opacityElement.style.opacity = '0.0';
        }, 3000);
    };
    PeerCursorComponent.prototype.stopTransition = function () {
        this.cursorElement.style.transform = window.getComputedStyle(this.cursorElement).transform;
    };
    PeerCursorComponent.prototype.setAnimatedTransition = function () {
        this.cursorElement.style.transition = "transform " + (this.delayMs + 33) + "ms linear, opacity 0.5s ease-out";
    };
    PeerCursorComponent.prototype.setPosition = function (x, y, z) {
        this.cursorElement.style.transform = 'translateX(' + x + 'px) translateY(' + y + 'px) translateZ(' + z + 'px)';
    };
    PeerCursorComponent.ctorParameters = function () { return [
        { type: service_tabletop_service__WEBPACK_IMPORTED_MODULE_5__["TabletopService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('cursor', { static: false })
    ], PeerCursorComponent.prototype, "cursorElementRef", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('opacity', { static: false })
    ], PeerCursorComponent.prototype, "opacityElementRef", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], PeerCursorComponent.prototype, "cursor", void 0);
    PeerCursorComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'peer-cursor, [peer-cursor]',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./peer-cursor.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/peer-cursor/peer-cursor.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./peer-cursor.component.css */ "./src/app/component/peer-cursor/peer-cursor.component.css")).default]
        })
    ], PeerCursorComponent);
    return PeerCursorComponent;
}());



/***/ }),

/***/ "./src/app/component/peer-menu/peer-menu.component.css":
/*!*************************************************************!*\
  !*** ./src/app/component/peer-menu/peer-menu.component.css ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".image {\n  padding: 0px;\n  width: 128px;\n  height: 128px;\n  display: table-cell;\n  vertical-align: top;\n}\n\n.image img{\n  width: auto;\n  height: auto;\n  max-width:100%;\n  max-height:100%;\n  vertical-align: bottom;\n}\n\n.cover {\n  background-position: center top;\n  background-repeat: no-repeat;\n  background-size: cover;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L3BlZXItbWVudS9wZWVyLW1lbnUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQVk7RUFDWixZQUFZO0VBQ1osYUFBYTtFQUNiLG1CQUFtQjtFQUNuQixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsWUFBWTtFQUNaLGNBQWM7RUFDZCxlQUFlO0VBQ2Ysc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsK0JBQStCO0VBQy9CLDRCQUE0QjtFQUM1QixzQkFBc0I7QUFDeEIiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvcGVlci1tZW51L3BlZXItbWVudS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmltYWdlIHtcbiAgcGFkZGluZzogMHB4O1xuICB3aWR0aDogMTI4cHg7XG4gIGhlaWdodDogMTI4cHg7XG4gIGRpc3BsYXk6IHRhYmxlLWNlbGw7XG4gIHZlcnRpY2FsLWFsaWduOiB0b3A7XG59XG5cbi5pbWFnZSBpbWd7XG4gIHdpZHRoOiBhdXRvO1xuICBoZWlnaHQ6IGF1dG87XG4gIG1heC13aWR0aDoxMDAlO1xuICBtYXgtaGVpZ2h0OjEwMCU7XG4gIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG59XG5cbi5jb3ZlciB7XG4gIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlciB0b3A7XG4gIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XG4gIGJhY2tncm91bmQtc2l6ZTogY292ZXI7XG59Il19 */");

/***/ }),

/***/ "./src/app/component/peer-menu/peer-menu.component.ts":
/*!************************************************************!*\
  !*** ./src/app/component/peer-menu/peer-menu.component.ts ***!
  \************************************************************/
/*! exports provided: PeerMenuComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PeerMenuComponent", function() { return PeerMenuComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/system/network/peer-context */ "./src/app/class/core/system/network/peer-context.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! component/file-selecter/file-selecter.component */ "./src/app/component/file-selecter/file-selecter.component.ts");
/* harmony import */ var component_lobby_lobby_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! component/lobby/lobby.component */ "./src/app/component/lobby/lobby.component.ts");
/* harmony import */ var service_app_config_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! service/app-config.service */ "./src/app/service/app-config.service.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");











var PeerMenuComponent = /** @class */ (function () {
    function PeerMenuComponent(ngZone, modalService, panelService, appConfigService) {
        this.ngZone = ngZone;
        this.modalService = modalService;
        this.panelService = panelService;
        this.appConfigService = appConfigService;
        this.targetPeerId = '';
        this.networkService = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"];
        this.gameRoomService = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance;
        this.help = '';
    }
    Object.defineProperty(PeerMenuComponent.prototype, "myPeer", {
        get: function () { return _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__["PeerCursor"].myCursor; },
        enumerable: true,
        configurable: true
    });
    PeerMenuComponent.prototype.ngOnInit = function () {
        this.panelService.title = '接続情報';
    };
    PeerMenuComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('OPEN_NETWORK', function (event) {
            _this.ngZone.run(function () { });
        });
    };
    PeerMenuComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    PeerMenuComponent.prototype.changeIcon = function () {
        var _this = this;
        this.modalService.open(component_file_selecter_file_selecter_component__WEBPACK_IMPORTED_MODULE_6__["FileSelecterComponent"]).then(function (value) {
            if (!_this.myPeer || !value)
                return;
            _this.myPeer.imageIdentifier = value;
        });
    };
    PeerMenuComponent.prototype.resetPeerIfNeeded = function () {
        if (_udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContexts.length < 1) {
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].open();
            _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__["PeerCursor"].myCursor.peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId;
        }
    };
    PeerMenuComponent.prototype.connectPeer = function () {
        var _this = this;
        this.help = '';
        var context = _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_3__["PeerContext"].create(this.targetPeerId);
        if (!context.isRoom) {
            _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.clearDeleteHistory();
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].connect(this.targetPeerId);
        }
        else {
            if (_udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContexts.length) {
                this.help = '入力されたIDはルーム用のIDのようですが、ルーム用IDと通常のIDを混在させることはできません。プライベート接続を切ってください。（※ページリロードで切断ができます）';
                return;
            }
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].open(_udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.id, context.room, context.roomName, context.password);
            _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__["PeerCursor"].myCursor.peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId;
            var dummy_1 = {};
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(dummy_1)
                .on('OPEN_NETWORK', function (event) {
                _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.clearDeleteHistory();
                _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].connect(_this.targetPeerId);
                _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(dummy_1);
                _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(dummy_1)
                    .on('CONNECT_PEER', function (event) {
                    console.log('接続成功！', event.data.peer);
                    _this.resetPeerIfNeeded();
                    _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(dummy_1);
                })
                    .on('DISCONNECT_PEER', function (event) {
                    console.warn('接続失敗', event.data.peer);
                    _this.resetPeerIfNeeded();
                    _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(dummy_1);
                });
            });
        }
    };
    PeerMenuComponent.prototype.connectPeerHistory = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var conectPeers, room, _a, _b, peer, context, conectPeers_1, peerIds, peerIds_1, peerIds_1_1, id, context, listener;
            var e_1, _c, e_2, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        this.help = '';
                        conectPeers = [];
                        room = '';
                        try {
                            for (_a = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.appConfigService.peerHistory), _b = _a.next(); !_b.done; _b = _a.next()) {
                                peer = _b.value;
                                context = _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_3__["PeerContext"].create(peer);
                                if (context.isRoom) {
                                    if (room !== context.room)
                                        conectPeers = [];
                                    room = context.room;
                                    conectPeers.push(context);
                                }
                                else {
                                    if (room !== context.room)
                                        conectPeers = [];
                                    conectPeers.push(context);
                                }
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        if (!room.length) return [3 /*break*/, 2];
                        console.warn('connectPeerRoom <' + room + '>');
                        conectPeers_1 = [];
                        return [4 /*yield*/, _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].listAllPeers()];
                    case 1:
                        peerIds = _e.sent();
                        try {
                            for (peerIds_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](peerIds), peerIds_1_1 = peerIds_1.next(); !peerIds_1_1.done; peerIds_1_1 = peerIds_1.next()) {
                                id = peerIds_1_1.value;
                                console.log(id);
                                context = new _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_3__["PeerContext"](id);
                                if (context.room === room) {
                                    conectPeers_1.push(context);
                                }
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (peerIds_1_1 && !peerIds_1_1.done && (_d = peerIds_1.return)) _d.call(peerIds_1);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                        if (conectPeers_1.length < 1) {
                            this.help = '前回接続していたルームが見つかりませんでした。既に解散しているかもしれません。';
                            console.warn('Room is already closed...');
                            return [2 /*return*/];
                        }
                        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].open(_udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_3__["PeerContext"].generateId(), conectPeers_1[0].room, conectPeers_1[0].roomName, conectPeers_1[0].password);
                        return [3 /*break*/, 3];
                    case 2:
                        console.warn('connectPeers ' + conectPeers.length);
                        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].open();
                        _e.label = 3;
                    case 3:
                        _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__["PeerCursor"].myCursor.peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerId;
                        listener = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this);
                        listener.on('OPEN_NETWORK', function (event) {
                            var e_3, _a;
                            console.log('OPEN_NETWORK', event.data.peer);
                            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregisterListener(listener);
                            _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.clearDeleteHistory();
                            try {
                                for (var conectPeers_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](conectPeers), conectPeers_2_1 = conectPeers_2.next(); !conectPeers_2_1.done; conectPeers_2_1 = conectPeers_2.next()) {
                                    var context = conectPeers_2_1.value;
                                    _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].connect(context.fullstring);
                                }
                            }
                            catch (e_3_1) { e_3 = { error: e_3_1 }; }
                            finally {
                                try {
                                    if (conectPeers_2_1 && !conectPeers_2_1.done && (_a = conectPeers_2.return)) _a.call(conectPeers_2);
                                }
                                finally { if (e_3) throw e_3.error; }
                            }
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    PeerMenuComponent.prototype.showLobby = function () {
        this.modalService.open(component_lobby_lobby_component__WEBPACK_IMPORTED_MODULE_7__["LobbyComponent"], { width: 700, height: 400, left: 0, top: 400 });
    };
    PeerMenuComponent.prototype.findPeerName = function (peerId) {
        var peerCursor = _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_5__["PeerCursor"].find(peerId);
        return peerCursor ? peerCursor.name : '';
    };
    PeerMenuComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_9__["ModalService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_10__["PanelService"] },
        { type: service_app_config_service__WEBPACK_IMPORTED_MODULE_8__["AppConfigService"] }
    ]; };
    PeerMenuComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'peer-menu',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./peer-menu.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/peer-menu/peer-menu.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./peer-menu.component.css */ "./src/app/component/peer-menu/peer-menu.component.css")).default]
        })
    ], PeerMenuComponent);
    return PeerMenuComponent;
}());



/***/ }),

/***/ "./src/app/component/room-setting/room-setting.component.css":
/*!*******************************************************************!*\
  !*** ./src/app/component/room-setting/room-setting.component.css ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".box {\n  border-bottom:1px dotted #888;\n}\n.image {\n  padding: 0px;\n  width: 64px;\n  height: 64px;\n  display: inline-block;\n  vertical-align: top;\n}\n.contain {\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.input {\n  width: 100%;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L3Jvb20tc2V0dGluZy9yb29tLXNldHRpbmcuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLDZCQUE2QjtBQUMvQjtBQUNBO0VBQ0UsWUFBWTtFQUNaLFdBQVc7RUFDWCxZQUFZO0VBQ1oscUJBQXFCO0VBQ3JCLG1CQUFtQjtBQUNyQjtBQUVBO0VBQ0Usa0NBQWtDO0VBQ2xDLDRCQUE0QjtFQUM1Qix3QkFBd0I7QUFDMUI7QUFFQTtFQUNFLFdBQVc7QUFDYiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9yb29tLXNldHRpbmcvcm9vbS1zZXR0aW5nLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuYm94IHtcbiAgYm9yZGVyLWJvdHRvbToxcHggZG90dGVkICM4ODg7XG59XG4uaW1hZ2Uge1xuICBwYWRkaW5nOiAwcHg7XG4gIHdpZHRoOiA2NHB4O1xuICBoZWlnaHQ6IDY0cHg7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcbn1cblxuLmNvbnRhaW4ge1xuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXIgY2VudGVyO1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XG59XG5cbi5pbnB1dCB7XG4gIHdpZHRoOiAxMDAlO1xufSJdfQ== */");

/***/ }),

/***/ "./src/app/component/room-setting/room-setting.component.ts":
/*!******************************************************************!*\
  !*** ./src/app/component/room-setting/room-setting.component.ts ***!
  \******************************************************************/
/*! exports provided: RoomSettingComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RoomSettingComponent", function() { return RoomSettingComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system/network/peer-context */ "./src/app/class/core/system/network/peer-context.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");







var RoomSettingComponent = /** @class */ (function () {
    function RoomSettingComponent(panelService, modalService) {
        this.panelService = panelService;
        this.modalService = modalService;
        this.peers = [];
        this.isReloading = false;
        this.roomName = 'ふつうの部屋';
        this.password = '';
        this.isPrivate = false;
        this.validateLength = false;
    }
    Object.defineProperty(RoomSettingComponent.prototype, "peerId", {
        get: function () { return _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RoomSettingComponent.prototype, "isConnected", {
        get: function () { return _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerIds.length <= 1 ? false : true; },
        enumerable: true,
        configurable: true
    });
    RoomSettingComponent.prototype.ngOnInit = function () {
        this.modalService.title = this.panelService.title = 'ルーム作成';
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].register(this);
        this.calcPeerId(this.roomName, this.password);
    };
    RoomSettingComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].unregister(this);
    };
    RoomSettingComponent.prototype.calcPeerId = function (roomName, password) {
        var peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerContext ? _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerContext.id : _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_2__["PeerContext"].generateId();
        var context = _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_2__["PeerContext"].create(peerId, _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_2__["PeerContext"].generateId('***'), roomName, password);
        this.validateLength = context.fullstring.length < 64 ? true : false;
    };
    RoomSettingComponent.prototype.createRoom = function () {
        var peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerContext ? _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerContext.id : _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_2__["PeerContext"].generateId();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].open(peerId, _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_2__["PeerContext"].generateId('***'), this.roomName, this.password);
        _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_4__["PeerCursor"].myCursor.peerId = _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId;
        this.modalService.resolve();
    };
    RoomSettingComponent.ctorParameters = function () { return [
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_6__["PanelService"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_5__["ModalService"] }
    ]; };
    RoomSettingComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'room-setting',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./room-setting.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/room-setting/room-setting.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./room-setting.component.css */ "./src/app/component/room-setting/room-setting.component.css")).default]
        })
    ], RoomSettingComponent);
    return RoomSettingComponent;
}());



/***/ }),

/***/ "./src/app/component/terrain/terrain.component.css":
/*!*********************************************************!*\
  !*** ./src/app/component/terrain/terrain.component.css ***!
  \*********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".is-grab {\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n\n.is-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.is-3d {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n\n.is-transition {\n  -webkit-transition: -webkit-transform 132ms linear;\n  transition: -webkit-transform 132ms linear;\n  transition: transform 132ms linear;\n  transition: transform 132ms linear, -webkit-transform 132ms linear;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n\n.is-pointer-events-auto {\n  pointer-events: auto;\n}\n\n.component {\n  position: absolute;\n  height: 50px;\n  width: 50px;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  \n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n}\n\n.component-content {\n  height: 100%;\n  width: 100%;\n}\n\n.texture {\n  position: absolute;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  background-repeat: no-repeat;\n  background-size: 100% 100%;\n  height: 100%;\n  width: 100%;\n}\n\n.of-wall-top {\n  top: 0px;\n  left: 0px;\n\n  -webkit-transform-origin: 50% 100%;\n\n          transform-origin: 50% 100%;\n  -webkit-transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0);\n          transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0);\n  -webkit-filter: brightness(0.3);\n          filter: brightness(0.3);\n}\n\n.of-wall-bottom {\n  bottom: 0px;\n  left: 0px;\n\n  -webkit-transform-origin: 50% 100%;\n\n          transform-origin: 50% 100%;\n  -webkit-transform: rotateX(-90deg);\n          transform: rotateX(-90deg);\n  -webkit-filter: brightness(1.0);\n          filter: brightness(1.0);\n}\n\n.of-wall-left {\n  top: 0px;\n  left: 0px;\n\n  -webkit-transform-origin: 0% 0%;\n\n          transform-origin: 0% 0%;\n  -webkit-transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%);\n          transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%);\n  -webkit-filter: brightness(0.5);\n          filter: brightness(0.5);\n}\n\n.of-wall-right {\n  top: 0px;\n  right: 0px;\n\n  -webkit-transform-origin: 100% 0%;\n\n          transform-origin: 100% 0%;\n  -webkit-transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%);\n          transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%);\n  -webkit-filter: brightness(0.8);\n          filter: brightness(0.8);\n}\n\n.pedestal-grab {\n  z-index: -1;\n  position: absolute;\n  top: -14px;\n  left: -14px;\n  right: -14px;\n  bottom: -14px;\n  cursor: default;\n\n  box-sizing: border-box;\n  border-top: solid 7px #CCC;\n  border-left: solid 7px #CCC;\n  border-right: solid 7px #CCC;\n  border-bottom: solid 7px #CCC;\n  border-radius: 14px;\n}\n\n.rotate-grab {\n  opacity: 0;\n  z-index: -1;\n}\n\n.rotate-grab-icon {\n  position: absolute;\n  width: 28px;\n  height: 28px;\n  box-sizing: border-box;\n  border: solid 2px #CCCCCC;\n  cursor: -moz-default;\n  cursor: -webkit-default;\n  cursor: default;\n  z-index: 1;\n  padding: 0;\n  background-color: #CCCCCC;\n  border-radius: 100%;\n  color: #444;\n  font-size: 8px;\n\n  -webkit-transform-style: preserve-3d;\n\n          transform-style: preserve-3d;\n  -webkit-transform: translateZ(0.1px);\n          transform: translateZ(0.1px);\n}\n\n.component:hover .rotate-grab, .component:active .rotate-grab {\n  opacity: 1;\n}\n\n.of-left-top {\n  top: -14px;\n  left: -14px;\n  border-radius: 14px 7px 14px 7px;\n}\n\n.of-left-bottom {\n  bottom: -14px;\n  left: -14px;\n  border-radius: 7px 14px 7px 14px;\n}\n\n.of-right-bottom {\n  bottom: -14px;\n  right: -14px;\n  border-radius: 14px 7px 14px 7px;\n}\n\n.of-right-top {\n  top: -14px;\n  right: -14px;\n  border-radius: 7px 14px 7px 14px;\n}\n\n.blinking-animation {\n\t-webkit-animation: blink 1.0s linear infinite alternate;\n   animation: blink 1.0s linear infinite alternate;\n}\n\n@-webkit-keyframes blink {\n  0% { opacity:0.9; }\n  100% { opacity:0.5; }\n}\n\n@keyframes blink {\n  0% { opacity:0.9; }\n  100% { opacity:0.5; }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L3RlcnJhaW4vdGVycmFpbi5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUUsb0JBQW9CO0VBQ3BCLFlBQVk7QUFDZDs7QUFFQTtFQUVFLHdCQUF3QjtFQUN4QixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxvQ0FBb0M7RUFDcEMsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0Usa0RBQWtEO0VBQ2xELDBDQUFrQztFQUFsQyxrQ0FBa0M7RUFBbEMsa0VBQWtDO0FBQ3BDOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFlBQVk7RUFDWixXQUFXO0VBQ1gsbUNBQTJCO1VBQTNCLDJCQUEyQjtFQUMzQixzQkFBc0I7RUFDdEIseUJBQXlCO0VBQ3pCLHFCQUFpQjtNQUFqQixpQkFBaUI7O0VBRWpCLG9CQUFvQjtFQUNwQix1QkFBdUI7QUFDekI7O0FBRUE7RUFDRSxZQUFZO0VBQ1osV0FBVztBQUNiOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLG1DQUEyQjtVQUEzQiwyQkFBMkI7RUFDM0IsNEJBQTRCO0VBQzVCLDBCQUEwQjtFQUMxQixZQUFZO0VBQ1osV0FBVztBQUNiOztBQUVBO0VBQ0UsUUFBUTtFQUNSLFNBQVM7O0VBRVQsa0NBQTBCOztVQUExQiwwQkFBMEI7RUFDMUIsZ0ZBQXdFO1VBQXhFLHdFQUF3RTtFQUN4RSwrQkFBdUI7VUFBdkIsdUJBQXVCO0FBQ3pCOztBQUVBO0VBQ0UsV0FBVztFQUNYLFNBQVM7O0VBRVQsa0NBQTBCOztVQUExQiwwQkFBMEI7RUFDMUIsa0NBQTBCO1VBQTFCLDBCQUEwQjtFQUMxQiwrQkFBdUI7VUFBdkIsdUJBQXVCO0FBQ3pCOztBQUVBO0VBQ0UsUUFBUTtFQUNSLFNBQVM7O0VBRVQsK0JBQXVCOztVQUF2Qix1QkFBdUI7RUFDdkIsa0dBQTBGO1VBQTFGLDBGQUEwRjtFQUMxRiwrQkFBdUI7VUFBdkIsdUJBQXVCO0FBQ3pCOztBQUVBO0VBQ0UsUUFBUTtFQUNSLFVBQVU7O0VBRVYsaUNBQXlCOztVQUF6Qix5QkFBeUI7RUFDekIsb0VBQTREO1VBQTVELDREQUE0RDtFQUM1RCwrQkFBdUI7VUFBdkIsdUJBQXVCO0FBQ3pCOztBQUVBO0VBQ0UsV0FBVztFQUNYLGtCQUFrQjtFQUNsQixVQUFVO0VBQ1YsV0FBVztFQUNYLFlBQVk7RUFDWixhQUFhO0VBQ2IsZUFBZTs7RUFFZixzQkFBc0I7RUFDdEIsMEJBQTBCO0VBQzFCLDJCQUEyQjtFQUMzQiw0QkFBNEI7RUFDNUIsNkJBQTZCO0VBQzdCLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLFVBQVU7RUFDVixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIseUJBQXlCO0VBQ3pCLG9CQUFvQjtFQUNwQix1QkFBdUI7RUFDdkIsZUFBZTtFQUNmLFVBQVU7RUFDVixVQUFVO0VBQ1YseUJBQXlCO0VBQ3pCLG1CQUFtQjtFQUNuQixXQUFXO0VBQ1gsY0FBYzs7RUFFZCxvQ0FBNEI7O1VBQTVCLDRCQUE0QjtFQUM1QixvQ0FBNEI7VUFBNUIsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0UsVUFBVTtBQUNaOztBQUVBO0VBQ0UsVUFBVTtFQUNWLFdBQVc7RUFDWCxnQ0FBZ0M7QUFDbEM7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsV0FBVztFQUNYLGdDQUFnQztBQUNsQzs7QUFFQTtFQUNFLGFBQWE7RUFDYixZQUFZO0VBQ1osZ0NBQWdDO0FBQ2xDOztBQUVBO0VBQ0UsVUFBVTtFQUNWLFlBQVk7RUFDWixnQ0FBZ0M7QUFDbEM7O0FBRUE7Q0FDQyx1REFBdUQ7R0FFckQsK0NBQStDO0FBQ2xEOztBQUVBO0VBQ0UsS0FBSyxXQUFXLEVBQUU7RUFDbEIsT0FBTyxXQUFXLEVBQUU7QUFDdEI7O0FBT0E7RUFDRSxLQUFLLFdBQVcsRUFBRTtFQUNsQixPQUFPLFdBQVcsRUFBRTtBQUN0QiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC90ZXJyYWluL3RlcnJhaW4uY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5pcy1ncmFiIHtcbiAgY3Vyc29yOiAtbW96LWdyYWI7XG4gIGN1cnNvcjogLXdlYmtpdC1ncmFiO1xuICBjdXJzb3I6IGdyYWI7XG59XG5cbi5pcy1ncmFiYmluZyB7XG4gIGN1cnNvcjogLW1vei1ncmFiYmluZztcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWJiaW5nO1xuICBjdXJzb3I6IGdyYWJiaW5nO1xufVxuXG4uaXMtM2Qge1xuICAtd2Via2l0LXRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7XG4gIHRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7XG59XG5cbi5pcy10cmFuc2l0aW9uIHtcbiAgLXdlYmtpdC10cmFuc2l0aW9uOiAtd2Via2l0LXRyYW5zZm9ybSAxMzJtcyBsaW5lYXI7XG4gIHRyYW5zaXRpb246IHRyYW5zZm9ybSAxMzJtcyBsaW5lYXI7XG59XG5cbi5pcy1wb2ludGVyLWV2ZW50cy1ub25lIHtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG59XG5cbi5pcy1wb2ludGVyLWV2ZW50cy1hdXRvIHtcbiAgcG9pbnRlci1ldmVudHM6IGF1dG87XG59XG5cbi5jb21wb25lbnQge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGhlaWdodDogNTBweDtcbiAgd2lkdGg6IDUwcHg7XG4gIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjtcbiAgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gIFxuICAtbW96LXVzZXItZHJhZzogbm9uZTtcbiAgLXdlYmtpdC11c2VyLWRyYWc6IG5vbmU7XG59XG5cbi5jb21wb25lbnQtY29udGVudCB7XG4gIGhlaWdodDogMTAwJTtcbiAgd2lkdGg6IDEwMCU7XG59XG5cbi50ZXh0dXJlIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG4gIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XG4gIGJhY2tncm91bmQtc2l6ZTogMTAwJSAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4ub2Ytd2FsbC10b3Age1xuICB0b3A6IDBweDtcbiAgbGVmdDogMHB4O1xuXG4gIHRyYW5zZm9ybS1vcmlnaW46IDUwJSAxMDAlO1xuICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwMCUpIHJvdGF0ZVgoOTBkZWcpIHJvdGF0ZVooMTgwZGVnKSBzY2FsZVgoLTEuMCk7XG4gIGZpbHRlcjogYnJpZ2h0bmVzcygwLjMpO1xufVxuXG4ub2Ytd2FsbC1ib3R0b20ge1xuICBib3R0b206IDBweDtcbiAgbGVmdDogMHB4O1xuXG4gIHRyYW5zZm9ybS1vcmlnaW46IDUwJSAxMDAlO1xuICB0cmFuc2Zvcm06IHJvdGF0ZVgoLTkwZGVnKTtcbiAgZmlsdGVyOiBicmlnaHRuZXNzKDEuMCk7XG59XG5cbi5vZi13YWxsLWxlZnQge1xuICB0b3A6IDBweDtcbiAgbGVmdDogMHB4O1xuXG4gIHRyYW5zZm9ybS1vcmlnaW46IDAlIDAlO1xuICB0cmFuc2Zvcm06IHJvdGF0ZVooOTBkZWcpIHJvdGF0ZVgoLTkwZGVnKSBzY2FsZVgoLTEuMCkgdHJhbnNsYXRlWCgtMTAwJSkgdHJhbnNsYXRlWSgtMTAwJSk7XG4gIGZpbHRlcjogYnJpZ2h0bmVzcygwLjUpO1xufVxuXG4ub2Ytd2FsbC1yaWdodCB7XG4gIHRvcDogMHB4O1xuICByaWdodDogMHB4O1xuXG4gIHRyYW5zZm9ybS1vcmlnaW46IDEwMCUgMCU7XG4gIHRyYW5zZm9ybTogcm90YXRlWigtOTBkZWcpIHJvdGF0ZVgoLTkwZGVnKSB0cmFuc2xhdGVZKC0xMDAlKTtcbiAgZmlsdGVyOiBicmlnaHRuZXNzKDAuOCk7XG59XG5cbi5wZWRlc3RhbC1ncmFiIHtcbiAgei1pbmRleDogLTE7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAtMTRweDtcbiAgbGVmdDogLTE0cHg7XG4gIHJpZ2h0OiAtMTRweDtcbiAgYm90dG9tOiAtMTRweDtcbiAgY3Vyc29yOiBkZWZhdWx0O1xuXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlci10b3A6IHNvbGlkIDdweCAjQ0NDO1xuICBib3JkZXItbGVmdDogc29saWQgN3B4ICNDQ0M7XG4gIGJvcmRlci1yaWdodDogc29saWQgN3B4ICNDQ0M7XG4gIGJvcmRlci1ib3R0b206IHNvbGlkIDdweCAjQ0NDO1xuICBib3JkZXItcmFkaXVzOiAxNHB4O1xufVxuXG4ucm90YXRlLWdyYWIge1xuICBvcGFjaXR5OiAwO1xuICB6LWluZGV4OiAtMTtcbn1cblxuLnJvdGF0ZS1ncmFiLWljb24ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHdpZHRoOiAyOHB4O1xuICBoZWlnaHQ6IDI4cHg7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGJvcmRlcjogc29saWQgMnB4ICNDQ0NDQ0M7XG4gIGN1cnNvcjogLW1vei1kZWZhdWx0O1xuICBjdXJzb3I6IC13ZWJraXQtZGVmYXVsdDtcbiAgY3Vyc29yOiBkZWZhdWx0O1xuICB6LWluZGV4OiAxO1xuICBwYWRkaW5nOiAwO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjQ0NDQ0NDO1xuICBib3JkZXItcmFkaXVzOiAxMDAlO1xuICBjb2xvcjogIzQ0NDtcbiAgZm9udC1zaXplOiA4cHg7XG5cbiAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDtcbiAgdHJhbnNmb3JtOiB0cmFuc2xhdGVaKDAuMXB4KTtcbn1cblxuLmNvbXBvbmVudDpob3ZlciAucm90YXRlLWdyYWIsIC5jb21wb25lbnQ6YWN0aXZlIC5yb3RhdGUtZ3JhYiB7XG4gIG9wYWNpdHk6IDE7XG59XG5cbi5vZi1sZWZ0LXRvcCB7XG4gIHRvcDogLTE0cHg7XG4gIGxlZnQ6IC0xNHB4O1xuICBib3JkZXItcmFkaXVzOiAxNHB4IDdweCAxNHB4IDdweDtcbn1cblxuLm9mLWxlZnQtYm90dG9tIHtcbiAgYm90dG9tOiAtMTRweDtcbiAgbGVmdDogLTE0cHg7XG4gIGJvcmRlci1yYWRpdXM6IDdweCAxNHB4IDdweCAxNHB4O1xufVxuXG4ub2YtcmlnaHQtYm90dG9tIHtcbiAgYm90dG9tOiAtMTRweDtcbiAgcmlnaHQ6IC0xNHB4O1xuICBib3JkZXItcmFkaXVzOiAxNHB4IDdweCAxNHB4IDdweDtcbn1cblxuLm9mLXJpZ2h0LXRvcCB7XG4gIHRvcDogLTE0cHg7XG4gIHJpZ2h0OiAtMTRweDtcbiAgYm9yZGVyLXJhZGl1czogN3B4IDE0cHggN3B4IDE0cHg7XG59XG5cbi5ibGlua2luZy1hbmltYXRpb24ge1xuXHQtd2Via2l0LWFuaW1hdGlvbjogYmxpbmsgMS4wcyBsaW5lYXIgaW5maW5pdGUgYWx0ZXJuYXRlO1xuICAtbW96LWFuaW1hdGlvbjogYmxpbmsgMS4wcyBsaW5lYXIgaW5maW5pdGUgYWx0ZXJuYXRlO1xuICAgYW5pbWF0aW9uOiBibGluayAxLjBzIGxpbmVhciBpbmZpbml0ZSBhbHRlcm5hdGU7XG59XG5cbkAtd2Via2l0LWtleWZyYW1lcyBibGluayB7XG4gIDAlIHsgb3BhY2l0eTowLjk7IH1cbiAgMTAwJSB7IG9wYWNpdHk6MC41OyB9XG59XG5cbkAtbW96LWtleWZyYW1lcyBibGluayB7XG4gIDAlIHsgb3BhY2l0eTowLjk7IH1cbiAgMTAwJSB7IG9wYWNpdHk6MC41OyB9XG59XG5cbkBrZXlmcmFtZXMgYmxpbmsge1xuICAwJSB7IG9wYWNpdHk6MC45OyB9XG4gIDEwMCUgeyBvcGFjaXR5OjAuNTsgfVxufSJdfQ== */");

/***/ }),

/***/ "./src/app/component/terrain/terrain.component.ts":
/*!********************************************************!*\
  !*** ./src/app/component/terrain/terrain.component.ts ***!
  \********************************************************/
/*! exports provided: TerrainComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TerrainComponent", function() { return TerrainComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var _udonarium_terrain__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/terrain */ "./src/app/class/terrain.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var directive_input_handler__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! directive/input-handler */ "./src/app/directive/input-handler.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_tabletop_service__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! service/tabletop.service */ "./src/app/service/tabletop.service.ts");













var TerrainComponent = /** @class */ (function () {
    function TerrainComponent(tabletopService, contextMenuService, elementRef, panelService, changeDetector, pointerDeviceService) {
        this.tabletopService = tabletopService;
        this.contextMenuService = contextMenuService;
        this.elementRef = elementRef;
        this.panelService = panelService;
        this.changeDetector = changeDetector;
        this.pointerDeviceService = pointerDeviceService;
        this.terrain = null;
        this.is3D = false;
        this.gridSize = 50;
        this.movableOption = {};
        this.rotableOption = {};
        this.input = null;
    }
    Object.defineProperty(TerrainComponent.prototype, "name", {
        get: function () { return this.terrain.name; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "mode", {
        get: function () { return this.terrain.mode; },
        set: function (mode) { this.terrain.mode = mode; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "isLocked", {
        get: function () { return this.terrain.isLocked; },
        set: function (isLocked) { this.terrain.isLocked = isLocked; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "hasWall", {
        get: function () { return this.terrain.hasWall; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "hasFloor", {
        get: function () { return this.terrain.hasFloor; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "wallImage", {
        get: function () { return this.terrain.wallImage; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "floorImage", {
        get: function () { return this.terrain.floorImage; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "height", {
        get: function () { return this.adjustMinBounds(this.terrain.height); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "width", {
        get: function () { return this.adjustMinBounds(this.terrain.width); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TerrainComponent.prototype, "depth", {
        get: function () { return this.adjustMinBounds(this.terrain.depth); },
        enumerable: true,
        configurable: true
    });
    TerrainComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.terrain || !object)
                return;
            if (_this.terrain === object || (object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__["ObjectNode"] && _this.terrain.contains(object))) {
                _this.changeDetector.markForCheck();
            }
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('UPDATE_FILE_RESOURE', -1000, function (event) {
            _this.changeDetector.markForCheck();
        });
        this.movableOption = {
            tabletopObject: this.terrain,
            colideLayers: ['terrain']
        };
        this.rotableOption = {
            tabletopObject: this.terrain
        };
    };
    TerrainComponent.prototype.ngAfterViewInit = function () {
        this.input = new directive_input_handler__WEBPACK_IMPORTED_MODULE_8__["InputHandler"](this.elementRef.nativeElement);
        this.input.onStart = this.onInputStart.bind(this);
    };
    TerrainComponent.prototype.ngOnDestroy = function () {
        this.input.destroy();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    TerrainComponent.prototype.onDragstart = function (e) {
        e.stopPropagation();
        e.preventDefault();
    };
    TerrainComponent.prototype.onInputStart = function (e) {
        this.input.cancel();
        // TODO:もっと良い方法考える
        if (this.isLocked) {
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].trigger('DRAG_LOCKED_OBJECT', {});
        }
    };
    TerrainComponent.prototype.onContextMenu = function (e) {
        var _this = this;
        e.stopPropagation();
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        var menuPosition = this.pointerDeviceService.pointers[0];
        var objectPosition = this.tabletopService.calcTabletopLocalCoordinate();
        this.contextMenuService.open(menuPosition, [
            (this.isLocked
                ? {
                    name: '固定解除', action: function () {
                        _this.isLocked = false;
                        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].unlock);
                    }
                } : {
                name: '固定する', action: function () {
                    _this.isLocked = true;
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].lock);
                }
            }),
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuSeparator"],
            (this.hasWall
                ? {
                    name: '壁を非表示', action: function () {
                        _this.mode = _udonarium_terrain__WEBPACK_IMPORTED_MODULE_6__["TerrainViewState"].FLOOR;
                        if (_this.depth * _this.width === 0) {
                            _this.terrain.width = _this.width <= 0 ? 1 : _this.width;
                            _this.terrain.depth = _this.depth <= 0 ? 1 : _this.depth;
                        }
                    }
                } : {
                name: '壁を表示', action: function () {
                    _this.mode = _udonarium_terrain__WEBPACK_IMPORTED_MODULE_6__["TerrainViewState"].ALL;
                }
            }),
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuSeparator"],
            { name: '地形設定を編集', action: function () { _this.showDetail(_this.terrain); } },
            {
                name: 'コピーを作る', action: function () {
                    var cloneObject = _this.terrain.clone();
                    cloneObject.location.x += _this.gridSize;
                    cloneObject.location.y += _this.gridSize;
                    cloneObject.isLocked = false;
                    if (_this.terrain.parent)
                        _this.terrain.parent.appendChild(cloneObject);
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].blockPut);
                }
            },
            {
                name: '削除する', action: function () {
                    _this.terrain.destroy();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].sweep);
                }
            },
            service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuSeparator"],
            { name: 'オブジェクト作成', action: null, subActions: this.tabletopService.getContextMenuActionsForCreateObject(objectPosition) }
        ], this.name);
    };
    TerrainComponent.prototype.onMove = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].blockPick);
    };
    TerrainComponent.prototype.onMoved = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].blockPut);
    };
    TerrainComponent.prototype.adjustMinBounds = function (value, min) {
        if (min === void 0) { min = 0; }
        return value < min ? min : value;
    };
    TerrainComponent.prototype.showDetail = function (gameObject) {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: gameObject.identifier, className: gameObject.aliasName });
        var coordinate = this.pointerDeviceService.pointers[0];
        var title = '地形設定';
        if (gameObject.name.length)
            title += ' - ' + gameObject.name;
        var option = { title: title, left: coordinate.x - 250, top: coordinate.y - 150, width: 500, height: 300 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_7__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    TerrainComponent.ctorParameters = function () { return [
        { type: service_tabletop_service__WEBPACK_IMPORTED_MODULE_12__["TabletopService"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_9__["ContextMenuService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_10__["PanelService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_11__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], TerrainComponent.prototype, "terrain", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], TerrainComponent.prototype, "is3D", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('dragstart', ['$event'])
    ], TerrainComponent.prototype, "onDragstart", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('contextmenu', ['$event'])
    ], TerrainComponent.prototype, "onContextMenu", null);
    TerrainComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'terrain',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./terrain.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/terrain/terrain.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./terrain.component.css */ "./src/app/component/terrain/terrain.component.css")).default]
        })
    ], TerrainComponent);
    return TerrainComponent;
}());



/***/ }),

/***/ "./src/app/component/text-note/text-note.component.css":
/*!*************************************************************!*\
  !*** ./src/app/component/text-note/text-note.component.css ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".is-grab {\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n\n.is-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.is-3d {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n\n.is-transition {\n  -webkit-transition: -webkit-transform 132ms linear;\n  transition: -webkit-transform 132ms linear;\n  transition: transform 132ms linear;\n  transition: transform 132ms linear, -webkit-transform 132ms linear;\n}\n\n.is-pointer-events-none {\n  pointer-events: none;\n}\n\n.is-pointer-events-auto {\n  pointer-events: auto;\n}\n\n.component {\n  position: absolute;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n      user-select: none;\n  \n  -moz-user-drag: none;\n  -webkit-user-drag: none;\n\n  width: 0;\n  height:0;\n}\n\n.component-content {\n  height: 100%;\n  width: 100%;\n  -webkit-transform : translateX(-50%);\n          transform : translateX(-50%);\n}\n\n.upright-transform {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  -webkit-transform-origin: 50% 100%;\n          transform-origin: 50% 100%;\n  -webkit-transform: rotateX(-90deg);\n          transform: rotateX(-90deg);\n}\n\n.is-bg-texture {\n  background-repeat: no-repeat;\n  background-size: 100% 100%;\n}\n\n.is-bg-color {\n  box-sizing: border-box;\n  color: #444;\n  background-color: rgba(240,218,189, 0.9);\n  border: solid 1px #999;\n}\n\n.title {\n  box-sizing: border-box;\n  font-size: 15px;\n  padding: 3px 9px;\n  white-space: nowrap;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n}\n\n.is-black-background {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n\ntextarea {\n  width: 100%;\n  height: 100%;\n  resize: none;\n  overflow: hidden;\n  \n  box-sizing: border-box;\n  background: none;\n  border: none;\n  border-radius: 0px;\n  outline: none;\n\n  color: #444;\n  font-family: Cambria, Georgia;\n  font-size: 1.0rem;\n  padding: 2px;\n  margin: 0;\n  word-break: break-all;\n\n  -webkit-backface-visibility: hidden;\n\n          backface-visibility: hidden;\n}\n\ntextarea:focus {\n  background: rgba(255, 255, 255, 0.75);\n}\n\n.is-black-background {\n  color: #CCC;\n  background-color: rgba(30, 30, 30, 0.8);\n}\n\n.is-outline-text {\n  font-size: 24px;\n  color: #444;\n  text-shadow: \n  #f2f2f2 0px 0px 0.5px, \n  #f2f2f2 0px 0px 0.5px, \n  #f2f2f2 0px 0px 0.5px, \n  #f2f2f2 0px 0px 0.5px, \n  #f2f2f2 0px 0px 0.5px, \n  #f2f2f2 0px 0px 0.5px,\n  #f2f2f2 0px 0px 0.5px,\n  #f2f2f2 0px 0px 0.5px;\n}\n\n.rotate-grab {\n  position: absolute;\n  width: 42px;\n  height: 28px;\n  box-sizing: border-box;\n  cursor: -moz-default;\n  cursor: -webkit-default;\n  cursor: default;\n  z-index: 1;\n  text-align: center;\n  padding: 2px;\n  background-color: #CCCCCC;\n  border-radius: 28px;\n  color: #444;\n  font-size: 8px;\n}\n\n.of-left-top {\n  top: -14px;\n  left: -21px;\n}\n\n.of-right-top {\n  top: -14px;\n  right: -21px;\n}\n\n.rotate-grab {\n  opacity: 0;\n}\n\n.component:hover .rotate-grab {\n  opacity: 0.5;\n}\n\n.component:active .rotate-grab {\n  opacity: 0;\n}\n\n.component .rotate-grab:hover, .component .rotate-grab:active {\n  opacity: 1;\n}\n\n.material-icons {\n  display: none;\n}\n\n.component:hover .material-icons, .component:active .material-icons {\n  display: inline;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L3RleHQtbm90ZS90ZXh0LW5vdGUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVFLG9CQUFvQjtFQUNwQixZQUFZO0FBQ2Q7O0FBRUE7RUFFRSx3QkFBd0I7RUFDeEIsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0Usb0NBQW9DO0VBQ3BDLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLGtEQUFrRDtFQUNsRCwwQ0FBa0M7RUFBbEMsa0NBQWtDO0VBQWxDLGtFQUFrQztBQUNwQzs7QUFFQTtFQUNFLG9CQUFvQjtBQUN0Qjs7QUFFQTtFQUNFLG9CQUFvQjtBQUN0Qjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixtQ0FBMkI7VUFBM0IsMkJBQTJCO0VBQzNCLHNCQUFzQjtFQUN0Qix5QkFBeUI7RUFDekIscUJBQWlCO01BQWpCLGlCQUFpQjs7RUFFakIsb0JBQW9CO0VBQ3BCLHVCQUF1Qjs7RUFFdkIsUUFBUTtFQUNSLFFBQVE7QUFDVjs7QUFFQTtFQUNFLFlBQVk7RUFDWixXQUFXO0VBQ1gsb0NBQTRCO1VBQTVCLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsT0FBTztFQUNQLFFBQVE7RUFDUixrQ0FBMEI7VUFBMUIsMEJBQTBCO0VBQzFCLGtDQUEwQjtVQUExQiwwQkFBMEI7QUFDNUI7O0FBRUE7RUFDRSw0QkFBNEI7RUFDNUIsMEJBQTBCO0FBQzVCOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLFdBQVc7RUFDWCx3Q0FBd0M7RUFDeEMsc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLGVBQWU7RUFDZixnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLG1DQUEyQjtVQUEzQiwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsdUNBQXVDO0FBQ3pDOztBQUVBO0VBQ0UsV0FBVztFQUNYLFlBQVk7RUFDWixZQUFZO0VBQ1osZ0JBQWdCOztFQUVoQixzQkFBc0I7RUFDdEIsZ0JBQWdCO0VBQ2hCLFlBQVk7RUFDWixrQkFBa0I7RUFDbEIsYUFBYTs7RUFFYixXQUFXO0VBQ1gsNkJBQTZCO0VBQzdCLGlCQUFpQjtFQUNqQixZQUFZO0VBQ1osU0FBUztFQUNULHFCQUFxQjs7RUFFckIsbUNBQTJCOztVQUEzQiwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxxQ0FBcUM7QUFDdkM7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsdUNBQXVDO0FBQ3pDOztBQUVBO0VBQ0UsZUFBZTtFQUNmLFdBQVc7RUFDWDs7Ozs7Ozs7dUJBUXFCO0FBQ3ZCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLFdBQVc7RUFDWCxZQUFZO0VBQ1osc0JBQXNCO0VBQ3RCLG9CQUFvQjtFQUNwQix1QkFBdUI7RUFDdkIsZUFBZTtFQUNmLFVBQVU7RUFDVixrQkFBa0I7RUFDbEIsWUFBWTtFQUNaLHlCQUF5QjtFQUN6QixtQkFBbUI7RUFDbkIsV0FBVztFQUNYLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxVQUFVO0VBQ1YsV0FBVztBQUNiOztBQUVBO0VBQ0UsVUFBVTtFQUNWLFlBQVk7QUFDZDs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFFQTtFQUNFLFlBQVk7QUFDZDs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTtFQUNFLGVBQWU7QUFDakIiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvdGV4dC1ub3RlL3RleHQtbm90ZS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmlzLWdyYWIge1xuICBjdXJzb3I6IC1tb3otZ3JhYjtcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWI7XG4gIGN1cnNvcjogZ3JhYjtcbn1cblxuLmlzLWdyYWJiaW5nIHtcbiAgY3Vyc29yOiAtbW96LWdyYWJiaW5nO1xuICBjdXJzb3I6IC13ZWJraXQtZ3JhYmJpbmc7XG4gIGN1cnNvcjogZ3JhYmJpbmc7XG59XG5cbi5pcy0zZCB7XG4gIC13ZWJraXQtdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDtcbiAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDtcbn1cblxuLmlzLXRyYW5zaXRpb24ge1xuICAtd2Via2l0LXRyYW5zaXRpb246IC13ZWJraXQtdHJhbnNmb3JtIDEzMm1zIGxpbmVhcjtcbiAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDEzMm1zIGxpbmVhcjtcbn1cblxuLmlzLXBvaW50ZXItZXZlbnRzLW5vbmUge1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbn1cblxuLmlzLXBvaW50ZXItZXZlbnRzLWF1dG8ge1xuICBwb2ludGVyLWV2ZW50czogYXV0bztcbn1cblxuLmNvbXBvbmVudCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgYmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuO1xuICAtbW96LXVzZXItc2VsZWN0OiBub25lO1xuICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lO1xuICB1c2VyLXNlbGVjdDogbm9uZTtcbiAgXG4gIC1tb3otdXNlci1kcmFnOiBub25lO1xuICAtd2Via2l0LXVzZXItZHJhZzogbm9uZTtcblxuICB3aWR0aDogMDtcbiAgaGVpZ2h0OjA7XG59XG5cbi5jb21wb25lbnQtY29udGVudCB7XG4gIGhlaWdodDogMTAwJTtcbiAgd2lkdGg6IDEwMCU7XG4gIHRyYW5zZm9ybSA6IHRyYW5zbGF0ZVgoLTUwJSk7XG59XG5cbi51cHJpZ2h0LXRyYW5zZm9ybSB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgYm90dG9tOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgdHJhbnNmb3JtLW9yaWdpbjogNTAlIDEwMCU7XG4gIHRyYW5zZm9ybTogcm90YXRlWCgtOTBkZWcpO1xufVxuXG4uaXMtYmctdGV4dHVyZSB7XG4gIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XG4gIGJhY2tncm91bmQtc2l6ZTogMTAwJSAxMDAlO1xufVxuXG4uaXMtYmctY29sb3Ige1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBjb2xvcjogIzQ0NDtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNDAsMjE4LDE4OSwgMC45KTtcbiAgYm9yZGVyOiBzb2xpZCAxcHggIzk5OTtcbn1cblxuLnRpdGxlIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgZm9udC1zaXplOiAxNXB4O1xuICBwYWRkaW5nOiAzcHggOXB4O1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XG59XG5cbi5pcy1ibGFjay1iYWNrZ3JvdW5kIHtcbiAgY29sb3I6ICNDQ0M7XG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMzAsIDMwLCAzMCwgMC44KTtcbn1cblxudGV4dGFyZWEge1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuICByZXNpemU6IG5vbmU7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIFxuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBiYWNrZ3JvdW5kOiBub25lO1xuICBib3JkZXI6IG5vbmU7XG4gIGJvcmRlci1yYWRpdXM6IDBweDtcbiAgb3V0bGluZTogbm9uZTtcblxuICBjb2xvcjogIzQ0NDtcbiAgZm9udC1mYW1pbHk6IENhbWJyaWEsIEdlb3JnaWE7XG4gIGZvbnQtc2l6ZTogMS4wcmVtO1xuICBwYWRkaW5nOiAycHg7XG4gIG1hcmdpbjogMDtcbiAgd29yZC1icmVhazogYnJlYWstYWxsO1xuXG4gIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjtcbn1cblxudGV4dGFyZWE6Zm9jdXMge1xuICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNzUpO1xufVxuXG4uaXMtYmxhY2stYmFja2dyb3VuZCB7XG4gIGNvbG9yOiAjQ0NDO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDMwLCAzMCwgMzAsIDAuOCk7XG59XG5cbi5pcy1vdXRsaW5lLXRleHQge1xuICBmb250LXNpemU6IDI0cHg7XG4gIGNvbG9yOiAjNDQ0O1xuICB0ZXh0LXNoYWRvdzogXG4gICNmMmYyZjIgMHB4IDBweCAwLjVweCwgXG4gICNmMmYyZjIgMHB4IDBweCAwLjVweCwgXG4gICNmMmYyZjIgMHB4IDBweCAwLjVweCwgXG4gICNmMmYyZjIgMHB4IDBweCAwLjVweCwgXG4gICNmMmYyZjIgMHB4IDBweCAwLjVweCwgXG4gICNmMmYyZjIgMHB4IDBweCAwLjVweCxcbiAgI2YyZjJmMiAwcHggMHB4IDAuNXB4LFxuICAjZjJmMmYyIDBweCAwcHggMC41cHg7XG59XG5cbi5yb3RhdGUtZ3JhYiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDQycHg7XG4gIGhlaWdodDogMjhweDtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgY3Vyc29yOiAtbW96LWRlZmF1bHQ7XG4gIGN1cnNvcjogLXdlYmtpdC1kZWZhdWx0O1xuICBjdXJzb3I6IGRlZmF1bHQ7XG4gIHotaW5kZXg6IDE7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgcGFkZGluZzogMnB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjQ0NDQ0NDO1xuICBib3JkZXItcmFkaXVzOiAyOHB4O1xuICBjb2xvcjogIzQ0NDtcbiAgZm9udC1zaXplOiA4cHg7XG59XG5cbi5vZi1sZWZ0LXRvcCB7XG4gIHRvcDogLTE0cHg7XG4gIGxlZnQ6IC0yMXB4O1xufVxuXG4ub2YtcmlnaHQtdG9wIHtcbiAgdG9wOiAtMTRweDtcbiAgcmlnaHQ6IC0yMXB4O1xufVxuXG4ucm90YXRlLWdyYWIge1xuICBvcGFjaXR5OiAwO1xufVxuXG4uY29tcG9uZW50OmhvdmVyIC5yb3RhdGUtZ3JhYiB7XG4gIG9wYWNpdHk6IDAuNTtcbn1cblxuLmNvbXBvbmVudDphY3RpdmUgLnJvdGF0ZS1ncmFiIHtcbiAgb3BhY2l0eTogMDtcbn1cblxuLmNvbXBvbmVudCAucm90YXRlLWdyYWI6aG92ZXIsIC5jb21wb25lbnQgLnJvdGF0ZS1ncmFiOmFjdGl2ZSB7XG4gIG9wYWNpdHk6IDE7XG59XG5cbi5tYXRlcmlhbC1pY29ucyB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG5cbi5jb21wb25lbnQ6aG92ZXIgLm1hdGVyaWFsLWljb25zLCAuY29tcG9uZW50OmFjdGl2ZSAubWF0ZXJpYWwtaWNvbnMge1xuICBkaXNwbGF5OiBpbmxpbmU7XG59Il19 */");

/***/ }),

/***/ "./src/app/component/text-note/text-note.component.ts":
/*!************************************************************!*\
  !*** ./src/app/component/text-note/text-note.component.ts ***!
  \************************************************************/
/*! exports provided: TextNoteComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextNoteComponent", function() { return TextNoteComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-node */ "./src/app/class/core/synchronize-object/object-node.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! component/game-character-sheet/game-character-sheet.component */ "./src/app/component/game-character-sheet/game-character-sheet.component.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");










var TextNoteComponent = /** @class */ (function () {
    function TextNoteComponent(ngZone, contextMenuService, panelService, changeDetector, pointerDeviceService) {
        var _this = this;
        this.ngZone = ngZone;
        this.contextMenuService = contextMenuService;
        this.panelService = panelService;
        this.changeDetector = changeDetector;
        this.pointerDeviceService = pointerDeviceService;
        this.textNote = null;
        this.is3D = false;
        this.callbackOnMouseUp = function (e) { return _this.onMouseUp(e); };
        this.gridSize = 50;
        this.calcFitHeightTimer = null;
        this.movableOption = {};
        this.rotableOption = {};
    }
    Object.defineProperty(TextNoteComponent.prototype, "title", {
        get: function () { return this.textNote.title; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNoteComponent.prototype, "text", {
        get: function () { this.calcFitHeightIfNeeded(); return this.textNote.text; },
        set: function (text) { this.calcFitHeightIfNeeded(); this.textNote.text = text; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNoteComponent.prototype, "fontSize", {
        get: function () { this.calcFitHeightIfNeeded(); return this.textNote.fontSize; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNoteComponent.prototype, "imageFile", {
        get: function () { return this.textNote.imageFile; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNoteComponent.prototype, "rotate", {
        get: function () { return this.textNote.rotate; },
        set: function (rotate) { this.textNote.rotate = rotate; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNoteComponent.prototype, "height", {
        get: function () { return this.adjustMinBounds(this.textNote.height); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNoteComponent.prototype, "width", {
        get: function () { return this.adjustMinBounds(this.textNote.width); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextNoteComponent.prototype, "isSelected", {
        get: function () { return document.activeElement === this.textAreaElementRef.nativeElement; },
        enumerable: true,
        configurable: true
    });
    TextNoteComponent.prototype.ngOnInit = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(event.data.identifier);
            if (!_this.textNote || !object)
                return;
            if (_this.textNote === object || (object instanceof _udonarium_core_synchronize_object_object_node__WEBPACK_IMPORTED_MODULE_2__["ObjectNode"] && _this.textNote.contains(object))) {
                _this.changeDetector.markForCheck();
            }
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            _this.changeDetector.markForCheck();
        })
            .on('UPDATE_FILE_RESOURE', -1000, function (event) {
            _this.changeDetector.markForCheck();
        });
        this.movableOption = {
            tabletopObject: this.textNote,
            transformCssOffset: 'translateZ(0.15px)',
            colideLayers: ['terrain']
        };
        this.rotableOption = {
            tabletopObject: this.textNote
        };
    };
    TextNoteComponent.prototype.ngAfterViewInit = function () { };
    TextNoteComponent.prototype.ngOnDestroy = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].unregister(this);
    };
    TextNoteComponent.prototype.onDragstart = function (e) {
        e.stopPropagation();
        e.preventDefault();
    };
    TextNoteComponent.prototype.onMouseDown = function (e) {
        if (this.isSelected)
            return;
        e.preventDefault();
        this.textNote.toTopmost();
        // TODO:もっと良い方法考える
        if (e.button === 2) {
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].trigger('DRAG_LOCKED_OBJECT', {});
            return;
        }
        this.addMouseEventListeners();
    };
    TextNoteComponent.prototype.onMouseUp = function (e) {
        if (this.pointerDeviceService.isAllowedToOpenContextMenu) {
            var selection = window.getSelection();
            if (!selection.isCollapsed)
                selection.removeAllRanges();
            this.textAreaElementRef.nativeElement.focus();
        }
        this.removeMouseEventListeners();
        e.preventDefault();
    };
    TextNoteComponent.prototype.onRotateMouseDown = function (e) {
        e.stopPropagation();
        e.preventDefault();
    };
    TextNoteComponent.prototype.onContextMenu = function (e) {
        var _this = this;
        this.removeMouseEventListeners();
        if (this.isSelected)
            return;
        e.stopPropagation();
        e.preventDefault();
        if (!this.pointerDeviceService.isAllowedToOpenContextMenu)
            return;
        var position = this.pointerDeviceService.pointers[0];
        this.contextMenuService.open(position, [
            { name: 'メモを編集', action: function () { _this.showDetail(_this.textNote); } },
            {
                name: 'コピーを作る', action: function () {
                    var cloneObject = _this.textNote.clone();
                    console.log('コピー', cloneObject);
                    cloneObject.location.x += _this.gridSize;
                    cloneObject.location.y += _this.gridSize;
                    cloneObject.toTopmost();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].cardPut);
                }
            },
            {
                name: '削除する', action: function () {
                    _this.textNote.destroy();
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].sweep);
                }
            },
        ], this.title);
    };
    TextNoteComponent.prototype.onMove = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].cardPick);
    };
    TextNoteComponent.prototype.onMoved = function () {
        _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_5__["PresetSound"].cardPut);
    };
    TextNoteComponent.prototype.calcFitHeightIfNeeded = function () {
        var _this = this;
        if (this.calcFitHeightTimer)
            return;
        this.ngZone.runOutsideAngular(function () {
            _this.calcFitHeightTimer = setTimeout(function () {
                _this.calcFitHeight();
                _this.calcFitHeightTimer = null;
            }, 0);
        });
    };
    TextNoteComponent.prototype.calcFitHeight = function () {
        var textArea = this.textAreaElementRef.nativeElement;
        textArea.style.height = '0';
        if (textArea.scrollHeight > textArea.offsetHeight) {
            textArea.style.height = textArea.scrollHeight + 'px';
        }
    };
    TextNoteComponent.prototype.adjustMinBounds = function (value, min) {
        if (min === void 0) { min = 0; }
        return value < min ? min : value;
    };
    TextNoteComponent.prototype.addMouseEventListeners = function () {
        document.body.addEventListener('mouseup', this.callbackOnMouseUp, false);
    };
    TextNoteComponent.prototype.removeMouseEventListeners = function () {
        document.body.removeEventListener('mouseup', this.callbackOnMouseUp, false);
    };
    TextNoteComponent.prototype.showDetail = function (gameObject) {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: gameObject.identifier, className: gameObject.aliasName });
        var coordinate = this.pointerDeviceService.pointers[0];
        var title = '共有メモ設定';
        if (gameObject.title.length)
            title += ' - ' + gameObject.title;
        var option = { title: title, left: coordinate.x - 350, top: coordinate.y - 200, width: 700, height: 400 };
        var component = this.panelService.open(component_game_character_sheet_game_character_sheet_component__WEBPACK_IMPORTED_MODULE_6__["GameCharacterSheetComponent"], option);
        component.tabletopObject = gameObject;
    };
    TextNoteComponent.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: service_context_menu_service__WEBPACK_IMPORTED_MODULE_7__["ContextMenuService"] },
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_8__["PanelService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_9__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('textArea', { static: true })
    ], TextNoteComponent.prototype, "textAreaElementRef", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], TextNoteComponent.prototype, "textNote", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], TextNoteComponent.prototype, "is3D", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('dragstart', ['$event'])
    ], TextNoteComponent.prototype, "onDragstart", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('mousedown', ['$event'])
    ], TextNoteComponent.prototype, "onMouseDown", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["HostListener"])('contextmenu', ['$event'])
    ], TextNoteComponent.prototype, "onContextMenu", null);
    TextNoteComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'text-note',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./text-note.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/text-note/text-note.component.html")).default,
            changeDetection: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectionStrategy"].OnPush,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./text-note.component.css */ "./src/app/component/text-note/text-note.component.css")).default]
        })
    ], TextNoteComponent);
    return TextNoteComponent;
}());



/***/ }),

/***/ "./src/app/component/text-view/text-view.component.css":
/*!*************************************************************!*\
  !*** ./src/app/component/text-view/text-view.component.css ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".text {\n  font-family: -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", Verdana, Meiryo, sans-serif;\n  font-size: 12px;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L3RleHQtdmlldy90ZXh0LXZpZXcuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLDZGQUE2RjtFQUM3RixlQUFlO0FBQ2pCIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L3RleHQtdmlldy90ZXh0LXZpZXcuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi50ZXh0IHtcbiAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgXCJIZWx2ZXRpY2EgTmV1ZVwiLCBWZXJkYW5hLCBNZWlyeW8sIHNhbnMtc2VyaWY7XG4gIGZvbnQtc2l6ZTogMTJweDtcbn0iXX0= */");

/***/ }),

/***/ "./src/app/component/text-view/text-view.component.ts":
/*!************************************************************!*\
  !*** ./src/app/component/text-view/text-view.component.ts ***!
  \************************************************************/
/*! exports provided: TextViewComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextViewComponent", function() { return TextViewComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var service_modal_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! service/modal.service */ "./src/app/service/modal.service.ts");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");




var TextViewComponent = /** @class */ (function () {
    function TextViewComponent(panelService, modalService) {
        this.panelService = panelService;
        this.modalService = modalService;
        this.text = '';
        this.title = '';
    }
    TextViewComponent.prototype.ngOnInit = function () {
        this.panelService.title = this.title;
        if (this.modalService.option && this.modalService.option.title != null) {
            this.modalService.title = this.modalService.option.title ? this.modalService.option.title : '';
            this.text = this.modalService.option.text ? this.modalService.option.text : '';
        }
    };
    TextViewComponent.ctorParameters = function () { return [
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_3__["PanelService"] },
        { type: service_modal_service__WEBPACK_IMPORTED_MODULE_2__["ModalService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], TextViewComponent.prototype, "text", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
    ], TextViewComponent.prototype, "title", void 0);
    TextViewComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'text-view',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./text-view.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/text-view/text-view.component.html")).default,
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./text-view.component.css */ "./src/app/component/text-view/text-view.component.css")).default]
        })
    ], TextViewComponent);
    return TextViewComponent;
}());



/***/ }),

/***/ "./src/app/component/ui-panel/ui-panel.component.css":
/*!***********************************************************!*\
  !*** ./src/app/component/ui-panel/ui-panel.component.css ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".draggable-panel {\n  box-sizing: border-box;\n  overflow: visible;\n  position: absolute;\n\n  color: #444;\n  background: linear-gradient(-30deg, rgba(240,218,189, 0.9), rgba(255, 244, 232, 0.9));\n  border: solid 1px #999;\n\n  padding: 0px;\n  top: 200px;\n\n  height: 200px;\n  width: 300px;\n  max-height: 100%;\n  max-width: 100%;\n}\n\n.scrollable-panel {\n  box-sizing: border-box;\n  overflow: auto;\n  position: absolute;\n  top: 25px;\n  bottom: 0;\n  width: 100%;\n  padding: 8px;\n  -ms-scroll-chaining: none;\n      overscroll-behavior: contain;\n  -webkit-overflow-scrolling: touch;\n}\n\n.title {\n  overflow: hidden;\n  white-space: nowrap;\n  box-sizing: border-box;\n  font-size: 12px;\n  height: 25px;\n  padding: 2px 5px;\n  width: 100%;\n  background-color: #555;\n  color: #CCC;\n}\n\n.title-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.title button {\n  background: none;\n  border: none;\n  border-radius: 0;\n  outline: none;\n  color: #CCC;\n}\n\n.pointer-events-none {\n  pointer-events: none;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L3VpLXBhbmVsL3VpLXBhbmVsLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxzQkFBc0I7RUFDdEIsaUJBQWlCO0VBQ2pCLGtCQUFrQjs7RUFFbEIsV0FBVztFQUNYLHFGQUFxRjtFQUNyRixzQkFBc0I7O0VBRXRCLFlBQVk7RUFDWixVQUFVOztFQUVWLGFBQWE7RUFDYixZQUFZO0VBQ1osZ0JBQWdCO0VBQ2hCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsY0FBYztFQUNkLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsU0FBUztFQUNULFdBQVc7RUFDWCxZQUFZO0VBQ1oseUJBQTRCO01BQTVCLDRCQUE0QjtFQUM1QixpQ0FBaUM7QUFDbkM7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLHNCQUFzQjtFQUN0QixlQUFlO0VBQ2YsWUFBWTtFQUNaLGdCQUFnQjtFQUNoQixXQUFXO0VBQ1gsc0JBQXNCO0VBQ3RCLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixRQUFRO0VBQ1IsTUFBTTtBQUNSOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsYUFBYTtFQUNiLFdBQVc7QUFDYjs7QUFFQTtFQUNFLG9CQUFvQjtBQUN0QiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC91aS1wYW5lbC91aS1wYW5lbC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmRyYWdnYWJsZS1wYW5lbCB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIG92ZXJmbG93OiB2aXNpYmxlO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgY29sb3I6ICM0NDQ7XG4gIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgtMzBkZWcsIHJnYmEoMjQwLDIxOCwxODksIDAuOSksIHJnYmEoMjU1LCAyNDQsIDIzMiwgMC45KSk7XG4gIGJvcmRlcjogc29saWQgMXB4ICM5OTk7XG5cbiAgcGFkZGluZzogMHB4O1xuICB0b3A6IDIwMHB4O1xuXG4gIGhlaWdodDogMjAwcHg7XG4gIHdpZHRoOiAzMDBweDtcbiAgbWF4LWhlaWdodDogMTAwJTtcbiAgbWF4LXdpZHRoOiAxMDAlO1xufVxuXG4uc2Nyb2xsYWJsZS1wYW5lbCB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIG92ZXJmbG93OiBhdXRvO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMjVweDtcbiAgYm90dG9tOiAwO1xuICB3aWR0aDogMTAwJTtcbiAgcGFkZGluZzogOHB4O1xuICBvdmVyc2Nyb2xsLWJlaGF2aW9yOiBjb250YWluO1xuICAtd2Via2l0LW92ZXJmbG93LXNjcm9sbGluZzogdG91Y2g7XG59XG5cbi50aXRsZSB7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIGZvbnQtc2l6ZTogMTJweDtcbiAgaGVpZ2h0OiAyNXB4O1xuICBwYWRkaW5nOiAycHggNXB4O1xuICB3aWR0aDogMTAwJTtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzU1NTtcbiAgY29sb3I6ICNDQ0M7XG59XG5cbi50aXRsZS1idXR0b24ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHJpZ2h0OiAwO1xuICB0b3A6IDA7XG59XG5cbi50aXRsZSBidXR0b24ge1xuICBiYWNrZ3JvdW5kOiBub25lO1xuICBib3JkZXI6IG5vbmU7XG4gIGJvcmRlci1yYWRpdXM6IDA7XG4gIG91dGxpbmU6IG5vbmU7XG4gIGNvbG9yOiAjQ0NDO1xufVxuXG4ucG9pbnRlci1ldmVudHMtbm9uZSB7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xufSJdfQ== */");

/***/ }),

/***/ "./src/app/component/ui-panel/ui-panel.component.ts":
/*!**********************************************************!*\
  !*** ./src/app/component/ui-panel/ui-panel.component.ts ***!
  \**********************************************************/
/*! exports provided: UIPanelComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UIPanelComponent", function() { return UIPanelComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/animations */ "./node_modules/@angular/animations/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var service_panel_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! service/panel.service */ "./src/app/service/panel.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");





var UIPanelComponent = /** @class */ (function () {
    function UIPanelComponent(panelService, pointerDeviceService) {
        this.panelService = panelService;
        this.pointerDeviceService = pointerDeviceService;
        this.preLeft = 0;
        this.preTop = 0;
        this.preWidth = 100;
        this.preHeight = 100;
        this.isFullScreen = false;
    }
    Object.defineProperty(UIPanelComponent.prototype, "title", {
        get: function () { return this.panelService.title; },
        set: function (title) { this.panelService.title = title; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UIPanelComponent.prototype, "left", {
        get: function () { return this.panelService.left; },
        set: function (left) { this.panelService.left = left; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UIPanelComponent.prototype, "top", {
        get: function () { return this.panelService.top; },
        set: function (top) { this.panelService.top = top; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UIPanelComponent.prototype, "width", {
        get: function () { return this.panelService.width; },
        set: function (width) { this.panelService.width = width; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UIPanelComponent.prototype, "height", {
        get: function () { return this.panelService.height; },
        set: function (height) { this.panelService.height = height; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UIPanelComponent.prototype, "isPointerDragging", {
        get: function () { return this.pointerDeviceService.isDragging; },
        enumerable: true,
        configurable: true
    });
    UIPanelComponent.prototype.ngOnInit = function () {
        this.panelService.scrollablePanel = this.scrollablePanel.nativeElement;
    };
    UIPanelComponent.prototype.toggleFullScreen = function () {
        var panel = this.draggablePanel.nativeElement;
        if (panel.offsetLeft <= 0
            && panel.offsetTop <= 0
            && panel.offsetWidth >= window.innerWidth
            && panel.offsetHeight >= window.innerHeight) {
            this.isFullScreen = false;
        }
        else {
            this.isFullScreen = true;
        }
        if (this.isFullScreen) {
            this.preLeft = panel.offsetLeft;
            this.preTop = panel.offsetTop;
            this.preWidth = panel.offsetWidth;
            this.preHeight = panel.offsetHeight;
            this.left = 0;
            this.top = 0;
            this.width = window.innerWidth;
            this.height = window.innerHeight;
            panel.style.left = this.left + 'px';
            panel.style.top = this.top + 'px';
            panel.style.width = this.width + 'px';
            panel.style.height = this.height + 'px';
        }
        else {
            this.left = this.preLeft;
            this.top = this.preTop;
            this.width = this.preWidth;
            this.height = this.preHeight;
        }
    };
    UIPanelComponent.prototype.close = function () {
        if (this.panelService)
            this.panelService.close();
    };
    UIPanelComponent.ctorParameters = function () { return [
        { type: service_panel_service__WEBPACK_IMPORTED_MODULE_3__["PanelService"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_4__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ViewChild"])('draggablePanel', { static: true })
    ], UIPanelComponent.prototype, "draggablePanel", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ViewChild"])('scrollablePanel', { static: true })
    ], UIPanelComponent.prototype, "scrollablePanel", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ViewChild"])('content', { read: _angular_core__WEBPACK_IMPORTED_MODULE_2__["ViewContainerRef"], static: true })
    ], UIPanelComponent.prototype, "content", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], UIPanelComponent.prototype, "title", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], UIPanelComponent.prototype, "left", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], UIPanelComponent.prototype, "top", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], UIPanelComponent.prototype, "width", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
    ], UIPanelComponent.prototype, "height", null);
    UIPanelComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
            selector: 'ui-panel',
            template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./ui-panel.component.html */ "./node_modules/raw-loader/dist/cjs.js!./src/app/component/ui-panel/ui-panel.component.html")).default,
            providers: [
                service_panel_service__WEBPACK_IMPORTED_MODULE_3__["PanelService"],
            ],
            animations: [
                Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["trigger"])('flyInOut', [
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('void => *', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])('100ms ease-out', Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["keyframes"])([
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale(0.8, 0.8)', opacity: '0', offset: 0 }),
                            Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale(1.0, 1.0)', opacity: '1', offset: 1.0 })
                        ]))
                    ]),
                    Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["transition"])('* => void', [
                        Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["animate"])(100, Object(_angular_animations__WEBPACK_IMPORTED_MODULE_1__["style"])({ transform: 'scale(0, 0)' }))
                    ])
                ])
            ],
            styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./ui-panel.component.css */ "./src/app/component/ui-panel/ui-panel.component.css")).default]
        })
    ], UIPanelComponent);
    return UIPanelComponent;
}());

service_panel_service__WEBPACK_IMPORTED_MODULE_3__["PanelService"].UIPanelComponentClass = UIPanelComponent;


/***/ }),

/***/ "./src/app/directive/draggable.directive.ts":
/*!**************************************************!*\
  !*** ./src/app/directive/draggable.directive.ts ***!
  \**************************************************/
/*! exports provided: DraggableDirective */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DraggableDirective", function() { return DraggableDirective; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_transform_css_number__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/transform/css-number */ "./src/app/class/transform/css-number.ts");
/* harmony import */ var _input_handler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./input-handler */ "./src/app/directive/input-handler.ts");




var DraggableDirective = /** @class */ (function () {
    function DraggableDirective(ngZone, elementRef) {
        this.ngZone = ngZone;
        this.elementRef = elementRef;
        this.isDisable = false;
        this.boundsSelector = 'body';
        this.handleSelector = '';
        this.unhandleSelector = 'input,textarea,button,select,option,span';
        this.stackSelector = '';
        this.opacity = 0.7;
        this.onstart = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.onmove = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.onend = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.callbackOnResize = this.adjustPosition.bind(this);
        this.input = null;
        this.startPosition = { x: 0, y: 0, z: 0 };
        this.startPointer = { x: 0, y: 0, z: 0 };
        this.prevTrans = { x: 0, y: 0, z: 0 };
    }
    DraggableDirective.prototype.ngAfterViewInit = function () {
        this.initialize();
        this.adjustPosition();
        this.setForeground();
    };
    DraggableDirective.prototype.ngOnDestroy = function () {
        this.cancel();
        this.destroy();
    };
    DraggableDirective.prototype.initialize = function () {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            _this.input = new _input_handler__WEBPACK_IMPORTED_MODULE_3__["InputHandler"](_this.elementRef.nativeElement);
            window.addEventListener('resize', _this.callbackOnResize, false);
        });
        this.input.onStart = this.onInputStart.bind(this);
        this.input.onMove = this.onInputMove.bind(this);
        this.input.onEnd = this.onInputEnd.bind(this);
        this.input.onContextMenu = this.onContextMenu.bind(this);
    };
    DraggableDirective.prototype.cancel = function () {
        this.input.cancel();
    };
    DraggableDirective.prototype.destroy = function () {
        window.removeEventListener('resize', this.callbackOnResize, false);
        this.input.destroy();
    };
    DraggableDirective.prototype.onInputStart = function (e) {
        if (e.button === 1 || e.button === 2)
            return this.cancel();
        this.setForeground();
        this.startPosition = this.calcElementPosition(this.elementRef.nativeElement);
        this.startPointer = this.input.pointer;
        this.prevTrans = { x: 0, y: 0, z: 0 };
        var isHandle = this.isHandleElement(e.target);
        var isUnhandle = this.isUnhandleElement(e.target);
        var isScrollable = e.touches != null ? this.isScrollableElement(e.target) : false;
        if (!isHandle || isUnhandle || isScrollable) {
            this.cancel();
            return;
        }
        if (e.touches == null && e.cancelable)
            e.preventDefault();
        e.stopPropagation();
    };
    DraggableDirective.prototype.onInputMove = function (e) {
        var trans = {
            x: this.input.pointer.x - this.startPointer.x,
            y: this.input.pointer.y - this.startPointer.y,
            z: this.input.pointer.z - this.startPointer.z
        };
        var diff = {
            x: trans.x - this.prevTrans.x,
            y: trans.y - this.prevTrans.y,
            z: trans.z - this.prevTrans.z
        };
        var correction = this.calcCorrectionPosition(diff);
        trans.x += correction.x;
        trans.y += correction.y;
        trans.z += correction.z;
        if (0 < Math.pow(trans.x, 2) + Math.pow(trans.y, 2) + Math.pow(trans.z, 2)) {
            this.elementRef.nativeElement.style.opacity = this.opacity + '';
        }
        this.elementRef.nativeElement.style.left = trans.x + this.startPosition.x + 'px';
        this.elementRef.nativeElement.style.top = trans.y + this.startPosition.y + 'px';
        this.prevTrans = trans;
        if (e.cancelable)
            e.preventDefault();
        e.stopPropagation();
    };
    DraggableDirective.prototype.onInputEnd = function (e) {
        this.elementRef.nativeElement.style.opacity = null;
        if (this.input.isDragging && e.cancelable)
            e.preventDefault();
        e.stopPropagation();
    };
    DraggableDirective.prototype.onContextMenu = function (e) {
        e.stopPropagation();
    };
    DraggableDirective.prototype.adjustPosition = function () {
        var current = this.calcElementPosition(this.elementRef.nativeElement);
        var correction = this.calcCorrectionPosition();
        this.elementRef.nativeElement.style.left = correction.x + current.x + 'px';
        this.elementRef.nativeElement.style.top = correction.y + current.y + 'px';
    };
    DraggableDirective.prototype.isHandleElement = function (target) {
        if (this.handleSelector.length < 1)
            return true;
        return this.isContainsElement(target, this.unhandleSelector);
    };
    DraggableDirective.prototype.isUnhandleElement = function (target) {
        if (this.unhandleSelector.length < 1)
            return false;
        return this.isContainsElement(target, this.unhandleSelector);
    };
    DraggableDirective.prototype.isContainsElement = function (target, selectors) {
        var elms = this.elementRef.nativeElement.querySelectorAll(selectors);
        for (var i = 0; i < elms.length; i++) {
            if (elms[i].contains(target))
                return true;
        }
        return false;
    };
    DraggableDirective.prototype.isScrollableElement = function (target) {
        var boundsElm = this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector);
        var node = target;
        var overflowType = ['scroll', 'auto'];
        var positionType = ['fixed', 'sticky', '-webkit-sticky'];
        while (node && boundsElm !== node && this.elementRef.nativeElement !== node) {
            var css = window.getComputedStyle(node);
            if (0 <= overflowType.indexOf(css.overflowY) && node.offsetHeight < node.scrollHeight)
                return true;
            if (0 <= positionType.indexOf(css.position))
                return false;
            node = node.parentElement;
        }
        return false;
    };
    DraggableDirective.prototype.calcCorrectionPosition = function (diff) {
        if (diff === void 0) { diff = { x: 0, y: 0, z: 0 }; }
        var correction = { x: 0, y: 0, z: 0 };
        var box = this.elementRef.nativeElement.getBoundingClientRect();
        var bounds = this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();
        if (bounds.right < box.right + diff.x) {
            correction.x += bounds.right - (box.right + diff.x);
        }
        if (box.left + diff.x < bounds.left) {
            correction.x += bounds.left - (box.left + diff.x);
        }
        if (bounds.bottom < box.bottom + diff.y) {
            correction.y += bounds.bottom - (box.bottom + diff.y);
        }
        if (box.top + diff.y < bounds.top) {
            correction.y += bounds.top - (box.top + diff.y);
        }
        return correction;
    };
    DraggableDirective.prototype.calcElementPosition = function (target) {
        var css = window.getComputedStyle(target);
        return {
            x: _udonarium_transform_css_number__WEBPACK_IMPORTED_MODULE_2__["CSSNumber"].relation(css.left, target.parentElement.offsetWidth, target.parentElement.offsetWidth * 0.5),
            y: _udonarium_transform_css_number__WEBPACK_IMPORTED_MODULE_2__["CSSNumber"].relation(css.top, target.parentElement.offsetHeight, target.parentElement.offsetHeight * 0.5),
            z: 0
        };
    };
    DraggableDirective.prototype.setForeground = function () {
        if (this.stackSelector.length < 1)
            return;
        var stacks = this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector);
        var topZindex = 0;
        var bottomZindex = 99999;
        stacks.forEach(function (elm) {
            var zIndex = parseInt(elm.style.zIndex);
            if (topZindex < zIndex)
                topZindex = zIndex;
            if (zIndex < bottomZindex)
                bottomZindex = zIndex;
        });
        if (topZindex <= parseInt(this.elementRef.nativeElement.style.zIndex))
            return;
        stacks.forEach(function (elm) {
            elm.style.zIndex = (parseInt(elm.style.zIndex) - bottomZindex) + '';
        });
        this.elementRef.nativeElement.style.zIndex = (topZindex + 1) + '';
    };
    DraggableDirective.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('draggable.disable')
    ], DraggableDirective.prototype, "isDisable", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('draggable.bounds')
    ], DraggableDirective.prototype, "boundsSelector", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('draggable.handle')
    ], DraggableDirective.prototype, "handleSelector", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('draggable.unhandle')
    ], DraggableDirective.prototype, "unhandleSelector", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('draggable.stack')
    ], DraggableDirective.prototype, "stackSelector", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('draggable.opacity')
    ], DraggableDirective.prototype, "opacity", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('draggable.start')
    ], DraggableDirective.prototype, "onstart", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('draggable.move')
    ], DraggableDirective.prototype, "onmove", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('draggable.end')
    ], DraggableDirective.prototype, "onend", void 0);
    DraggableDirective = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Directive"])({
            selector: '[appDraggable]'
        })
    ], DraggableDirective);
    return DraggableDirective;
}());



/***/ }),

/***/ "./src/app/directive/input-handler.ts":
/*!********************************************!*\
  !*** ./src/app/directive/input-handler.ts ***!
  \********************************************/
/*! exports provided: InputHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputHandler", function() { return InputHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var MOUSE_IDENTIFIER = -9999;
var InputHandler = /** @class */ (function () {
    function InputHandler(target, option) {
        if (option === void 0) { option = { capture: false, passive: false, always: false }; }
        this.target = target;
        this.callbackOnMouse = this.onMouse.bind(this);
        this.callbackOnTouch = this.onTouch.bind(this);
        this.callbackOnMenu = this.onMenu.bind(this);
        this.lastPointers = [];
        this.primaryPointer = { x: 0, y: 0, z: 0, identifier: MOUSE_IDENTIFIER };
        this._isDragging = false;
        this._isGrabbing = false;
        this._isDestroyed = false;
        this.option = null;
        this.option = {
            capture: option.capture === true,
            passive: option.passive === true,
            always: option.always === true
        };
        this.initialize();
    }
    Object.defineProperty(InputHandler.prototype, "pointer", {
        get: function () { return this.primaryPointer; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InputHandler.prototype, "isDragging", {
        get: function () { return this._isDragging; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InputHandler.prototype, "isGrabbing", {
        get: function () { return this._isGrabbing; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InputHandler.prototype, "isDestroyed", {
        get: function () { return this._isDestroyed; },
        enumerable: true,
        configurable: true
    });
    InputHandler.prototype.initialize = function () {
        this.target.addEventListener('mousedown', this.callbackOnMouse, this.option.capture);
        this.target.addEventListener('touchstart', this.callbackOnTouch, this.option.capture);
        if (this.option.always)
            this.addEventListeners();
    };
    InputHandler.prototype.destroy = function () {
        this.cancel();
        this._isDestroyed = true;
        this.target.removeEventListener('mousedown', this.callbackOnMouse, this.option.capture);
        this.target.removeEventListener('touchstart', this.callbackOnTouch, this.option.capture);
        this.removeEventListeners();
    };
    InputHandler.prototype.cancel = function () {
        this._isDragging = this._isGrabbing = false;
        if (!this.option.always)
            this.removeEventListeners();
    };
    InputHandler.prototype.onMouse = function (e) {
        var mosuePointer = { x: e.pageX, y: e.pageY, z: 0, identifier: MOUSE_IDENTIFIER };
        if (this.isSyntheticEvent(mosuePointer))
            return;
        this.lastPointers = [mosuePointer];
        this.primaryPointer = mosuePointer;
        this.onPointer(e);
    };
    InputHandler.prototype.onTouch = function (e) {
        var _this = this;
        var length = e.changedTouches.length;
        if (length < 1)
            return;
        this.lastPointers = [];
        for (var i = 0; i < length; i++) {
            var touch = e.changedTouches[i];
            var touchPointer = { x: touch.pageX, y: touch.pageY, z: 0, identifier: touch.identifier };
            this.lastPointers.push(touchPointer);
        }
        if (e.type === 'touchstart') {
            this.primaryPointer = this.lastPointers[0];
        }
        else {
            var changedTouches = Array.from(e.changedTouches);
            var touch = changedTouches.find(function (touch) { return touch.identifier === _this.primaryPointer.identifier; });
            if (touch == null)
                return;
            var touchPointer = { x: touch.pageX, y: touch.pageY, z: 0, identifier: touch.identifier };
            this.primaryPointer = touchPointer;
        }
        this.onPointer(e);
    };
    InputHandler.prototype.onPointer = function (e) {
        switch (e.type) {
            case 'mousedown':
            case 'touchstart':
                this._isGrabbing = true;
                this._isDragging = false;
                this.addEventListeners();
                if (this.onStart)
                    this.onStart(e);
                break;
            case 'mousemove':
            case 'touchmove':
                if (this.onMove)
                    this.onMove(e);
                this._isDragging = this._isGrabbing;
                break;
            default:
                if (this.onEnd)
                    this.onEnd(e);
                this.cancel();
                break;
        }
    };
    InputHandler.prototype.onMenu = function (e) {
        if (this.onContextMenu)
            this.onContextMenu(e);
    };
    InputHandler.prototype.isSyntheticEvent = function (mosuePointer, threshold) {
        var e_1, _a;
        if (threshold === void 0) { threshold = 15; }
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.lastPointers), _c = _b.next(); !_c.done; _c = _b.next()) {
                var pointer = _c.value;
                if (pointer.identifier === mosuePointer.identifier)
                    continue;
                var distance = Math.pow((mosuePointer.x - pointer.x), 2) + Math.pow((mosuePointer.y - pointer.y), 2);
                if (distance < Math.pow(threshold, 2)) {
                    return true;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return false;
    };
    InputHandler.prototype.addEventListeners = function () {
        var option = {
            capture: this.option.capture,
            passive: this.option.passive
        };
        this.target.ownerDocument.addEventListener('mousemove', this.callbackOnMouse, option);
        this.target.ownerDocument.addEventListener('mouseup', this.callbackOnMouse, option);
        this.target.ownerDocument.addEventListener('touchmove', this.callbackOnTouch, option);
        this.target.ownerDocument.addEventListener('touchend', this.callbackOnTouch, option);
        this.target.ownerDocument.addEventListener('touchcancel', this.callbackOnTouch, option);
        this.target.ownerDocument.addEventListener('contextmenu', this.callbackOnMenu, option);
        this.target.ownerDocument.addEventListener('drop', this.callbackOnMouse, option);
    };
    InputHandler.prototype.removeEventListeners = function () {
        var option = {
            capture: this.option.capture
        };
        this.target.ownerDocument.removeEventListener('mousemove', this.callbackOnMouse, option);
        this.target.ownerDocument.removeEventListener('mouseup', this.callbackOnMouse, option);
        this.target.ownerDocument.removeEventListener('touchmove', this.callbackOnTouch, option);
        this.target.ownerDocument.removeEventListener('touchend', this.callbackOnTouch, option);
        this.target.ownerDocument.removeEventListener('touchcancel', this.callbackOnTouch, option);
        this.target.ownerDocument.removeEventListener('contextmenu', this.callbackOnMenu, option);
        this.target.ownerDocument.removeEventListener('drop', this.callbackOnMouse, option);
    };
    return InputHandler;
}());



/***/ }),

/***/ "./src/app/directive/movable.directive.ts":
/*!************************************************!*\
  !*** ./src/app/directive/movable.directive.ts ***!
  \************************************************/
/*! exports provided: MovableDirective */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MovableDirective", function() { return MovableDirective; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_tabletop_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! service/tabletop.service */ "./src/app/service/tabletop.service.ts");
/* harmony import */ var _input_handler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./input-handler */ "./src/app/directive/input-handler.ts");







var MovableDirective = /** @class */ (function () {
    function MovableDirective(ngZone, elementRef, tabletopService) {
        this.ngZone = ngZone;
        this.elementRef = elementRef;
        this.tabletopService = tabletopService;
        this.layerName = '';
        this.colideLayers = [];
        this.transformCssOffset = '';
        this.isDisable = false;
        this.onstart = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.ondragstart = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.ondrag = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.ondragend = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.onend = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this._posX = 0;
        this._posY = 0;
        this._posZ = 0;
        this.pointer3d = { x: 0, y: 0, z: 0 };
        this.pointerOffset3d = { x: 0, y: 0, z: 0 };
        this.pointerStart3d = { x: 0, y: 0, z: 0 };
        this.pointerPrev3d = { x: 0, y: 0, z: 0 };
        this.height = 0;
        this.width = 0;
        this.ratio = 1.0;
        this.updateTimer = null;
        this.collidableElements = [];
        this.input = null;
    }
    MovableDirective_1 = MovableDirective;
    Object.defineProperty(MovableDirective.prototype, "option", {
        set: function (option) {
            this.tabletopObject = option.tabletopObject != null ? option.tabletopObject : this.tabletopObject;
            this.layerName = option.layerName != null ? option.layerName : this.layerName;
            this.colideLayers = option.colideLayers != null ? option.colideLayers : this.colideLayers;
            this.transformCssOffset = option.transformCssOffset != null ? option.transformCssOffset : this.transformCssOffset;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MovableDirective.prototype, "posX", {
        get: function () { return this._posX; },
        set: function (posX) { this._posX = posX; this.setUpdateTimer(); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MovableDirective.prototype, "posY", {
        get: function () { return this._posY; },
        set: function (posY) { this._posY = posY; this.setUpdateTimer(); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MovableDirective.prototype, "posZ", {
        get: function () { return this._posZ; },
        set: function (posZ) { this._posZ = posZ; this.setUpdateTimer(); },
        enumerable: true,
        configurable: true
    });
    MovableDirective.prototype.ngAfterViewInit = function () {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            _this.input = new _input_handler__WEBPACK_IMPORTED_MODULE_6__["InputHandler"](_this.elementRef.nativeElement);
        });
        this.input.onStart = this.onInputStart.bind(this);
        this.input.onMove = this.onInputMove.bind(this);
        this.input.onEnd = this.onInputEnd.bind(this);
        this.input.onContextMenu = this.onContextMenu.bind(this);
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            if ((event.isSendFromSelf && _this.input.isGrabbing) || event.data.identifier !== _this.tabletopObject.identifier || !_this.shouldTransition(_this.tabletopObject))
                return;
            _this.tabletopService.addBatch(function () {
                if (_this.input.isGrabbing) {
                    _this.cancel();
                }
                else {
                    _this.setAnimatedTransition(true);
                }
                _this.stopTransition();
                _this.setPosition(_this.tabletopObject);
            }, _this);
        });
        if (this.layerName.length < 1 && this.tabletopObject)
            this.layerName = this.tabletopObject.aliasName;
        this.register();
        this.findCollidableElements();
        this.setPosition(this.tabletopObject);
    };
    MovableDirective.prototype.ngOnDestroy = function () {
        this.cancel();
        this.input.destroy();
        this.unregister();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].unregister(this);
        this.tabletopService.removeBatch(this);
    };
    MovableDirective.prototype.cancel = function () {
        this.input.cancel();
        this.setPointerEvents(true);
        this.setAnimatedTransition(true);
        this.setCollidableLayer(false);
    };
    MovableDirective.prototype.onInputStart = function (e) {
        this.callSelectedEvent();
        if (this.collidableElements.length < 1)
            this.findCollidableElements(); // 稀にcollidableElementsの取得に失敗している
        if (this.isDisable || e.button === 1 || e.button === 2)
            return this.cancel();
        this.onstart.emit(e);
        this.setPointerEvents(false);
        this.setAnimatedTransition(false);
        this.setCollidableLayer(true);
        var target = document.elementFromPoint(this.input.pointer.x, this.input.pointer.y);
        this.pointer3d = this.calcLocalCoordinate(target, this.input.pointer);
        this.setPointerEvents(true);
        this.pointerOffset3d.x = this.posX - this.pointer3d.x;
        this.pointerOffset3d.y = this.posY - this.pointer3d.y;
        this.pointerOffset3d.z = this.posZ - this.pointer3d.z;
        this.pointerStart3d.x = this.pointerPrev3d.x = this.pointer3d.x;
        this.pointerStart3d.y = this.pointerPrev3d.y = this.pointer3d.y;
        this.pointerStart3d.z = this.pointerPrev3d.z = this.pointer3d.z;
        this.ratio = 1.0;
        if (this.pointer3d.z !== this.posZ) {
            this.ratio /= Math.abs(this.pointer3d.z - this.posZ) / 2;
        }
        this.width = this.input.target.clientWidth;
        this.height = this.input.target.clientHeight;
    };
    MovableDirective.prototype.onInputMove = function (e) {
        if (this.input.isGrabbing && !this.tabletopService.pointerDeviceService.isDragging) {
            return this.cancel(); // todo
        }
        if (this.isDisable || !this.input.isGrabbing)
            return this.cancel();
        if (!this.input.isDragging)
            this.setPointerEvents(false);
        var target = document.elementFromPoint(this.input.pointer.x, this.input.pointer.y);
        if (target == null)
            return;
        this.pointer3d = this.calcLocalCoordinate(target, this.input.pointer);
        if (this.pointerPrev3d.x === this.pointer3d.x && this.pointerPrev3d.y === this.pointer3d.y && this.pointerPrev3d.z === this.pointer3d.z)
            return;
        if (!this.input.isDragging)
            this.ondragstart.emit(e);
        this.ondrag.emit(e);
        var ratio = this.calcDistanceRatio(this.pointerStart3d, this.pointer3d);
        if (ratio < this.ratio)
            this.ratio = ratio;
        this.pointerPrev3d.x = this.pointer3d.x;
        this.pointerPrev3d.y = this.pointer3d.y;
        this.pointerPrev3d.z = this.pointer3d.z;
        this.posX = this.pointer3d.x + (this.pointerOffset3d.x * this.ratio) + (-(this.width / 2) * (1.0 - this.ratio));
        this.posY = this.pointer3d.y + (this.pointerOffset3d.y * this.ratio) + (-(this.height / 2) * (1.0 - this.ratio));
        this.posZ = this.pointer3d.z;
    };
    MovableDirective.prototype.onInputEnd = function (e) {
        if (this.isDisable)
            return this.cancel();
        if (this.input.isDragging)
            this.ondragend.emit(e);
        this.cancel();
        var tableSelecter = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get('tableSelecter');
        if (tableSelecter.gridSnap)
            this.snapToGrid();
        this.onend.emit(e);
    };
    MovableDirective.prototype.onContextMenu = function (e) {
        var _this = this;
        if (this.isDisable)
            return this.cancel();
        e.preventDefault();
        var tableSelecter = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get('tableSelecter');
        if (tableSelecter.gridSnap)
            this.snapToGrid();
        var needsDispatch = this.input.isGrabbing && e.isTrusted;
        this.cancel();
        if (needsDispatch) {
            // ロングプレスによるタッチ操作でコンテキストメニューを開く場合、イベントを適切なDOMに伝搬させる
            e.stopPropagation();
            var ev_1 = new MouseEvent(e.type, e);
            this.ngZone.run(function () { return _this.input.target.dispatchEvent(ev_1); });
        }
    };
    MovableDirective.prototype.callSelectedEvent = function () {
        if (this.tabletopObject)
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: this.tabletopObject.identifier, className: this.tabletopObject.aliasName });
    };
    MovableDirective.prototype.calcLocalCoordinate = function (target, coordinate) {
        if (target.contains(this.tabletopService.dragAreaElement)) {
            coordinate = service_pointer_device_service__WEBPACK_IMPORTED_MODULE_4__["PointerDeviceService"].convertToLocal(coordinate, this.tabletopService.dragAreaElement);
            coordinate.z = 0;
        }
        else {
            coordinate = service_pointer_device_service__WEBPACK_IMPORTED_MODULE_4__["PointerDeviceService"].convertLocalToLocal(coordinate, target, this.tabletopService.dragAreaElement);
        }
        return { x: coordinate.x, y: coordinate.y, z: 0 < coordinate.z ? coordinate.z : 0 };
    };
    MovableDirective.prototype.calcDistanceRatio = function (start, now) {
        var width = this.collidableElements[0].clientWidth;
        var height = this.collidableElements[0].clientHeight;
        var ratio = Math.sqrt(width * width + height * height);
        ratio = ratio < 1 ? 1 : ratio * 3;
        var distanceY = start.y - now.y;
        var distanceX = start.x - now.x;
        var distanceZ = (start.z - now.z) * 100;
        var distance = Math.sqrt(Math.pow(distanceY, 2) + Math.pow(distanceX, 2) + Math.pow(distanceZ, 2));
        return ratio / (distance + ratio);
    };
    MovableDirective.prototype.snapToGrid = function (gridSize) {
        if (gridSize === void 0) { gridSize = 25; }
        this.posX = this.calcSnapNum(this.posX, gridSize);
        this.posY = this.calcSnapNum(this.posY, gridSize);
    };
    MovableDirective.prototype.calcSnapNum = function (num, interval) {
        if (interval <= 0)
            return num;
        num = num < 0 ? num - interval / 2 : num + interval / 2;
        return num - (num % interval);
    };
    MovableDirective.prototype.setPosition = function (object) {
        this._posX = object.location.x;
        this._posY = object.location.y;
        this._posZ = object.posZ;
        this.updateTransformCss();
    };
    MovableDirective.prototype.setUpdateTimer = function () {
        var _this = this;
        if (this.updateTimer === null && this.tabletopObject) {
            this.updateTimer = setTimeout(function () {
                _this.tabletopObject.location.x = _this.posX;
                _this.tabletopObject.location.y = _this.posY;
                _this.tabletopObject.posZ = _this.posZ;
                _this.updateTimer = null;
            }, 66);
        }
        this.updateTransformCss();
    };
    MovableDirective.prototype.findCollidableElements = function () {
        this.collidableElements = [];
        if (getComputedStyle(this.input.target).pointerEvents !== 'none') {
            this.collidableElements = [this.input.target];
            return;
        }
        this.findNestedCollidableElements(this.input.target);
    };
    MovableDirective.prototype.findNestedCollidableElements = function (element) {
        // TODO:不完全
        var children = element.children;
        for (var i = 0; i < children.length; i++) {
            var child = children[i];
            if (!(child instanceof HTMLElement))
                continue;
            if (getComputedStyle(child).pointerEvents !== 'none') {
                this.collidableElements.push(child);
            }
        }
        if (this.collidableElements.length < 1) {
            for (var i = 0; i < children.length; i++) {
                var child = children[i];
                if (!(child instanceof HTMLElement))
                    continue;
                this.findNestedCollidableElements(child);
            }
        }
    };
    MovableDirective.prototype.setPointerEvents = function (isEnable) {
        var css = isEnable ? 'auto' : 'none';
        this.collidableElements.forEach(function (element) { return element.style.pointerEvents = css; });
    };
    MovableDirective.prototype.setAnimatedTransition = function (isEnable) {
        if (!this.input)
            return;
        this.input.target.style.transition = isEnable ? 'transform 132ms linear' : '';
    };
    MovableDirective.prototype.shouldTransition = function (object) {
        return object.location.x !== this.posX || object.location.y !== this.posY || object.posZ !== this.posZ;
    };
    MovableDirective.prototype.stopTransition = function () {
        this.input.target.style.transform = window.getComputedStyle(this.input.target).transform;
    };
    MovableDirective.prototype.updateTransformCss = function () {
        if (!this.input)
            return;
        var css = this.transformCssOffset + ' translateX(' + this.posX + 'px) translateY(' + this.posY + 'px) translateZ(' + this.posZ + 'px)';
        this.input.target.style.transform = css;
    };
    MovableDirective.prototype.setCollidableLayer = function (isCollidable) {
        var _this = this;
        // todo
        var isEnable = isCollidable;
        for (var layerName in MovableDirective_1.layerHash) {
            if (-1 < this.colideLayers.indexOf(layerName)) {
                isEnable = this.input.isGrabbing ? isCollidable : true;
            }
            else {
                isEnable = !isCollidable;
            }
            MovableDirective_1.layerHash[layerName].forEach(function (movable) {
                if (movable === _this || movable.input.isGrabbing)
                    return;
                movable.setPointerEvents(isEnable);
            });
        }
    };
    MovableDirective.prototype.register = function () {
        if (!(this.layerName in MovableDirective_1.layerHash))
            MovableDirective_1.layerHash[this.layerName] = [];
        var index = MovableDirective_1.layerHash[this.layerName].indexOf(this);
        if (index < 0)
            MovableDirective_1.layerHash[this.layerName].push(this);
    };
    MovableDirective.prototype.unregister = function () {
        if (!(this.layerName in MovableDirective_1.layerHash))
            return;
        var index = MovableDirective_1.layerHash[this.layerName].indexOf(this);
        if (-1 < index)
            MovableDirective_1.layerHash[this.layerName].splice(index, 1);
    };
    var MovableDirective_1;
    MovableDirective.layerHash = {};
    MovableDirective.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: service_tabletop_service__WEBPACK_IMPORTED_MODULE_5__["TabletopService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('movable.option')
    ], MovableDirective.prototype, "option", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('movable.disable')
    ], MovableDirective.prototype, "isDisable", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('movable.onstart')
    ], MovableDirective.prototype, "onstart", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('movable.ondragstart')
    ], MovableDirective.prototype, "ondragstart", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('movable.ondrag')
    ], MovableDirective.prototype, "ondrag", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('movable.ondragend')
    ], MovableDirective.prototype, "ondragend", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('movable.onend')
    ], MovableDirective.prototype, "onend", void 0);
    MovableDirective = MovableDirective_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Directive"])({
            selector: '[appMovable]'
        })
    ], MovableDirective);
    return MovableDirective;
}());



/***/ }),

/***/ "./src/app/directive/resizable.directive.ts":
/*!**************************************************!*\
  !*** ./src/app/directive/resizable.directive.ts ***!
  \**************************************************/
/*! exports provided: ResizableDirective */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResizableDirective", function() { return ResizableDirective; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_transform_css_number__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/transform/css-number */ "./src/app/class/transform/css-number.ts");
/* harmony import */ var _resize_handler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./resize-handler */ "./src/app/directive/resize-handler.ts");




var ResizableDirective = /** @class */ (function () {
    function ResizableDirective(ngZone, elementRef) {
        this.ngZone = ngZone;
        this.elementRef = elementRef;
        this.isDisable = false;
        this.boundsSelector = 'body';
        this.minWidth = 100;
        this.minHeight = 100;
        this.ostart = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.onmove = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.onend = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.handleMap = new Map();
        this.handleTypes = [
            _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].N,
            _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].E,
            _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].W,
            _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].S,
            _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].NE,
            _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].NW,
            _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].SE,
            _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].SW
        ];
        this.startPosition = { left: 0, top: 0, width: 0, height: 0 };
        this.startPointer = { x: 0, y: 0, z: 0 };
        this.prevTrans = { left: 0, top: 0, width: 0, height: 0 };
    }
    ResizableDirective.prototype.ngAfterViewInit = function () {
        this.initialize();
    };
    ResizableDirective.prototype.ngOnDestroy = function () {
        this.cancel();
        this.destroy();
    };
    ResizableDirective.prototype.initialize = function () {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            _this.handleTypes.forEach(function (type) {
                var handle = new _resize_handler__WEBPACK_IMPORTED_MODULE_3__["ResizeHandler"](_this.elementRef.nativeElement, type);
                _this.handleMap.set(type, handle);
                handle.input.onStart = function (ev) { return _this.onResizeStart(ev, handle); };
                handle.input.onMove = function (ev) { return _this.onResizeMove(ev, handle); };
                handle.input.onEnd = function (ev) { return _this.onResizeEnd(ev, handle); };
                handle.input.onContextMenu = function (ev) { return _this.onContextMenu(ev, handle); };
            });
        });
    };
    ResizableDirective.prototype.cancel = function () {
        this.handleMap.forEach(function (handle) { return handle.input.cancel(); });
    };
    ResizableDirective.prototype.destroy = function () {
        this.handleMap.forEach(function (handle) { return handle.input.destroy(); });
    };
    ResizableDirective.prototype.onResizeStart = function (e, handle) {
        if (e.button === 1 || e.button === 2)
            return this.cancel();
        this.handleMap.forEach(function (h) {
            if (h !== handle)
                h.input.cancel();
        });
        this.startPosition = this.calcElementPosition(this.elementRef.nativeElement);
        this.startPointer = handle.input.pointer;
        this.prevTrans = { left: 0, top: 0, width: 0, height: 0 };
        if (e.cancelable)
            e.preventDefault();
        e.stopPropagation();
    };
    ResizableDirective.prototype.onResizeMove = function (e, handle) {
        var trans = {
            left: 0,
            top: 0,
            width: handle.input.pointer.x - this.startPointer.x,
            height: handle.input.pointer.y - this.startPointer.y
        };
        switch (handle.type) {
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].N:
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].S:
                trans.width = 0;
                break;
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].E:
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].W:
                trans.height = 0;
                break;
        }
        switch (handle.type) {
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].SW:
                trans.left = trans.width;
                trans.width *= -1;
                break;
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].NE:
                trans.top = trans.height;
                trans.height *= -1;
                break;
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].E:
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].S:
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].SE:
                break;
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].N:
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].W:
            case _resize_handler__WEBPACK_IMPORTED_MODULE_3__["HandleType"].NW:
                trans.left = trans.width;
                trans.top = trans.height;
                trans.width *= -1;
                trans.height *= -1;
                break;
        }
        if (trans.width + this.startPosition.width < this.minWidth) {
            trans.width = this.minWidth - this.startPosition.width;
            trans.left = trans.left !== 0 ? -trans.width : trans.left;
        }
        if (trans.height + this.startPosition.height < this.minHeight) {
            trans.height = this.minHeight - this.startPosition.height;
            trans.top = trans.top !== 0 ? -trans.height : trans.top;
        }
        var diff = {
            left: trans.left - this.prevTrans.left,
            top: trans.top - this.prevTrans.top,
            width: trans.width - this.prevTrans.width,
            height: trans.height - this.prevTrans.height
        };
        var correction = this.calcCorrectionPosition(diff);
        trans.left += correction.left;
        trans.top += correction.top;
        trans.width += correction.width;
        trans.height += correction.height;
        this.elementRef.nativeElement.style.left = trans.left + this.startPosition.left + 'px';
        this.elementRef.nativeElement.style.top = trans.top + this.startPosition.top + 'px';
        this.elementRef.nativeElement.style.width = trans.width + this.startPosition.width + 'px';
        this.elementRef.nativeElement.style.height = trans.height + this.startPosition.height + 'px';
        this.prevTrans = trans;
        e.stopPropagation();
    };
    ResizableDirective.prototype.onResizeEnd = function (e, handle) {
        e.stopPropagation();
    };
    ResizableDirective.prototype.onContextMenu = function (e, handle) {
        e.stopPropagation();
    };
    ResizableDirective.prototype.calcCorrectionPosition = function (diff) {
        if (diff === void 0) { diff = { left: 0, top: 0, width: 0, height: 0 }; }
        var correction = { left: 0, top: 0, width: 0, height: 0 };
        var box = this.elementRef.nativeElement.getBoundingClientRect();
        var bounds = this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();
        if (bounds.right < box.right + diff.left + diff.width) {
            correction.width += bounds.right - (box.right + diff.left + diff.width);
        }
        if (box.left + diff.left < bounds.left) {
            correction.left += bounds.left - (box.left + diff.left);
            correction.width -= correction.left;
        }
        if (bounds.bottom < box.bottom + diff.top + diff.height) {
            correction.height += bounds.bottom - (box.bottom + diff.top + diff.height);
        }
        if (box.top + diff.top < bounds.top) {
            correction.top += bounds.top - (box.top + diff.top);
            correction.height -= correction.top;
        }
        return correction;
    };
    ResizableDirective.prototype.calcElementPosition = function (target) {
        var css = window.getComputedStyle(target);
        return {
            left: _udonarium_transform_css_number__WEBPACK_IMPORTED_MODULE_2__["CSSNumber"].relation(css.left, target.parentElement.offsetWidth, target.parentElement.offsetWidth * 0.5),
            top: _udonarium_transform_css_number__WEBPACK_IMPORTED_MODULE_2__["CSSNumber"].relation(css.top, target.parentElement.offsetHeight, target.parentElement.offsetHeight * 0.5),
            width: _udonarium_transform_css_number__WEBPACK_IMPORTED_MODULE_2__["CSSNumber"].relation(css.width, target.parentElement.offsetWidth, target.parentElement.offsetWidth * 0.5),
            height: _udonarium_transform_css_number__WEBPACK_IMPORTED_MODULE_2__["CSSNumber"].relation(css.height, target.parentElement.offsetHeight, target.parentElement.offsetHeight * 0.5),
        };
    };
    ResizableDirective.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('resizable.disable')
    ], ResizableDirective.prototype, "isDisable", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('resizable.bounds')
    ], ResizableDirective.prototype, "boundsSelector", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('resizable.minWidth')
    ], ResizableDirective.prototype, "minWidth", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('resizable.minHeight')
    ], ResizableDirective.prototype, "minHeight", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('resizable.start')
    ], ResizableDirective.prototype, "ostart", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('resizable.move')
    ], ResizableDirective.prototype, "onmove", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('resizable.end')
    ], ResizableDirective.prototype, "onend", void 0);
    ResizableDirective = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Directive"])({
            selector: '[appResizable]'
        })
    ], ResizableDirective);
    return ResizableDirective;
}());



/***/ }),

/***/ "./src/app/directive/resize-handler.ts":
/*!*********************************************!*\
  !*** ./src/app/directive/resize-handler.ts ***!
  \*********************************************/
/*! exports provided: HandleType, ResizeHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HandleType", function() { return HandleType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResizeHandler", function() { return ResizeHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _input_handler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./input-handler */ "./src/app/directive/input-handler.ts");


var HandleType;
(function (HandleType) {
    HandleType["N"] = "n";
    HandleType["E"] = "e";
    HandleType["W"] = "w";
    HandleType["S"] = "s";
    HandleType["NE"] = "ne";
    HandleType["NW"] = "nw";
    HandleType["SE"] = "se";
    HandleType["SW"] = "sw";
})(HandleType || (HandleType = {}));
var ResizeHandler = /** @class */ (function () {
    function ResizeHandler(target, type) {
        this.target = target;
        this.type = type;
        this.input = null;
        this.handle = null;
        this.width = 12;
        this.initialize();
    }
    ResizeHandler.prototype.initialize = function () {
        this.handle = this.target.ownerDocument.createElement('div');
        this.handle.classList.add('ui-resize-handler-' + this.type);
        this.input = new _input_handler__WEBPACK_IMPORTED_MODULE_1__["InputHandler"](this.handle);
        this.target.appendChild(this.handle);
        var style = this.handle.style;
        style.position = 'absolute';
        style.zIndex = '1';
        style.backgroundColor = 'transparent';
        switch (this.type) {
            case HandleType.N:
                style.top = -this.width * 3 / 4 + "px";
                style.left = '0px';
                style.right = '0px';
                style.height = this.width + "px";
                style.cursor = 'ns-resize';
                break;
            case HandleType.E:
                style.top = '0px';
                style.bottom = '0px';
                style.right = -this.width * 3 / 4 + "px";
                style.width = this.width + "px";
                style.cursor = 'ew-resize';
                break;
            case HandleType.W:
                style.top = '0px';
                style.bottom = '0px';
                style.left = -this.width * 3 / 4 + "px";
                style.width = this.width + "px";
                style.cursor = 'ew-resize';
                break;
            case HandleType.S:
                style.bottom = -this.width * 3 / 4 + "px";
                style.left = '0px';
                style.right = '0px';
                style.height = this.width + "px";
                style.cursor = 'ns-resize';
                break;
            case HandleType.NE:
                style.top = -this.width * 3 / 4 + "px";
                style.right = -this.width * 3 / 4 + "px";
                style.width = this.width * 3 / 2 + "px";
                style.height = this.width * 3 / 2 + "px";
                style.cursor = 'nesw-resize';
                style.zIndex = '2';
                break;
            case HandleType.NW:
                style.top = -this.width * 3 / 4 + "px";
                style.left = -this.width * 3 / 4 + "px";
                style.width = this.width * 3 / 2 + "px";
                style.height = this.width * 3 / 2 + "px";
                style.cursor = 'nwse-resize';
                style.zIndex = '2';
                break;
            case HandleType.SE:
                style.bottom = -this.width * 3 / 4 + "px";
                style.right = -this.width * 3 / 4 + "px";
                style.width = this.width * 3 / 2 + "px";
                style.height = this.width * 3 / 2 + "px";
                style.cursor = 'nwse-resize';
                style.zIndex = '2';
                break;
            case HandleType.SW:
                style.bottom = -this.width * 3 / 4 + "px";
                style.left = -this.width * 3 / 4 + "px";
                style.width = this.width * 3 / 2 + "px";
                style.height = this.width * 3 / 2 + "px";
                style.cursor = 'nesw-resize';
                style.zIndex = '2';
                break;
        }
    };
    ResizeHandler.prototype.destroy = function () {
        this.handle.remove();
        this.input.destroy();
    };
    return ResizeHandler;
}());



/***/ }),

/***/ "./src/app/directive/rotable.directive.ts":
/*!************************************************!*\
  !*** ./src/app/directive/rotable.directive.ts ***!
  \************************************************/
/*! exports provided: RotableDirective */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RotableDirective", function() { return RotableDirective; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");
/* harmony import */ var service_tabletop_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! service/tabletop.service */ "./src/app/service/tabletop.service.ts");
/* harmony import */ var _input_handler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./input-handler */ "./src/app/directive/input-handler.ts");






var RotableDirective = /** @class */ (function () {
    function RotableDirective(ngZone, elementRef, tabletopService) {
        this.ngZone = ngZone;
        this.elementRef = elementRef;
        this.tabletopService = tabletopService;
        this.transformCssOffset = '';
        this.grabbingSelecter = '.rotate-grab';
        this.isDisable = false;
        this.onstart = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.ondragstart = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.ondrag = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.ondragend = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.onend = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this._rotate = 0;
        this.valueChange = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.rotateOffset = 0;
        this.updateTimer = null;
        this.grabbingElement = null;
        this.input = null;
    }
    Object.defineProperty(RotableDirective.prototype, "option", {
        set: function (option) {
            this.tabletopObject = option.tabletopObject != null ? option.tabletopObject : this.tabletopObject;
            this.grabbingSelecter = option.grabbingSelecter != null ? option.grabbingSelecter : this.grabbingSelecter;
            this.transformCssOffset = option.transformCssOffset != null ? option.transformCssOffset : this.transformCssOffset;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RotableDirective.prototype, "rotate", {
        get: function () { return this._rotate; },
        set: function (rotate) { this._rotate = rotate; this.setUpdateTimer(); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RotableDirective.prototype, "value", {
        set: function (value) { this._rotate = value; this.updateTransformCss(); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RotableDirective.prototype, "isAllowedToRotate", {
        get: function () {
            if (!this.grabbingElement || !this.input.target)
                return false;
            if (this.grabbingSelecter.length < 1)
                return true;
            var elements = this.input.target.querySelectorAll(this.grabbingSelecter);
            var macth = false;
            for (var i = 0; i < elements.length; i++) {
                macth = elements[i].contains(this.grabbingElement);
                if (macth)
                    return true;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    RotableDirective.prototype.ngAfterViewInit = function () {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            _this.input = new _input_handler__WEBPACK_IMPORTED_MODULE_5__["InputHandler"](_this.elementRef.nativeElement);
        });
        this.input.onStart = this.onInputStart.bind(this);
        this.input.onMove = this.onInputMove.bind(this);
        this.input.onEnd = this.onInputEnd.bind(this);
        this.input.onContextMenu = this.onContextMenu.bind(this);
        if (this.tabletopObject) {
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
                .on('UPDATE_GAME_OBJECT', -1000, function (event) {
                if ((event.isSendFromSelf && _this.input.isGrabbing) || event.data.identifier !== _this.tabletopObject.identifier || !_this.shouldTransition(_this.tabletopObject))
                    return;
                _this.tabletopService.addBatch(function () {
                    if (_this.input.isGrabbing) {
                        _this.cancel();
                    }
                    else {
                        _this.setAnimatedTransition(true);
                    }
                    _this.stopTransition();
                    _this.setRotate(_this.tabletopObject);
                }, _this);
            });
            this.setRotate(this.tabletopObject);
        }
        else {
            this.updateTransformCss();
        }
    };
    RotableDirective.prototype.ngOnDestroy = function () {
        this.cancel();
        this.input.destroy();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(this);
        this.tabletopService.removeBatch(this);
    };
    RotableDirective.prototype.cancel = function () {
        this.input.cancel();
        this.grabbingElement = null;
        this.setAnimatedTransition(true);
    };
    RotableDirective.prototype.onInputStart = function (e) {
        this.grabbingElement = e.target;
        if (this.isDisable || !this.isAllowedToRotate || e.button === 1 || e.button === 2)
            return this.cancel();
        if (e.cancelable)
            e.preventDefault();
        e.stopPropagation();
        this.onstart.emit(e);
        var pointer = service_pointer_device_service__WEBPACK_IMPORTED_MODULE_3__["PointerDeviceService"].convertLocalToLocal(this.input.pointer, this.grabbingElement, this.input.target.parentElement);
        this.rotateOffset = this.calcRotate(pointer, this.rotate);
        this.setAnimatedTransition(false);
    };
    RotableDirective.prototype.onInputMove = function (e) {
        if (this.input.isGrabbing && !this.tabletopService.pointerDeviceService.isDragging) {
            return this.cancel(); // todo
        }
        if (this.isDisable || !this.input.isGrabbing)
            return this.cancel();
        e.stopPropagation();
        var pointer3d = service_pointer_device_service__WEBPACK_IMPORTED_MODULE_3__["PointerDeviceService"].convertLocalToLocal(this.input.pointer, this.grabbingElement, this.input.target.parentElement);
        var angle = this.calcRotate(pointer3d, this.rotateOffset);
        if (!this.input.isDragging)
            this.ondragstart.emit(e);
        this.ondrag.emit(e);
        this.rotate = angle;
    };
    RotableDirective.prototype.onInputEnd = function (e) {
        if (this.isDisable)
            return this.cancel();
        e.stopPropagation();
        if (this.input.isDragging)
            this.ondragend.emit(e);
        this.cancel();
        this.snapToPolygonal();
        this.onend.emit(e);
    };
    RotableDirective.prototype.onContextMenu = function (e) {
        if (this.isDisable)
            return this.cancel();
        e.preventDefault();
        this.cancel();
        this.snapToPolygonal();
    };
    RotableDirective.prototype.calcRotate = function (pointer, rotateOffset) {
        var centerX = this.input.target.clientWidth / 2;
        var centerY = this.input.target.clientHeight / 2;
        var x = pointer.x - centerX;
        var y = pointer.y - centerY;
        var rad = Math.atan2(y, x);
        return ((rad * 180 / Math.PI) - rotateOffset) % 360;
    };
    RotableDirective.prototype.snapToPolygonal = function (polygonal) {
        if (polygonal === void 0) { polygonal = 24; }
        if (polygonal <= 1)
            return;
        this.rotate = this.rotate < 0 ? this.rotate - (180 / polygonal) : this.rotate + (180 / polygonal);
        this.rotate -= (this.rotate) % (360 / polygonal);
    };
    RotableDirective.prototype.setUpdateTimer = function () {
        var _this = this;
        if (this.updateTimer === null) {
            this.updateTimer = setTimeout(function () {
                _this.valueChange.emit(_this.rotate);
                if (_this.tabletopObject)
                    _this.tabletopObject.rotate = _this.rotate;
                _this.updateTimer = null;
            }, 66);
        }
        this.updateTransformCss();
    };
    RotableDirective.prototype.setRotate = function (object) {
        if (object)
            this._rotate = object.rotate;
        this.updateTransformCss();
    };
    RotableDirective.prototype.setAnimatedTransition = function (isEnable) {
        if (!this.input)
            return;
        this.input.target.style.transition = isEnable ? 'transform 132ms linear' : '';
    };
    RotableDirective.prototype.shouldTransition = function (object) {
        return object.rotate !== this.rotate;
    };
    RotableDirective.prototype.stopTransition = function () {
        this.input.target.style.transform = window.getComputedStyle(this.input.target).transform;
    };
    RotableDirective.prototype.updateTransformCss = function () {
        if (!this.input)
            return;
        var css = this.transformCssOffset + ' rotateZ(' + this.rotate + 'deg)';
        this.input.target.style.transform = css;
    };
    RotableDirective.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: service_tabletop_service__WEBPACK_IMPORTED_MODULE_4__["TabletopService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('rotable.option')
    ], RotableDirective.prototype, "option", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('rotable.disable')
    ], RotableDirective.prototype, "isDisable", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('rotable.onstart')
    ], RotableDirective.prototype, "onstart", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('rotable.ondragstart')
    ], RotableDirective.prototype, "ondragstart", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('rotable.ondrag')
    ], RotableDirective.prototype, "ondrag", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('rotable.ondragend')
    ], RotableDirective.prototype, "ondragend", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('rotable.onend')
    ], RotableDirective.prototype, "onend", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('rotable.value')
    ], RotableDirective.prototype, "value", null);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])('rotable.valueChange')
    ], RotableDirective.prototype, "valueChange", void 0);
    RotableDirective = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Directive"])({
            selector: '[appRotable]'
        })
    ], RotableDirective);
    return RotableDirective;
}());



/***/ }),

/***/ "./src/app/directive/tooltip.directive.ts":
/*!************************************************!*\
  !*** ./src/app/directive/tooltip.directive.ts ***!
  \************************************************/
/*! exports provided: TooltipDirective */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TooltipDirective", function() { return TooltipDirective; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var component_overview_panel_overview_panel_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! component/overview-panel/overview-panel.component */ "./src/app/component/overview-panel/overview-panel.component.ts");
/* harmony import */ var service_context_menu_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! service/context-menu.service */ "./src/app/service/context-menu.service.ts");
/* harmony import */ var service_pointer_device_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! service/pointer-device.service */ "./src/app/service/pointer-device.service.ts");






var TooltipDirective = /** @class */ (function () {
    function TooltipDirective(ngZone, viewContainerRef, componentFactoryResolver, pointerDeviceService) {
        var _this = this;
        this.ngZone = ngZone;
        this.viewContainerRef = viewContainerRef;
        this.componentFactoryResolver = componentFactoryResolver;
        this.pointerDeviceService = pointerDeviceService;
        this.callbackOnMouseEnter = function (e) { return _this.onMouseEnter(e); };
        this.callbackOnMouseLeave = function (e) { return _this.onMouseLeave(e); };
        this.callbackOnMouseDown = function (e) { return _this.onMouseDown(e); };
    }
    TooltipDirective_1 = TooltipDirective;
    TooltipDirective.prototype.ngOnInit = function () { };
    TooltipDirective.prototype.ngAfterViewInit = function () {
        this.addEventListeners(this.viewContainerRef.element.nativeElement);
    };
    TooltipDirective.prototype.ngOnDestroy = function () {
        this.removeEventListeners(this.viewContainerRef.element.nativeElement);
        this.clearTimer();
        this.close();
    };
    TooltipDirective.prototype.onMouseEnter = function (e) {
        this.clearTimer();
        if (!this.tooltipComponentRef)
            this.startOpenTimer();
    };
    TooltipDirective.prototype.onMouseLeave = function (e) {
        this.clearTimer();
        if (this.tooltipComponentRef)
            this.startCloseTimer();
    };
    TooltipDirective.prototype.onMouseDown = function (e) {
        var _this = this;
        if (!this.tooltipComponentRef)
            return;
        if (!this.tooltipComponentRef.location.nativeElement.contains(e.target)
            && !this.viewContainerRef.element.nativeElement.contains(e.target)) {
            this.ngZone.run(function () { return _this.closeAll(); });
        }
    };
    TooltipDirective.prototype.startOpenTimer = function () {
        var _this = this;
        var pointerX = this.pointerDeviceService.pointerX;
        var pointerY = this.pointerDeviceService.pointerY;
        this.openTooltipTimer = setTimeout(function () {
            var magnitude = Math.pow((pointerX - _this.pointerDeviceService.pointerX), 2) + Math.pow((pointerY - _this.pointerDeviceService.pointerY), 2);
            if (4 < magnitude) {
                _this.startOpenTimer();
            }
            else {
                _this.ngZone.run(function () { return _this.open(); });
            }
        }, 100);
    };
    TooltipDirective.prototype.startCloseTimer = function () {
        var _this = this;
        this.closeTooltipTimer = setTimeout(function () {
            if (_this.tooltipComponentRef && _this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)) {
                _this.startCloseTimer();
            }
            else {
                _this.ngZone.run(function () { return _this.closeAll(); });
            }
        }, 400);
    };
    TooltipDirective.prototype.clearTimer = function () {
        clearTimeout(this.closeTooltipTimer);
        clearTimeout(this.openTooltipTimer);
    };
    TooltipDirective.prototype.open = function () {
        var _this = this;
        this.closeAll();
        if (this.pointerDeviceService.isDragging)
            return;
        var parentViewContainerRef = service_context_menu_service__WEBPACK_IMPORTED_MODULE_4__["ContextMenuService"].defaultParentViewContainerRef;
        var injector = parentViewContainerRef.injector;
        var panelComponentFactory = this.componentFactoryResolver.resolveComponentFactory(component_overview_panel_overview_panel_component__WEBPACK_IMPORTED_MODULE_3__["OverviewPanelComponent"]);
        this.tooltipComponentRef = parentViewContainerRef.createComponent(panelComponentFactory, parentViewContainerRef.length, injector);
        this.tooltipComponentRef.instance.tabletopObject = this.tabletopObject;
        this.tooltipComponentRef.instance.left = this.pointerDeviceService.pointerX;
        this.tooltipComponentRef.instance.top = this.pointerDeviceService.pointerY;
        this.addEventListeners(this.tooltipComponentRef.location.nativeElement);
        this.ngZone.runOutsideAngular(function () {
            document.body.addEventListener('touchstart', _this.callbackOnMouseDown, true);
            document.body.addEventListener('mousedown', _this.callbackOnMouseDown, true);
        });
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
            .on('DELETE_GAME_OBJECT', -1000, function (event) {
            if (_this.tabletopObject && _this.tabletopObject.identifier === event.data.identifier)
                _this.closeAll();
        });
        this.tooltipComponentRef.onDestroy(function () {
            _this.removeEventListeners(_this.tooltipComponentRef.location.nativeElement);
            document.body.removeEventListener('touchstart', _this.callbackOnMouseDown, true);
            document.body.removeEventListener('mousedown', _this.callbackOnMouseDown, true);
            _this.clearTimer();
            _this.tooltipComponentRef = null;
            _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].unregister(_this);
        });
        TooltipDirective_1.activeTooltips.push(this.tooltipComponentRef);
    };
    TooltipDirective.prototype.close = function () {
        if (!this.tooltipComponentRef)
            return;
        var index = TooltipDirective_1.activeTooltips.indexOf(this.tooltipComponentRef);
        if (0 <= index)
            TooltipDirective_1.activeTooltips.splice(index, 1);
        this.tooltipComponentRef.destroy();
        this.tooltipComponentRef = null;
    };
    TooltipDirective.prototype.closeAll = function () {
        TooltipDirective_1.activeTooltips.forEach(function (componentRef) { return componentRef.destroy(); });
        TooltipDirective_1.activeTooltips = [];
        this.close();
    };
    TooltipDirective.prototype.addEventListeners = function (element) {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            element.addEventListener('mouseenter', _this.callbackOnMouseEnter, false);
            element.addEventListener('mouseleave', _this.callbackOnMouseLeave, false);
        });
    };
    TooltipDirective.prototype.removeEventListeners = function (element) {
        element.removeEventListener('mouseenter', this.callbackOnMouseEnter, false);
        element.removeEventListener('mouseleave', this.callbackOnMouseLeave, false);
    };
    var TooltipDirective_1;
    TooltipDirective.activeTooltips = [];
    TooltipDirective.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewContainerRef"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ComponentFactoryResolver"] },
        { type: service_pointer_device_service__WEBPACK_IMPORTED_MODULE_5__["PointerDeviceService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])('appTooltip')
    ], TooltipDirective.prototype, "tabletopObject", void 0);
    TooltipDirective = TooltipDirective_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Directive"])({
            selector: '[appTooltip]'
        })
    ], TooltipDirective);
    return TooltipDirective;
}());



/***/ }),

/***/ "./src/app/pipe/safe.pipe.ts":
/*!***********************************!*\
  !*** ./src/app/pipe/safe.pipe.ts ***!
  \***********************************/
/*! exports provided: SafePipe */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SafePipe", function() { return SafePipe; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");



var SafePipe = /** @class */ (function () {
    function SafePipe(_sanitizer) {
        this._sanitizer = _sanitizer;
    }
    SafePipe.prototype.transform = function (value, type) {
        if (type === void 0) { type = 'html'; }
        switch (type) {
            case 'html': return this._sanitizer.bypassSecurityTrustHtml(value);
            case 'style': return this._sanitizer.bypassSecurityTrustStyle(value);
            case 'script': return this._sanitizer.bypassSecurityTrustScript(value);
            case 'url': return this._sanitizer.bypassSecurityTrustUrl(value);
            case 'resourceUrl': return this._sanitizer.bypassSecurityTrustResourceUrl(value);
            default: throw new Error("Invalid safe type specified: " + type);
        }
    };
    SafePipe.ctorParameters = function () { return [
        { type: _angular_platform_browser__WEBPACK_IMPORTED_MODULE_2__["DomSanitizer"] }
    ]; };
    SafePipe = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({
            name: 'safe'
        })
    ], SafePipe);
    return SafePipe;
}());



/***/ }),

/***/ "./src/app/service/app-config.service.ts":
/*!***********************************************!*\
  !*** ./src/app/service/app-config.service.ts ***!
  \***********************************************/
/*! exports provided: AppConfigService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppConfigService", function() { return AppConfigService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_database_database__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/database/database */ "./src/app/class/database/database.ts");
/* harmony import */ var js_yaml_dist_js_yaml_min_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! js-yaml/dist/js-yaml.min.js */ "./node_modules/js-yaml/dist/js-yaml.min.js");
/* harmony import */ var js_yaml_dist_js_yaml_min_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(js_yaml_dist_js_yaml_min_js__WEBPACK_IMPORTED_MODULE_4__);





var AppConfigService = /** @class */ (function () {
    function AppConfigService() {
        this.peerHistory = [];
        this.isOpen = false;
    }
    AppConfigService_1 = AppConfigService;
    AppConfigService.prototype.initialize = function () {
        this.initAppConfig();
        this.initDatabase();
    };
    AppConfigService.prototype.initDatabase = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var db, history, i, _a, _b, historyId;
            var e_1, _c;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                switch (_d.label) {
                    case 0:
                        console.log('initDatabase...');
                        if (!window.indexedDB) {
                            console.warn('このブラウザは安定板の IndexedDB をサポートしていません。IndexedDB の機能は利用できません。');
                            return [2 /*return*/];
                        }
                        db = new _udonarium_database_database__WEBPACK_IMPORTED_MODULE_3__["Database"]();
                        return [4 /*yield*/, db.getPeerHistory()];
                    case 1:
                        history = _d.sent();
                        history.sort(function (a, b) {
                            if (a.timestamp < b.timestamp)
                                return 1;
                            if (a.timestamp > b.timestamp)
                                return -1;
                            return 0;
                        });
                        for (i = 1; i < history.length; i++) {
                            db.deletePeerHistory(history[i].peerId);
                        }
                        console.log('履歴: ', history);
                        this.peerHistory = [];
                        if (history.length) {
                            try {
                                for (_a = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](history[0].history), _b = _a.next(); !_b.done; _b = _a.next()) {
                                    historyId = _b.value;
                                    if (historyId !== history[0].peerId) {
                                        this.peerHistory.push(historyId);
                                    }
                                }
                            }
                            catch (e_1_1) { e_1 = { error: e_1_1 }; }
                            finally {
                                try {
                                    if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
                                }
                                finally { if (e_1) throw e_1.error; }
                            }
                        }
                        console.log('最終履歴: ', this.peerHistory);
                        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].register(this)
                            .on('CONNECT_PEER', -1000, function () {
                            console.log('AppConfigService CONNECT_PEER', _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerIds);
                            if (!_this.isOpen) {
                                _this.isOpen = true;
                            }
                            db.addPeerHistory(_udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerId, _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerIds);
                        })
                            .on('DISCONNECT_PEER', -1000, function () {
                            console.log('AppConfigService DISCONNECT_PEER', _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["Network"].peerIds);
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    AppConfigService.prototype.initAppConfig = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var config, obj, e_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        console.log('YAML読み込み...');
                        return [4 /*yield*/, this.loadYaml()];
                    case 1:
                        config = _a.sent();
                        obj = js_yaml_dist_js_yaml_min_js__WEBPACK_IMPORTED_MODULE_4__["safeLoad"](config);
                        AppConfigService_1.applyConfig(obj);
                        console.log(AppConfigService_1.appConfig);
                        return [3 /*break*/, 3];
                    case 2:
                        e_2 = _a.sent();
                        console.warn(e_2);
                        return [3 /*break*/, 3];
                    case 3:
                        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_2__["EventSystem"].trigger('LOAD_CONFIG', AppConfigService_1.appConfig);
                        return [2 /*return*/];
                }
            });
        });
    };
    AppConfigService.prototype.loadYaml = function () {
        return new Promise(function (resolve, reject) {
            var config = document.querySelector('script[type$="yaml"]');
            if (!config) {
                console.warn('loadYaml element not found.');
                resolve('');
                return;
            }
            console.log('loadYaml ready...', config);
            var configString = config.textContent;
            var url = config.getAttribute('src');
            if (url == null) {
                console.warn('loadYaml url undefined.');
                resolve(configString);
                return;
            }
            var http = new XMLHttpRequest();
            http.open('get', url, true);
            http.onerror = function (event) {
                console.error(event);
                resolve(configString);
            };
            http.onreadystatechange = function (event) {
                if (http.readyState !== 4) {
                    return;
                }
                if (http.status === 200) {
                    console.log('loadYaml success!');
                    configString = http.responseText;
                }
                else {
                    console.warn('loadYaml fail...? status:' + http.status);
                }
                resolve(configString);
            };
            console.log('loadYaml start');
            http.send(null);
        });
    };
    AppConfigService.applyConfig = function (config, root) {
        if (root === void 0) { root = AppConfigService_1.appConfig; }
        for (var key in config) {
            if (isArray(config[key])) {
                root[key] = config[key];
            }
            else if (typeof config[key] === 'object') {
                if (!(key in root))
                    root[key] = {};
                AppConfigService_1.applyConfig(config[key], root[key]);
            }
            else {
                root[key] = config[key];
            }
        }
        return root;
    };
    var AppConfigService_1;
    AppConfigService.appConfig = {
        webrtc: {
            key: ''
        },
        app: {
            title: '',
            mode: ''
        }
    };
    AppConfigService = AppConfigService_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], AppConfigService);
    return AppConfigService;
}());

function isArray(obj) {
    return Object.prototype.toString.call(obj) === '[object Array]';
}


/***/ }),

/***/ "./src/app/service/chat-message.service.ts":
/*!*************************************************!*\
  !*** ./src/app/service/chat-message.service.ts ***!
  \*************************************************/
/*! exports provided: ChatMessageService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatMessageService", function() { return ChatMessageService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_chat_tab__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/chat-tab */ "./src/app/class/chat-tab.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/system/network/peer-context */ "./src/app/class/core/system/network/peer-context.ts");
/* harmony import */ var _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/game-character */ "./src/app/class/game-character.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");








var HOURS = 60 * 60 * 1000;
var ChatMessageService = /** @class */ (function () {
    function ChatMessageService() {
        this.intervalTimer = null;
        this.timeOffset = Date.now();
        this.performanceOffset = performance.now();
        this.ntpApiUrls = [
            'https://ntp-a1.nict.go.jp/cgi-bin/json',
            'https://ntp-b1.nict.go.jp/cgi-bin/json',
        ];
        this.gameType = '';
    }
    Object.defineProperty(ChatMessageService.prototype, "chatTabs", {
        get: function () {
            return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.getObjects(_udonarium_chat_tab__WEBPACK_IMPORTED_MODULE_2__["ChatTab"]);
        },
        enumerable: true,
        configurable: true
    });
    ChatMessageService.prototype.calibrateTimeOffset = function () {
        var _this = this;
        if (this.intervalTimer != null) {
            console.log('calibrateTimeOffset was canceled.');
            return;
        }
        var index = Math.floor(Math.random() * this.ntpApiUrls.length);
        var ntpApiUrl = this.ntpApiUrls[index];
        var sendTime = performance.now();
        fetch(ntpApiUrl)
            .then(function (response) {
            if (response.ok)
                return response.json();
            throw new Error('Network response was not ok.');
        })
            .then(function (jsonObj) {
            var endTime = performance.now();
            var latency = (endTime - sendTime) / 2;
            var timeobj = jsonObj;
            var st = timeobj.st * 1000;
            var fixedTime = st + latency;
            _this.timeOffset = fixedTime;
            _this.performanceOffset = endTime;
            console.log('latency: ' + latency + 'ms');
            console.log('st: ' + st + '');
            console.log('timeOffset: ' + _this.timeOffset);
            console.log('performanceOffset: ' + _this.performanceOffset);
            _this.setRerequest();
        })
            .catch(function (error) {
            console.warn('There has been a problem with your fetch operation: ', error.message);
            _this.setRerequest();
        });
    };
    ChatMessageService.prototype.setRerequest = function () {
        var _this = this;
        this.intervalTimer = setTimeout(function () {
            _this.intervalTimer = null;
            _this.calibrateTimeOffset();
        }, 6 * HOURS);
    };
    ChatMessageService.prototype.getTime = function () {
        return Math.floor(this.timeOffset + (performance.now() - this.performanceOffset));
    };
    ChatMessageService.prototype.sendMessage = function (chatTab, text, gameType, sendFrom, sendTo) {
        var chatMessage = {
            from: _udonarium_core_system__WEBPACK_IMPORTED_MODULE_4__["Network"].peerContext.id,
            to: this.findId(sendTo),
            name: this.makeMessageName(sendFrom, sendTo),
            imageIdentifier: this.findImageIdentifier(sendFrom),
            timestamp: this.calcTimeStamp(chatTab),
            tag: gameType,
            text: text,
        };
        return chatTab.addMessage(chatMessage);
    };
    ChatMessageService.prototype.findId = function (identifier) {
        var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(identifier);
        if (object instanceof _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"]) {
            return object.identifier;
        }
        else if (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"]) {
            return _udonarium_core_system_network_peer_context__WEBPACK_IMPORTED_MODULE_5__["PeerContext"].create(object.peerId).id;
        }
        return null;
    };
    ChatMessageService.prototype.findObjectName = function (identifier) {
        var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(identifier);
        if (object instanceof _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"]) {
            return object.name;
        }
        else if (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"]) {
            return object.name;
        }
        return identifier;
    };
    ChatMessageService.prototype.makeMessageName = function (sendFrom, sendTo) {
        var sendFromName = this.findObjectName(sendFrom);
        if (sendTo == null || sendTo.length < 1)
            return sendFromName;
        var sendToName = this.findObjectName(sendTo);
        return sendFromName + ' > ' + sendToName;
    };
    ChatMessageService.prototype.findImageIdentifier = function (identifier) {
        var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_3__["ObjectStore"].instance.get(identifier);
        if (object instanceof _udonarium_game_character__WEBPACK_IMPORTED_MODULE_6__["GameCharacter"]) {
            return object.imageFile ? object.imageFile.identifier : '';
        }
        else if (object instanceof _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_7__["PeerCursor"]) {
            return object.imageIdentifier;
        }
        return identifier;
    };
    ChatMessageService.prototype.calcTimeStamp = function (chatTab) {
        var now = this.getTime();
        var latest = chatTab.latestTimeStamp;
        return now <= latest ? latest + 1 : now;
    };
    ChatMessageService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], ChatMessageService);
    return ChatMessageService;
}());



/***/ }),

/***/ "./src/app/service/context-menu.service.ts":
/*!*************************************************!*\
  !*** ./src/app/service/context-menu.service.ts ***!
  \*************************************************/
/*! exports provided: ContextMenuType, ContextMenuSeparator, ContextMenuService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContextMenuType", function() { return ContextMenuType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContextMenuSeparator", function() { return ContextMenuSeparator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContextMenuService", function() { return ContextMenuService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");


var ContextMenuType;
(function (ContextMenuType) {
    ContextMenuType["ACTION"] = "action";
    ContextMenuType["SEPARATOR"] = "separator";
})(ContextMenuType || (ContextMenuType = {}));
var ContextMenuSeparator = {
    name: '',
    enabled: true,
    type: ContextMenuType.SEPARATOR
};
var ContextMenuService = /** @class */ (function () {
    function ContextMenuService(componentFactoryResolver) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.title = '';
        this.actions = [];
        this.position = { x: 0, y: 0 };
    }
    ContextMenuService_1 = ContextMenuService;
    Object.defineProperty(ContextMenuService.prototype, "isShow", {
        get: function () {
            return this.panelComponentRef ? true : false;
        },
        enumerable: true,
        configurable: true
    });
    ContextMenuService.prototype.open = function (position, actions, title, parentViewContainerRef) {
        this.close();
        if (!parentViewContainerRef) {
            parentViewContainerRef = ContextMenuService_1.defaultParentViewContainerRef;
            console.log('Context Open');
        }
        var panelComponentRef;
        var injector = parentViewContainerRef.injector;
        var panelComponentFactory = this.componentFactoryResolver.resolveComponentFactory(ContextMenuService_1.UIPanelComponentClass);
        panelComponentRef = parentViewContainerRef.createComponent(panelComponentFactory, parentViewContainerRef.length, injector);
        var childPanelService = panelComponentRef.injector.get(ContextMenuService_1);
        childPanelService.panelComponentRef = panelComponentRef;
        if (actions) {
            childPanelService.actions = actions;
        }
        if (position) {
            childPanelService.position.x = position.x;
            childPanelService.position.y = position.y;
        }
        childPanelService.title = title != null ? title : '';
        panelComponentRef.onDestroy(function () {
            childPanelService.panelComponentRef = null;
        });
    };
    ContextMenuService.prototype.close = function () {
        if (this.panelComponentRef) {
            this.panelComponentRef.destroy();
            this.panelComponentRef = null;
        }
    };
    var ContextMenuService_1;
    ContextMenuService.UIPanelComponentClass = null;
    ContextMenuService.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ComponentFactoryResolver"] }
    ]; };
    ContextMenuService = ContextMenuService_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], ContextMenuService);
    return ContextMenuService;
}());



/***/ }),

/***/ "./src/app/service/game-object-inventory.service.ts":
/*!**********************************************************!*\
  !*** ./src/app/service/game-object-inventory.service.ts ***!
  \**********************************************************/
/*! exports provided: GameObjectInventoryService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameObjectInventoryService", function() { return GameObjectInventoryService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_core_system_util_string_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/system/util/string-util */ "./src/app/class/core/system/util/string-util.ts");
/* harmony import */ var _udonarium_data_element__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/data-element */ "./src/app/class/data-element.ts");
/* harmony import */ var _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/data-summary-setting */ "./src/app/class/data-summary-setting.ts");
/* harmony import */ var _udonarium_game_character__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/game-character */ "./src/app/class/game-character.ts");








var GameObjectInventoryService = /** @class */ (function () {
    function GameObjectInventoryService() {
        var _this = this;
        this.tableInventory = new ObjectInventory(function (object) { return object.location.name === 'table'; });
        this.commonInventory = new ObjectInventory(function (object) { return !_this.isAnyLocation(object.location.name); });
        this.privateInventory = new ObjectInventory(function (object) { return object.location.name === _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId; });
        this.graveyardInventory = new ObjectInventory(function (object) { return object.location.name === 'graveyard'; });
        this.locationMap = new Map();
        this.tagNameMap = new Map();
        this.newLineString = '/';
        this.newLineDataElement = _udonarium_data_element__WEBPACK_IMPORTED_MODULE_5__["DataElement"].create(this.newLineString);
        this.initialize();
    }
    Object.defineProperty(GameObjectInventoryService.prototype, "summarySetting", {
        get: function () { return _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_6__["DataSummarySetting"].instance; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryService.prototype, "sortTag", {
        get: function () { return this.summarySetting.sortTag; },
        set: function (sortTag) { this.summarySetting.sortTag = sortTag; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryService.prototype, "sortOrder", {
        get: function () { return this.summarySetting.sortOrder; },
        set: function (sortOrder) { this.summarySetting.sortOrder = sortOrder; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryService.prototype, "dataTag", {
        get: function () { return this.summarySetting.dataTag; },
        set: function (dataTag) { this.summarySetting.dataTag = dataTag; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameObjectInventoryService.prototype, "dataTags", {
        get: function () { return this.summarySetting.dataTags; },
        enumerable: true,
        configurable: true
    });
    GameObjectInventoryService.prototype.initialize = function () {
        var _this = this;
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].register(this)
            .on('OPEN_NETWORK', function (event) { _this.refresh(); })
            .on('CONNECT_PEER', function (event) { _this.refresh(); })
            .on('DISCONNECT_PEER', function (event) { _this.refresh(); })
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.get(event.data.identifier);
            if (!object)
                return;
            if (object instanceof _udonarium_game_character__WEBPACK_IMPORTED_MODULE_7__["GameCharacter"]) {
                var prevLocation = _this.locationMap.get(object.identifier);
                if (object.location.name !== prevLocation) {
                    _this.locationMap.set(object.identifier, object.location.name);
                    _this.refresh();
                }
            }
            else if (object instanceof _udonarium_data_element__WEBPACK_IMPORTED_MODULE_5__["DataElement"]) {
                if (!_this.containsInGameCharacter(object))
                    return;
                var prevName = _this.tagNameMap.get(object.identifier);
                if ((_this.dataTags.includes(prevName) || _this.dataTags.includes(object.name)) && object.name !== prevName) {
                    _this.tagNameMap.set(object.identifier, object.name);
                    _this.refreshDataElements();
                }
                if (_this.sortTag === object.name) {
                    _this.refreshSort();
                }
                if (0 < object.children.length) {
                    _this.refreshDataElements();
                    _this.refreshSort();
                }
                _this.callInventoryUpdate();
            }
            else if (object instanceof _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_6__["DataSummarySetting"]) {
                _this.refreshDataElements();
                _this.refreshSort();
                _this.callInventoryUpdate();
            }
        })
            .on('DELETE_GAME_OBJECT', 1000, function (event) {
            _this.locationMap.delete(event.data.identifier);
            _this.tagNameMap.delete(event.data.identifier);
            _this.refresh();
        })
            .on('SYNCHRONIZE_FILE_LIST', function (event) {
            if (event.isSendFromSelf)
                _this.callInventoryUpdate();
        });
    };
    GameObjectInventoryService.prototype.containsInGameCharacter = function (element) {
        var parent = element.parent;
        var aliasName = _udonarium_game_character__WEBPACK_IMPORTED_MODULE_7__["GameCharacter"].aliasName;
        while (parent) {
            if (parent.aliasName === aliasName)
                return true;
            parent = parent.parent;
        }
        return false;
    };
    GameObjectInventoryService.prototype.refresh = function () {
        this.refreshObjects();
        this.refreshDataElements();
        this.refreshSort();
        this.callInventoryUpdate();
    };
    GameObjectInventoryService.prototype.refreshObjects = function () {
        this.tableInventory.refreshObjects();
        this.commonInventory.refreshObjects();
        this.privateInventory.refreshObjects();
        this.graveyardInventory.refreshObjects();
    };
    GameObjectInventoryService.prototype.refreshDataElements = function () {
        this.tableInventory.refreshDataElements();
        this.commonInventory.refreshDataElements();
        this.privateInventory.refreshDataElements();
        this.graveyardInventory.refreshDataElements();
    };
    GameObjectInventoryService.prototype.refreshSort = function () {
        this.tableInventory.refreshSort();
        this.commonInventory.refreshSort();
        this.privateInventory.refreshSort();
        this.graveyardInventory.refreshSort();
    };
    GameObjectInventoryService.prototype.callInventoryUpdate = function () {
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["EventSystem"].trigger('UPDATE_INVENTORY', null);
    };
    GameObjectInventoryService.prototype.isAnyLocation = function (location) {
        var e_1, _a;
        if (location === 'table' || location === _udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerId || location === 'graveyard')
            return true;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](_udonarium_core_system__WEBPACK_IMPORTED_MODULE_3__["Network"].peerContexts), _c = _b.next(); !_c.done; _c = _b.next()) {
                var conn = _c.value;
                if (conn.isOpen && location === conn.fullstring) {
                    return true;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return false;
    };
    GameObjectInventoryService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])({
            providedIn: 'root'
        })
    ], GameObjectInventoryService);
    return GameObjectInventoryService;
}());

var ObjectInventory = /** @class */ (function () {
    function ObjectInventory(classifier) {
        this.classifier = classifier;
        this.newLineString = '/';
        this.newLineDataElement = _udonarium_data_element__WEBPACK_IMPORTED_MODULE_5__["DataElement"].create(this.newLineString);
        this._tabletopObjects = [];
        this._dataElementMap = new Map();
        this.needsRefreshObjects = true;
        this.needsRefreshElements = true;
        this.needsSort = true;
    }
    Object.defineProperty(ObjectInventory.prototype, "summarySetting", {
        get: function () { return _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_6__["DataSummarySetting"].instance; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectInventory.prototype, "sortTag", {
        get: function () { return this.summarySetting.sortTag; },
        set: function (sortTag) { this.summarySetting.sortTag = sortTag; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectInventory.prototype, "sortOrder", {
        get: function () { return this.summarySetting.sortOrder; },
        set: function (sortOrder) { this.summarySetting.sortOrder = sortOrder; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectInventory.prototype, "dataTag", {
        get: function () { return this.summarySetting.dataTag; },
        set: function (dataTag) { this.summarySetting.dataTag = dataTag; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectInventory.prototype, "dataTags", {
        get: function () { return this.summarySetting.dataTags; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectInventory.prototype, "tabletopObjects", {
        get: function () {
            if (this.needsRefreshObjects) {
                this._tabletopObjects = this.searchTabletopObjects();
                this.needsRefreshObjects = false;
            }
            if (this.needsSort) {
                this._tabletopObjects = this.sortTabletopObjects(this._tabletopObjects);
                this.needsSort = false;
            }
            return this._tabletopObjects;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectInventory.prototype, "length", {
        get: function () {
            if (this.needsRefreshObjects) {
                this._tabletopObjects = this.searchTabletopObjects();
                this.needsRefreshObjects = false;
            }
            return this._tabletopObjects.length;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ObjectInventory.prototype, "dataElementMap", {
        get: function () {
            var e_2, _a;
            var _this = this;
            if (this.needsRefreshElements) {
                this._dataElementMap.clear();
                var caches_2 = this.tabletopObjects;
                var _loop_1 = function (object) {
                    if (!object.rootDataElement)
                        return "continue";
                    var elements = this_1.dataTags.map(function (tag) { return tag === _this.newLineString ? _this.newLineDataElement : object.rootDataElement.getFirstElementByName(tag); });
                    this_1._dataElementMap.set(object.identifier, elements);
                };
                var this_1 = this;
                try {
                    for (var caches_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](caches_2), caches_1_1 = caches_1.next(); !caches_1_1.done; caches_1_1 = caches_1.next()) {
                        var object = caches_1_1.value;
                        _loop_1(object);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (caches_1_1 && !caches_1_1.done && (_a = caches_1.return)) _a.call(caches_1);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                this.needsRefreshElements = false;
            }
            return this._dataElementMap;
        },
        enumerable: true,
        configurable: true
    });
    ObjectInventory.prototype.refreshObjects = function () {
        this.needsRefreshObjects = true;
    };
    ObjectInventory.prototype.refreshDataElements = function () {
        this.needsRefreshElements = true;
    };
    ObjectInventory.prototype.refreshSort = function () {
        this.needsSort = true;
    };
    ObjectInventory.prototype.searchTabletopObjects = function () {
        var e_3, _a;
        var objects = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_2__["ObjectStore"].instance.getObjects(_udonarium_game_character__WEBPACK_IMPORTED_MODULE_7__["GameCharacter"]);
        var caches = [];
        try {
            for (var objects_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](objects), objects_1_1 = objects_1.next(); !objects_1_1.done; objects_1_1 = objects_1.next()) {
                var object = objects_1_1.value;
                if (this.classifier(object))
                    caches.push(object);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (objects_1_1 && !objects_1_1.done && (_a = objects_1.return)) _a.call(objects_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return caches;
    };
    ObjectInventory.prototype.sortTabletopObjects = function (objects) {
        var _this = this;
        var sortTag = this.sortTag.length ? this.sortTag.trim() : '';
        var sortOrder = this.sortOrder === 'ASC' ? -1 : 1;
        if (sortTag.length < 1)
            return objects;
        objects.sort(function (a, b) {
            var aElm = a.rootDataElement.getFirstElementByName(sortTag);
            var bElm = b.rootDataElement.getFirstElementByName(sortTag);
            if (!aElm && !bElm)
                return 0;
            if (!bElm)
                return -1;
            if (!aElm)
                return 1;
            var aValue = _this.convertToSortableValue(aElm);
            var bValue = _this.convertToSortableValue(bElm);
            if (aValue < bValue)
                return sortOrder;
            if (aValue > bValue)
                return sortOrder * -1;
            return 0;
        });
        return objects;
    };
    ObjectInventory.prototype.convertToSortableValue = function (dataElement) {
        var value = dataElement.isNumberResource ? dataElement.currentValue : dataElement.value;
        var resultStr = _udonarium_core_system_util_string_util__WEBPACK_IMPORTED_MODULE_4__["StringUtil"].toHalfWidth((value + '').trim());
        var resultNum = +resultStr;
        return Number.isNaN(resultNum) ? resultStr : resultNum;
    };
    return ObjectInventory;
}());


/***/ }),

/***/ "./src/app/service/modal.service.ts":
/*!******************************************!*\
  !*** ./src/app/service/modal.service.ts ***!
  \******************************************/
/*! exports provided: ModalService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModalService", function() { return ModalService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");


/*
thanks
http://qiita.com/Quramy/items/ccfcfa0e45dd9e43f041
http://qiita.com/alclimb/items/1c740a432c10b6dc700a
*/
var ModalContext = /** @class */ (function () {
    function ModalContext(_resolve, _reject, option) {
        this._resolve = _resolve;
        this._reject = _reject;
        this.option = option;
    }
    ModalContext.prototype.resolve = function (value) {
        this._resolve(value);
        this._resolve = null;
    };
    ModalContext.prototype.reject = function (reason) {
        this._reject(reason);
        this._reject = null;
    };
    return ModalContext;
}());
var ModalService = /** @class */ (function () {
    function ModalService(componentFactoryResolver) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.modalContext = null;
        this.count = 0;
        this.title = '無名のモーダル';
    }
    ModalService_1 = ModalService;
    Object.defineProperty(ModalService.prototype, "option", {
        get: function () {
            return this.modalContext ? this.modalContext.option : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ModalService.prototype, "isShow", {
        get: function () {
            return this.count > 0;
        },
        enumerable: true,
        configurable: true
    });
    ModalService.prototype.open = function (childComponent, option, parentViewContainerRef) {
        var _this = this;
        if (!parentViewContainerRef) {
            parentViewContainerRef = ModalService_1.defaultParentViewContainerRef;
        }
        var panelComponentRef;
        return new Promise(function (resolve, reject) {
            // Injector 作成
            var _resolve = function (val) {
                if (panelComponentRef) {
                    panelComponentRef.destroy();
                    resolve(val);
                    _this.count--;
                }
            };
            var _reject = function (reason) {
                if (panelComponentRef) {
                    panelComponentRef.destroy();
                    reject(reason);
                    _this.count--;
                }
            };
            var childModalService = new ModalService_1(_this.componentFactoryResolver);
            childModalService.modalContext = new ModalContext(_resolve, _reject, option);
            var parentInjector = parentViewContainerRef.injector; //parentViewContainerRef.parentInjector;
            var injector = _angular_core__WEBPACK_IMPORTED_MODULE_1__["Injector"].create([{ provide: ModalService_1, useValue: childModalService }], parentInjector);
            var panelComponentFactory = _this.componentFactoryResolver.resolveComponentFactory(ModalService_1.ModalComponentClass);
            var bodyComponentFactory = _this.componentFactoryResolver.resolveComponentFactory(childComponent);
            panelComponentRef = parentViewContainerRef.createComponent(panelComponentFactory, parentViewContainerRef.length, injector);
            panelComponentRef.instance.content.createComponent(bodyComponentFactory);
            panelComponentRef.onDestroy(function () {
                _this.count--;
            });
            _this.count++;
        });
    };
    ModalService.prototype.resolve = function (value) {
        if (this.modalContext) {
            this.modalContext.resolve(value);
            this.modalContext = null;
        }
    };
    ModalService.prototype.reject = function (reason) {
        if (this.modalContext) {
            this.modalContext.reject(reason);
            this.modalContext = null;
        }
    };
    var ModalService_1;
    ModalService.ModalComponentClass = null;
    ModalService.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ComponentFactoryResolver"] }
    ]; };
    ModalService = ModalService_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], ModalService);
    return ModalService;
}());



/***/ }),

/***/ "./src/app/service/panel.service.ts":
/*!******************************************!*\
  !*** ./src/app/service/panel.service.ts ***!
  \******************************************/
/*! exports provided: PanelService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PanelService", function() { return PanelService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");


var PanelService = /** @class */ (function () {
    function PanelService(componentFactoryResolver) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.title = '無名のパネル';
        this.left = 0;
        this.top = 0;
        this.width = 100;
        this.height = 100;
        this.scrollablePanel = null;
    }
    PanelService_1 = PanelService;
    Object.defineProperty(PanelService.prototype, "isShow", {
        get: function () {
            return this.panelComponentRef ? true : false;
        },
        enumerable: true,
        configurable: true
    });
    PanelService.prototype.open = function (childComponent, option, parentViewContainerRef) {
        if (!parentViewContainerRef) {
            parentViewContainerRef = PanelService_1.defaultParentViewContainerRef;
        }
        var panelComponentRef;
        var injector = parentViewContainerRef.injector;
        var panelComponentFactory = this.componentFactoryResolver.resolveComponentFactory(PanelService_1.UIPanelComponentClass);
        var bodyComponentFactory = this.componentFactoryResolver.resolveComponentFactory(childComponent);
        panelComponentRef = parentViewContainerRef.createComponent(panelComponentFactory, parentViewContainerRef.length, injector);
        var bodyComponentRef = panelComponentRef.instance.content.createComponent(bodyComponentFactory);
        var childPanelService = panelComponentRef.injector.get(PanelService_1);
        childPanelService.panelComponentRef = panelComponentRef;
        if (option) {
            if (option.title)
                childPanelService.title = option.title;
            if (option.top)
                childPanelService.top = option.top;
            if (option.left)
                childPanelService.left = option.left;
            if (option.width)
                childPanelService.width = option.width;
            if (option.height)
                childPanelService.height = option.height;
        }
        panelComponentRef.onDestroy(function () {
            childPanelService.panelComponentRef = null;
        });
        return bodyComponentRef.instance;
    };
    PanelService.prototype.close = function () {
        if (this.panelComponentRef) {
            this.panelComponentRef.destroy();
            this.panelComponentRef = null;
        }
    };
    var PanelService_1;
    PanelService.UIPanelComponentClass = null;
    PanelService.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ComponentFactoryResolver"] }
    ]; };
    PanelService = PanelService_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], PanelService);
    return PanelService;
}());



/***/ }),

/***/ "./src/app/service/pointer-device.service.ts":
/*!***************************************************!*\
  !*** ./src/app/service/pointer-device.service.ts ***!
  \***************************************************/
/*! exports provided: PointerDeviceService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PointerDeviceService", function() { return PointerDeviceService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_transform_transform__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/transform/transform */ "./src/app/class/transform/transform.ts");



var MOUSE_IDENTIFIER = -9999;
var PointerDeviceService = /** @class */ (function () {
    function PointerDeviceService(ngZone) {
        var _this = this;
        this.ngZone = ngZone;
        this.callbackOnPointerDown = function (e) { return _this.onPointerDown(e); };
        this.callbackOnPointerMove = function (e) { return _this.onPointerMove(e); };
        this.callbackOnPointerUp = function (e) { return _this.onPointerUp(e); };
        this.callbackOnContextMenu = function (e) { return _this.onContextMenu(e); };
        this._isAllowedToOpenContextMenu = false;
        this.pointers = [{ x: 0, y: 0, z: 0, identifier: -1 }];
        this.startPostion = this.pointers[0];
        this.primaryPointer = this.pointers[0];
        this.isDragging = false; // todo
    }
    Object.defineProperty(PointerDeviceService.prototype, "isAllowedToOpenContextMenu", {
        get: function () { return this._isAllowedToOpenContextMenu; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PointerDeviceService.prototype, "pointer", {
        get: function () { return this.primaryPointer; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PointerDeviceService.prototype, "pointerX", {
        get: function () { return this.primaryPointer.x; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PointerDeviceService.prototype, "pointerY", {
        get: function () { return this.primaryPointer.y; },
        enumerable: true,
        configurable: true
    });
    PointerDeviceService.prototype.initialize = function () {
        this.addEventListeners();
    };
    PointerDeviceService.prototype.destroy = function () {
        this.removeEventListeners();
    };
    PointerDeviceService.prototype.onPointerDown = function (e) {
        this.onPointerMove(e);
        this._isAllowedToOpenContextMenu = true;
        this.startPostion = this.pointers[0];
    };
    PointerDeviceService.prototype.onPointerMove = function (e) {
        if (e.touches) {
            this.onTouchMove(e);
        }
        else {
            this.onMouseMove(e);
        }
        this.targetElement = e.target;
    };
    PointerDeviceService.prototype.onPointerUp = function (e) {
        this.onPointerMove(e);
    };
    PointerDeviceService.prototype.onMouseMove = function (e) {
        var mosuePointer = { x: e.pageX, y: e.pageY, z: 0, identifier: MOUSE_IDENTIFIER };
        if (this.isSyntheticEvent(mosuePointer))
            return;
        if (this._isAllowedToOpenContextMenu)
            this.preventContextMenuIfNeeded(mosuePointer);
        this.pointers = [mosuePointer];
        this.primaryPointer = mosuePointer;
    };
    PointerDeviceService.prototype.onTouchMove = function (e) {
        var length = e.touches.length;
        if (length < 1)
            return;
        this.pointers = [];
        for (var i = 0; i < length; i++) {
            var touch = e.touches[i];
            var touchPointer = { x: touch.pageX, y: touch.pageY, z: 0, identifier: touch.identifier };
            if (this._isAllowedToOpenContextMenu)
                this.preventContextMenuIfNeeded(touchPointer);
            this.pointers.push(touchPointer);
        }
        this.primaryPointer = this.pointers[0];
    };
    PointerDeviceService.prototype.onContextMenu = function (e) {
        this._isAllowedToOpenContextMenu = true;
        this.onPointerUp(e);
    };
    PointerDeviceService.prototype.preventContextMenuIfNeeded = function (pointer, threshold) {
        if (threshold === void 0) { threshold = 3; }
        var distance = Math.pow((pointer.x - this.startPostion.x), 2) + Math.pow((pointer.y - this.startPostion.y), 2);
        if (Math.pow(threshold, 2) < distance)
            this._isAllowedToOpenContextMenu = false;
    };
    PointerDeviceService.prototype.isSyntheticEvent = function (mosuePointer, threshold) {
        var e_1, _a;
        if (threshold === void 0) { threshold = 15; }
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](this.pointers), _c = _b.next(); !_c.done; _c = _b.next()) {
                var pointer = _c.value;
                if (pointer.identifier === mosuePointer.identifier)
                    continue;
                var distance = Math.pow((mosuePointer.x - pointer.x), 2) + Math.pow((mosuePointer.y - pointer.y), 2);
                if (distance < Math.pow(threshold, 2))
                    return true;
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return false;
    };
    PointerDeviceService.prototype.addEventListeners = function () {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            document.body.addEventListener('mousedown', _this.callbackOnPointerDown, true);
            document.body.addEventListener('mousemove', _this.callbackOnPointerMove, true);
            document.body.addEventListener('mouseup', _this.callbackOnPointerUp, true);
            document.body.addEventListener('touchstart', _this.callbackOnPointerDown, true);
            document.body.addEventListener('touchmove', _this.callbackOnPointerMove, true);
            document.body.addEventListener('touchend', _this.callbackOnPointerUp, true);
            document.body.addEventListener('touchcancel', _this.callbackOnPointerUp, true);
            document.body.addEventListener('drop', _this.callbackOnPointerUp, true);
            document.body.addEventListener('contextmenu', _this.callbackOnContextMenu, true);
        });
    };
    PointerDeviceService.prototype.removeEventListeners = function () {
        document.body.removeEventListener('mousedown', this.callbackOnPointerDown, true);
        document.body.removeEventListener('mousemove', this.callbackOnPointerMove, true);
        document.body.removeEventListener('mouseup', this.callbackOnPointerUp, true);
        document.body.removeEventListener('touchstart', this.callbackOnPointerDown, true);
        document.body.removeEventListener('touchmove', this.callbackOnPointerMove, true);
        document.body.removeEventListener('touchend', this.callbackOnPointerUp, true);
        document.body.removeEventListener('touchcancel', this.callbackOnPointerUp, true);
        document.body.removeEventListener('drop', this.callbackOnPointerUp, true);
        document.body.removeEventListener('contextmenu', this.callbackOnContextMenu, true);
    };
    PointerDeviceService.convertToLocal = function (pointer, element) {
        if (element === void 0) { element = document.body; }
        var transformer = new _udonarium_transform_transform__WEBPACK_IMPORTED_MODULE_2__["Transform"](element);
        var ray = transformer.globalToLocal(pointer.x, pointer.y, pointer.z ? pointer.z : 0);
        transformer.clear();
        return { x: ray.x, y: ray.y, z: ray.z };
    };
    PointerDeviceService.convertToGlobal = function (pointer, element) {
        if (element === void 0) { element = document.body; }
        var transformer = new _udonarium_transform_transform__WEBPACK_IMPORTED_MODULE_2__["Transform"](element);
        var ray = transformer.localToGlobal(pointer.x, pointer.y, pointer.z ? pointer.z : 0);
        transformer.clear();
        return { x: ray.x, y: ray.y, z: ray.z };
    };
    PointerDeviceService.convertLocalToLocal = function (pointer, from, to) {
        var transformer = new _udonarium_transform_transform__WEBPACK_IMPORTED_MODULE_2__["Transform"](from);
        var local = transformer.globalToLocal(pointer.x, pointer.y, pointer.z ? pointer.z : 0);
        var ray = transformer.localToLocal(local.x, local.y, 0, to);
        transformer.clear();
        return { x: ray.x, y: ray.y, z: ray.z };
    };
    PointerDeviceService.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] }
    ]; };
    PointerDeviceService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])({
            providedIn: 'root'
        })
    ], PointerDeviceService);
    return PointerDeviceService;
}());



/***/ }),

/***/ "./src/app/service/save-data.service.ts":
/*!**********************************************!*\
  !*** ./src/app/service/save-data.service.ts ***!
  \**********************************************/
/*! exports provided: SaveDataService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SaveDataService", function() { return SaveDataService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_chat_tab_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/chat-tab-list */ "./src/app/class/chat-tab-list.ts");
/* harmony import */ var _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/core/file-storage/file-archiver */ "./src/app/class/core/file-storage/file-archiver.ts");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _udonarium_core_file_storage_mime_type__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/file-storage/mime-type */ "./src/app/class/core/file-storage/mime-type.ts");
/* harmony import */ var _udonarium_core_system_util_xml_util__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/core/system/util/xml-util */ "./src/app/class/core/system/util/xml-util.ts");
/* harmony import */ var _udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @udonarium/data-summary-setting */ "./src/app/class/data-summary-setting.ts");
/* harmony import */ var _udonarium_room__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @udonarium/room */ "./src/app/class/room.ts");
/* harmony import */ var vkbeautify__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! vkbeautify */ "./node_modules/vkbeautify/index.js");
/* harmony import */ var vkbeautify__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(vkbeautify__WEBPACK_IMPORTED_MODULE_10__);











var SaveDataService = /** @class */ (function () {
    function SaveDataService() {
    }
    SaveDataService.prototype.saveRoom = function (fileName) {
        if (fileName === void 0) { fileName = 'ルームデータ'; }
        var files = [];
        var roomXml = this.convertToXml(new _udonarium_room__WEBPACK_IMPORTED_MODULE_9__["Room"]());
        var chatXml = this.convertToXml(new _udonarium_chat_tab_list__WEBPACK_IMPORTED_MODULE_2__["ChatTabList"]());
        var summarySetting = this.convertToXml(_udonarium_data_summary_setting__WEBPACK_IMPORTED_MODULE_8__["DataSummarySetting"].instance);
        files.push(new File([roomXml], 'data.xml', { type: 'text/plain' }));
        files.push(new File([chatXml], 'chat.xml', { type: 'text/plain' }));
        files.push(new File([summarySetting], 'summary.xml', { type: 'text/plain' }));
        files = files.concat(this.searchImageFiles(roomXml));
        files = files.concat(this.searchImageFiles(chatXml));
        _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_3__["FileArchiver"].instance.save(files, fileName);
    };
    SaveDataService.prototype.saveGameObject = function (gameObject, fileName) {
        if (fileName === void 0) { fileName = 'xml_data'; }
        var files = [];
        var xml = this.convertToXml(gameObject);
        files.push(new File([xml], 'data.xml', { type: 'text/plain' }));
        files = files.concat(this.searchImageFiles(xml));
        _udonarium_core_file_storage_file_archiver__WEBPACK_IMPORTED_MODULE_3__["FileArchiver"].instance.save(files, fileName);
    };
    SaveDataService.prototype.convertToXml = function (gameObject) {
        var xmlDeclaration = '<?xml version="1.0" encoding="UTF-8"?>';
        return xmlDeclaration + '\n' + vkbeautify__WEBPACK_IMPORTED_MODULE_10__["xml"](gameObject.toXml(), 2);
    };
    SaveDataService.prototype.searchImageFiles = function (xml) {
        var xmlElement = _udonarium_core_system_util_xml_util__WEBPACK_IMPORTED_MODULE_7__["XmlUtil"].xml2element(xml);
        var files = [];
        if (!xmlElement)
            return files;
        var images = {};
        var imageElements = xmlElement.ownerDocument.querySelectorAll('*[type="image"]');
        for (var i = 0; i < imageElements.length; i++) {
            var identifier = imageElements[i].innerHTML;
            images[identifier] = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.get(identifier);
        }
        imageElements = xmlElement.ownerDocument.querySelectorAll('*[imageIdentifier], *[backgroundImageIdentifier]');
        for (var i = 0; i < imageElements.length; i++) {
            var identifier = imageElements[i].getAttribute('imageIdentifier');
            if (identifier)
                images[identifier] = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.get(identifier);
            var backgroundImageIdentifier = imageElements[i].getAttribute('backgroundImageIdentifier');
            if (backgroundImageIdentifier)
                images[backgroundImageIdentifier] = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.get(backgroundImageIdentifier);
        }
        for (var identifier in images) {
            var image = images[identifier];
            if (image && image.state === _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__["ImageState"].COMPLETE) {
                files.push(new File([image.blob], image.identifier + '.' + _udonarium_core_file_storage_mime_type__WEBPACK_IMPORTED_MODULE_6__["MimeType"].extension(image.blob.type), { type: image.blob.type }));
            }
        }
        return files;
    };
    SaveDataService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])({
            providedIn: 'root'
        })
    ], SaveDataService);
    return SaveDataService;
}());



/***/ }),

/***/ "./src/app/service/tabletop.service.ts":
/*!*********************************************!*\
  !*** ./src/app/service/tabletop.service.ts ***!
  \*********************************************/
/*! exports provided: TabletopService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TabletopService", function() { return TabletopService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _udonarium_card__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @udonarium/card */ "./src/app/class/card.ts");
/* harmony import */ var _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @udonarium/card-stack */ "./src/app/class/card-stack.ts");
/* harmony import */ var _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @udonarium/core/file-storage/image-file */ "./src/app/class/core/file-storage/image-file.ts");
/* harmony import */ var _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @udonarium/core/file-storage/image-storage */ "./src/app/class/core/file-storage/image-storage.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-serializer */ "./src/app/class/core/synchronize-object/object-serializer.ts");
/* harmony import */ var _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @udonarium/core/synchronize-object/object-store */ "./src/app/class/core/synchronize-object/object-store.ts");
/* harmony import */ var _udonarium_core_system__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @udonarium/core/system */ "./src/app/class/core/system/index.ts");
/* harmony import */ var _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @udonarium/dice-symbol */ "./src/app/class/dice-symbol.ts");
/* harmony import */ var _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @udonarium/game-character */ "./src/app/class/game-character.ts");
/* harmony import */ var _udonarium_game_table__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @udonarium/game-table */ "./src/app/class/game-table.ts");
/* harmony import */ var _udonarium_game_table_mask__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @udonarium/game-table-mask */ "./src/app/class/game-table-mask.ts");
/* harmony import */ var _udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @udonarium/peer-cursor */ "./src/app/class/peer-cursor.ts");
/* harmony import */ var _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @udonarium/sound-effect */ "./src/app/class/sound-effect.ts");
/* harmony import */ var _udonarium_table_selecter__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @udonarium/table-selecter */ "./src/app/class/table-selecter.ts");
/* harmony import */ var _udonarium_tabletop_object__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @udonarium/tabletop-object */ "./src/app/class/tabletop-object.ts");
/* harmony import */ var _udonarium_terrain__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @udonarium/terrain */ "./src/app/class/terrain.ts");
/* harmony import */ var _udonarium_text_note__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @udonarium/text-note */ "./src/app/class/text-note.ts");
/* harmony import */ var _pointer_device_service__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./pointer-device.service */ "./src/app/service/pointer-device.service.ts");




















var TabletopService = /** @class */ (function () {
    function TabletopService(ngZone, pointerDeviceService) {
        var _this = this;
        this.ngZone = ngZone;
        this.pointerDeviceService = pointerDeviceService;
        this.dragAreaElement = document.body;
        this.batchTask = new Map();
        this.batchTaskTimer = null;
        this._emptyTable = new _udonarium_game_table__WEBPACK_IMPORTED_MODULE_11__["GameTable"]('');
        this.locationMap = new Map();
        this.parentMap = new Map();
        this.characterCache = new TabletopCache(function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.getObjects(_udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"]).filter(function (obj) { return obj.isVisibleOnTable; }); });
        this.cardCache = new TabletopCache(function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.getObjects(_udonarium_card__WEBPACK_IMPORTED_MODULE_2__["Card"]).filter(function (obj) { return obj.isVisibleOnTable; }); });
        this.cardStackCache = new TabletopCache(function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.getObjects(_udonarium_card_stack__WEBPACK_IMPORTED_MODULE_3__["CardStack"]).filter(function (obj) { return obj.isVisibleOnTable; }); });
        this.tableMaskCache = new TabletopCache(function () {
            var viewTable = _this.tableSelecter.viewTable;
            return viewTable ? viewTable.masks : [];
        });
        this.terrainCache = new TabletopCache(function () {
            var viewTable = _this.tableSelecter.viewTable;
            return viewTable ? viewTable.terrains : [];
        });
        this.textNoteCache = new TabletopCache(function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.getObjects(_udonarium_text_note__WEBPACK_IMPORTED_MODULE_18__["TextNote"]); });
        this.diceSymbolCache = new TabletopCache(function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.getObjects(_udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceSymbol"]); });
        this.initialize();
    }
    Object.defineProperty(TabletopService.prototype, "tableSelecter", {
        get: function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.get('tableSelecter'); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "currentTable", {
        get: function () {
            var table = this.tableSelecter.viewTable;
            return table ? table : this._emptyTable;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "characters", {
        get: function () { return this.characterCache.objects; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "cards", {
        get: function () { return this.cardCache.objects; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "cardStacks", {
        get: function () { return this.cardStackCache.objects; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "tableMasks", {
        get: function () { return this.tableMaskCache.objects; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "terrains", {
        get: function () { return this.terrainCache.objects; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "textNotes", {
        get: function () { return this.textNoteCache.objects; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "diceSymbols", {
        get: function () { return this.diceSymbolCache.objects; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabletopService.prototype, "peerCursors", {
        get: function () { return _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.getObjects(_udonarium_peer_cursor__WEBPACK_IMPORTED_MODULE_13__["PeerCursor"]); },
        enumerable: true,
        configurable: true
    });
    TabletopService.prototype.initialize = function () {
        var _this = this;
        this.refreshCacheAll();
        _udonarium_core_system__WEBPACK_IMPORTED_MODULE_8__["EventSystem"].register(this)
            .on('UPDATE_GAME_OBJECT', -1000, function (event) {
            if (event.data.identifier === _this.currentTable.identifier || event.data.identifier === _this.tableSelecter.identifier) {
                _this.refreshCache(_udonarium_game_table_mask__WEBPACK_IMPORTED_MODULE_12__["GameTableMask"].aliasName);
                _this.refreshCache(_udonarium_terrain__WEBPACK_IMPORTED_MODULE_17__["Terrain"].aliasName);
                return;
            }
            var object = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.get(event.data.identifier);
            if (!object || !(object instanceof _udonarium_tabletop_object__WEBPACK_IMPORTED_MODULE_16__["TabletopObject"])) {
                _this.refreshCache(event.data.aliasName);
            }
            else if (_this.shouldRefreshCache(object)) {
                _this.refreshCache(event.data.aliasName);
                _this.updateMap(object);
            }
        })
            .on('DELETE_GAME_OBJECT', -1000, function (event) {
            var garbage = _udonarium_core_synchronize_object_object_store__WEBPACK_IMPORTED_MODULE_7__["ObjectStore"].instance.get(event.data.identifier);
            if (garbage == null || garbage.aliasName.length < 1) {
                _this.refreshCacheAll();
            }
            else {
                _this.refreshCache(garbage.aliasName);
            }
        })
            .on('XML_LOADED', function (event) {
            var xmlElement = event.data.xmlElement;
            // todo:立体地形の上にドロップした時の挙動
            var gameObject = _udonarium_core_synchronize_object_object_serializer__WEBPACK_IMPORTED_MODULE_6__["ObjectSerializer"].instance.parseXml(xmlElement);
            if (gameObject instanceof _udonarium_tabletop_object__WEBPACK_IMPORTED_MODULE_16__["TabletopObject"]) {
                var pointer = _this.calcTabletopLocalCoordinate();
                gameObject.location.x = pointer.x - 25;
                gameObject.location.y = pointer.y - 25;
                gameObject.posZ = pointer.z;
                _this.placeToTabletop(gameObject);
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["PresetSound"].piecePut);
            }
        });
    };
    TabletopService.prototype.addBatch = function (task, key) {
        var _this = this;
        if (key === void 0) { key = {}; }
        this.batchTask.set(key, task);
        if (this.batchTaskTimer != null)
            return;
        this.execBatch();
        this.batchTaskTimer = setInterval(function () {
            if (0 < _this.batchTask.size) {
                _this.execBatch();
            }
            else {
                clearInterval(_this.batchTaskTimer);
                _this.batchTaskTimer = null;
            }
        }, 66);
    };
    TabletopService.prototype.removeBatch = function (key) {
        if (key === void 0) { key = {}; }
        this.batchTask.delete(key);
    };
    TabletopService.prototype.execBatch = function () {
        this.batchTask.forEach(function (task) { return task(); });
        this.batchTask.clear();
    };
    TabletopService.prototype.findCache = function (aliasName) {
        switch (aliasName) {
            case _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"].aliasName:
                return this.characterCache;
            case _udonarium_card__WEBPACK_IMPORTED_MODULE_2__["Card"].aliasName:
                return this.cardCache;
            case _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_3__["CardStack"].aliasName:
                return this.cardStackCache;
            case _udonarium_game_table_mask__WEBPACK_IMPORTED_MODULE_12__["GameTableMask"].aliasName:
                return this.tableMaskCache;
            case _udonarium_terrain__WEBPACK_IMPORTED_MODULE_17__["Terrain"].aliasName:
                return this.terrainCache;
            case _udonarium_text_note__WEBPACK_IMPORTED_MODULE_18__["TextNote"].aliasName:
                return this.textNoteCache;
            case _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceSymbol"].aliasName:
                return this.diceSymbolCache;
            default:
                return null;
        }
    };
    TabletopService.prototype.refreshCache = function (aliasName) {
        var cache = this.findCache(aliasName);
        if (cache)
            cache.refresh();
    };
    TabletopService.prototype.refreshCacheAll = function () {
        this.characterCache.refresh();
        this.cardCache.refresh();
        this.cardStackCache.refresh();
        this.tableMaskCache.refresh();
        this.terrainCache.refresh();
        this.textNoteCache.refresh();
        this.diceSymbolCache.refresh();
        this.clearMap();
    };
    TabletopService.prototype.shouldRefreshCache = function (object) {
        return this.locationMap.get(object.identifier) !== object.location.name || this.parentMap.get(object.identifier) !== object.parentId;
    };
    TabletopService.prototype.updateMap = function (object) {
        this.locationMap.set(object.identifier, object.location.name);
        this.parentMap.set(object.identifier, object.parentId);
    };
    TabletopService.prototype.clearMap = function () {
        this.locationMap.clear();
        this.parentMap.clear();
    };
    TabletopService.prototype.placeToTabletop = function (gameObject) {
        switch (gameObject.aliasName) {
            case _udonarium_game_table_mask__WEBPACK_IMPORTED_MODULE_12__["GameTableMask"].aliasName:
                if (gameObject instanceof _udonarium_game_table_mask__WEBPACK_IMPORTED_MODULE_12__["GameTableMask"])
                    gameObject.isLock = false;
            case _udonarium_terrain__WEBPACK_IMPORTED_MODULE_17__["Terrain"].aliasName:
                if (gameObject instanceof _udonarium_terrain__WEBPACK_IMPORTED_MODULE_17__["Terrain"])
                    gameObject.isLocked = false;
                if (!this.tableSelecter || !this.tableSelecter.viewTable)
                    return;
                this.tableSelecter.viewTable.appendChild(gameObject);
                break;
            default:
                gameObject.setLocation('table');
                break;
        }
    };
    TabletopService.prototype.calcTabletopLocalCoordinate = function (x, y, target) {
        if (x === void 0) { x = this.pointerDeviceService.pointers[0].x; }
        if (y === void 0) { y = this.pointerDeviceService.pointers[0].y; }
        if (target === void 0) { target = this.pointerDeviceService.targetElement; }
        var coordinate = { x: x, y: y, z: 0 };
        if (target.contains(this.dragAreaElement)) {
            coordinate = _pointer_device_service__WEBPACK_IMPORTED_MODULE_19__["PointerDeviceService"].convertToLocal(coordinate, this.dragAreaElement);
            coordinate.z = 0;
        }
        else {
            coordinate = _pointer_device_service__WEBPACK_IMPORTED_MODULE_19__["PointerDeviceService"].convertLocalToLocal(coordinate, target, this.dragAreaElement);
        }
        return { x: coordinate.x, y: coordinate.y, z: 0 < coordinate.z ? coordinate.z : 0 };
    };
    TabletopService.prototype.createGameCharacter = function (position) {
        var character = _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"].create('新しいキャラクター', 1, '');
        character.location.x = position.x - 25;
        character.location.y = position.y - 25;
        character.posZ = position.z;
        return character;
    };
    TabletopService.prototype.createGameTableMask = function (position) {
        var viewTable = this.tableSelecter.viewTable;
        if (!viewTable)
            return;
        var tableMask = _udonarium_game_table_mask__WEBPACK_IMPORTED_MODULE_12__["GameTableMask"].create('マップマスク', 5, 5, 100);
        tableMask.location.x = position.x - 25;
        tableMask.location.y = position.y - 25;
        tableMask.posZ = position.z;
        viewTable.appendChild(tableMask);
        return tableMask;
    };
    TabletopService.prototype.createTerrain = function (position) {
        var url = './assets/images/tex.jpg';
        var image = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.get(url);
        if (!image)
            image = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(url);
        var viewTable = this.tableSelecter.viewTable;
        if (!viewTable)
            return;
        var terrain = _udonarium_terrain__WEBPACK_IMPORTED_MODULE_17__["Terrain"].create('地形', 2, 2, 2, image.identifier, image.identifier);
        terrain.location.x = position.x - 50;
        terrain.location.y = position.y - 50;
        terrain.posZ = position.z;
        viewTable.appendChild(terrain);
        return terrain;
    };
    TabletopService.prototype.createTextNote = function (position) {
        var textNote = _udonarium_text_note__WEBPACK_IMPORTED_MODULE_18__["TextNote"].create('共有メモ', 'テキストを入力してください', 5, 4, 3);
        textNote.location.x = position.x;
        textNote.location.y = position.y;
        textNote.posZ = position.z;
        return textNote;
    };
    TabletopService.prototype.createDiceSymbol = function (position, name, diceType, imagePathPrefix) {
        var diceSymbol = _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceSymbol"].create(name, diceType, 1);
        var image = null;
        diceSymbol.faces.forEach(function (face) {
            var url = "./assets/images/dice/" + imagePathPrefix + "/" + imagePathPrefix + "[" + face + "].png";
            image = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.get(url);
            if (!image) {
                image = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(url);
            }
            diceSymbol.imageDataElement.getFirstElementByName(face).value = image.identifier;
        });
        diceSymbol.location.x = position.x - 25;
        diceSymbol.location.y = position.y - 25;
        diceSymbol.posZ = position.z;
        return diceSymbol;
    };
    TabletopService.prototype.createTrump = function (position) {
        var e_1, _a;
        var cardStack = _udonarium_card_stack__WEBPACK_IMPORTED_MODULE_3__["CardStack"].create('トランプ山札');
        cardStack.location.x = position.x - 25;
        cardStack.location.y = position.y - 25;
        cardStack.posZ = position.z;
        var back = './assets/images/trump/z02.gif';
        if (!_udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.get(back)) {
            _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(back);
        }
        var names = ['c', 'd', 'h', 's'];
        try {
            for (var names_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](names), names_1_1 = names_1.next(); !names_1_1.done; names_1_1 = names_1.next()) {
                var name_1 = names_1_1.value;
                for (var i = 1; i <= 13; i++) {
                    var trump = name_1 + (('00' + i).slice(-2));
                    var url = './assets/images/trump/' + trump + '.gif';
                    if (!_udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.get(url)) {
                        _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(url);
                    }
                    var card = _udonarium_card__WEBPACK_IMPORTED_MODULE_2__["Card"].create('カード', url, back);
                    cardStack.putOnBottom(card);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (names_1_1 && !names_1_1.done && (_a = names_1.return)) _a.call(names_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        for (var i = 1; i <= 2; i++) {
            var trump = 'x' + (('00' + i).slice(-2));
            var url = './assets/images/trump/' + trump + '.gif';
            if (!_udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.get(url)) {
                _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(url);
            }
            var card = _udonarium_card__WEBPACK_IMPORTED_MODULE_2__["Card"].create('カード', url, back);
            cardStack.putOnBottom(card);
        }
        return cardStack;
    };
    TabletopService.prototype.makeDefaultTable = function () {
        var tableSelecter = new _udonarium_table_selecter__WEBPACK_IMPORTED_MODULE_15__["TableSelecter"]('tableSelecter');
        tableSelecter.initialize();
        var gameTable = new _udonarium_game_table__WEBPACK_IMPORTED_MODULE_11__["GameTable"]('gameTable');
        var testBgFile = null;
        var bgFileContext = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__["ImageFile"].createEmpty('testTableBackgroundImage_image').toContext();
        bgFileContext.url = './assets/images/BG10a_80.jpg';
        testBgFile = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(bgFileContext);
        //let testDistanceFile: ImageFile = null;
        //let distanceFileContext = ImageFile.createEmpty('testTableDistanceviewImage_image').toContext();
        //distanceFileContext.url = './assets/images/BG00a1_80.jpg';
        //testDistanceFile = ImageStorage.instance.add(distanceFileContext);
        gameTable.name = '最初のテーブル';
        gameTable.imageIdentifier = testBgFile.identifier;
        //gameTable.backgroundImageIdentifier = testDistanceFile.identifier;
        gameTable.width = 20;
        gameTable.height = 15;
        gameTable.initialize();
        tableSelecter.viewTableIdentifier = gameTable.identifier;
    };
    TabletopService.prototype.makeDefaultTabletopObjects = function () {
        var testCharacter = null;
        var testFile = null;
        var fileContext = null;
        testCharacter = new _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"]('testCharacter_1');
        fileContext = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__["ImageFile"].createEmpty('testCharacter_1_image').toContext();
        fileContext.url = './assets/images/mon_052.gif';
        testFile = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(fileContext);
        testCharacter.location.x = 5 * 50;
        testCharacter.location.y = 9 * 50;
        testCharacter.initialize();
        testCharacter.createTestGameDataElement('モンスターA', 1, testFile.identifier);
        testCharacter = new _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"]('testCharacter_2');
        testCharacter.location.x = 8 * 50;
        testCharacter.location.y = 8 * 50;
        testCharacter.initialize();
        testCharacter.createTestGameDataElement('モンスターB', 1, testFile.identifier);
        testCharacter = new _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"]('testCharacter_3');
        fileContext = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__["ImageFile"].createEmpty('testCharacter_3_image').toContext();
        fileContext.url = './assets/images/mon_128.gif';
        testFile = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(fileContext);
        testCharacter.location.x = 4 * 50;
        testCharacter.location.y = 2 * 50;
        testCharacter.initialize();
        testCharacter.createTestGameDataElement('モンスターC', 3, testFile.identifier);
        testCharacter = new _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"]('testCharacter_4');
        fileContext = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__["ImageFile"].createEmpty('testCharacter_4_image').toContext();
        fileContext.url = './assets/images/mon_150.gif';
        testFile = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(fileContext);
        testCharacter.location.x = 6 * 50;
        testCharacter.location.y = 11 * 50;
        testCharacter.initialize();
        testCharacter.createTestGameDataElement('キャラクターA', 1, testFile.identifier);
        testCharacter = new _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"]('testCharacter_5');
        fileContext = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__["ImageFile"].createEmpty('testCharacter_5_image').toContext();
        fileContext.url = './assets/images/mon_211.gif';
        testFile = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(fileContext);
        testCharacter.location.x = 12 * 50;
        testCharacter.location.y = 12 * 50;
        testCharacter.initialize();
        testCharacter.createTestGameDataElement('キャラクターB', 1, testFile.identifier);
        testCharacter = new _udonarium_game_character__WEBPACK_IMPORTED_MODULE_10__["GameCharacter"]('testCharacter_6');
        fileContext = _udonarium_core_file_storage_image_file__WEBPACK_IMPORTED_MODULE_4__["ImageFile"].createEmpty('testCharacter_6_image').toContext();
        fileContext.url = './assets/images/mon_135.gif';
        testFile = _udonarium_core_file_storage_image_storage__WEBPACK_IMPORTED_MODULE_5__["ImageStorage"].instance.add(fileContext);
        testCharacter.initialize();
        testCharacter.location.x = 5 * 50;
        testCharacter.location.y = 13 * 50;
        testCharacter.createTestGameDataElement('キャラクターC', 1, testFile.identifier);
    };
    TabletopService.prototype.getContextMenuActionsForCreateObject = function (position) {
        return [
            this.getCreateCharacterMenu(position),
            this.getCreateTableMaskMenu(position),
            this.getCreateTerrainMenu(position),
            this.getCreateTextNoteMenu(position),
            this.getCreateTrumpMenu(position),
            this.getCreateDiceSymbolMenu(position),
        ];
    };
    TabletopService.prototype.getCreateCharacterMenu = function (position) {
        var _this = this;
        return {
            name: 'キャラクターを作成', action: function () {
                var character = _this.createGameCharacter(position);
                _udonarium_core_system__WEBPACK_IMPORTED_MODULE_8__["EventSystem"].trigger('SELECT_TABLETOP_OBJECT', { identifier: character.identifier, className: character.aliasName });
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["PresetSound"].piecePut);
            }
        };
    };
    TabletopService.prototype.getCreateTableMaskMenu = function (position) {
        var _this = this;
        return {
            name: 'マップマスクを作成', action: function () {
                _this.createGameTableMask(position);
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["PresetSound"].cardPut);
            }
        };
    };
    TabletopService.prototype.getCreateTerrainMenu = function (position) {
        var _this = this;
        return {
            name: '地形を作成', action: function () {
                _this.createTerrain(position);
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["PresetSound"].blockPut);
            }
        };
    };
    TabletopService.prototype.getCreateTextNoteMenu = function (position) {
        var _this = this;
        return {
            name: '共有メモを作成', action: function () {
                _this.createTextNote(position);
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["PresetSound"].cardPut);
            }
        };
    };
    TabletopService.prototype.getCreateTrumpMenu = function (position) {
        var _this = this;
        return {
            name: 'トランプの山札を作成', action: function () {
                _this.createTrump(position);
                _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["PresetSound"].cardPut);
            }
        };
    };
    TabletopService.prototype.getCreateDiceSymbolMenu = function (position) {
        var _this = this;
        var dices = [
            { menuName: 'D4', diceName: 'D4', type: _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceType"].D4, imagePathPrefix: '4_dice' },
            { menuName: 'D6', diceName: 'D6', type: _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceType"].D6, imagePathPrefix: '6_dice' },
            { menuName: 'D8', diceName: 'D8', type: _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceType"].D8, imagePathPrefix: '8_dice' },
            { menuName: 'D10', diceName: 'D10', type: _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceType"].D10, imagePathPrefix: '10_dice' },
            { menuName: 'D10 (00-90)', diceName: 'D10', type: _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceType"].D10_10TIMES, imagePathPrefix: '100_dice' },
            { menuName: 'D12', diceName: 'D12', type: _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceType"].D12, imagePathPrefix: '12_dice' },
            { menuName: 'D20', diceName: 'D20', type: _udonarium_dice_symbol__WEBPACK_IMPORTED_MODULE_9__["DiceType"].D20, imagePathPrefix: '20_dice' },
        ];
        var subMenus = [];
        dices.forEach(function (item) {
            subMenus.push({
                name: item.menuName, action: function () {
                    _this.createDiceSymbol(position, item.diceName, item.type, item.imagePathPrefix);
                    _udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["SoundEffect"].play(_udonarium_sound_effect__WEBPACK_IMPORTED_MODULE_14__["PresetSound"].dicePut);
                }
            });
        });
        return { name: 'ダイスを作成', action: null, subActions: subMenus };
    };
    TabletopService.ctorParameters = function () { return [
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
        { type: _pointer_device_service__WEBPACK_IMPORTED_MODULE_19__["PointerDeviceService"] }
    ]; };
    TabletopService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], TabletopService);
    return TabletopService;
}());

var TabletopCache = /** @class */ (function () {
    function TabletopCache(refreshCollector) {
        this.refreshCollector = refreshCollector;
        this.needsRefresh = true;
        this._objects = [];
    }
    Object.defineProperty(TabletopCache.prototype, "objects", {
        get: function () {
            if (this.needsRefresh) {
                this._objects = this.refreshCollector();
                this._objects = this._objects ? this._objects : [];
                this.needsRefresh = false;
            }
            return this._objects;
        },
        enumerable: true,
        configurable: true
    });
    TabletopCache.prototype.refresh = function () {
        this.needsRefresh = true;
    };
    return TabletopCache;
}());


/***/ }),

/***/ "./src/environments/environment.ts":
/*!*****************************************!*\
  !*** ./src/environments/environment.ts ***!
  \*****************************************/
/*! exports provided: environment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "environment", function() { return environment; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
// This file can be replaced during build by using the `fileReplacements` array.
// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.
// The list of file replacements can be found in `angular.json`.

var environment = {
    production: false
};
/*
 * For easier debugging in development mode, you can import the following file
 * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.
 *
 * This import should be commented out in production mode because it will have a negative impact
 * on performance if an error is thrown.
 */
// import 'zone.js/dist/zone-error';  // Included with Angular CLI.


/***/ }),

/***/ "./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var hammerjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! hammerjs */ "./node_modules/hammerjs/hammer.js");
/* harmony import */ var hammerjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(hammerjs__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/platform-browser-dynamic */ "./node_modules/@angular/platform-browser-dynamic/fesm5/platform-browser-dynamic.js");
/* harmony import */ var _app_app_module__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./app/app.module */ "./src/app/app.module.ts");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./environments/environment */ "./src/environments/environment.ts");






if (_environments_environment__WEBPACK_IMPORTED_MODULE_5__["environment"].production) {
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["enableProdMode"])();
}
Object(_angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_3__["platformBrowserDynamic"])().bootstrapModule(_app_app_module__WEBPACK_IMPORTED_MODULE_4__["AppModule"])
    .catch(function (err) { return console.error(err); });


/***/ }),

/***/ 0:
/*!***************************!*\
  !*** multi ./src/main.ts ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /home/tetsuro/Desktop/udon/udonarium/src/main.ts */"./src/main.ts");


/***/ })

},[[0,"runtime","vendor"]]]);
//# sourceMappingURL=main.js.map